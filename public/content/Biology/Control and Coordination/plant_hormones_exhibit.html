<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plant Hormones and Chemical Coordination</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tween.js/18.6.4/tween.umd.js"></script>

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #059669 0%, #065f46 50%, #064e3b 100%);
            color: white;
            overflow: hidden;
            position: relative;
            height: 100vh;
        }

        /* Animated Background */
        .bg-animation {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 0;
            opacity: 0.12;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320"><path fill="%23ffffff" fill-opacity="0.08" d="M0,192L48,197.3C96,203,192,213,288,192C384,171,480,117,576,122.7C672,128,768,192,864,218.7C960,245,1056,235,1152,213.3C1248,192,1344,160,1392,144L1440,128L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path></svg>') repeat-x;
            animation: wave 20s linear infinite;
        }

        @keyframes wave {
            0% { background-position-x: 0; }
            100% { background-position-x: 1440px; }
        }

        /* Museum Interface - Compact Header */
        .museum-header {
            position: absolute;
            top: 10px;
            left: 20px;
            text-align: left;
            z-index: 1000;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            padding: 10px 18px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        .museum-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 4px;
            background: linear-gradient(45deg, #10b981, #059669);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: titleGlow 3s ease-in-out infinite;
        }

        @keyframes titleGlow {
            0%, 100% { filter: brightness(1); }
            50% { filter: brightness(1.2); }
        }

        .exhibit-subtitle {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.8);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .hormone-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: #10b981;
            border-radius: 50%;
            animation: signal 2.5s ease-in-out infinite;
        }

        @keyframes signal {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.5); opacity: 0.6; }
        }

        /* Journey Navigation - Enhanced */
        .journey-navigation {
            position: absolute;
            bottom: 20px;
            left: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 1000;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            padding: 15px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            max-width: 340px;
        }

        .journey-title {
            font-size: 14px;
            font-weight: 600;
            color: #10b981;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .journey-steps {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
        }

        .journey-btn {
            background: rgba(16, 185, 129, 0.2);
            border: 1px solid rgba(16, 185, 129, 0.4);
            color: white;
            padding: 6px 10px;
            border-radius: 20px;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 4px;
            white-space: nowrap;
        }

        .journey-btn:hover {
            background: rgba(16, 185, 129, 0.3);
            border-color: #10b981;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        }

        .journey-btn.active {
            background: linear-gradient(135deg, #059669, #065f46);
            border-color: #059669;
            box-shadow: 0 0 20px rgba(5, 150, 105, 0.5);
            animation: pulse 2s infinite;
        }

        .journey-btn.completed {
            background: rgba(5, 150, 105, 0.3);
            border-color: #059669;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* 3D Model Container */
        .model-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 0;
            overflow: hidden;
            border: none;
            z-index: 100;
        }

        .sketchfab-embed-wrapper {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #059669 0%, #065f46 50%, #064e3b 100%);
        }

        .sketchfab-embed-wrapper iframe {
            width: 100%;
            height: 100%;
            border: none;
            border-radius: 0;
        }

        /* Information Panel - Enhanced */
        .info-panel {
            position: absolute;
            top: 70px;
            right: 20px;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 16px;
            padding: 24px;
            width: 440px;
            max-height: calc(100vh - 140px);
            z-index: 800;
            overflow-y: auto;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }

        .info-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
        }

        .info-icon {
            font-size: 28px;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        .info-title {
            flex: 1;
        }

        .info-title h2 {
            font-size: 18px;
            color: #059669;
            margin-bottom: 4px;
        }

        .info-subtitle {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
        }

        .info-content {
            color: rgba(255, 255, 255, 0.9);
            font-size: 14px;
            line-height: 1.6;
        }

        /* Progress Tracker */
        .progress-tracker {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(5, 150, 105, 0.1));
            border: 1px solid rgba(16, 185, 129, 0.3);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 20px;
        }

        .progress-header {
            font-size: 13px;
            font-weight: 600;
            color: #10b981;
            margin-bottom: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .progress-percentage {
            font-size: 18px;
            color: #059669;
            font-weight: 700;
        }

        .progress-bar {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 12px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #10b981, #059669);
            border-radius: 4px;
            transition: width 0.8s ease;
            box-shadow: 0 0 10px rgba(5, 150, 105, 0.5);
        }

        .progress-steps-mini {
            display: flex;
            justify-content: space-between;
            font-size: 10px;
            color: rgba(255, 255, 255, 0.6);
        }

        .step-mini {
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .step-mini.active {
            color: #059669;
            font-weight: 600;
        }

        .step-mini.completed {
            color: #10b981;
        }

        /* Information Cards */
        .info-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 14px;
            margin-bottom: 14px;
        }

        .info-card-title {
            color: #10b981;
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .info-card-content {
            color: rgba(255, 255, 255, 0.85);
            font-size: 12px;
            line-height: 1.5;
        }

        .info-list {
            list-style: none;
            padding: 0;
        }

        .info-list li {
            padding: 6px 0;
            padding-left: 20px;
            position: relative;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.8);
        }

        .info-list li:before {
            content: "→";
            position: absolute;
            left: 0;
            color: #059669;
        }

        /* Fun Fact Box */
        .fun-fact {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(5, 150, 105, 0.1));
            border: 1px solid rgba(16, 185, 129, 0.3);
            border-radius: 12px;
            padding: 14px;
            margin: 16px 0;
            position: relative;
            overflow: hidden;
        }

        .fun-fact:before {
            content: "🧪";
            position: absolute;
            top: -20px;
            right: -20px;
            font-size: 60px;
            opacity: 0.1;
        }

        .fun-fact-title {
            color: #10b981;
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 6px;
        }

        .fun-fact-text {
            color: rgba(255, 255, 255, 0.9);
            font-size: 12px;
            line-height: 1.5;
            position: relative;
            z-index: 1;
        }

        /* Voice Controls */
        .voice-controls {
            position: absolute;
            top: 10px;
            right: 20px;
            display: flex;
            gap: 8px;
            z-index: 1000;
        }

        .control-btn {
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            position: relative;
        }

        .control-btn:hover {
            background: rgba(5, 150, 105, 0.3);
            border-color: #059669;
            transform: scale(1.1);
        }

        .control-btn.active {
            background: rgba(5, 150, 105, 0.4);
            border-color: #059669;
            box-shadow: 0 0 20px rgba(5, 150, 105, 0.5);
        }

        .control-tooltip {
            position: absolute;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.9);
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 10px;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .control-btn:hover .control-tooltip {
            opacity: 1;
        }

        /* Loading Screen */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #059669 0%, #065f46 50%, #064e3b 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            transition: opacity 1s ease;
        }

        .loading-content {
            text-align: center;
        }

        .loading-hormone {
            font-size: 60px;
            animation: signal 1.5s ease-in-out infinite;
            margin-bottom: 20px;
        }

        .loading-text {
            color: white;
            font-size: 20px;
            margin-bottom: 20px;
        }

        .loading-progress {
            width: 200px;
            height: 4px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 2px;
            overflow: hidden;
        }

        .loading-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #059669, #10b981);
            animation: loading 2s ease-in-out infinite;
        }

        @keyframes loading {
            0% { width: 0%; }
            50% { width: 100%; }
            100% { width: 0%; }
        }

        /* Voice Indicator */
        .voice-indicator {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(5, 150, 105, 0.5);
            border-radius: 30px;
            padding: 14px 28px;
            display: flex;
            align-items: center;
            gap: 12px;
            z-index: 1000;
            opacity: 0;
            transition: all 0.3s ease;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }

        .voice-indicator.visible {
            opacity: 1;
            transform: translateX(-50%) translateY(-10px);
        }

        .voice-waves {
            display: flex;
            align-items: center;
            gap: 3px;
        }

        .voice-wave {
            width: 3px;
            height: 20px;
            background: linear-gradient(180deg, #059669, #10b981);
            border-radius: 2px;
            animation: voice-wave 1s ease-in-out infinite;
        }

        .voice-wave:nth-child(2) { animation-delay: 0.1s; }
        .voice-wave:nth-child(3) { animation-delay: 0.2s; }
        .voice-wave:nth-child(4) { animation-delay: 0.3s; }
        .voice-wave:nth-child(5) { animation-delay: 0.4s; }

        @keyframes voice-wave {
            0%, 100% { transform: scaleY(0.3); }
            50% { transform: scaleY(1); }
        }

        .narration-text {
            color: white;
            font-size: 13px;
            max-width: 300px;
        }

        /* Quick Actions */
        .quick-actions {
            position: absolute;
            bottom: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
            z-index: 1000;
        }

        .action-btn {
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 10px 16px;
            border-radius: 25px;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
        }

        .action-btn:hover {
            background: rgba(16, 185, 129, 0.3);
            border-color: #10b981;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        }

        /* Custom Scrollbar */
        .info-panel::-webkit-scrollbar {
            width: 6px;
        }

        .info-panel::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 3px;
        }

        .info-panel::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, #059669, #10b981);
            border-radius: 3px;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .info-panel {
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                top: auto;
                width: 100%;
                max-height: 50vh;
                border-radius: 20px 20px 0 0;
            }
            
            .journey-navigation {
                bottom: 52vh;
                max-width: calc(100% - 40px);
            }
            
            .voice-controls {
                top: auto;
                bottom: 55vh;
                right: 10px;
            }
            
            .quick-actions {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="bg-animation"></div>

    <!-- Loading Screen -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="loading-hormone">🧪</div>
            <div class="loading-text">Preparing Your Hormone Journey...</div>
            <div class="loading-progress">
                <div class="loading-progress-bar"></div>
            </div>
        </div>
    </div>

    <!-- Museum Header -->
    <div class="museum-header">
        <div class="museum-title">Plant Hormones and Chemical Coordination</div>
        <div class="exhibit-subtitle">
            <span class="hormone-indicator"></span>
            Chemical Messengers that Control Plant Life
        </div>
    </div>

    <!-- Journey Navigation -->
    <div class="journey-navigation">
        <div class="journey-title">
            <span>🧬</span>
            <span>Chemical Coordination Journey</span>
        </div>
        <div class="journey-steps">
            <button class="journey-btn active" onclick="loadJourneyStep('cellular')">
                <span>🔬</span> Cellular Basis
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('leaf')">
                <span>🍃</span> Leaf Structure
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('vascular')">
                <span>🚰</span> Transport
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('structures')">
                <span>🌿</span> Plant Parts
            </button>
        </div>
    </div>

    <!-- 3D Model Container -->
    <div class="model-container">
        <div class="sketchfab-embed-wrapper">
            <iframe id="api-frame"
                    title="Plant Hormone Model" 
                    frameborder="0" 
                    allowfullscreen 
                    mozallowfullscreen="true" 
                    webkitallowfullscreen="true" 
                    allow="autoplay; fullscreen; xr-spatial-tracking"
                    xr-spatial-tracking 
                    execution-while-out-of-viewport 
                    execution-while-not-rendered 
                    web-share 
                    src="https://sketchfab.com/models/06c34533b4f441569bfa207aff7c8a19/embed?autostart=1&internal=1&tracking=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_watermark=0">
            </iframe>
        </div>
    </div>

    <!-- Information Panel -->
    <div class="info-panel" id="infoPanel">
        <div class="info-header">
            <div class="info-icon" id="stepIcon">🔬</div>
            <div class="info-title">
                <h2 id="stepTitle">Plant Cell - Chemical Factory</h2>
                <div class="info-subtitle" id="stepSubtitle">Where hormones are synthesized and processed</div>
            </div>
        </div>

        <!-- Progress Tracker -->
        <div class="progress-tracker">
            <div class="progress-header">
                <span>Coordination Progress</span>
                <span class="progress-percentage" id="progressPercent">25%</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 25%"></div>
            </div>
            <div class="progress-steps-mini">
                <span class="step-mini active" onclick="loadJourneyStep('cellular')">Cellular</span>
                <span class="step-mini" onclick="loadJourneyStep('leaf')">Leaf</span>
                <span class="step-mini" onclick="loadJourneyStep('vascular')">Transport</span>
                <span class="step-mini" onclick="loadJourneyStep('structures')">Parts</span>
            </div>
        </div>

        <div class="info-content" id="mainDescription">
            Plant cells are sophisticated chemical factories that produce, process, and respond to hormones. These cellular structures contain specialized organelles where different hormones are synthesized and from where they coordinate plant growth, development, and responses to environmental stimuli.
        </div>

        <div class="info-card">
            <div class="info-card-title">
                <span>🧪</span> Hormone Production Sites
            </div>
            <div class="info-card-content">
                <ul class="info-list" id="keyConcepts">
                    <li>Auxins produced in shoot tips and young leaves</li>
                    <li>Gibberellins synthesized in young tissues</li>
                    <li>Cytokinins made in root tips and seeds</li>
                    <li>Abscisic acid produced in stressed tissues</li>
                </ul>
            </div>
        </div>

        <div class="fun-fact">
            <div class="fun-fact-title">Chemical Marvel!</div>
            <div class="fun-fact-text" id="funFact">
                Plant hormones work at incredibly low concentrations - sometimes just a few molecules per million can trigger major growth responses!
            </div>
        </div>

        <div class="info-card">
            <div class="info-card-title">
                <span>🎯</span> Learning Objectives
            </div>
            <div class="info-card-content" id="learningObjectives">
                Understand how plant cells produce and respond to chemical signals that coordinate growth, development, and environmental responses.
            </div>
        </div>
    </div>

    <!-- Voice Controls -->
    <div class="voice-controls">
        <button class="control-btn active" id="voiceToggle" onclick="toggleVoice()">
            🔊
            <span class="control-tooltip">Voice Narration</span>
        </button>
        <button class="control-btn" onclick="toggleAutoPlay()">
            ▶️
            <span class="control-tooltip">Auto Journey</span>
        </button>
        <button class="control-btn" onclick="toggleInfo()">
            ℹ️
            <span class="control-tooltip">Toggle Info</span>
        </button>
    </div>

    <!-- Quick Actions -->
    <div class="quick-actions">
        <button class="action-btn" onclick="startGuidedTour()">
            <span>🚀</span> Guided Tour
        </button>
        <button class="action-btn" onclick="showQuiz()">
            <span>🎯</span> Test Knowledge
        </button>
    </div>

    <!-- Voice Indicator -->
    <div class="voice-indicator" id="voiceIndicator">
        <div class="voice-waves">
            <div class="voice-wave"></div>
            <div class="voice-wave"></div>
            <div class="voice-wave"></div>
            <div class="voice-wave"></div>
            <div class="voice-wave"></div>
        </div>
        <div class="narration-text" id="narrationText">Narrating...</div>
    </div>

    <script>
        // Journey Step Data with Complete Educational Content
        const JOURNEY_DATA = {
            cellular: {
                title: "Plant Cell - Chemical Factory",
                subtitle: "Where hormones are synthesized and processed",
                icon: "🔬",
                modelUrl: "https://sketchfab.com/models/06c34533b4f441569bfa207aff7c8a19/embed?autostart=1&internal=1&tracking=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_watermark=0",
                description: "Plant cells are sophisticated chemical factories that produce, process, and respond to hormones. These cellular structures contain specialized organelles where different hormones are synthesized and from where they coordinate plant growth, development, and responses to environmental stimuli.",
                concepts: [
                    "Auxins produced in shoot tips and young leaves",
                    "Gibberellins synthesized in young tissues",
                    "Cytokinins made in root tips and seeds",
                    "Abscisic acid produced in stressed tissues"
                ],
                funFact: "Plant hormones work at incredibly low concentrations - sometimes just a few molecules per million can trigger major growth responses!",
                objectives: "Understand how plant cells produce and respond to chemical signals that coordinate growth, development, and environmental responses.",
                narration: "Welcome to the plant cell - nature's chemical coordination center! This remarkable structure is where the magic of plant hormones begins. Inside these cells, specialized organelles work as hormone factories. The endoplasmic reticulum synthesizes auxins, particularly in the shoot apical meristems where cell division is most active. Gibberellins are produced in the plastids of young, rapidly growing tissues. The mitochondria contribute to cytokinin synthesis, especially in root tips where these hormones promote cell division. When plants face stress, cells throughout the plant can produce abscisic acid to coordinate protective responses. Each hormone is a chemical messenger that can travel from cell to cell through plasmodesmata or longer distances through the vascular system. The beauty of plant hormone coordination lies in how these simple chemical signals can orchestrate complex developmental programs - from seed germination to flowering to fruit ripening - all without a nervous system!"
            },
            leaf: {
                title: "Leaf Structure - Hormone Response Center",
                subtitle: "Where light signals trigger chemical cascades",
                icon: "🍃",
                modelUrl: "https://sketchfab.com/models/e71bfcf145c742cdbbde168d0f9736b8/embed?autostart=1&internal=1&tracking=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_watermark=0",
                description: "Leaves are sophisticated hormone-sensing organs that detect light conditions and respond by producing chemical signals. The cross-section reveals specialized tissues where phototropism begins - the process by which plants bend toward light through auxin redistribution.",
                concepts: [
                    "Photoreceptors detect light direction and quality",
                    "Auxin redistribution creates differential growth",
                    "Palisade cells respond to gibberellin signals",
                    "Guard cells react to abscisic acid levels"
                ],
                funFact: "When light hits one side of a plant shoot, auxin moves to the shaded side within minutes, causing it to grow faster and bend toward the light!",
                objectives: "Explore how leaf structure enables plants to sense environmental signals and translate them into coordinated hormone responses.",
                narration: "Examine this detailed leaf cross-section - a hormone response center that detects and responds to environmental signals! The upper epidermis contains photoreceptors that sense light direction and quality. When light hits the leaf unequally, these receptors trigger a fascinating hormone redistribution. Auxin, produced in the shoot tip, gets redistributed to the shaded side of the stem. This causes cells on the shaded side to elongate faster, bending the plant toward the light source - a process called phototropism. The palisade mesophyll cells are packed with chloroplasts that not only photosynthesize but also respond to gibberelin signals that regulate leaf expansion and chlorophyll production. The spongy mesophyll contains air spaces that allow gases to move freely, while the guard cells surrounding stomata respond to abscisic acid levels to control water loss. Each tissue layer in the leaf is both a sensor and a responder in the plant's chemical communication network. This elegant system allows plants to optimize their position and physiology for maximum survival and growth!"
            },
            vascular: {
                title: "Vascular System - Hormone Highway",
                subtitle: "How chemical signals travel through plants",
                icon: "🚰",
                modelUrl: "https://sketchfab.com/models/004bb5e10c3a41c5ae10f8243a61be9d/embed?autostart=1&internal=1&tracking=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "The plant vascular system serves as a sophisticated transport network for hormones. Xylem and phloem tissues create pathways that allow chemical signals to coordinate responses throughout the entire plant body, from roots to leaves.",
                concepts: [
                    "Xylem transports cytokinins from roots upward",
                    "Phloem carries auxins and other hormones bidirectionally",
                    "Companion cells facilitate hormone loading",
                    "Vascular bundles create hormone concentration gradients"
                ],
                funFact: "Hormones can travel through the phloem at speeds up to 1 meter per hour - fast enough to coordinate responses across a tall tree in just a few hours!",
                objectives: "Understand how the vascular system enables long-distance hormone transport and whole-plant coordination.",
                narration: "Discover the plant's hormone superhighway - the vascular system that enables chemical coordination across the entire plant body! The xylem, those large circular vessels you see, primarily transport water and minerals from roots to leaves, but they also carry cytokinins upward. These hormones promote cell division and delay aging in leaves. The smaller, more complex phloem tissue is the main hormone transport system. Its sieve tube elements, supported by companion cells, carry auxins, gibberellins, and abscisic acid throughout the plant. Unlike animal circulatory systems, phloem can transport hormones bidirectionally - auxin can flow from shoots to roots to control root development, while cytokinins flow from roots to shoots to regulate leaf growth. The companion cells act as loading stations, actively pumping hormones into the phloem stream. This creates concentration gradients that help target hormones to specific tissues. The vascular bundles are arranged to create efficient distribution networks, ensuring that chemical signals reach every part of the plant. This system is so efficient that a hormone produced in a root tip can influence leaf development at the top of a tree within hours!"
            },
            structures: {
                title: "Plant Structures - Integrated Hormone Network",
                subtitle: "How different parts coordinate through chemicals",
                icon: "🌿",
                modelUrl: "https://sketchfab.com/models/f9a871a696c541eaa38e9f763ba10379/embed?autostart=1&internal=1&tracking=0&ui_ar=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "This complete plant model shows how different structures work together through hormone coordination. Each part - from roots to stems to leaves - both produces and responds to chemical signals that integrate the plant's growth and development.",
                concepts: [
                    "Apical dominance controlled by auxin from shoot tips",
                    "Root development regulated by auxin gradients",
                    "Leaf senescence delayed by cytokinin transport",
                    "Stress responses coordinated by abscisic acid"
                ],
                funFact: "A single plant can have hundreds of different hormone concentration gradients operating simultaneously to coordinate growth, defense, and reproduction!",
                objectives: "See how the entire plant functions as an integrated chemical communication network where every structure participates in hormone coordination.",
                narration: "Behold the complete plant - an integrated network of chemical communication that rivals any computer system! Every structure you see participates in hormone coordination. The shoot apical meristem at the tip produces auxin that travels downward, maintaining apical dominance by suppressing lateral bud growth. This is why pruning the top of a plant causes side branches to grow. The roots produce cytokinins that travel upward through the xylem, promoting cell division in shoots and delaying leaf aging. When leaves start to yellow with age, it's often because cytokinin supply from roots is decreasing. The mature leaves produce auxin that flows down to roots, stimulating root development and branching. The entire system creates a feedback loop - healthy roots support vigorous shoot growth, which produces more auxin to stimulate more root growth. During stress, any tissue can produce abscisic acid, which travels throughout the plant to coordinate water conservation responses. The beauty of this system is its redundancy and integration - if one part is damaged, other parts can compensate by adjusting their hormone production. This chemical coordination network allows plants to function as unified organisms despite having no nervous system!"
            }
        };

        // Global Variables
        let currentStep = 'cellular';
        let voiceEnabled = true;
        let autoPlayEnabled = false;
        let currentSpeech = null;
        let selectedVoice = null;
        let journeyProgress = 25;
        let guidedTourActive = false;

        // Initialize Voice System
        function initVoiceSystem() {
            if (!('speechSynthesis' in window)) {
                console.warn('Speech synthesis not supported');
                voiceEnabled = false;
                document.getElementById('voiceToggle').style.display = 'none';
                return;
            }

            function loadVoices() {
                const voices = speechSynthesis.getVoices();
                if (voices.length === 0) return;

                const preferredVoices = [
                    'Google UK English Female',
                    'Microsoft Sonia',
                    'Microsoft Hazel',
                    'Samantha',
                    'Victoria'
                ];

                for (const name of preferredVoices) {
                    selectedVoice = voices.find(v => v.name.includes(name));
                    if (selectedVoice) break;
                }

                if (!selectedVoice) {
                    selectedVoice = voices.find(v => v.lang.startsWith('en'));
                }
            }

            loadVoices();
            if (speechSynthesis.onvoiceschanged !== undefined) {
                speechSynthesis.onvoiceschanged = loadVoices;
            }
        }

        // Load Journey Step
        function loadJourneyStep(stepId) {
            const stepData = JOURNEY_DATA[stepId];
            if (!stepData) return;

            currentStep = stepId;
            
            // Update model
            document.getElementById('api-frame').src = stepData.modelUrl;
            
            // Update info panel
            document.getElementById('stepIcon').textContent = stepData.icon;
            document.getElementById('stepTitle').textContent = stepData.title;
            document.getElementById('stepSubtitle').textContent = stepData.subtitle;
            document.getElementById('mainDescription').textContent = stepData.description;
            
            // Update key concepts
            const conceptsList = document.getElementById('keyConcepts');
            conceptsList.innerHTML = stepData.concepts.map(c => `<li>${c}</li>`).join('');
            
            // Update fun fact
            document.getElementById('funFact').textContent = stepData.funFact;
            
            // Update learning objectives
            document.getElementById('learningObjectives').textContent = stepData.objectives;
            
            // Update navigation buttons
            updateNavigationButtons(stepId);
            
            // Update progress
            updateProgress();
            
            // Play narration if enabled
            if (voiceEnabled) {
                speakText(stepData.narration);
            }
        }

        // Update Navigation Buttons
        function updateNavigationButtons(activeStep) {
            const buttons = document.querySelectorAll('.journey-btn');
            const steps = ['cellular', 'leaf', 'vascular', 'structures'];
            const activeIndex = steps.indexOf(activeStep);
            
            buttons.forEach((btn, index) => {
                btn.classList.remove('active', 'completed');
                if (index < activeIndex) {
                    btn.classList.add('completed');
                } else if (index === activeIndex) {
                    btn.classList.add('active');
                }
            });
            
            // Update mini steps
            const miniSteps = document.querySelectorAll('.step-mini');
            miniSteps.forEach((step, index) => {
                step.classList.remove('active', 'completed');
                if (index < activeIndex) {
                    step.classList.add('completed');
                } else if (index === activeIndex) {
                    step.classList.add('active');
                }
            });
        }

        // Update Progress
        function updateProgress() {
            const steps = ['cellular', 'leaf', 'vascular', 'structures'];
            const currentIndex = steps.indexOf(currentStep);
            const progress = ((currentIndex + 1) / steps.length) * 100;
            
            document.getElementById('progressPercent').textContent = Math.round(progress) + '%';
            document.getElementById('progressFill').style.width = progress + '%';
        }

        // Speech Functions
        function speakText(text) {
            if (!voiceEnabled || !text) return;
            
            stopSpeech();
            
            currentSpeech = new SpeechSynthesisUtterance(text);
            if (selectedVoice) {
                currentSpeech.voice = selectedVoice;
            }
            currentSpeech.rate = 0.9;
            currentSpeech.pitch = 1.0;
            currentSpeech.volume = 0.9;
            
            currentSpeech.onstart = () => {
                document.getElementById('voiceIndicator').classList.add('visible');
                document.getElementById('narrationText').textContent = 
                    text.substring(0, 50) + (text.length > 50 ? '...' : '');
            };
            
            currentSpeech.onend = () => {
                document.getElementById('voiceIndicator').classList.remove('visible');
                currentSpeech = null;
                
                // Auto-advance if guided tour is active
                if (guidedTourActive) {
                    setTimeout(nextStep, 2000);
                }
            };
            
            speechSynthesis.speak(currentSpeech);
        }

        function stopSpeech() {
            if (currentSpeech) {
                speechSynthesis.cancel();
                currentSpeech = null;
                document.getElementById('voiceIndicator').classList.remove('visible');
            }
        }

        // Control Functions
        function toggleVoice() {
            voiceEnabled = !voiceEnabled;
            const btn = document.getElementById('voiceToggle');
            btn.textContent = voiceEnabled ? '🔊' : '🔇';
            btn.classList.toggle('active', voiceEnabled);
            
            if (!voiceEnabled) {
                stopSpeech();
            }
        }

        function toggleAutoPlay() {
            autoPlayEnabled = !autoPlayEnabled;
            if (autoPlayEnabled) {
                startGuidedTour();
            } else {
                guidedTourActive = false;
            }
        }

        function toggleInfo() {
            const panel = document.getElementById('infoPanel');
            panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
        }

        // Guided Tour
        function startGuidedTour() {
            guidedTourActive = true;
            const steps = ['cellular', 'leaf', 'vascular', 'structures'];
            let stepIndex = 0;
            
            function tourStep() {
                if (stepIndex < steps.length && guidedTourActive) {
                    loadJourneyStep(steps[stepIndex]);
                    stepIndex++;
                } else {
                    guidedTourActive = false;
                    if (voiceEnabled) {
                        speakText("Incredible! You've explored how plants use chemical coordination to integrate their entire body. From cellular hormone factories to transport highways, plants demonstrate that complex coordination doesn't require a nervous system - just elegant chemistry!");
                    }
                }
            }
            
            tourStep();
            window.nextStep = tourStep;
        }

        // Quiz Function
        function showQuiz() {
            const questions = [
                "How do auxins control plant growth and development?",
                "What role do cytokinins play in plant coordination?",
                "How do plants transport hormones throughout their body?",
                "What triggers phototropism in plants?",
                "How do different plant hormones work together?"
            ];
            
            const randomQ = questions[Math.floor(Math.random() * questions.length)];
            
            if (voiceEnabled) {
                speakText(`Here's a question to test your knowledge: ${randomQ} Think about the amazing chemical coordination systems you've discovered!`);
            }
        }

        // Initialize
        function init() {
            initVoiceSystem();
            
            // Hide loading screen
            setTimeout(() => {
                const loading = document.getElementById('loadingOverlay');
                loading.style.opacity = '0';
                setTimeout(() => {
                    loading.style.display = 'none';
                    
                    // Welcome message
                    if (voiceEnabled) {
                        speakText("Welcome to the world of plant hormones and chemical coordination! Discover how plants use sophisticated chemical messaging systems to coordinate growth, development, and responses to their environment. Let's start by exploring the cellular basis of hormone production!");
                    }
                }, 1000);
            }, 3000);
            
            // Keyboard shortcuts
            document.addEventListener('keydown', (e) => {
                switch(e.key) {
                    case 'v': toggleVoice(); break;
                    case 'i': toggleInfo(); break;
                    case 'g': startGuidedTour(); break;
                    case 'Escape': stopSpeech(); guidedTourActive = false; break;
                    case 'ArrowRight': nextStep && nextStep(); break;
                }
            });
        }

        // Start the application
        init();
    </script>
</body>
</html>