<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Animal Hormones - Introduction and Adrenaline</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tween.js/18.6.4/tween.umd.js"></script>

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #dc2626 0%, #b91c1c 50%, #991b1b 100%);
            color: white;
            overflow: hidden;
            position: relative;
            height: 100vh;
        }

        /* Animated Background */
        .bg-animation {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 0;
            opacity: 0.08;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320"><path fill="%23ffffff" fill-opacity="0.1" d="M0,288L48,272C96,256,192,224,288,197.3C384,171,480,149,576,165.3C672,181,768,235,864,250.7C960,267,1056,245,1152,250.7C1248,256,1344,288,1392,304L1440,320L1440,0L1392,0C1344,0,1248,0,1152,0C1056,0,960,0,864,0C768,0,672,0,576,0C480,0,384,0,288,0C192,0,96,0,48,0L0,0Z"></path></svg>') repeat-x;
            animation: wave 18s linear infinite;
        }

        @keyframes wave {
            0% { background-position-x: 0; }
            100% { background-position-x: 1440px; }
        }

        /* Museum Interface - Compact Header */
        .museum-header {
            position: absolute;
            top: 10px;
            left: 20px;
            text-align: left;
            z-index: 1000;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            padding: 10px 18px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        .museum-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 4px;
            background: linear-gradient(45deg, #ef4444, #dc2626);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: titleGlow 3s ease-in-out infinite;
        }

        @keyframes titleGlow {
            0%, 100% { filter: brightness(1); }
            50% { filter: brightness(1.2); }
        }

        .exhibit-subtitle {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.8);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .hormone-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: #ef4444;
            border-radius: 50%;
            animation: pulse-hormone 1.8s ease-in-out infinite;
        }

        @keyframes pulse-hormone {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.4); opacity: 0.7; }
        }

        /* Journey Navigation - Enhanced */
        .journey-navigation {
            position: absolute;
            bottom: 20px;
            left: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 1000;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            padding: 15px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            max-width: 360px;
        }

        .journey-title {
            font-size: 14px;
            font-weight: 600;
            color: #ef4444;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .journey-steps {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
        }

        .journey-btn {
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid rgba(239, 68, 68, 0.4);
            color: white;
            padding: 6px 10px;
            border-radius: 20px;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 4px;
            white-space: nowrap;
        }

        .journey-btn:hover {
            background: rgba(239, 68, 68, 0.3);
            border-color: #ef4444;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
        }

        .journey-btn.active {
            background: linear-gradient(135deg, #dc2626, #b91c1c);
            border-color: #dc2626;
            box-shadow: 0 0 20px rgba(220, 38, 38, 0.5);
            animation: pulse 2s infinite;
        }

        .journey-btn.completed {
            background: rgba(220, 38, 38, 0.3);
            border-color: #dc2626;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* 3D Model Container */
        .model-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 0;
            overflow: hidden;
            border: none;
            z-index: 100;
        }

        .sketchfab-embed-wrapper {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #dc2626 0%, #b91c1c 50%, #991b1b 100%);
        }

        .sketchfab-embed-wrapper iframe {
            width: 100%;
            height: 100%;
            border: none;
            border-radius: 0;
        }

        /* Information Panel - Enhanced */
        .info-panel {
            position: absolute;
            top: 70px;
            right: 20px;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 16px;
            padding: 24px;
            width: 460px;
            max-height: calc(100vh - 140px);
            z-index: 800;
            overflow-y: auto;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }

        .info-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
        }

        .info-icon {
            font-size: 28px;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        .info-title {
            flex: 1;
        }

        .info-title h2 {
            font-size: 18px;
            color: #dc2626;
            margin-bottom: 4px;
        }

        .info-subtitle {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
        }

        .info-content {
            color: rgba(255, 255, 255, 0.9);
            font-size: 14px;
            line-height: 1.6;
        }

        /* Progress Tracker */
        .progress-tracker {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.1), rgba(220, 38, 38, 0.1));
            border: 1px solid rgba(239, 68, 68, 0.3);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 20px;
        }

        .progress-header {
            font-size: 13px;
            font-weight: 600;
            color: #ef4444;
            margin-bottom: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .progress-percentage {
            font-size: 18px;
            color: #dc2626;
            font-weight: 700;
        }

        .progress-bar {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 12px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #ef4444, #dc2626);
            border-radius: 4px;
            transition: width 0.8s ease;
            box-shadow: 0 0 10px rgba(220, 38, 38, 0.5);
        }

        .progress-steps-mini {
            display: flex;
            justify-content: space-between;
            font-size: 9px;
            color: rgba(255, 255, 255, 0.6);
        }

        .step-mini {
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .step-mini.active {
            color: #dc2626;
            font-weight: 600;
        }

        .step-mini.completed {
            color: #ef4444;
        }

        /* Information Cards */
        .info-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 14px;
            margin-bottom: 14px;
        }

        .info-card-title {
            color: #ef4444;
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .info-card-content {
            color: rgba(255, 255, 255, 0.85);
            font-size: 12px;
            line-height: 1.5;
        }

        .info-list {
            list-style: none;
            padding: 0;
        }

        .info-list li {
            padding: 6px 0;
            padding-left: 20px;
            position: relative;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.8);
        }

        .info-list li:before {
            content: "→";
            position: absolute;
            left: 0;
            color: #dc2626;
        }

        /* Fun Fact Box */
        .fun-fact {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.1), rgba(220, 38, 38, 0.1));
            border: 1px solid rgba(239, 68, 68, 0.3);
            border-radius: 12px;
            padding: 14px;
            margin: 16px 0;
            position: relative;
            overflow: hidden;
        }

        .fun-fact:before {
            content: "⚡";
            position: absolute;
            top: -20px;
            right: -20px;
            font-size: 60px;
            opacity: 0.1;
        }

        .fun-fact-title {
            color: #ef4444;
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 6px;
        }

        .fun-fact-text {
            color: rgba(255, 255, 255, 0.9);
            font-size: 12px;
            line-height: 1.5;
            position: relative;
            z-index: 1;
        }

        /* Voice Controls */
        .voice-controls {
            position: absolute;
            top: 10px;
            right: 20px;
            display: flex;
            gap: 8px;
            z-index: 1000;
        }

        .control-btn {
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            position: relative;
        }

        .control-btn:hover {
            background: rgba(220, 38, 38, 0.3);
            border-color: #dc2626;
            transform: scale(1.1);
        }

        .control-btn.active {
            background: rgba(220, 38, 38, 0.4);
            border-color: #dc2626;
            box-shadow: 0 0 20px rgba(220, 38, 38, 0.5);
        }

        .control-tooltip {
            position: absolute;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.9);
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 10px;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .control-btn:hover .control-tooltip {
            opacity: 1;
        }

        /* Loading Screen */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #dc2626 0%, #b91c1c 50%, #991b1b 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            transition: opacity 1s ease;
        }

        .loading-content {
            text-align: center;
        }

        .loading-hormone {
            font-size: 60px;
            animation: pulse-hormone 1.5s ease-in-out infinite;
            margin-bottom: 20px;
        }

        .loading-text {
            color: white;
            font-size: 20px;
            margin-bottom: 20px;
        }

        .loading-progress {
            width: 200px;
            height: 4px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 2px;
            overflow: hidden;
        }

        .loading-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #dc2626, #ef4444);
            animation: loading 2s ease-in-out infinite;
        }

        @keyframes loading {
            0% { width: 0%; }
            50% { width: 100%; }
            100% { width: 0%; }
        }

        /* Voice Indicator */
        .voice-indicator {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(220, 38, 38, 0.5);
            border-radius: 30px;
            padding: 14px 28px;
            display: flex;
            align-items: center;
            gap: 12px;
            z-index: 1000;
            opacity: 0;
            transition: all 0.3s ease;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }

        .voice-indicator.visible {
            opacity: 1;
            transform: translateX(-50%) translateY(-10px);
        }

        .voice-waves {
            display: flex;
            align-items: center;
            gap: 3px;
        }

        .voice-wave {
            width: 3px;
            height: 20px;
            background: linear-gradient(180deg, #dc2626, #ef4444);
            border-radius: 2px;
            animation: voice-wave 1s ease-in-out infinite;
        }

        .voice-wave:nth-child(2) { animation-delay: 0.1s; }
        .voice-wave:nth-child(3) { animation-delay: 0.2s; }
        .voice-wave:nth-child(4) { animation-delay: 0.3s; }
        .voice-wave:nth-child(5) { animation-delay: 0.4s; }

        @keyframes voice-wave {
            0%, 100% { transform: scaleY(0.3); }
            50% { transform: scaleY(1); }
        }

        .narration-text {
            color: white;
            font-size: 13px;
            max-width: 300px;
        }

        /* Quick Actions */
        .quick-actions {
            position: absolute;
            bottom: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
            z-index: 1000;
        }

        .action-btn {
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 10px 16px;
            border-radius: 25px;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
        }

        .action-btn:hover {
            background: rgba(239, 68, 68, 0.3);
            border-color: #ef4444;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
        }

        /* Custom Scrollbar */
        .info-panel::-webkit-scrollbar {
            width: 6px;
        }

        .info-panel::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 3px;
        }

        .info-panel::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, #dc2626, #ef4444);
            border-radius: 3px;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .info-panel {
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                top: auto;
                width: 100%;
                max-height: 50vh;
                border-radius: 20px 20px 0 0;
            }
            
            .journey-navigation {
                bottom: 52vh;
                max-width: calc(100% - 40px);
            }
            
            .voice-controls {
                top: auto;
                bottom: 55vh;
                right: 10px;
            }
            
            .quick-actions {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="bg-animation"></div>

    <!-- Loading Screen -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="loading-hormone">⚡</div>
            <div class="loading-text">Preparing Your Hormone Journey...</div>
            <div class="loading-progress">
                <div class="loading-progress-bar"></div>
            </div>
        </div>
    </div>

    <!-- Museum Header -->
    <div class="museum-header">
        <div class="museum-title">Animal Hormones - Introduction and Adrenaline</div>
        <div class="exhibit-subtitle">
            <span class="hormone-indicator"></span>
            Chemical Messengers of the Animal Body
        </div>
    </div>

    <!-- Journey Navigation -->
    <div class="journey-navigation">
        <div class="journey-title">
            <span>🧪</span>
            <span>Endocrine System Journey</span>
        </div>
        <div class="journey-steps">
            <button class="journey-btn active" onclick="loadJourneyStep('adrenal')">
                <span>⚡</span> Adrenal Gland
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('circulatory')">
                <span>🩸</span> Transport
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('hypothalamus')">
                <span>🧠</span> Control Center
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('pituitary')">
                <span>👑</span> Master Gland
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('pancreas')">
                <span>🍃</span> Pancreas
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('molecule')">
                <span>🔬</span> Adrenaline
            </button>
        </div>
    </div>

    <!-- 3D Model Container -->
    <div class="model-container">
        <div class="sketchfab-embed-wrapper">
            <iframe id="api-frame"
                    title="Animal Hormone Model" 
                    frameborder="0" 
                    allowfullscreen 
                    mozallowfullscreen="true" 
                    webkitallowfullscreen="true" 
                    allow="autoplay; fullscreen; xr-spatial-tracking"
                    xr-spatial-tracking 
                    execution-while-out-of-viewport 
                    execution-while-not-rendered 
                    web-share 
                    src="https://sketchfab.com/models/271e40e97ae048b3bea75e91a82bc84b/embed?autostart=1&internal=1&tracking=0&ui_ar=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0">
            </iframe>
        </div>
    </div>

    <!-- Information Panel -->
    <div class="info-panel" id="infoPanel">
        <div class="info-header">
            <div class="info-icon" id="stepIcon">⚡</div>
            <div class="info-title">
                <h2 id="stepTitle">Adrenal Gland - The Emergency Response Center</h2>
                <div class="info-subtitle" id="stepSubtitle">Source of the fight-or-flight hormone</div>
            </div>
        </div>

        <!-- Progress Tracker -->
        <div class="progress-tracker">
            <div class="progress-header">
                <span>Endocrine Progress</span>
                <span class="progress-percentage" id="progressPercent">17%</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 17%"></div>
            </div>
            <div class="progress-steps-mini">
                <span class="step-mini active" onclick="loadJourneyStep('adrenal')">Adrenal</span>
                <span class="step-mini" onclick="loadJourneyStep('circulatory')">Transport</span>
                <span class="step-mini" onclick="loadJourneyStep('hypothalamus')">Brain</span>
                <span class="step-mini" onclick="loadJourneyStep('pituitary')">Master</span>
                <span class="step-mini" onclick="loadJourneyStep('pancreas')">Pancreas</span>
                <span class="step-mini" onclick="loadJourneyStep('molecule')">Molecule</span>
            </div>
        </div>

        <div class="info-content" id="mainDescription">
            The adrenal glands sit atop your kidneys like small caps, constantly monitoring your body's stress levels. When danger strikes, these remarkable organs release adrenaline (epinephrine) in seconds, transforming your entire physiology for maximum survival performance.
        </div>

        <div class="info-card">
            <div class="info-card-title">
                <span>⚡</span> Fight-or-Flight Effects
            </div>
            <div class="info-card-content">
                <ul class="info-list" id="keyConcepts">
                    <li>Heart rate increases dramatically</li>
                    <li>Blood pressure rises for better circulation</li>
                    <li>Breathing becomes deeper and faster</li>
                    <li>Glucose released for instant energy</li>
                </ul>
            </div>
        </div>

        <div class="fun-fact">
            <div class="fun-fact-title">Survival Mechanism!</div>
            <div class="fun-fact-text" id="funFact">
                Adrenaline can increase your strength by up to 15% and your heart rate to over 180 beats per minute - preparing your body for extraordinary physical performance!
            </div>
        </div>

        <div class="info-card">
            <div class="info-card-title">
                <span>🎯</span> Learning Objectives
            </div>
            <div class="info-card-content" id="learningObjectives">
                Understand how the adrenal glands coordinate rapid, body-wide responses to stress through hormone release and circulatory transport.
            </div>
        </div>
    </div>

    <!-- Voice Controls -->
    <div class="voice-controls">
        <button class="control-btn active" id="voiceToggle" onclick="toggleVoice()">
            🔊
            <span class="control-tooltip">Voice Narration</span>
        </button>
        <button class="control-btn" onclick="toggleAutoPlay()">
            ▶️
            <span class="control-tooltip">Auto Journey</span>
        </button>
        <button class="control-btn" onclick="toggleInfo()">
            ℹ️
            <span class="control-tooltip">Toggle Info</span>
        </button>
    </div>

    <!-- Quick Actions -->
    <div class="quick-actions">
        <button class="action-btn" onclick="startGuidedTour()">
            <span>🚀</span> Guided Tour
        </button>
        <button class="action-btn" onclick="showQuiz()">
            <span>🎯</span> Test Knowledge
        </button>
    </div>

    <!-- Voice Indicator -->
    <div class="voice-indicator" id="voiceIndicator">
        <div class="voice-waves">
            <div class="voice-wave"></div>
            <div class="voice-wave"></div>
            <div class="voice-wave"></div>
            <div class="voice-wave"></div>
            <div class="voice-wave"></div>
        </div>
        <div class="narration-text" id="narrationText">Narrating...</div>
    </div>

    <script>
        // Journey Step Data with Complete Educational Content
        const JOURNEY_DATA = {
            adrenal: {
                title: "Adrenal Gland - The Emergency Response Center",
                subtitle: "Source of the fight-or-flight hormone",
                icon: "⚡",
                modelUrl: "https://sketchfab.com/models/271e40e97ae048b3bea75e91a82bc84b/embed?autostart=1&internal=1&tracking=0&ui_ar=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "The adrenal glands sit atop your kidneys like small caps, constantly monitoring your body's stress levels. When danger strikes, these remarkable organs release adrenaline (epinephrine) in seconds, transforming your entire physiology for maximum survival performance.",
                concepts: [
                    "Heart rate increases dramatically",
                    "Blood pressure rises for better circulation",
                    "Breathing becomes deeper and faster",
                    "Glucose released for instant energy"
                ],
                funFact: "Adrenaline can increase your strength by up to 15% and your heart rate to over 180 beats per minute - preparing your body for extraordinary physical performance!",
                objectives: "Understand how the adrenal glands coordinate rapid, body-wide responses to stress through hormone release and circulatory transport.",
                narration: "Welcome to the adrenal glands - your body's emergency response headquarters! These small but mighty organs sit like caps on top of your kidneys, constantly ready to flood your system with life-saving hormones. The cross-section reveals two distinct regions: the outer cortex produces steroid hormones like cortisol for long-term stress management, while the inner medulla is your adrenaline factory. When your brain perceives danger - whether real or imagined - nerve signals race to the adrenal medulla in milliseconds. Specialized chromaffin cells immediately release adrenaline and noradrenaline into your bloodstream. Within seconds, this chemical messenger reaches every organ in your body, triggering the fight-or-flight response. Your heart pounds faster to pump more oxygen-rich blood, your breathing deepens to take in more air, your liver dumps glucose for instant energy, and your muscles receive enhanced blood flow. This coordinated response transforms you from everyday human into a survival machine, ready to fight threats or flee to safety!"
            },
            circulatory: {
                title: "Circulatory System - The Hormone Highway",
                subtitle: "How adrenaline reaches every cell",
                icon: "🩸",
                modelUrl: "https://sketchfab.com/models/e7abdabd3a6d422cb25e6e63b45b1ab0/embed?autostart=1&internal=1&tracking=0&ui_ar=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "The circulatory system serves as the body's hormone delivery network. When adrenaline is released from the adrenal glands, it travels through blood vessels to reach target organs throughout the body, enabling coordinated responses in seconds.",
                concepts: [
                    "Hormones dissolve in blood plasma",
                    "Arteries carry hormones away from glands",
                    "Capillaries allow hormone-cell interaction",
                    "Venous return completes the cycle"
                ],
                funFact: "Adrenaline can circulate through your entire body in less than 60 seconds, reaching from your adrenal glands to your brain in just 8 seconds!",
                objectives: "Explore how the cardiovascular system enables rapid hormone distribution and whole-body coordination during stress responses.",
                narration: "Witness the incredible hormone highway - your circulatory system in action! When adrenaline is released from the adrenal glands, it doesn't just sit there - it immediately enters the bloodstream and begins a high-speed journey throughout your body. The hormone molecules dissolve in blood plasma and are carried by red blood cells through your arteries. From the adrenal veins, adrenaline enters the inferior vena cava and reaches your heart within seconds. Your heart then pumps this hormone-rich blood through the aorta and into every major artery system. The carotid arteries carry adrenaline to your brain, enhancing alertness and focus. Coronary arteries deliver it to your heart muscle, increasing contraction strength. Renal arteries bring it to your kidneys, which respond by conserving water and electrolytes. In the microscopic capillaries, adrenaline molecules pass through vessel walls to bind with receptor proteins on target cells. This triggers specific cellular responses - muscle cells contract more forcefully, liver cells release stored glucose, and lung cells relax airways for better breathing. The beauty of this system is its speed and precision - within one heartbeat, adrenaline can reach virtually every cell in your body!"
            },
            hypothalamus: {
                title: "Hypothalamus - The Master Controller",
                subtitle: "Brain's hormone command center",
                icon: "🧠",
                modelUrl: "https://sketchfab.com/models/f762a8b8cdd14ac5bf0d62d5b1725a40/embed?autostart=1&internal=1&tracking=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_watermark=0",
                description: "The hypothalamus is the brain's hormone control center, integrating nervous and endocrine systems. It detects stress, processes emotions, and coordinates hormonal responses by controlling both the pituitary gland and direct neural pathways to the adrenals.",
                concepts: [
                    "Integrates nervous and endocrine systems",
                    "Detects internal and external stress signals",
                    "Controls pituitary hormone release",
                    "Sends direct signals to adrenal medulla"
                ],
                funFact: "Despite being only 3 grams - less than the weight of a penny - the hypothalamus controls your entire endocrine system and can trigger body-wide responses in milliseconds!",
                objectives: "Understand how the hypothalamus serves as the master coordinator between your brain and hormone system.",
                narration: "Behold the hypothalamus - the master coordinator that bridges your nervous and endocrine systems! This tiny but incredibly powerful brain region sits just above your brainstem, constantly monitoring your internal state and external environment. It contains specialized neurons that can both conduct electrical signals like regular nerve cells and secrete hormones like endocrine glands. When you perceive a threat, sensory information flows into the hypothalamus from your eyes, ears, and other senses. Emotional processing from the limbic system also feeds into this control center. The hypothalamus rapidly evaluates this information and can trigger responses through two pathways: the fast neural pathway and the slower hormonal pathway. For immediate response, it sends electrical signals through the sympathetic nervous system directly to the adrenal medulla, triggering adrenaline release in under a second. For sustained response, it releases corticotropin-releasing hormone into the hypothalamic-pituitary portal system, ultimately leading to cortisol production. The hypothalamus also regulates body temperature, hunger, thirst, and sleep cycles - making it the ultimate body management system. Its neurons contain receptors for virtually every hormone in your body, allowing it to maintain precise homeostasis while coordinating emergency responses when needed!"
            },
            pituitary: {
                title: "Pituitary Gland - The Master Gland",
                subtitle: "Coordinator of endocrine responses",
                icon: "👑",
                modelUrl: "https://sketchfab.com/models/71df89f271204233ae89ee6156f9836a/embed?autostart=1&internal=1&tracking=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_watermark=0",
                description: "The pituitary gland, often called the 'master gland,' receives commands from the hypothalamus and controls other endocrine glands throughout the body. It orchestrates long-term stress responses that complement adrenaline's immediate effects.",
                concepts: [
                    "Anterior lobe produces tropic hormones",
                    "Posterior lobe releases hypothalamic hormones",
                    "ACTH stimulates cortisol production",
                    "Growth hormone affects metabolism"
                ],
                funFact: "The pituitary gland is only the size of a pea but produces over 8 different hormones that control growth, metabolism, reproduction, and stress responses!",
                objectives: "Learn how the pituitary gland serves as the master coordinator of the endocrine system and supports the body's stress response.",
                narration: "Enter the pituitary gland - the master conductor of your body's hormone orchestra! This pea-sized gland dangles from your hypothalamus like a puppet on strings, but don't let its size fool you - it controls virtually every other hormone-producing gland in your body. The pituitary has two distinct lobes with different functions. The posterior lobe is essentially an extension of the hypothalamus, storing and releasing hormones like vasopressin and oxytocin that are made in the brain. The anterior lobe is where the real hormonal magic happens. When the hypothalamus detects stress, it releases corticotropin-releasing hormone into a special portal blood system that connects directly to the anterior pituitary. This triggers the release of ACTH - adrenocorticotropic hormone - which travels through your bloodstream to the adrenal cortex. There, ACTH stimulates the production of cortisol, the body's long-term stress hormone that helps sustain the fight-or-flight response. The anterior pituitary also produces growth hormone, which during stress helps mobilize energy stores, and thyroid-stimulating hormone, which can speed up metabolism. This creates a beautifully coordinated response: adrenaline provides immediate action, while pituitary-controlled hormones sustain and support your body through prolonged stress!"
            },
            pancreas: {
                title: "Pancreas - The Metabolic Regulator",
                subtitle: "Glucose control during stress",
                icon: "🍃",
                modelUrl: "https://sketchfab.com/models/8acf64dc315b49308b4fcbd47e48b92b/embed?autostart=1&internal=1&tracking=0&ui_ar=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "The pancreas plays a crucial role in the stress response by regulating blood glucose levels. During adrenaline release, it adjusts insulin and glucagon production to ensure muscles and brain have adequate fuel for the fight-or-flight response.",
                concepts: [
                    "Beta cells produce insulin to lower glucose",
                    "Alpha cells produce glucagon to raise glucose",
                    "Adrenaline inhibits insulin release",
                    "Stress hormones promote glucagon action"
                ],
                funFact: "During a stress response, your pancreas can triple glucagon production while nearly stopping insulin release, ensuring your muscles have maximum fuel available!",
                objectives: "Understand how the pancreas coordinates with the stress response to provide optimal energy availability during emergencies.",
                narration: "Explore the pancreas - your body's metabolic command center that ensures you have the fuel needed for survival! This elongated organ behind your stomach serves dual roles: producing digestive enzymes and regulating blood sugar through hormone release. The cross-section reveals clusters of cells called islets of Langerhans scattered throughout the pancreatic tissue like islands in a sea. These islets contain three main cell types that work together to manage your energy supply. Beta cells produce insulin, which normally helps cells absorb glucose from the bloodstream. Alpha cells produce glucagon, which signals the liver to release stored glucose when blood sugar drops. During a stress response triggered by adrenaline, this system shifts dramatically. Adrenaline directly inhibits beta cells, reducing insulin production so that glucose stays in the bloodstream rather than being stored in cells. Simultaneously, stress hormones enhance the action of alpha cells, increasing glucagon production. This hormonal shift ensures that glucose - your body's preferred fuel - remains readily available in your blood for immediate use by your muscles and brain. The liver responds to these signals by breaking down glycogen stores and even creating new glucose from proteins and fats. This metabolic coordination is essential because fight-or-flight responses require enormous amounts of energy, and the pancreas ensures that fuel is available exactly when and where your body needs it most!"
            },
            molecule: {
                title: "Adrenaline Molecule - The Chemical Messenger",
                subtitle: "Structure determines function",
                icon: "🔬",
                modelUrl: "https://sketchfab.com/models/6fa584d84f204399a8668ebb65dc673a/embed?autostart=1&internal=1&tracking=0&ui_ar=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "The adrenaline molecule's unique structure allows it to bind specifically to adrenergic receptors throughout the body. This small chemical messenger can trigger cascades of cellular responses that coordinate the entire fight-or-flight reaction.",
                concepts: [
                    "Catecholamine structure with benzene ring",
                    "Hydroxyl groups enable receptor binding",
                    "Amine group allows blood transport",
                    "Binds to alpha and beta adrenergic receptors"
                ],
                funFact: "One adrenaline molecule weighs only 0.3 attograms - that's 0.0000000000000000003 grams - yet it can trigger responses involving billions of cells!",
                objectives: "Examine how adrenaline's molecular structure enables it to function as a rapid, body-wide chemical coordinator.",
                narration: "Witness the adrenaline molecule - a tiny chemical masterpiece that can transform your entire physiology! This remarkable structure, also known as epinephrine, belongs to a family of compounds called catecholamines. The molecule consists of a benzene ring with two hydroxyl groups, making it a catechol, attached to an ethylamine side chain. This specific arrangement is crucial for its function. The benzene ring provides stability and allows the molecule to fit precisely into receptor binding sites. The hydroxyl groups act like molecular keys that unlock specific adrenergic receptors found throughout your body. The amine group makes the molecule water-soluble, allowing it to travel freely in your bloodstream. When adrenaline reaches a target cell, it binds to one of two main receptor types: alpha receptors, which generally cause muscle contraction and blood vessel constriction, or beta receptors, which typically cause muscle relaxation and increased heart rate. This binding triggers a cascade of chemical reactions inside the cell, amplifying the original signal millions of times. One adrenaline molecule binding to a receptor can activate hundreds of enzyme molecules, each of which can process thousands of substrate molecules. This amplification system means that even tiny amounts of adrenaline can create massive physiological changes. The molecule's structure is so perfectly designed that it can coordinate responses in your heart, lungs, muscles, liver, and brain simultaneously - all from a single chemical signal!"
            }
        };

        // Global Variables
        let currentStep = 'adrenal';
        let voiceEnabled = true;
        let autoPlayEnabled = false;
        let currentSpeech = null;
        let selectedVoice = null;
        let journeyProgress = 17;
        let guidedTourActive = false;

        // Initialize Voice System
        function initVoiceSystem() {
            if (!('speechSynthesis' in window)) {
                console.warn('Speech synthesis not supported');
                voiceEnabled = false;
                document.getElementById('voiceToggle').style.display = 'none';
                return;
            }

            function loadVoices() {
                const voices = speechSynthesis.getVoices();
                if (voices.length === 0) return;

                const preferredVoices = [
                    'Google UK English Female',
                    'Microsoft Sonia',
                    'Microsoft Hazel',
                    'Samantha',
                    'Victoria'
                ];

                for (const name of preferredVoices) {
                    selectedVoice = voices.find(v => v.name.includes(name));
                    if (selectedVoice) break;
                }

                if (!selectedVoice) {
                    selectedVoice = voices.find(v => v.lang.startsWith('en'));
                }
            }

            loadVoices();
            if (speechSynthesis.onvoiceschanged !== undefined) {
                speechSynthesis.onvoiceschanged = loadVoices;
            }
        }

        // Load Journey Step
        function loadJourneyStep(stepId) {
            const stepData = JOURNEY_DATA[stepId];
            if (!stepData) return;

            currentStep = stepId;
            
            // Update model
            document.getElementById('api-frame').src = stepData.modelUrl;
            
            // Update info panel
            document.getElementById('stepIcon').textContent = stepData.icon;
            document.getElementById('stepTitle').textContent = stepData.title;
            document.getElementById('stepSubtitle').textContent = stepData.subtitle;
            document.getElementById('mainDescription').textContent = stepData.description;
            
            // Update key concepts
            const conceptsList = document.getElementById('keyConcepts');
            conceptsList.innerHTML = stepData.concepts.map(c => `<li>${c}</li>`).join('');
            
            // Update fun fact
            document.getElementById('funFact').textContent = stepData.funFact;
            
            // Update learning objectives
            document.getElementById('learningObjectives').textContent = stepData.objectives;
            
            // Update navigation buttons
            updateNavigationButtons(stepId);
            
            // Update progress
            updateProgress();
            
            // Play narration if enabled
            if (voiceEnabled) {
                speakText(stepData.narration);
            }
        }

        // Update Navigation Buttons
        function updateNavigationButtons(activeStep) {
            const buttons = document.querySelectorAll('.journey-btn');
            const steps = ['adrenal', 'circulatory', 'hypothalamus', 'pituitary', 'pancreas', 'molecule'];
            const activeIndex = steps.indexOf(activeStep);
            
            buttons.forEach((btn, index) => {
                btn.classList.remove('active', 'completed');
                if (index < activeIndex) {
                    btn.classList.add('completed');
                } else if (index === activeIndex) {
                    btn.classList.add('active');
                }
            });
            
            // Update mini steps
            const miniSteps = document.querySelectorAll('.step-mini');
            miniSteps.forEach((step, index) => {
                step.classList.remove('active', 'completed');
                if (index < activeIndex) {
                    step.classList.add('completed');
                } else if (index === activeIndex) {
                    step.classList.add('active');
                }
            });
        }

        // Update Progress
        function updateProgress() {
            const steps = ['adrenal', 'circulatory', 'hypothalamus', 'pituitary', 'pancreas', 'molecule'];
            const currentIndex = steps.indexOf(currentStep);
            const progress = ((currentIndex + 1) / steps.length) * 100;
            
            document.getElementById('progressPercent').textContent = Math.round(progress) + '%';
            document.getElementById('progressFill').style.width = progress + '%';
        }

        // Speech Functions
        function speakText(text) {
            if (!voiceEnabled || !text) return;
            
            stopSpeech();
            
            currentSpeech = new SpeechSynthesisUtterance(text);
            if (selectedVoice) {
                currentSpeech.voice = selectedVoice;
            }
            currentSpeech.rate = 0.9;
            currentSpeech.pitch = 1.0;
            currentSpeech.volume = 0.9;
            
            currentSpeech.onstart = () => {
                document.getElementById('voiceIndicator').classList.add('visible');
                document.getElementById('narrationText').textContent = 
                    text.substring(0, 50) + (text.length > 50 ? '...' : '');
            };
            
            currentSpeech.onend = () => {
                document.getElementById('voiceIndicator').classList.remove('visible');
                currentSpeech = null;
                
                // Auto-advance if guided tour is active
                if (guidedTourActive) {
                    setTimeout(nextStep, 2000);
                }
            };
            
            speechSynthesis.speak(currentSpeech);
        }

        function stopSpeech() {
            if (currentSpeech) {
                speechSynthesis.cancel();
                currentSpeech = null;
                document.getElementById('voiceIndicator').classList.remove('visible');
            }
        }

        // Control Functions
        function toggleVoice() {
            voiceEnabled = !voiceEnabled;
            const btn = document.getElementById('voiceToggle');
            btn.textContent = voiceEnabled ? '🔊' : '🔇';
            btn.classList.toggle('active', voiceEnabled);
            
            if (!voiceEnabled) {
                stopSpeech();
            }
        }

        function toggleAutoPlay() {
            autoPlayEnabled = !autoPlayEnabled;
            if (autoPlayEnabled) {
                startGuidedTour();
            } else {
                guidedTourActive = false;
            }
        }

        function toggleInfo() {
            const panel = document.getElementById('infoPanel');
            panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
        }

        // Guided Tour
        function startGuidedTour() {
            guidedTourActive = true;
            const steps = ['adrenal', 'circulatory', 'hypothalamus', 'pituitary', 'pancreas', 'molecule'];
            let stepIndex = 0;
            
            function tourStep() {
                if (stepIndex < steps.length && guidedTourActive) {
                    loadJourneyStep(steps[stepIndex]);
                    stepIndex++;
                } else {
                    guidedTourActive = false;
                    if (voiceEnabled) {
                        speakText("Outstanding! You've explored the complete endocrine system and the remarkable adrenaline response. From brain control centers to molecular messengers, you now understand how chemical coordination enables rapid, body-wide responses that can mean the difference between life and death!");
                    }
                }
            }
            
            tourStep();
            window.nextStep = tourStep;
        }

        // Quiz Function
        function showQuiz() {
            const questions = [
                "What triggers the release of adrenaline from the adrenal glands?",
                "How does adrenaline travel throughout the body so quickly?",
                "What role does the hypothalamus play in stress responses?",
                "How do hormones coordinate with the nervous system?",
                "What makes adrenaline such an effective chemical messenger?"
            ];
            
            const randomQ = questions[Math.floor(Math.random() * questions.length)];
            
            if (voiceEnabled) {
                speakText(`Here's a question to test your knowledge: ${randomQ} Think about the incredible coordination systems you've discovered in the endocrine system!`);
            }
        }

        // Initialize
        function init() {
            initVoiceSystem();
            
            // Hide loading screen
            setTimeout(() => {
                const loading = document.getElementById('loadingOverlay');
                loading.style.opacity = '0';
                setTimeout(() => {
                    loading.style.display = 'none';
                    
                    // Welcome message
                    if (voiceEnabled) {
                        speakText("Welcome to the world of animal hormones and chemical coordination! Discover how your endocrine system uses powerful chemical messengers to coordinate rapid, life-saving responses. We'll start by exploring the adrenal glands - your body's emergency response centers!");
                    }
                }, 1000);
            }, 3000);
            
            // Keyboard shortcuts
            document.addEventListener('keydown', (e) => {
                switch(e.key) {
                    case 'v': toggleVoice(); break;
                    case 'i': toggleInfo(); break;
                    case 'g': startGuidedTour(); break;
                    case 'Escape': stopSpeech(); guidedTourActive = false; break;
                    case 'ArrowRight': nextStep && nextStep(); break;
                }
            });
        }

        // Start the application
        init();
    </script>
</body>
</html>