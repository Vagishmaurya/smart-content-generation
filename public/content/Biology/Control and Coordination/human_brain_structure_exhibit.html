<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Human Brain Structure and Functions - The Command Center of Life</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tween.js/18.6.4/tween.umd.js"></script>

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            color: white;
            overflow: hidden;
            position: relative;
            height: 100vh;
        }

        /* Animated Background */
        .bg-animation {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 0;
            opacity: 0.1;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320"><path fill="%23ffffff" fill-opacity="0.2" d="M0,96L48,112C96,128,192,160,288,186.7C384,213,480,235,576,213.3C672,192,768,128,864,128C960,128,1056,192,1152,197.3C1248,203,1344,149,1392,122.7L1440,96L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path></svg>') repeat-x;
            animation: wave 30s linear infinite;
        }

        @keyframes wave {
            0% { background-position-x: 0; }
            100% { background-position-x: 1440px; }
        }

        /* Museum Interface - Compact Header */
        .museum-header {
            position: absolute;
            top: 10px;
            left: 20px;
            text-align: left;
            z-index: 1000;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            padding: 10px 18px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        .museum-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 4px;
            background: linear-gradient(45deg, #667eea, #f093fb);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: titleGlow 3s ease-in-out infinite;
        }

        @keyframes titleGlow {
            0%, 100% { filter: brightness(1); }
            50% { filter: brightness(1.2); }
        }

        .exhibit-subtitle {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.8);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .brain-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: #f093fb;
            border-radius: 50%;
            animation: brain-pulse 2s ease-in-out infinite;
        }

        @keyframes brain-pulse {
            0%, 100% { transform: scale(1); opacity: 1; box-shadow: 0 0 0 0 rgba(240, 147, 251, 0.7); }
            50% { transform: scale(1.2); opacity: 0.8; box-shadow: 0 0 0 10px rgba(240, 147, 251, 0); }
        }

        /* Journey Navigation - Enhanced */
        .journey-navigation {
            position: absolute;
            bottom: 20px;
            left: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 1000;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            padding: 15px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            max-width: 360px;
        }

        .journey-title {
            font-size: 14px;
            font-weight: 600;
            color: #667eea;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .journey-steps {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
        }

        .journey-btn {
            background: rgba(102, 126, 234, 0.2);
            border: 1px solid rgba(102, 126, 234, 0.4);
            color: white;
            padding: 6px 10px;
            border-radius: 20px;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 4px;
            white-space: nowrap;
        }

        .journey-btn:hover {
            background: rgba(102, 126, 234, 0.3);
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        .journey-btn.active {
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-color: #667eea;
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.5);
            animation: pulse 2s infinite;
        }

        .journey-btn.completed {
            background: rgba(240, 147, 251, 0.3);
            border-color: #f093fb;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* 3D Model Container */
        .model-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 0;
            overflow: hidden;
            border: none;
            z-index: 100;
        }

        .sketchfab-embed-wrapper {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
        }

        .sketchfab-embed-wrapper iframe {
            width: 100%;
            height: 100%;
            border: none;
            border-radius: 0;
        }

        /* Information Panel - Enhanced */
        .info-panel {
            position: absolute;
            top: 70px;
            right: 20px;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 16px;
            padding: 24px;
            width: 380px;
            max-height: calc(100vh - 140px);
            z-index: 800;
            overflow-y: auto;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }

        .info-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
        }

        .info-icon {
            font-size: 28px;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        .info-title {
            flex: 1;
        }

        .info-title h2 {
            font-size: 18px;
            color: #667eea;
            margin-bottom: 4px;
        }

        .info-subtitle {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
        }

        .info-content {
            color: rgba(255, 255, 255, 0.9);
            font-size: 14px;
            line-height: 1.6;
        }

        /* Progress Tracker */
        .progress-tracker {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(240, 147, 251, 0.1));
            border: 1px solid rgba(102, 126, 234, 0.3);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 20px;
        }

        .progress-header {
            font-size: 13px;
            font-weight: 600;
            color: #667eea;
            margin-bottom: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .progress-percentage {
            font-size: 18px;
            color: #f093fb;
            font-weight: 700;
        }

        .progress-bar {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 12px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #f093fb);
            border-radius: 4px;
            transition: width 0.8s ease;
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.5);
        }

        .progress-steps-mini {
            display: flex;
            justify-content: space-between;
            font-size: 8px;
            color: rgba(255, 255, 255, 0.6);
        }

        .step-mini {
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .step-mini.active {
            color: #667eea;
            font-weight: 600;
        }

        .step-mini.completed {
            color: #f093fb;
        }

        /* Information Cards */
        .info-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 14px;
            margin-bottom: 14px;
        }

        .info-card-title {
            color: #667eea;
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .info-card-content {
            color: rgba(255, 255, 255, 0.85);
            font-size: 12px;
            line-height: 1.5;
        }

        .info-list {
            list-style: none;
            padding: 0;
        }

        .info-list li {
            padding: 6px 0;
            padding-left: 20px;
            position: relative;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.8);
        }

        .info-list li:before {
            content: "🧠";
            position: absolute;
            left: 0;
            font-size: 10px;
        }

        /* Brain Fact Box */
        .brain-fact {
            background: linear-gradient(135deg, rgba(240, 147, 251, 0.1), rgba(102, 126, 234, 0.1));
            border: 1px solid rgba(240, 147, 251, 0.3);
            border-radius: 12px;
            padding: 14px;
            margin: 16px 0;
            position: relative;
            overflow: hidden;
        }

        .brain-fact:before {
            content: "🧠";
            position: absolute;
            top: -20px;
            right: -20px;
            font-size: 60px;
            opacity: 0.1;
        }

        .brain-fact-title {
            color: #f093fb;
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 6px;
        }

        .brain-fact-text {
            color: rgba(255, 255, 255, 0.9);
            font-size: 12px;
            line-height: 1.5;
            position: relative;
            z-index: 1;
        }

        /* Voice Controls */
        .voice-controls {
            position: absolute;
            top: 10px;
            right: 20px;
            display: flex;
            gap: 8px;
            z-index: 1000;
        }

        .control-btn {
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            position: relative;
        }

        .control-btn:hover {
            background: rgba(102, 126, 234, 0.3);
            border-color: #667eea;
            transform: scale(1.1);
        }

        .control-btn.active {
            background: rgba(102, 126, 234, 0.4);
            border-color: #667eea;
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.5);
        }

        .control-tooltip {
            position: absolute;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.9);
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 10px;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .control-btn:hover .control-tooltip {
            opacity: 1;
        }

        /* Loading Screen */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            transition: opacity 1s ease;
        }

        .loading-content {
            text-align: center;
        }

        .loading-brain {
            font-size: 60px;
            animation: brain-activity 3s ease-in-out infinite;
            margin-bottom: 20px;
        }

        @keyframes brain-activity {
            0%, 100% { transform: scale(1) rotate(0deg); filter: brightness(1); }
            33% { transform: scale(1.1) rotate(5deg); filter: brightness(1.3); }
            66% { transform: scale(0.95) rotate(-3deg); filter: brightness(1.1); }
        }

        .loading-text {
            color: white;
            font-size: 20px;
            margin-bottom: 20px;
        }

        .loading-progress {
            width: 200px;
            height: 4px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 2px;
            overflow: hidden;
        }

        .loading-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #f093fb);
            animation: loading 2s ease-in-out infinite;
        }

        @keyframes loading {
            0% { width: 0%; }
            50% { width: 100%; }
            100% { width: 0%; }
        }

        /* Voice Indicator */
        .voice-indicator {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(102, 126, 234, 0.5);
            border-radius: 30px;
            padding: 14px 28px;
            display: flex;
            align-items: center;
            gap: 12px;
            z-index: 1000;
            opacity: 0;
            transition: all 0.3s ease;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }

        .voice-indicator.visible {
            opacity: 1;
            transform: translateX(-50%) translateY(-10px);
        }

        .voice-waves {
            display: flex;
            align-items: center;
            gap: 3px;
        }

        .voice-wave {
            width: 3px;
            height: 20px;
            background: linear-gradient(180deg, #667eea, #f093fb);
            border-radius: 2px;
            animation: voice-wave 1s ease-in-out infinite;
        }

        .voice-wave:nth-child(2) { animation-delay: 0.1s; }
        .voice-wave:nth-child(3) { animation-delay: 0.2s; }
        .voice-wave:nth-child(4) { animation-delay: 0.3s; }
        .voice-wave:nth-child(5) { animation-delay: 0.4s; }

        @keyframes voice-wave {
            0%, 100% { transform: scaleY(0.3); }
            50% { transform: scaleY(1); }
        }

        .narration-text {
            color: white;
            font-size: 13px;
            max-width: 300px;
        }

        /* Quick Actions */
        .quick-actions {
            position: absolute;
            bottom: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
            z-index: 1000;
        }

        .action-btn {
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 10px 16px;
            border-radius: 25px;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
        }

        .action-btn:hover {
            background: rgba(102, 126, 234, 0.3);
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        /* Custom Scrollbar */
        .info-panel::-webkit-scrollbar {
            width: 6px;
        }

        .info-panel::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 3px;
        }

        .info-panel::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, #667eea, #f093fb);
            border-radius: 3px;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .info-panel {
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                top: auto;
                width: 100%;
                max-height: 50vh;
                border-radius: 20px 20px 0 0;
            }
            
            .journey-navigation {
                bottom: 52vh;
                max-width: calc(100% - 40px);
            }
            
            .voice-controls {
                top: auto;
                bottom: 55vh;
                right: 10px;
            }
            
            .quick-actions {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="bg-animation"></div>

    <!-- Loading Screen -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="loading-brain">🧠</div>
            <div class="loading-text">Preparing Your Brain Journey...</div>
            <div class="loading-progress">
                <div class="loading-progress-bar"></div>
            </div>
        </div>
    </div>

    <!-- Museum Header -->
    <div class="museum-header">
        <div class="museum-title">Human Brain Structure and Functions</div>
        <div class="exhibit-subtitle">
            <span class="brain-indicator"></span>
            The Command Center of Life
        </div>
    </div>

    <!-- Journey Navigation -->
    <div class="journey-navigation">
        <div class="journey-title">
            <span>🧠</span>
            <span>Your Brain Journey</span>
        </div>
        <div class="journey-steps">
            <button class="journey-btn active" onclick="loadJourneyStep('brain_overview')">
                <span>🧠</span> Brain Overview
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('cns')">
                <span>🔗</span> CNS
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('cerebrum')">
                <span>⚡</span> Cerebrum
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('cerebellum')">
                <span>🎯</span> Cerebellum
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('medulla')">
                <span>💓</span> Medulla
            </button>
        </div>
    </div>

    <!-- 3D Model Container -->
    <div class="model-container">
        <div class="sketchfab-embed-wrapper">
            <iframe id="api-frame"
                    title="Brain Sagittal Section Model" 
                    frameborder="0" 
                    allowfullscreen 
                    mozallowfullscreen="true" 
                    webkitallowfullscreen="true" 
                    allow="autoplay; fullscreen; xr-spatial-tracking"
                    xr-spatial-tracking 
                    execution-while-out-of-viewport 
                    execution-while-not-rendered 
                    web-share 
                    src="https://sketchfab.com/models/1a7556d3b0ec424b96c314a2b45c64d6/embed?autostart=1&internal=1&tracking=0&ui_ar=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0">
            </iframe>
        </div>
    </div>

    <!-- Information Panel -->
    <div class="info-panel" id="infoPanel">
        <div class="info-header">
            <div class="info-icon" id="stepIcon">🧠</div>
            <div class="info-title">
                <h2 id="stepTitle">Brain Overview - The Master Control Center</h2>
                <div class="info-subtitle" id="stepSubtitle">Exploring the three main brain divisions</div>
            </div>
        </div>

        <!-- Progress Tracker -->
        <div class="progress-tracker">
            <div class="progress-header">
                <span>Brain Learning Progress</span>
                <span class="progress-percentage" id="progressPercent">20%</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 20%"></div>
            </div>
            <div class="progress-steps-mini">
                <span class="step-mini active" onclick="loadJourneyStep('brain_overview')">Overview</span>
                <span class="step-mini" onclick="loadJourneyStep('cns')">CNS</span>
                <span class="step-mini" onclick="loadJourneyStep('cerebrum')">Cerebrum</span>
                <span class="step-mini" onclick="loadJourneyStep('cerebellum')">Cerebellum</span>
                <span class="step-mini" onclick="loadJourneyStep('medulla')">Medulla</span>
            </div>
        </div>

        <div class="info-content" id="mainDescription">
            The human brain is the most complex organ in the known universe, containing approximately 86 billion neurons. This sagittal section reveals the three major divisions: the forebrain, midbrain, and hindbrain, each with specialized functions that work together to control every aspect of human life.
        </div>

        <div class="info-card">
            <div class="info-card-title">
                <span>🔬</span> Brain Divisions
            </div>
            <div class="info-card-content">
                <ul class="info-list" id="keyConcepts">
                    <li>Forebrain: cerebrum and diencephalon for higher functions</li>
                    <li>Midbrain: connects forebrain and hindbrain, reflexes</li>
                    <li>Hindbrain: cerebellum, pons, medulla for vital functions</li>
                    <li>Each region specialized for specific life processes</li>
                </ul>
            </div>
        </div>

        <div class="brain-fact">
            <div class="brain-fact-title">Brain Insight</div>
            <div class="brain-fact-text" id="brainFact">
                Despite weighing only about 3 pounds (2% of body weight), the human brain consumes approximately 20% of the body's total energy, demonstrating its incredible metabolic demands for complex thinking and consciousness.
            </div>
        </div>

        <div class="info-card">
            <div class="info-card-title">
                <span>🎯</span> Learning Objectives
            </div>
            <div class="info-card-content" id="learningObjectives">
                Identify the major brain divisions and understand how each region contributes to voluntary and involuntary actions that sustain human life and enable complex behaviors.
            </div>
        </div>
    </div>

    <!-- Voice Controls -->
    <div class="voice-controls">
        <button class="control-btn active" id="voiceToggle" onclick="toggleVoice()">
            🔊
            <span class="control-tooltip">Voice Narration</span>
        </button>
        <button class="control-btn" onclick="toggleAutoPlay()">
            ▶️
            <span class="control-tooltip">Auto Journey</span>
        </button>
        <button class="control-btn" onclick="toggleInfo()">
            ℹ️
            <span class="control-tooltip">Toggle Info</span>
        </button>
    </div>

    <!-- Quick Actions -->
    <div class="quick-actions">
        <button class="action-btn" onclick="startGuidedTour()">
            <span>🚀</span> Guided Tour
        </button>
        <button class="action-btn" onclick="showQuiz()">
            <span>🎯</span> Test Knowledge
        </button>
    </div>

    <!-- Voice Indicator -->
    <div class="voice-indicator" id="voiceIndicator">
        <div class="voice-waves">
            <div class="voice-wave"></div>
            <div class="voice-wave"></div>
            <div class="voice-wave"></div>
            <div class="voice-wave"></div>
            <div class="voice-wave"></div>
        </div>
        <div class="narration-text" id="narrationText">Narrating...</div>
    </div>

    <script>
        // Journey Step Data with Complete Educational Content
        const JOURNEY_DATA = {
            brain_overview: {
                title: "Brain Overview - The Master Control Center",
                subtitle: "Exploring the three main brain divisions",
                icon: "🧠",
                modelUrl: "https://sketchfab.com/models/1a7556d3b0ec424b96c314a2b45c64d6/embed?autostart=1&internal=1&tracking=0&ui_ar=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "The human brain is the most complex organ in the known universe, containing approximately 86 billion neurons. This sagittal section reveals the three major divisions: the forebrain, midbrain, and hindbrain, each with specialized functions that work together to control every aspect of human life.",
                concepts: [
                    "Forebrain: cerebrum and diencephalon for higher functions",
                    "Midbrain: connects forebrain and hindbrain, reflexes",
                    "Hindbrain: cerebellum, pons, medulla for vital functions",
                    "Each region specialized for specific life processes"
                ],
                brainFact: "Despite weighing only about 3 pounds (2% of body weight), the human brain consumes approximately 20% of the body's total energy, demonstrating its incredible metabolic demands for complex thinking and consciousness.",
                objectives: "Identify the major brain divisions and understand how each region contributes to voluntary and involuntary actions that sustain human life and enable complex behaviors.",
                narration: "Welcome to the human brain - the most sophisticated structure in the known universe! This sagittal section shows the brain's remarkable organization into three major divisions, each with specialized roles. The forebrain, located at the front and top, includes the cerebrum with its wrinkled cortex where conscious thought, memory, and voluntary movements are controlled. The diencephalon, part of the forebrain, contains structures like the thalamus and hypothalamus that regulate vital functions and relay information. The midbrain, though small, serves as a crucial relay station between higher and lower brain regions, controlling reflexes and eye movements. The hindbrain includes the cerebellum for balance and coordination, the pons for sleep and arousal, and the medulla for essential life functions like breathing and heart rate. This hierarchical organization allows the brain to simultaneously manage complex voluntary actions like solving problems while automatically maintaining involuntary functions that keep us alive."
            },
            cns: {
                title: "Central Nervous System - Brain and Spinal Cord Unity",
                subtitle: "The integrated command and control network",
                icon: "🔗",
                modelUrl: "https://sketchfab.com/models/2e6be1399756494b9f185ce8c5900911/embed?autostart=1&internal=1&tracking=0&ui_ar=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "The central nervous system consists of the brain and spinal cord working as an integrated unit. This model shows how the brain connects seamlessly with the spinal cord to form a continuous information processing system that coordinates all body functions.",
                concepts: [
                    "Brain processes complex information and makes decisions",
                    "Spinal cord relays signals between brain and body",
                    "Continuous neural pathways connect all body regions",
                    "Protected by bone and cerebrospinal fluid"
                ],
                brainFact: "The spinal cord contains about 13.5 million neurons and serves as a two-way highway carrying up to 1 billion nerve signals between the brain and body every second.",
                objectives: "Understand how the brain and spinal cord work together as the central nervous system to coordinate voluntary and involuntary actions throughout the body.",
                narration: "Observe the central nervous system as an integrated whole - the brain and spinal cord working in perfect unity! This model demonstrates how these structures form one continuous system protected by bone and bathed in cerebrospinal fluid. The brain serves as the command center, processing sensory information, making decisions, and initiating responses. The spinal cord acts as the information superhighway, carrying messages between the brain and the rest of the body through ascending and descending pathways. Ascending pathways carry sensory information from the body to the brain, while descending pathways carry motor commands from the brain to muscles and glands. This two-way communication happens at incredible speeds, allowing for real-time coordination of complex behaviors. The spinal cord also has its own processing capabilities, handling reflexes independently to provide immediate protection. The seamless integration between brain and spinal cord enables the nervous system to simultaneously manage conscious activities like reading this text while unconsciously regulating breathing, heart rate, and countless other vital functions."
            },
            cerebrum: {
                title: "Cerebrum - The Seat of Consciousness",
                subtitle: "Higher thinking and voluntary control",
                icon: "⚡",
                modelUrl: "https://sketchfab.com/models/b0b618dc553d42068611a4c1b5a0b80b/embed?autostart=1&internal=1&tracking=0&ui_ar=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "The cerebrum is the largest part of the human brain, responsible for consciousness, thinking, memory, and voluntary movements. Its highly folded cortex maximizes surface area for billions of neurons that process complex information and control sophisticated behaviors.",
                concepts: [
                    "Cerebral cortex contains billions of neurons for processing",
                    "Four lobes: frontal, parietal, temporal, occipital",
                    "Controls voluntary movements and conscious thought",
                    "Gray matter processes information, white matter connects"
                ],
                brainFact: "If the cerebral cortex were flattened out, it would cover an area about the size of a large pizza (roughly 2.5 square feet), but evolution has folded it to fit inside the skull.",
                objectives: "Explore cerebrum structure and understand how this brain region enables complex thinking, voluntary movements, and conscious experiences that define human intelligence.",
                narration: "Enter the cerebrum - the crown jewel of human evolution and the seat of everything that makes us uniquely human! This massive structure comprises about 85% of total brain weight and houses the neural networks responsible for consciousness, reasoning, language, and voluntary movement. The outer layer, the cerebral cortex, is a thin sheet of gray matter packed with billions of neurons arranged in six distinct layers. Each layer has specialized functions, creating a sophisticated information processing system. The cortex is divided into four lobes: the frontal lobe handles executive functions and motor control, the parietal lobe processes sensory information and spatial awareness, the temporal lobe manages hearing and memory, and the occipital lobe processes vision. Beneath the cortex lies white matter - bundles of myelinated axons that connect different brain regions, enabling rapid communication across the entire cerebrum. The cerebrum's remarkable folding pattern, called gyri and sulci, dramatically increases surface area while fitting within the skull. This is where voluntary actions originate - every conscious decision to move, speak, or think begins in the cerebrum's neural networks."
            },
            cerebellum: {
                title: "Cerebellum - The Precision Coordinator",
                subtitle: "Balance, coordination, and motor learning",
                icon: "🎯",
                modelUrl: "https://sketchfab.com/models/3a4e017a202a4928b666371d075d0e21/embed?autostart=1&internal=1&tracking=0&ui_ar=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "The cerebellum, meaning 'little brain,' is a highly organized structure that fine-tunes movement and maintains balance. Despite being only 10% of brain weight, it contains over half of all brain neurons, enabling precise coordination and motor learning.",
                concepts: [
                    "Contains over 50% of all brain neurons despite small size",
                    "Fine-tunes movements initiated by cerebrum",
                    "Maintains balance and posture",
                    "Essential for motor learning and coordination"
                ],
                brainFact: "The cerebellum contains more neurons than the rest of the brain combined - approximately 69 billion neurons packed into its highly organized, layered structure.",
                objectives: "Understand how the cerebellum coordinates voluntary movements and maintains balance, demonstrating the distinction between initiation and refinement of motor actions.",
                narration: "Discover the cerebellum - the brain's master coordinator that transforms clumsy movements into graceful, precise actions! This remarkable structure, whose name means 'little brain,' demonstrates that size doesn't always correlate with importance. Despite comprising only 10% of the brain's weight, the cerebellum contains an astounding 69 billion neurons - more than the rest of the brain combined! These neurons are arranged in a highly organized, crystalline structure with three distinct layers that create an incredibly efficient processing system. The cerebellum receives input from virtually every part of the nervous system: sensory information about body position, visual input about the environment, and copies of motor commands from the cerebrum. It uses this information to constantly compare intended movements with actual movements, making real-time adjustments to ensure smooth, coordinated action. When you learn to ride a bicycle or play a musical instrument, it's your cerebellum that stores these motor memories and automates complex movement patterns. The cerebellum also maintains balance by continuously processing information from the inner ear and adjusting muscle tone throughout the body. Without the cerebellum, movements would be jerky, uncoordinated, and imprecise - highlighting how voluntary actions require both cerebral initiation and cerebellar refinement."
            },
            medulla: {
                title: "Medulla Oblongata - The Life Sustainer",
                subtitle: "Vital involuntary functions and reflexes",
                icon: "💓",
                modelUrl: "https://sketchfab.com/models/0f6b3fd34ab840cd9d65ce44c4a913e1/embed?autostart=1&internal=1&tracking=0&ui_ar=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "The medulla oblongata, shown here in blue, is the most vital part of the brainstem, controlling essential involuntary functions like breathing, heart rate, and blood pressure. This small but crucial region keeps us alive without conscious effort.",
                concepts: [
                    "Controls breathing, heart rate, and blood pressure",
                    "Manages swallowing, coughing, and vomiting reflexes",
                    "Contains vital cardiovascular and respiratory centers",
                    "Operates completely without conscious control"
                ],
                brainFact: "The medulla is so essential that damage to this small region can be immediately life-threatening, as it controls the automatic functions that sustain life every second of every day.",
                objectives: "Understand how the medulla controls involuntary vital functions and appreciate the critical distinction between voluntary cerebral control and involuntary brainstem regulation.",
                narration: "Behold the medulla oblongata - the small but mighty brain region that literally keeps you alive! This blue-colored structure in the model represents the most crucial part of your brainstem, containing control centers for functions so vital that they operate completely outside conscious awareness. The medulla houses the respiratory center that automatically adjusts your breathing rate based on carbon dioxide levels in your blood. Even when you're asleep or unconscious, this center ensures you continue breathing. The cardiac center regulates heart rate and the strength of heart contractions, responding to the body's changing needs without any conscious input. The vasomotor center controls blood pressure by adjusting the diameter of blood vessels throughout your body. The medulla also manages protective reflexes like coughing, sneezing, swallowing, and vomiting - responses that occur automatically when triggered by appropriate stimuli. This represents the clearest example of involuntary action in the nervous system - while your cerebrum controls voluntary movements like raising your hand, your medulla controls involuntary functions like your heartbeat. The medulla demonstrates how the brain has evolved specialized regions for different types of control, ensuring that life-sustaining functions continue reliably regardless of what else you're thinking about or doing."
            }
        };

        // Global Variables
        let currentStep = 'brain_overview';
        let voiceEnabled = true;
        let autoPlayEnabled = false;
        let currentSpeech = null;
        let selectedVoice = null;
        let journeyProgress = 0;
        let guidedTourActive = false;

        // Initialize Voice System
        function initVoiceSystem() {
            if (!('speechSynthesis' in window)) {
                console.warn('Speech synthesis not supported');
                voiceEnabled = false;
                document.getElementById('voiceToggle').style.display = 'none';
                return;
            }

            function loadVoices() {
                const voices = speechSynthesis.getVoices();
                if (voices.length === 0) return;

                // Prefer natural-sounding voices
                const preferredVoices = [
                    'Google UK English Female',
                    'Microsoft Sonia',
                    'Microsoft Hazel',
                    'Samantha',
                    'Victoria'
                ];

                for (const name of preferredVoices) {
                    selectedVoice = voices.find(v => v.name.includes(name));
                    if (selectedVoice) break;
                }

                if (!selectedVoice) {
                    selectedVoice = voices.find(v => v.lang.startsWith('en'));
                }
            }

            loadVoices();
            if (speechSynthesis.onvoiceschanged !== undefined) {
                speechSynthesis.onvoiceschanged = loadVoices;
            }
        }

        // Load Journey Step
        function loadJourneyStep(stepId) {
            const stepData = JOURNEY_DATA[stepId];
            if (!stepData) return;

            currentStep = stepId;
            
            // Update model
            document.getElementById('api-frame').src = stepData.modelUrl;
            
            // Update info panel
            document.getElementById('stepIcon').textContent = stepData.icon;
            document.getElementById('stepTitle').textContent = stepData.title;
            document.getElementById('stepSubtitle').textContent = stepData.subtitle;
            document.getElementById('mainDescription').textContent = stepData.description;
            
            // Update key concepts
            const conceptsList = document.getElementById('keyConcepts');
            conceptsList.innerHTML = stepData.concepts.map(c => `<li>${c}</li>`).join('');
            
            // Update brain fact
            document.getElementById('brainFact').textContent = stepData.brainFact;
            
            // Update learning objectives
            document.getElementById('learningObjectives').textContent = stepData.objectives;
            
            // Update navigation buttons
            updateNavigationButtons(stepId);
            
            // Update progress
            updateProgress();
            
            // Play narration if enabled
            if (voiceEnabled) {
                speakText(stepData.narration);
            }
        }

        // Update Navigation Buttons
        function updateNavigationButtons(activeStep) {
            const buttons = document.querySelectorAll('.journey-btn');
            const steps = ['brain_overview', 'cns', 'cerebrum', 'cerebellum', 'medulla'];
            const activeIndex = steps.indexOf(activeStep);
            
            buttons.forEach((btn, index) => {
                btn.classList.remove('active', 'completed');
                if (index < activeIndex) {
                    btn.classList.add('completed');
                } else if (index === activeIndex) {
                    btn.classList.add('active');
                }
            });
            
            // Update mini steps
            const miniSteps = document.querySelectorAll('.step-mini');
            miniSteps.forEach((step, index) => {
                step.classList.remove('active', 'completed');
                if (index < activeIndex) {
                    step.classList.add('completed');
                } else if (index === activeIndex) {
                    step.classList.add('active');
                }
            });
        }

        // Update Progress
        function updateProgress() {
            const steps = ['brain_overview', 'cns', 'cerebrum', 'cerebellum', 'medulla'];
            const currentIndex = steps.indexOf(currentStep);
            const progress = ((currentIndex + 1) / steps.length) * 100;
            
            document.getElementById('progressPercent').textContent = Math.round(progress) + '%';
            document.getElementById('progressFill').style.width = progress + '%';
        }

        // Speech Functions
        function speakText(text) {
            if (!voiceEnabled || !text) return;
            
            stopSpeech();
            
            currentSpeech = new SpeechSynthesisUtterance(text);
            if (selectedVoice) {
                currentSpeech.voice = selectedVoice;
            }
            currentSpeech.rate = 0.9;
            currentSpeech.pitch = 1.0;
            currentSpeech.volume = 0.9;
            
            currentSpeech.onstart = () => {
                document.getElementById('voiceIndicator').classList.add('visible');
                document.getElementById('narrationText').textContent = 
                    text.substring(0, 50) + (text.length > 50 ? '...' : '');
            };
            
            currentSpeech.onend = () => {
                document.getElementById('voiceIndicator').classList.remove('visible');
                currentSpeech = null;
                
                // Auto-advance if guided tour is active
                if (guidedTourActive) {
                    setTimeout(nextStep, 2000);
                }
            };
            
            speechSynthesis.speak(currentSpeech);
        }

        function stopSpeech() {
            if (currentSpeech) {
                speechSynthesis.cancel();
                currentSpeech = null;
                document.getElementById('voiceIndicator').classList.remove('visible');
            }
        }

        // Control Functions
        function toggleVoice() {
            voiceEnabled = !voiceEnabled;
            const btn = document.getElementById('voiceToggle');
            btn.textContent = voiceEnabled ? '🔊' : '🔇';
            btn.classList.toggle('active', voiceEnabled);
            
            if (!voiceEnabled) {
                stopSpeech();
            }
        }

        function toggleAutoPlay() {
            autoPlayEnabled = !autoPlayEnabled;
            if (autoPlayEnabled) {
                startGuidedTour();
            } else {
                guidedTourActive = false;
            }
        }

        function toggleInfo() {
            const panel = document.getElementById('infoPanel');
            panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
        }

        // Guided Tour
        function startGuidedTour() {
            guidedTourActive = true;
            const steps = ['brain_overview', 'cns', 'cerebrum', 'cerebellum', 'medulla'];
            let stepIndex = 0;
            
            function tourStep() {
                if (stepIndex < steps.length && guidedTourActive) {
                    loadJourneyStep(steps[stepIndex]);
                    stepIndex++;
                } else {
                    guidedTourActive = false;
                    if (voiceEnabled) {
                        speakText("You have completed your journey through the human brain! You now understand how this remarkable organ coordinates voluntary and involuntary actions, from conscious thoughts in the cerebrum to vital life functions in the medulla, all working together to create the miracle of human consciousness and behavior.");
                    }
                }
            }
            
            tourStep();
            window.nextStep = tourStep;
        }

        // Quiz Function
        function showQuiz() {
            const questions = [
                "What are the three major divisions of the brain and their functions?",
                "How does the central nervous system coordinate body functions?",
                "What makes the cerebrum responsible for voluntary actions?",
                "Why is the cerebellum called the brain's coordinator?",
                "How does the medulla control involuntary vital functions?"
            ];
            
            const randomQ = questions[Math.floor(Math.random() * questions.length)];
            
            if (voiceEnabled) {
                speakText(`Here's a question about brain structure and function: ${randomQ} Think about what you've learned about how different brain regions control voluntary and involuntary actions.`);
            }
        }

        // Initialize
        function init() {
            initVoiceSystem();
            
            // Hide loading screen
            setTimeout(() => {
                const loading = document.getElementById('loadingOverlay');
                loading.style.opacity = '0';
                setTimeout(() => {
                    loading.style.display = 'none';
                    
                    // Welcome message
                    if (voiceEnabled) {
                        speakText("Welcome to your exploration of the human brain - the most complex structure in the known universe! We'll journey through the brain's major divisions and discover how different regions control voluntary conscious actions and involuntary life-sustaining functions. Let's begin with an overview of the brain's remarkable organization!");
                    }
                }, 1000);
            }, 3000);
            
            // Keyboard shortcuts
            document.addEventListener('keydown', (e) => {
                switch(e.key) {
                    case 'v': toggleVoice(); break;
                    case 'i': toggleInfo(); break;
                    case 'g': startGuidedTour(); break;
                    case 'Escape': stopSpeech(); guidedTourActive = false; break;
                    case 'ArrowRight': nextStep && nextStep(); break;
                }
            });
        }

        // Start the application
        init();
    </script>
</body>
</html>