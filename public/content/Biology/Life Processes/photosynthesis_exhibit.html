<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Autotrophic Nutrition - Photosynthesis Journey</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tween.js/18.6.4/tween.umd.js"></script>

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
            color: white;
            overflow: hidden;
            position: relative;
            height: 100vh;
        }

        /* Animated Background */
        .bg-animation {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 0;
            opacity: 0.1;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320"><path fill="%23ffffff" fill-opacity="0.2" d="M0,96L48,112C96,128,192,160,288,186.7C384,213,480,235,576,213.3C672,192,768,128,864,128C960,128,1056,192,1152,197.3C1248,203,1344,149,1392,122.7L1440,96L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path></svg>') repeat-x;
            animation: wave 10s linear infinite;
        }

        @keyframes wave {
            0% { background-position-x: 0; }
            100% { background-position-x: 1440px; }
        }

        /* Museum Interface - Compact Header */
        .museum-header {
            position: absolute;
            top: 10px;
            left: 20px;
            text-align: left;
            z-index: 1000;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            padding: 10px 18px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        .museum-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 4px;
            background: linear-gradient(45deg, #27ae60, #f1c40f);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: titleGlow 3s ease-in-out infinite;
        }

        @keyframes titleGlow {
            0%, 100% { filter: brightness(1); }
            50% { filter: brightness(1.2); }
        }

        .exhibit-subtitle {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.8);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .sun-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: #f1c40f;
            border-radius: 50%;
            animation: sun-pulse 1.5s ease-in-out infinite;
        }

        @keyframes sun-pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.3); opacity: 0.7; }
        }

        /* Journey Navigation - Enhanced */
        .journey-navigation {
            position: absolute;
            bottom: 20px;
            left: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 1000;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            padding: 15px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            max-width: 320px;
        }

        .journey-title {
            font-size: 14px;
            font-weight: 600;
            color: #27ae60;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .journey-steps {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
        }

        .journey-btn {
            background: rgba(46, 204, 113, 0.2);
            border: 1px solid rgba(46, 204, 113, 0.4);
            color: white;
            padding: 6px 10px;
            border-radius: 20px;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 4px;
            white-space: nowrap;
        }

        .journey-btn:hover {
            background: rgba(46, 204, 113, 0.3);
            border-color: #2ecc71;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(46, 204, 113, 0.3);
        }

        .journey-btn.active {
            background: linear-gradient(135deg, #f1c40f, #f39c12);
            border-color: #f1c40f;
            box-shadow: 0 0 20px rgba(241, 196, 15, 0.5);
            animation: pulse 2s infinite;
        }

        .journey-btn.completed {
            background: rgba(52, 152, 219, 0.3);
            border-color: #3498db;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* 3D Model Container */
        .model-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 0;
            overflow: hidden;
            border: none;
            z-index: 100;
        }

        .sketchfab-embed-wrapper {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
        }

        .sketchfab-embed-wrapper iframe {
            width: 100%;
            height: 100%;
            border: none;
            border-radius: 0;
        }

        /* Information Panel - Enhanced */
        .info-panel {
            position: absolute;
            top: 70px;
            right: 20px;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 16px;
            padding: 24px;
            width: 380px;
            max-height: calc(100vh - 140px);
            z-index: 800;
            overflow-y: auto;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }

        .info-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
        }

        .info-icon {
            font-size: 28px;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        .info-title {
            flex: 1;
        }

        .info-title h2 {
            font-size: 18px;
            color: #27ae60;
            margin-bottom: 4px;
        }

        .info-subtitle {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
        }

        .info-content {
            color: rgba(255, 255, 255, 0.9);
            font-size: 14px;
            line-height: 1.6;
        }

        /* Progress Tracker */
        .progress-tracker {
            background: linear-gradient(135deg, rgba(46, 204, 113, 0.1), rgba(241, 196, 15, 0.1));
            border: 1px solid rgba(46, 204, 113, 0.3);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 20px;
        }

        .progress-header {
            font-size: 13px;
            font-weight: 600;
            color: #27ae60;
            margin-bottom: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .progress-percentage {
            font-size: 18px;
            color: #f1c40f;
            font-weight: 700;
        }

        .progress-bar {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 12px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #27ae60, #f1c40f);
            border-radius: 4px;
            transition: width 0.8s ease;
            box-shadow: 0 0 10px rgba(241, 196, 15, 0.5);
        }

        .progress-steps-mini {
            display: flex;
            justify-content: space-between;
            font-size: 10px;
            color: rgba(255, 255, 255, 0.6);
        }

        .step-mini {
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .step-mini.active {
            color: #f1c40f;
            font-weight: 600;
        }

        .step-mini.completed {
            color: #3498db;
        }

        /* Information Cards */
        .info-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 14px;
            margin-bottom: 14px;
        }

        .info-card-title {
            color: #27ae60;
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .info-card-content {
            color: rgba(255, 255, 255, 0.85);
            font-size: 12px;
            line-height: 1.5;
        }

        .info-list {
            list-style: none;
            padding: 0;
        }

        .info-list li {
            padding: 6px 0;
            padding-left: 20px;
            position: relative;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.8);
        }

        .info-list li:before {
            content: "→";
            position: absolute;
            left: 0;
            color: #f1c40f;
        }

        /* Fun Fact Box */
        .fun-fact {
            background: linear-gradient(135deg, rgba(241, 196, 15, 0.1), rgba(243, 156, 18, 0.1));
            border: 1px solid rgba(241, 196, 15, 0.3);
            border-radius: 12px;
            padding: 14px;
            margin: 16px 0;
            position: relative;
            overflow: hidden;
        }

        .fun-fact:before {
            content: "🌞";
            position: absolute;
            top: -20px;
            right: -20px;
            font-size: 60px;
            opacity: 0.1;
        }

        .fun-fact-title {
            color: #f1c40f;
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 6px;
        }

        .fun-fact-text {
            color: rgba(255, 255, 255, 0.9);
            font-size: 12px;
            line-height: 1.5;
            position: relative;
            z-index: 1;
        }

        /* Voice Controls */
        .voice-controls {
            position: absolute;
            top: 10px;
            right: 20px;
            display: flex;
            gap: 8px;
            z-index: 1000;
        }

        .control-btn {
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            position: relative;
        }

        .control-btn:hover {
            background: rgba(46, 204, 113, 0.3);
            border-color: #2ecc71;
            transform: scale(1.1);
        }

        .control-btn.active {
            background: rgba(46, 204, 113, 0.4);
            border-color: #2ecc71;
            box-shadow: 0 0 20px rgba(46, 204, 113, 0.5);
        }

        .control-tooltip {
            position: absolute;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.9);
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 10px;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .control-btn:hover .control-tooltip {
            opacity: 1;
        }

        /* Loading Screen */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            transition: opacity 1s ease;
        }

        .loading-content {
            text-align: center;
        }

        .loading-sun {
            font-size: 60px;
            animation: sun-rotate 3s ease-in-out infinite;
            margin-bottom: 20px;
        }

        @keyframes sun-rotate {
            0%, 100% { transform: rotate(0deg) scale(1); }
            50% { transform: rotate(180deg) scale(1.1); }
        }

        .loading-text {
            color: white;
            font-size: 20px;
            margin-bottom: 20px;
        }

        .loading-progress {
            width: 200px;
            height: 4px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 2px;
            overflow: hidden;
        }

        .loading-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #27ae60, #f1c40f);
            animation: loading 2s ease-in-out infinite;
        }

        @keyframes loading {
            0% { width: 0%; }
            50% { width: 100%; }
            100% { width: 0%; }
        }

        /* Voice Indicator */
        .voice-indicator {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(46, 204, 113, 0.5);
            border-radius: 30px;
            padding: 14px 28px;
            display: flex;
            align-items: center;
            gap: 12px;
            z-index: 1000;
            opacity: 0;
            transition: all 0.3s ease;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }

        .voice-indicator.visible {
            opacity: 1;
            transform: translateX(-50%) translateY(-10px);
        }

        .voice-waves {
            display: flex;
            align-items: center;
            gap: 3px;
        }

        .voice-wave {
            width: 3px;
            height: 20px;
            background: linear-gradient(180deg, #27ae60, #f1c40f);
            border-radius: 2px;
            animation: voice-wave 1s ease-in-out infinite;
        }

        .voice-wave:nth-child(2) { animation-delay: 0.1s; }
        .voice-wave:nth-child(3) { animation-delay: 0.2s; }
        .voice-wave:nth-child(4) { animation-delay: 0.3s; }
        .voice-wave:nth-child(5) { animation-delay: 0.4s; }

        @keyframes voice-wave {
            0%, 100% { transform: scaleY(0.3); }
            50% { transform: scaleY(1); }
        }

        .narration-text {
            color: white;
            font-size: 13px;
            max-width: 300px;
        }

        /* Quick Actions */
        .quick-actions {
            position: absolute;
            bottom: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
            z-index: 1000;
        }

        .action-btn {
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 10px 16px;
            border-radius: 25px;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
        }

        .action-btn:hover {
            background: rgba(46, 204, 113, 0.3);
            border-color: #2ecc71;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(46, 204, 113, 0.3);
        }

        /* Custom Scrollbar */
        .info-panel::-webkit-scrollbar {
            width: 6px;
        }

        .info-panel::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 3px;
        }

        .info-panel::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, #27ae60, #f1c40f);
            border-radius: 3px;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .info-panel {
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                top: auto;
                width: 100%;
                max-height: 50vh;
                border-radius: 20px 20px 0 0;
            }
            
            .journey-navigation {
                bottom: 52vh;
                max-width: calc(100% - 40px);
            }
            
            .voice-controls {
                top: auto;
                bottom: 55vh;
                right: 10px;
            }
            
            .quick-actions {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="bg-animation"></div>

    <!-- Loading Screen -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="loading-sun">🌞</div>
            <div class="loading-text">Exploring Photosynthesis...</div>
            <div class="loading-progress">
                <div class="loading-progress-bar"></div>
            </div>
        </div>
    </div>

    <!-- Museum Header -->
    <div class="museum-header">
        <div class="museum-title">Autotrophic Nutrition</div>
        <div class="exhibit-subtitle">
            <span class="sun-indicator"></span>
            How Plants Make Their Own Food
        </div>
    </div>

    <!-- Journey Navigation -->
    <div class="journey-navigation">
        <div class="journey-title">
            <span>🌞</span>
            <span>Photosynthesis Journey</span>
        </div>
        <div class="journey-steps">
            <button class="journey-btn active" onclick="loadJourneyStep('introduction')">
                <span>🌟</span> Introduction
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('autotrophic_concept')">
                <span>🌱</span> Autotrophic Nutrition
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('raw_materials')">
                <span>💧</span> Raw Materials
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('photosynthesis_equation')">
                <span>⚖️</span> Equation
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('chloroplast_structure')">
                <span>🔬</span> Chloroplasts
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('process_overview')">
                <span>🔄</span> Process
            </button>
        </div>
    </div>

    <!-- 3D Model Container -->
    <div class="model-container">
        <div class="sketchfab-embed-wrapper">
            <iframe id="api-frame"
                    title="Photosynthesis Model" 
                    frameborder="0" 
                    allowfullscreen 
                    mozallowfullscreen="true" 
                    webkitallowfullscreen="true" 
                    allow="autoplay; fullscreen; xr-spatial-tracking"
                    xr-spatial-tracking 
                    execution-while-out-of-viewport 
                    execution-while-not-rendered 
                    web-share 
                    src="https://sketchfab.com/models/8f41f1ab30c04da7a03860553e833b15/embed?autostart=1&internal=1&tracking=0&ui_ar=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0">
            </iframe>
        </div>
    </div>

    <!-- Information Panel -->
    <div class="info-panel" id="infoPanel">
        <div class="info-header">
            <div class="info-icon" id="stepIcon">🌟</div>
            <div class="info-title">
                <h2 id="stepTitle">Welcome to Photosynthesis</h2>
                <div class="info-subtitle" id="stepSubtitle">Nature's amazing food factory</div>
            </div>
        </div>

        <!-- Progress Tracker -->
        <div class="progress-tracker">
            <div class="progress-header">
                <span>Learning Progress</span>
                <span class="progress-percentage" id="progressPercent">0%</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 0%"></div>
            </div>
            <div class="progress-steps-mini">
                <span class="step-mini active" onclick="loadJourneyStep('introduction')">Intro</span>
                <span class="step-mini" onclick="loadJourneyStep('autotrophic_concept')">Auto</span>
                <span class="step-mini" onclick="loadJourneyStep('raw_materials')">Materials</span>
                <span class="step-mini" onclick="loadJourneyStep('photosynthesis_equation')">Equation</span>
                <span class="step-mini" onclick="loadJourneyStep('chloroplast_structure')">Chloroplast</span>
                <span class="step-mini" onclick="loadJourneyStep('process_overview')">Process</span>
            </div>
        </div>

        <div class="info-content" id="mainDescription">
            Photosynthesis is one of the most important biological processes on Earth. It's how plants create their own food using sunlight, water, and carbon dioxide. This amazing process not only feeds plants but also produces the oxygen we breathe and forms the foundation of almost all food chains on our planet.
        </div>

        <div class="info-card">
            <div class="info-card-title">
                <span>🔬</span> Key Concepts
            </div>
            <div class="info-card-content">
                <ul class="info-list" id="keyConcepts">
                    <li>Plants make their own food from simple ingredients</li>
                    <li>Sunlight provides the energy for photosynthesis</li>
                    <li>Chloroplasts are the food factories in plant cells</li>
                    <li>Oxygen is produced as a beneficial byproduct</li>
                </ul>
            </div>
        </div>

        <div class="fun-fact">
            <div class="fun-fact-title">Incredible Fact!</div>
            <div class="fun-fact-text" id="funFact">
                Plants produce approximately 330 billion tons of food annually through photosynthesis - enough to feed all life on Earth!
            </div>
        </div>

        <div class="info-card">
            <div class="info-card-title">
                <span>🎯</span> Learning Objectives
            </div>
            <div class="info-card-content" id="learningObjectives">
                Understand how plants create their own food, explore the role of chloroplasts, and learn the photosynthesis equation and its requirements.
            </div>
        </div>
    </div>

    <!-- Voice Controls -->
    <div class="voice-controls">
        <button class="control-btn active" id="voiceToggle" onclick="toggleVoice()">
            🔊
            <span class="control-tooltip">Voice Narration</span>
        </button>
        <button class="control-btn" onclick="toggleAutoPlay()">
            ▶️
            <span class="control-tooltip">Auto Journey</span>
        </button>
        <button class="control-btn" onclick="toggleInfo()">
            ℹ️
            <span class="control-tooltip">Toggle Info</span>
        </button>
    </div>

    <!-- Quick Actions -->
    <div class="quick-actions">
        <button class="action-btn" onclick="startGuidedTour()">
            <span>🚀</span> Guided Tour
        </button>
        <button class="action-btn" onclick="showQuiz()">
            <span>🎯</span> Test Knowledge
        </button>
    </div>

    <!-- Voice Indicator -->
    <div class="voice-indicator" id="voiceIndicator">
        <div class="voice-waves">
            <div class="voice-wave"></div>
            <div class="voice-wave"></div>
            <div class="voice-wave"></div>
            <div class="voice-wave"></div>
            <div class="voice-wave"></div>
        </div>
        <div class="narration-text" id="narrationText">Narrating...</div>
    </div>

    <script>
        // Journey Step Data with Complete Pedagogical Content
        const JOURNEY_DATA = {
            introduction: {
                title: "Welcome to Photosynthesis",
                subtitle: "Nature's amazing food factory",
                icon: "🌟",
                modelUrl: "https://sketchfab.com/models/8f41f1ab30c04da7a03860553e833b15/embed?autostart=1&internal=1&tracking=0&ui_ar=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "Photosynthesis is one of the most important biological processes on Earth. It's how plants create their own food using sunlight, water, and carbon dioxide. This amazing process not only feeds plants but also produces the oxygen we breathe and forms the foundation of almost all food chains on our planet.",
                concepts: [
                    "Plants make their own food from simple ingredients",
                    "Sunlight provides the energy for photosynthesis",
                    "Chloroplasts are the food factories in plant cells",
                    "Oxygen is produced as a beneficial byproduct"
                ],
                funFact: "Plants produce approximately 330 billion tons of food annually through photosynthesis - enough to feed all life on Earth!",
                objectives: "Understand how plants create their own food, explore the role of chloroplasts, and learn the photosynthesis equation and its requirements.",
                narration: "Welcome to the incredible world of photosynthesis! You're looking at a visual representation of this amazing process that happens in every green plant around you. Imagine being able to make your own food just by standing in the sunlight - that's exactly what plants do every single day! Photosynthesis is like nature's own solar-powered kitchen, where plants take simple ingredients like water, carbon dioxide, and sunlight, and transform them into sugar and oxygen. This process is so important that without it, there would be no life on Earth as we know it. Every breath you take contains oxygen produced by photosynthesis, and every meal you eat either comes directly from plants or from animals that ate plants. Let's explore how this remarkable process works!"
            },
            autotrophic_concept: {
                title: "Autotrophic Nutrition",
                subtitle: "Self-feeding organisms",
                icon: "🌱",
                modelUrl: "https://sketchfab.com/models/9a244f04a73d46cd8801fd3d9d40726b/embed?autostart=1&internal=1&tracking=0&ui_ar=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "Autotrophic nutrition means 'self-feeding.' Unlike animals that must eat other organisms for food, autotrophic organisms like plants can produce their own food from simple inorganic substances. This makes them the foundation of all food chains on Earth.",
                concepts: [
                    "Auto = self, trophic = feeding",
                    "Plants don't need to eat other organisms",
                    "They make food from simple chemicals",
                    "Primary producers in ecosystems"
                ],
                funFact: "The word 'autotrophic' comes from Greek: 'autos' meaning self and 'trophe' meaning nourishment - literally 'self-nourishing'!",
                objectives: "Understand what autotrophic nutrition means and why it's crucial for life on Earth.",
                narration: "Here we see a chloroplast - the amazing organelle that makes autotrophic nutrition possible! The term 'autotrophic' literally means 'self-feeding,' and that's exactly what plants do. Unlike you and me, who need to find and eat food, plants are like having their own kitchen and grocery store built right into their cells! Inside these chloroplasts, plants can take the simplest ingredients - water from the soil, carbon dioxide from the air, and energy from sunlight - and cook up their own food. This ability makes plants incredibly important because they're the primary producers in almost every ecosystem. All the food chains on Earth start with autotrophic organisms like plants. Even when you eat meat, that energy originally came from plants that the animal ate. So in a way, we're all solar-powered, just indirectly!"
            },
            raw_materials: {
                title: "Raw Materials for Photosynthesis",
                subtitle: "The simple ingredients that make food",
                icon: "💧",
                modelUrl: "https://sketchfab.com/models/6d87f6a52d79429ba8dfbc97732722c1/embed?autostart=1&internal=1&tracking=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "Photosynthesis requires only three simple raw materials: carbon dioxide from the air, water from the soil, and energy from sunlight. These basic ingredients are combined to create glucose (sugar) and release oxygen as a byproduct.",
                concepts: [
                    "Carbon dioxide enters through leaf pores",
                    "Water is absorbed by roots",
                    "Sunlight provides the energy",
                    "These simple materials make complex food"
                ],
                funFact: "A large tree can absorb 48 pounds of carbon dioxide per year and produce enough oxygen for two people to breathe!",
                objectives: "Identify the three essential raw materials needed for photosynthesis and understand how plants obtain each one.",
                narration: "You're looking at a carbon dioxide molecule - one of the three essential ingredients for photosynthesis! This simple molecule contains one carbon atom bonded to two oxygen atoms, and it's floating all around us in the air right now. Plants absorb CO2 through tiny pores in their leaves called stomata. The second ingredient is water, which plants absorb through their roots from the soil. Water molecules are made of two hydrogen atoms and one oxygen atom. The third ingredient isn't a substance at all - it's energy from sunlight! Plants capture this light energy using special molecules called chlorophyll. What's amazing is that from these three simple ingredients - CO2, H2O, and sunlight - plants can create glucose, a complex sugar that serves as food. It's like making a gourmet meal from just three basic ingredients! And as a bonus, plants release oxygen into the air, which is essential for all animal life."
            },
            photosynthesis_equation: {
                title: "The Photosynthesis Equation",
                subtitle: "A balanced chemical recipe",
                icon: "⚖️",
                modelUrl: "https://sketchfab.com/models/2b4c96af7c0c41debf1bd654c1103a00/embed?autostart=1&internal=1&tracking=0&ui_ar=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "The photosynthesis equation shows exactly how raw materials are converted into products: 6CO2 + 6H2O + light energy → C6H12O6 + 6O2. This balanced equation reveals that six molecules each of carbon dioxide and water, plus light energy, produce one glucose molecule and six oxygen molecules.",
                concepts: [
                    "6 CO2 + 6 H2O + light → C6H12O6 + 6 O2",
                    "Equation must be balanced",
                    "Glucose is the main product",
                    "Oxygen is released as waste"
                ],
                funFact: "The glucose molecule contains 24 atoms arranged in a specific pattern - 6 carbon, 12 hydrogen, and 6 oxygen atoms!",
                objectives: "Learn the balanced chemical equation for photosynthesis and understand what each component represents.",
                narration: "Here you can see a glucose molecule - the main product of photosynthesis! Glucose has the chemical formula C6H12O6, which means it contains 6 carbon atoms, 12 hydrogen atoms, and 6 oxygen atoms. Now let's look at the complete photosynthesis equation: 6CO2 plus 6H2O plus light energy yields C6H12O6 plus 6O2. This equation tells us that plants need 6 molecules of carbon dioxide and 6 molecules of water, along with light energy, to make 1 molecule of glucose and release 6 molecules of oxygen. Notice how the equation is perfectly balanced - the same number of each type of atom appears on both sides. The carbon dioxide provides the carbon atoms for glucose, the water provides the hydrogen atoms, and some of the oxygen atoms. The extra oxygen atoms are released as O2 gas. This glucose molecule is incredibly important - it's the food that plants use for energy, and it's also the foundation of the food chain that supports all life on Earth!"
            },
            chloroplast_structure: {
                title: "Chloroplast Structure",
                subtitle: "The photosynthesis factory",
                icon: "🔬",
                modelUrl: "https://sketchfab.com/models/9a244f04a73d46cd8801fd3d9d40726b/embed?autostart=1&internal=1&tracking=0&ui_ar=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "Chloroplasts are specialized organelles found in plant cells where photosynthesis occurs. They contain chlorophyll, the green pigment that captures light energy, and have a complex internal structure with stacks of membranes called thylakoids arranged in grana.",
                concepts: [
                    "Chloroplasts are found in plant cells",
                    "Contain chlorophyll for light capture",
                    "Thylakoids are stacked in grana",
                    "Stroma is the fluid surrounding thylakoids"
                ],
                funFact: "A single plant cell can contain 20-100 chloroplasts, and each chloroplast contains millions of chlorophyll molecules!",
                objectives: "Explore the internal structure of chloroplasts and understand how their design enables efficient photosynthesis.",
                narration: "Welcome inside a chloroplast - nature's most efficient solar panel! This amazing organelle is where all the magic of photosynthesis happens. You can see the complex internal structure with stacks of flattened sacs called thylakoids. These stacks are called grana, and they're where the light-dependent reactions of photosynthesis occur. The green color comes from chlorophyll molecules embedded in the thylakoid membranes. These chlorophyll molecules are incredibly good at capturing light energy - they can absorb red and blue light but reflect green light, which is why plants appear green to us. The fluid surrounding the thylakoids is called the stroma, where the light-independent reactions happen. The entire structure is perfectly designed for photosynthesis - the large surface area of the thylakoid membranes maximizes light capture, while the organized arrangement ensures efficient processing of materials. It's like having a highly sophisticated factory that runs entirely on solar power!"
            },
            process_overview: {
                title: "Photosynthesis Process Overview",
                subtitle: "Putting it all together",
                icon: "🔄",
                modelUrl: "https://sketchfab.com/models/8f41f1ab30c04da7a03860553e833b15/embed?autostart=1&internal=1&tracking=0&ui_ar=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "Photosynthesis involves two main stages: the light-dependent reactions that capture and convert light energy, and the light-independent reactions that use this energy to build glucose from carbon dioxide. These processes work together seamlessly to convert simple inorganic materials into complex organic food.",
                concepts: [
                    "Light reactions capture solar energy",
                    "Dark reactions build glucose",
                    "Processes are interconnected",
                    "Occurs continuously during daylight"
                ],
                funFact: "Plants perform photosynthesis so efficiently that they convert about 1% of available sunlight into chemical energy - powering almost all life on Earth!",
                objectives: "Understand how the different components and stages of photosynthesis work together as a complete system.",
                narration: "This comprehensive view shows photosynthesis as a complete, integrated process! Photosynthesis actually happens in two connected stages. First, the light-dependent reactions occur in the thylakoids, where chlorophyll captures light energy and splits water molecules, releasing oxygen as a byproduct. This stage converts light energy into chemical energy. Then, the light-independent reactions, also called the Calvin cycle, happen in the stroma. Here, the chemical energy is used to fix carbon dioxide into glucose molecules. The beauty of this system is how perfectly coordinated it is - the products of the light reactions are exactly what the dark reactions need, and vice versa. During daylight hours, both processes run simultaneously, with plants constantly absorbing CO2, releasing O2, and producing glucose. This glucose can be used immediately for energy, stored as starch for later use, or converted into cellulose for structural purposes. It's an incredibly efficient system that has been powering life on Earth for billions of years!"
            }
        };

        // Global Variables
        let currentStep = 'introduction';
        let voiceEnabled = true;
        let autoPlayEnabled = false;
        let currentSpeech = null;
        let selectedVoice = null;
        let journeyProgress = 0;
        let guidedTourActive = false;

        // Initialize Voice System
        function initVoiceSystem() {
            if (!('speechSynthesis' in window)) {
                console.warn('Speech synthesis not supported');
                voiceEnabled = false;
                document.getElementById('voiceToggle').style.display = 'none';
                return;
            }

            function loadVoices() {
                const voices = speechSynthesis.getVoices();
                if (voices.length === 0) return;

                const preferredVoices = [
                    'Google UK English Female',
                    'Microsoft Sonia',
                    'Microsoft Hazel',
                    'Samantha',
                    'Victoria'
                ];

                for (const name of preferredVoices) {
                    selectedVoice = voices.find(v => v.name.includes(name));
                    if (selectedVoice) break;
                }

                if (!selectedVoice) {
                    selectedVoice = voices.find(v => v.lang.startsWith('en'));
                }
            }

            loadVoices();
            if (speechSynthesis.onvoiceschanged !== undefined) {
                speechSynthesis.onvoiceschanged = loadVoices;
            }
        }

        // Load Journey Step
        function loadJourneyStep(stepId) {
            const stepData = JOURNEY_DATA[stepId];
            if (!stepData) return;

            currentStep = stepId;
            
            document.getElementById('api-frame').src = stepData.modelUrl;
            document.getElementById('stepIcon').textContent = stepData.icon;
            document.getElementById('stepTitle').textContent = stepData.title;
            document.getElementById('stepSubtitle').textContent = stepData.subtitle;
            document.getElementById('mainDescription').textContent = stepData.description;
            
            const conceptsList = document.getElementById('keyConcepts');
            conceptsList.innerHTML = stepData.concepts.map(c => `<li>${c}</li>`).join('');
            
            document.getElementById('funFact').textContent = stepData.funFact;
            document.getElementById('learningObjectives').textContent = stepData.objectives;
            
            updateNavigationButtons(stepId);
            updateProgress();
            
            if (voiceEnabled) {
                speakText(stepData.narration);
            }
        }

        function updateNavigationButtons(activeStep) {
            const buttons = document.querySelectorAll('.journey-btn');
            const steps = ['introduction', 'autotrophic_concept', 'raw_materials', 'photosynthesis_equation', 'chloroplast_structure', 'process_overview'];
            const activeIndex = steps.indexOf(activeStep);
            
            buttons.forEach((btn, index) => {
                btn.classList.remove('active', 'completed');
                if (index < activeIndex) {
                    btn.classList.add('completed');
                } else if (index === activeIndex) {
                    btn.classList.add('active');
                }
            });
            
            const miniSteps = document.querySelectorAll('.step-mini');
            miniSteps.forEach((step, index) => {
                step.classList.remove('active', 'completed');
                if (index < activeIndex) {
                    step.classList.add('completed');
                } else if (index === activeIndex) {
                    step.classList.add('active');
                }
            });
        }

        function updateProgress() {
            const steps = ['introduction', 'autotrophic_concept', 'raw_materials', 'photosynthesis_equation', 'chloroplast_structure', 'process_overview'];
            const currentIndex = steps.indexOf(currentStep);
            const progress = ((currentIndex + 1) / steps.length) * 100;
            
            document.getElementById('progressPercent').textContent = Math.round(progress) + '%';
            document.getElementById('progressFill').style.width = progress + '%';
        }

        function speakText(text) {
            if (!voiceEnabled || !text) return;
            
            stopSpeech();
            
            currentSpeech = new SpeechSynthesisUtterance(text);
            if (selectedVoice) {
                currentSpeech.voice = selectedVoice;
            }
            currentSpeech.rate = 0.9;
            currentSpeech.pitch = 1.0;
            currentSpeech.volume = 0.9;
            
            currentSpeech.onstart = () => {
                document.getElementById('voiceIndicator').classList.add('visible');
                document.getElementById('narrationText').textContent = 
                    text.substring(0, 50) + (text.length > 50 ? '...' : '');
            };
            
            currentSpeech.onend = () => {
                document.getElementById('voiceIndicator').classList.remove('visible');
                currentSpeech = null;
                
                if (guidedTourActive) {
                    setTimeout(nextStep, 2000);
                }
            };
            
            speechSynthesis.speak(currentSpeech);
        }

        function stopSpeech() {
            if (currentSpeech) {
                speechSynthesis.cancel();
                currentSpeech = null;
                document.getElementById('voiceIndicator').classList.remove('visible');
            }
        }

        function toggleVoice() {
            voiceEnabled = !voiceEnabled;
            const btn = document.getElementById('voiceToggle');
            btn.textContent = voiceEnabled ? '🔊' : '🔇';
            btn.classList.toggle('active', voiceEnabled);
            
            if (!voiceEnabled) {
                stopSpeech();
            }
        }

        function toggleAutoPlay() {
            autoPlayEnabled = !autoPlayEnabled;
            if (autoPlayEnabled) {
                startGuidedTour();
            } else {
                guidedTourActive = false;
            }
        }

        function toggleInfo() {
            const panel = document.getElementById('infoPanel');
            panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
        }

        function startGuidedTour() {
            guidedTourActive = true;
            const steps = ['introduction', 'autotrophic_concept', 'raw_materials', 'photosynthesis_equation', 'chloroplast_structure', 'process_overview'];
            let stepIndex = 0;
            
            function tourStep() {
                if (stepIndex < steps.length && guidedTourActive) {
                    loadJourneyStep(steps[stepIndex]);
                    stepIndex++;
                } else {
                    guidedTourActive = false;
                    if (voiceEnabled) {
                        speakText("Congratulations! You've completed your journey through autotrophic nutrition and photosynthesis. You now understand how plants create their own food and why this process is essential for all life on Earth!");
                    }
                }
            }
            
            tourStep();
            window.nextStep = tourStep;
        }

        function showQuiz() {
            const questions = [
                "What does autotrophic nutrition mean?",
                "What are the three raw materials needed for photosynthesis?",
                "What is the balanced equation for photosynthesis?",
                "Where in the plant cell does photosynthesis occur?",
                "Why is photosynthesis important for all life on Earth?"
            ];
            
            const randomQ = questions[Math.floor(Math.random() * questions.length)];
            
            if (voiceEnabled) {
                speakText(`Here's a photosynthesis question: ${randomQ} Think about what you've learned!`);
            }
        }

        function init() {
            initVoiceSystem();
            
            setTimeout(() => {
                const loading = document.getElementById('loadingOverlay');
                loading.style.opacity = '0';
                setTimeout(() => {
                    loading.style.display = 'none';
                    
                    if (voiceEnabled) {
                        speakText("Welcome to your journey through autotrophic nutrition and photosynthesis! We'll explore how plants make their own food from simple ingredients using the power of sunlight. Let's discover nature's amazing solar-powered kitchen!");
                    }
                }, 1000);
            }, 3000);
            
            document.addEventListener('keydown', (e) => {
                switch(e.key) {
                    case 'v': toggleVoice(); break;
                    case 'i': toggleInfo(); break;
                    case 'g': startGuidedTour(); break;
                    case 'Escape': stopSpeech(); guidedTourActive = false; break;
                    case 'ArrowRight': nextStep && nextStep(); break;
                }
            });
        }

        init();
    </script>
</body>
</html>