<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Human Digestive System Structure - Anatomical Journey</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tween.js/18.6.4/tween.umd.js"></script>

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #c0392b 0%, #8e44ad 100%);
            color: white;
            overflow: hidden;
            position: relative;
            height: 100vh;
        }

        /* Animated Background */
        .bg-animation {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 0;
            opacity: 0.1;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320"><path fill="%23ffffff" fill-opacity="0.2" d="M0,96L48,112C96,128,192,160,288,186.7C384,213,480,235,576,213.3C672,192,768,128,864,128C960,128,1056,192,1152,197.3C1248,203,1344,149,1392,122.7L1440,96L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path></svg>') repeat-x;
            animation: wave 10s linear infinite;
        }

        @keyframes wave {
            0% { background-position-x: 0; }
            100% { background-position-x: 1440px; }
        }

        /* Museum Interface - Compact Header */
        .museum-header {
            position: absolute;
            top: 10px;
            left: 20px;
            text-align: left;
            z-index: 1000;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            padding: 10px 18px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        .museum-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 4px;
            background: linear-gradient(45deg, #c0392b, #8e44ad);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: titleGlow 3s ease-in-out infinite;
        }

        @keyframes titleGlow {
            0%, 100% { filter: brightness(1); }
            50% { filter: brightness(1.2); }
        }

        .exhibit-subtitle {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.8);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .digestive-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: #c0392b;
            border-radius: 50%;
            animation: digestive-pulse 1.5s ease-in-out infinite;
        }

        @keyframes digestive-pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.3); opacity: 0.7; }
        }

        /* Journey Navigation - Enhanced */
        .journey-navigation {
            position: absolute;
            bottom: 20px;
            left: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 1000;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            padding: 15px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            max-width: 320px;
        }

        .journey-title {
            font-size: 14px;
            font-weight: 600;
            color: #c0392b;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .journey-steps {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
        }

        .journey-btn {
            background: rgba(192, 57, 43, 0.2);
            border: 1px solid rgba(192, 57, 43, 0.4);
            color: white;
            padding: 6px 10px;
            border-radius: 20px;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 4px;
            white-space: nowrap;
        }

        .journey-btn:hover {
            background: rgba(192, 57, 43, 0.3);
            border-color: #c0392b;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(192, 57, 43, 0.3);
        }

        .journey-btn.active {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            border-color: #e74c3c;
            box-shadow: 0 0 20px rgba(231, 76, 60, 0.5);
            animation: pulse 2s infinite;
        }

        .journey-btn.completed {
            background: rgba(52, 152, 219, 0.3);
            border-color: #3498db;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* 3D Model Container */
        .model-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 0;
            overflow: hidden;
            border: none;
            z-index: 100;
        }

        .sketchfab-embed-wrapper {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #c0392b 0%, #8e44ad 100%);
        }

        .sketchfab-embed-wrapper iframe {
            width: 100%;
            height: 100%;
            border: none;
            border-radius: 0;
        }

        /* Information Panel - Enhanced */
        .info-panel {
            position: absolute;
            top: 70px;
            right: 20px;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 16px;
            padding: 24px;
            width: 380px;
            max-height: calc(100vh - 140px);
            z-index: 800;
            overflow-y: auto;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }

        .info-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
        }

        .info-icon {
            font-size: 28px;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        .info-title {
            flex: 1;
        }

        .info-title h2 {
            font-size: 18px;
            color: #c0392b;
            margin-bottom: 4px;
        }

        .info-subtitle {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
        }

        .info-content {
            color: rgba(255, 255, 255, 0.9);
            font-size: 14px;
            line-height: 1.6;
        }

        /* Progress Tracker */
        .progress-tracker {
            background: linear-gradient(135deg, rgba(192, 57, 43, 0.1), rgba(142, 68, 173, 0.1));
            border: 1px solid rgba(192, 57, 43, 0.3);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 20px;
        }

        .progress-header {
            font-size: 13px;
            font-weight: 600;
            color: #c0392b;
            margin-bottom: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .progress-percentage {
            font-size: 18px;
            color: #e74c3c;
            font-weight: 700;
        }

        .progress-bar {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 12px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #c0392b, #8e44ad);
            border-radius: 4px;
            transition: width 0.8s ease;
            box-shadow: 0 0 10px rgba(192, 57, 43, 0.5);
        }

        .progress-steps-mini {
            display: flex;
            justify-content: space-between;
            font-size: 10px;
            color: rgba(255, 255, 255, 0.6);
        }

        .step-mini {
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .step-mini.active {
            color: #e74c3c;
            font-weight: 600;
        }

        .step-mini.completed {
            color: #3498db;
        }

        /* Information Cards */
        .info-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 14px;
            margin-bottom: 14px;
        }

        .info-card-title {
            color: #c0392b;
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .info-card-content {
            color: rgba(255, 255, 255, 0.85);
            font-size: 12px;
            line-height: 1.5;
        }

        .info-list {
            list-style: none;
            padding: 0;
        }

        .info-list li {
            padding: 6px 0;
            padding-left: 20px;
            position: relative;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.8);
        }

        .info-list li:before {
            content: "→";
            position: absolute;
            left: 0;
            color: #c0392b;
        }

        /* Fun Fact Box */
        .fun-fact {
            background: linear-gradient(135deg, rgba(142, 68, 173, 0.1), rgba(52, 152, 219, 0.1));
            border: 1px solid rgba(142, 68, 173, 0.3);
            border-radius: 12px;
            padding: 14px;
            margin: 16px 0;
            position: relative;
            overflow: hidden;
        }

        .fun-fact:before {
            content: "🫀";
            position: absolute;
            top: -20px;
            right: -20px;
            font-size: 60px;
            opacity: 0.1;
        }

        .fun-fact-title {
            color: #8e44ad;
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 6px;
        }

        .fun-fact-text {
            color: rgba(255, 255, 255, 0.9);
            font-size: 12px;
            line-height: 1.5;
            position: relative;
            z-index: 1;
        }

        /* Voice Controls */
        .voice-controls {
            position: absolute;
            top: 10px;
            right: 20px;
            display: flex;
            gap: 8px;
            z-index: 1000;
        }

        .control-btn {
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            position: relative;
        }

        .control-btn:hover {
            background: rgba(192, 57, 43, 0.3);
            border-color: #c0392b;
            transform: scale(1.1);
        }

        .control-btn.active {
            background: rgba(192, 57, 43, 0.4);
            border-color: #c0392b;
            box-shadow: 0 0 20px rgba(192, 57, 43, 0.5);
        }

        .control-tooltip {
            position: absolute;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.9);
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 10px;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .control-btn:hover .control-tooltip {
            opacity: 1;
        }

        /* Loading Screen */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #c0392b 0%, #8e44ad 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            transition: opacity 1s ease;
        }

        .loading-content {
            text-align: center;
        }

        .loading-anatomy {
            font-size: 60px;
            animation: anatomy-pulse 2s ease-in-out infinite;
            margin-bottom: 20px;
        }

        @keyframes anatomy-pulse {
            0%, 100% { transform: scale(1) rotate(0deg); }
            50% { transform: scale(1.1) rotate(5deg); }
        }

        .loading-text {
            color: white;
            font-size: 20px;
            margin-bottom: 20px;
        }

        .loading-progress {
            width: 200px;
            height: 4px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 2px;
            overflow: hidden;
        }

        .loading-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #c0392b, #8e44ad);
            animation: loading 2s ease-in-out infinite;
        }

        @keyframes loading {
            0% { width: 0%; }
            50% { width: 100%; }
            100% { width: 0%; }
        }

        /* Voice Indicator */
        .voice-indicator {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(192, 57, 43, 0.5);
            border-radius: 30px;
            padding: 14px 28px;
            display: flex;
            align-items: center;
            gap: 12px;
            z-index: 1000;
            opacity: 0;
            transition: all 0.3s ease;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }

        .voice-indicator.visible {
            opacity: 1;
            transform: translateX(-50%) translateY(-10px);
        }

        .voice-waves {
            display: flex;
            align-items: center;
            gap: 3px;
        }

        .voice-wave {
            width: 3px;
            height: 20px;
            background: linear-gradient(180deg, #c0392b, #8e44ad);
            border-radius: 2px;
            animation: voice-wave 1s ease-in-out infinite;
        }

        .voice-wave:nth-child(2) { animation-delay: 0.1s; }
        .voice-wave:nth-child(3) { animation-delay: 0.2s; }
        .voice-wave:nth-child(4) { animation-delay: 0.3s; }
        .voice-wave:nth-child(5) { animation-delay: 0.4s; }

        @keyframes voice-wave {
            0%, 100% { transform: scaleY(0.3); }
            50% { transform: scaleY(1); }
        }

        .narration-text {
            color: white;
            font-size: 13px;
            max-width: 300px;
        }

        /* Quick Actions */
        .quick-actions {
            position: absolute;
            bottom: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
            z-index: 1000;
        }

        .action-btn {
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 10px 16px;
            border-radius: 25px;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
        }

        .action-btn:hover {
            background: rgba(192, 57, 43, 0.3);
            border-color: #c0392b;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(192, 57, 43, 0.3);
        }

        /* Custom Scrollbar */
        .info-panel::-webkit-scrollbar {
            width: 6px;
        }

        .info-panel::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 3px;
        }

        .info-panel::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, #c0392b, #8e44ad);
            border-radius: 3px;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .info-panel {
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                top: auto;
                width: 100%;
                max-height: 50vh;
                border-radius: 20px 20px 0 0;
            }
            
            .journey-navigation {
                bottom: 52vh;
                max-width: calc(100% - 40px);
            }
            
            .voice-controls {
                top: auto;
                bottom: 55vh;
                right: 10px;
            }
            
            .quick-actions {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="bg-animation"></div>

    <!-- Loading Screen -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="loading-anatomy">🫀</div>
            <div class="loading-text">Exploring Human Digestive Anatomy...</div>
            <div class="loading-progress">
                <div class="loading-progress-bar"></div>
            </div>
        </div>
    </div>

    <!-- Museum Header -->
    <div class="museum-header">
        <div class="museum-title">Human Digestive System</div>
        <div class="exhibit-subtitle">
            <span class="digestive-indicator"></span>
            Anatomical Structure and Function
        </div>
    </div>

    <!-- Journey Navigation -->
    <div class="journey-navigation">
        <div class="journey-title">
            <span>🫀</span>
            <span>Anatomical Journey</span>
        </div>
        <div class="journey-steps">
            <button class="journey-btn active" onclick="loadJourneyStep('introduction')">
                <span>🌟</span> Overview
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('alimentary_canal')">
                <span>🛤️</span> Canal
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('teeth_structure')">
                <span>🦷</span> Teeth
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('tongue_anatomy')">
                <span>👅</span> Tongue
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('mouth_cavity')">
                <span>👄</span> Mouth
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('stomach_structure')">
                <span>🫃</span> Stomach
            </button>
        </div>
    </div>

    <!-- 3D Model Container -->
    <div class="model-container">
        <div class="sketchfab-embed-wrapper">
            <iframe id="api-frame"
                    title="Human Digestive System Model" 
                    frameborder="0" 
                    allowfullscreen 
                    mozallowfullscreen="true" 
                    webkitallowfullscreen="true" 
                    allow="autoplay; fullscreen; xr-spatial-tracking"
                    xr-spatial-tracking 
                    execution-while-out-of-viewport 
                    execution-while-not-rendered 
                    web-share 
                    src="https://sketchfab.com/models/3f598117d05044b88e95be6c5a3c59b9/embed?autostart=1&internal=1&tracking=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0">
            </iframe>
        </div>
    </div>

    <!-- Information Panel -->
    <div class="info-panel" id="infoPanel">
        <div class="info-header">
            <div class="info-icon" id="stepIcon">🌟</div>
            <div class="info-title">
                <h2 id="stepTitle">Human Digestive System Overview</h2>
                <div class="info-subtitle" id="stepSubtitle">A complex system for processing food</div>
            </div>
        </div>

        <!-- Progress Tracker -->
        <div class="progress-tracker">
            <div class="progress-header">
                <span>Anatomy Progress</span>
                <span class="progress-percentage" id="progressPercent">0%</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 0%"></div>
            </div>
            <div class="progress-steps-mini">
                <span class="step-mini active" onclick="loadJourneyStep('introduction')">Intro</span>
                <span class="step-mini" onclick="loadJourneyStep('alimentary_canal')">Canal</span>
                <span class="step-mini" onclick="loadJourneyStep('teeth_structure')">Teeth</span>
                <span class="step-mini" onclick="loadJourneyStep('tongue_anatomy')">Tongue</span>
                <span class="step-mini" onclick="loadJourneyStep('mouth_cavity')">Mouth</span>
                <span class="step-mini" onclick="loadJourneyStep('stomach_structure')">Stomach</span>
            </div>
        </div>

        <div class="info-content" id="mainDescription">
            The human digestive system is a complex network of organs designed to break down food, absorb nutrients, and eliminate waste. This sophisticated system includes the alimentary canal and accessory organs, each with specialized structures and functions essential for proper digestion.
        </div>

        <div class="info-card">
            <div class="info-card-title">
                <span>🔬</span> Key Structures
            </div>
            <div class="info-card-content">
                <ul class="info-list" id="keyConcepts">
                    <li>Alimentary canal forms the main digestive pathway</li>
                    <li>Specialized regions perform different functions</li>
                    <li>Teeth mechanically break down food</li>
                    <li>Stomach stores and chemically digests food</li>
                </ul>
            </div>
        </div>

        <div class="fun-fact">
            <div class="fun-fact-title">Anatomical Fact!</div>
            <div class="fun-fact-text" id="funFact">
                Your digestive system is about 30 feet long from mouth to anus, with the small intestine alone measuring about 20 feet when stretched out!
            </div>
        </div>

        <div class="info-card">
            <div class="info-card-title">
                <span>🎯</span> Learning Objectives
            </div>
            <div class="info-card-content" id="learningObjectives">
                Identify the major components of the digestive system, understand specialized regions and their functions, and explore the anatomy of key digestive organs.
            </div>
        </div>
    </div>

    <!-- Voice Controls -->
    <div class="voice-controls">
        <button class="control-btn active" id="voiceToggle" onclick="toggleVoice()">
            🔊
            <span class="control-tooltip">Voice Narration</span>
        </button>
        <button class="control-btn" onclick="toggleAutoPlay()">
            ▶️
            <span class="control-tooltip">Auto Journey</span>
        </button>
        <button class="control-btn" onclick="toggleInfo()">
            ℹ️
            <span class="control-tooltip">Toggle Info</span>
        </button>
    </div>

    <!-- Quick Actions -->
    <div class="quick-actions">
        <button class="action-btn" onclick="startGuidedTour()">
            <span>🚀</span> Guided Tour
        </button>
        <button class="action-btn" onclick="showQuiz()">
            <span>🎯</span> Test Knowledge
        </button>
    </div>

    <!-- Voice Indicator -->
    <div class="voice-indicator" id="voiceIndicator">
        <div class="voice-waves">
            <div class="voice-wave"></div>
            <div class="voice-wave"></div>
            <div class="voice-wave"></div>
            <div class="voice-wave"></div>
            <div class="voice-wave"></div>
        </div>
        <div class="narration-text" id="narrationText">Narrating...</div>
    </div>

    <script>
        // Journey Step Data with Complete Pedagogical Content
        const JOURNEY_DATA = {
            introduction: {
                title: "Human Digestive System Overview",
                subtitle: "A complex system for processing food",
                icon: "🌟",
                modelUrl: "https://sketchfab.com/models/3f598117d05044b88e95be6c5a3c59b9/embed?autostart=1&internal=1&tracking=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "The human digestive system is a complex network of organs designed to break down food, absorb nutrients, and eliminate waste. This sophisticated system includes the alimentary canal and accessory organs, each with specialized structures and functions essential for proper digestion.",
                concepts: [
                    "Alimentary canal forms the main digestive pathway",
                    "Specialized regions perform different functions",
                    "Teeth mechanically break down food",
                    "Stomach stores and chemically digests food"
                ],
                funFact: "Your digestive system is about 30 feet long from mouth to anus, with the small intestine alone measuring about 20 feet when stretched out!",
                objectives: "Identify the major components of the digestive system, understand specialized regions and their functions, and explore the anatomy of key digestive organs.",
                narration: "Welcome to the incredible world of human digestion! You're looking at the complete digestive system - a remarkable 30-foot-long processing plant that transforms the food you eat into the energy and nutrients your body needs. This system is divided into two main parts: the alimentary canal, which is the continuous tube from mouth to anus, and the accessory organs like the liver and pancreas that help with digestion. Every component has evolved for a specific purpose - from the initial mechanical breakdown in your mouth to the final absorption in your intestines. What you're seeing is one of the most efficient biological systems on Earth, capable of extracting nutrients from an incredible variety of foods while protecting your body from harmful substances."
            },
            alimentary_canal: {
                title: "The Alimentary Canal",
                subtitle: "The main digestive pathway",
                icon: "🛤️",
                modelUrl: "https://sketchfab.com/models/3f598117d05044b88e95be6c5a3c59b9/embed?autostart=1&internal=1&tracking=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "The alimentary canal is a continuous muscular tube that extends from the mouth to the anus. It includes the mouth, esophagus, stomach, small intestine, and large intestine. Each region has specialized structures and functions that contribute to the systematic breakdown and absorption of food.",
                concepts: [
                    "Continuous tube from mouth to anus",
                    "Mouth begins mechanical and chemical digestion",
                    "Esophagus transports food to stomach",
                    "Small and large intestines complete processing"
                ],
                funFact: "Food takes about 24-72 hours to travel through the entire alimentary canal, spending the longest time in the large intestine!",
                objectives: "Trace the path of food through the alimentary canal and understand the specialized function of each region.",
                narration: "The alimentary canal is like a sophisticated assembly line for processing food! Starting at the mouth, food begins its journey through this continuous tube. In the mouth, teeth break food into smaller pieces while saliva begins chemical digestion. The esophagus then acts as a transport tube, using rhythmic muscle contractions called peristalsis to push food down to the stomach. The stomach serves as both a storage tank and mixing chamber, where powerful acids and enzymes begin breaking down proteins. From there, the partially digested food moves into the small intestine - the main absorption site where nutrients enter your bloodstream. Finally, the large intestine processes the remaining material, absorbing water and forming waste for elimination. Each section is perfectly designed for its specific role in this amazing biological conveyor belt!"
            },
            teeth_structure: {
                title: "Teeth Structure and Function",
                subtitle: "Specialized tools for mechanical digestion",
                icon: "🦷",
                modelUrl: "https://sketchfab.com/models/fb20bbf7284e42bbb997f7d49f0db8cf/embed?autostart=1&internal=1&tracking=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "Human teeth are specialized structures designed for different aspects of mechanical digestion. Incisors cut, canines tear, and molars grind food. Each tooth has a complex structure with enamel, dentin, pulp, and roots that anchor it firmly in the jaw.",
                concepts: [
                    "Incisors cut food into smaller pieces",
                    "Canines tear tough or fibrous foods",
                    "Premolars and molars grind and crush",
                    "Enamel is the hardest substance in the body"
                ],
                funFact: "Tooth enamel is harder than steel and is the hardest substance produced by the human body, yet it can be damaged by acids produced by bacteria!",
                objectives: "Identify different types of teeth and understand how tooth structure relates to function in mechanical digestion.",
                narration: "Here we see the incredible engineering of human teeth - specialized tools perfectly designed for breaking down food! Notice how each type of tooth has a different shape for a specific job. The sharp, chisel-like incisors at the front are perfect for cutting and biting into food. The pointed canines are designed for tearing, especially useful for fibrous or tough foods. The broader premolars and molars at the back have flat surfaces with ridges for grinding and crushing food into smaller particles. Each tooth is a marvel of biological engineering - the outer enamel is the hardest substance your body produces, protecting the softer dentin underneath. Inside is the pulp containing nerves and blood vessels, while strong roots anchor each tooth firmly in the jawbone. This variety of tooth types allows humans to process a wide range of foods efficiently, making mechanical digestion the crucial first step in breaking down our meals."
            },
            tongue_anatomy: {
                title: "Tongue Anatomy and Function",
                subtitle: "A muscular organ with multiple roles",
                icon: "👅",
                modelUrl: "https://sketchfab.com/models/afa408912123471fb1c0e999a9c0e27a/embed?autostart=1&internal=1&tracking=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "The tongue is a highly muscular organ that plays multiple roles in digestion. It helps with mechanical breakdown by moving food around the mouth, assists in forming the food bolus, contains taste buds for detecting flavors, and is essential for swallowing.",
                concepts: [
                    "Muscular organ made of intrinsic and extrinsic muscles",
                    "Moves food around mouth during chewing",
                    "Contains thousands of taste buds",
                    "Forms food bolus for swallowing"
                ],
                funFact: "Your tongue contains about 10,000 taste buds, but you replace them completely every 1-2 weeks as they wear out from use!",
                objectives: "Understand the complex anatomy of the tongue and its multiple functions in digestion and taste perception.",
                narration: "The tongue is one of the most versatile organs in your digestive system! This incredibly muscular structure is made up of both intrinsic muscles that change its shape and extrinsic muscles that move it around. During eating, the tongue works like a sophisticated food processor - it positions food between your teeth for optimal chewing, mixes food with saliva, and helps form the chewed food into a cohesive ball called a bolus. The surface of the tongue is covered with tiny projections called papillae, many of which contain taste buds that can detect five basic tastes: sweet, sour, salty, bitter, and umami. These taste sensations help your brain determine if food is safe to eat and trigger appropriate digestive responses. When you're ready to swallow, the tongue pushes the food bolus toward the back of your mouth, initiating the swallowing reflex. It's remarkable how this single organ combines mechanical processing, chemical sensing, and coordinated movement!"
            },
            mouth_cavity: {
                title: "Mouth Cavity Structure",
                subtitle: "Where digestion begins",
                icon: "👄",
                modelUrl: "https://sketchfab.com/models/3f598117d05044b88e95be6c5a3c59b9/embed?autostart=1&internal=1&tracking=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "The mouth cavity is the entry point of the digestive system where both mechanical and chemical digestion begin. It includes the teeth, tongue, salivary glands, and supporting structures that work together to process food and prepare it for swallowing.",
                concepts: [
                    "Mechanical digestion by teeth and tongue",
                    "Chemical digestion by salivary enzymes",
                    "Salivary glands produce digestive enzymes",
                    "Coordinated structures prepare food for swallowing"
                ],
                funFact: "You produce about 1-1.5 liters of saliva every day, which contains enzymes that begin breaking down starches before food even reaches your stomach!",
                objectives: "Explore how the mouth cavity coordinates mechanical and chemical digestion through its various structures.",
                narration: "The mouth cavity is where the amazing process of digestion truly begins! This space is perfectly designed to coordinate both mechanical and chemical breakdown of food. Your teeth provide the mechanical action, cutting and grinding food into smaller pieces to increase surface area. Meanwhile, three pairs of salivary glands - the parotid, submandibular, and sublingual glands - release saliva containing important enzymes like amylase, which begins breaking down starches immediately. The tongue orchestrates this entire process, positioning food for optimal chewing while mixing it with saliva. The roof of your mouth, or palate, provides a firm surface against which the tongue can press food during processing. Even the cheeks and lips help by keeping food positioned properly for chewing. By the time food leaves your mouth, it has been mechanically reduced and chemically treated, forming a moist bolus that's ready for its journey down the esophagus. It's incredible how all these structures work in perfect coordination every time you take a bite!"
            },
            stomach_structure: {
                title: "Stomach Structure and Anatomy",
                subtitle: "The body's mixing and storage chamber",
                icon: "🫃",
                modelUrl: "https://sketchfab.com/models/609aa5391322433189a7e08a81768f87/embed?autostart=1&internal=1&tracking=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "The stomach is a muscular sac that serves as a temporary storage and mixing chamber for food. Its structure includes distinct regions (fundus, body, antrum) and specialized cells that produce acid and enzymes. The stomach's muscular walls create churning motions that help break down food mechanically and chemically.",
                concepts: [
                    "J-shaped muscular sac with distinct regions",
                    "Gastric glands produce acid and enzymes",
                    "Muscular walls create churning movements",
                    "Can expand to hold 1-1.5 liters of food"
                ],
                funFact: "Your stomach produces about 2-3 liters of gastric juice daily, with acid so strong it could dissolve metal, yet the stomach protects itself with a mucus lining!",
                objectives: "Examine the detailed anatomy of the stomach and understand how its structure enables both storage and initial protein digestion.",
                narration: "The stomach is truly one of the most remarkable organs in your digestive system! This J-shaped muscular bag can expand dramatically to accommodate meals, stretching from about 50ml when empty to over 1 liter when full. The stomach has distinct anatomical regions - the fundus at the top for storage, the main body for mixing, and the antrum at the bottom for grinding. The stomach walls contain three layers of smooth muscle that contract in coordinated waves, creating a churning action that thoroughly mixes food with gastric juices. Special cells called parietal cells produce hydrochloric acid that's strong enough to dissolve metal, while chief cells release pepsinogen, which becomes the protein-digesting enzyme pepsin in the acidic environment. The stomach lining protects itself with a thick mucus barrier that's constantly renewed. This incredible organ can hold your food for 1-4 hours, gradually releasing it into the small intestine as a soupy mixture called chyme. The stomach essentially transforms solid food into a liquid that's ready for the next stage of digestion!"
            }
        };

        // Global Variables
        let currentStep = 'introduction';
        let voiceEnabled = true;
        let autoPlayEnabled = false;
        let currentSpeech = null;
        let selectedVoice = null;
        let journeyProgress = 0;
        let guidedTourActive = false;

        // Initialize Voice System
        function initVoiceSystem() {
            if (!('speechSynthesis' in window)) {
                console.warn('Speech synthesis not supported');
                voiceEnabled = false;
                document.getElementById('voiceToggle').style.display = 'none';
                return;
            }

            function loadVoices() {
                const voices = speechSynthesis.getVoices();
                if (voices.length === 0) return;

                const preferredVoices = [
                    'Google UK English Female',
                    'Microsoft Sonia',
                    'Microsoft Hazel',
                    'Samantha',
                    'Victoria'
                ];

                for (const name of preferredVoices) {
                    selectedVoice = voices.find(v => v.name.includes(name));
                    if (selectedVoice) break;
                }

                if (!selectedVoice) {
                    selectedVoice = voices.find(v => v.lang.startsWith('en'));
                }
            }

            loadVoices();
            if (speechSynthesis.onvoiceschanged !== undefined) {
                speechSynthesis.onvoiceschanged = loadVoices;
            }
        }

        // Load Journey Step
        function loadJourneyStep(stepId) {
            const stepData = JOURNEY_DATA[stepId];
            if (!stepData) return;

            currentStep = stepId;
            
            document.getElementById('api-frame').src = stepData.modelUrl;
            document.getElementById('stepIcon').textContent = stepData.icon;
            document.getElementById('stepTitle').textContent = stepData.title;
            document.getElementById('stepSubtitle').textContent = stepData.subtitle;
            document.getElementById('mainDescription').textContent = stepData.description;
            
            const conceptsList = document.getElementById('keyConcepts');
            conceptsList.innerHTML = stepData.concepts.map(c => `<li>${c}</li>`).join('');
            
            document.getElementById('funFact').textContent = stepData.funFact;
            document.getElementById('learningObjectives').textContent = stepData.objectives;
            
            updateNavigationButtons(stepId);
            updateProgress();
            
            if (voiceEnabled) {
                speakText(stepData.narration);
            }
        }

        function updateNavigationButtons(activeStep) {
            const buttons = document.querySelectorAll('.journey-btn');
            const steps = ['introduction', 'alimentary_canal', 'teeth_structure', 'tongue_anatomy', 'mouth_cavity', 'stomach_structure'];
            const activeIndex = steps.indexOf(activeStep);
            
            buttons.forEach((btn, index) => {
                btn.classList.remove('active', 'completed');
                if (index < activeIndex) {
                    btn.classList.add('completed');
                } else if (index === activeIndex) {
                    btn.classList.add('active');
                }
            });
            
            const miniSteps = document.querySelectorAll('.step-mini');
            miniSteps.forEach((step, index) => {
                step.classList.remove('active', 'completed');
                if (index < activeIndex) {
                    step.classList.add('completed');
                } else if (index === activeIndex) {
                    step.classList.add('active');
                }
            });
        }

        function updateProgress() {
            const steps = ['introduction', 'alimentary_canal', 'teeth_structure', 'tongue_anatomy', 'mouth_cavity', 'stomach_structure'];
            const currentIndex = steps.indexOf(currentStep);
            const progress = ((currentIndex + 1) / steps.length) * 100;
            
            document.getElementById('progressPercent').textContent = Math.round(progress) + '%';
            document.getElementById('progressFill').style.width = progress + '%';
        }

        function speakText(text) {
            if (!voiceEnabled || !text) return;
            
            stopSpeech();
            
            currentSpeech = new SpeechSynthesisUtterance(text);
            if (selectedVoice) {
                currentSpeech.voice = selectedVoice;
            }
            currentSpeech.rate = 0.9;
            currentSpeech.pitch = 1.0;
            currentSpeech.volume = 0.9;
            
            currentSpeech.onstart = () => {
                document.getElementById('voiceIndicator').classList.add('visible');
                document.getElementById('narrationText').textContent = 
                    text.substring(0, 50) + (text.length > 50 ? '...' : '');
            };
            
            currentSpeech.onend = () => {
                document.getElementById('voiceIndicator').classList.remove('visible');
                currentSpeech = null;
                
                if (guidedTourActive) {
                    setTimeout(nextStep, 2000);
                }
            };
            
            speechSynthesis.speak(currentSpeech);
        }

        function stopSpeech() {
            if (currentSpeech) {
                speechSynthesis.cancel();
                currentSpeech = null;
                document.getElementById('voiceIndicator').classList.remove('visible');
            }
        }

        function toggleVoice() {
            voiceEnabled = !voiceEnabled;
            const btn = document.getElementById('voiceToggle');
            btn.textContent = voiceEnabled ? '🔊' : '🔇';
            btn.classList.toggle('active', voiceEnabled);
            
            if (!voiceEnabled) {
                stopSpeech();
            }
        }

        function toggleAutoPlay() {
            autoPlayEnabled = !autoPlayEnabled;
            if (autoPlayEnabled) {
                startGuidedTour();
            } else {
                guidedTourActive = false;
            }
        }

        function toggleInfo() {
            const panel = document.getElementById('infoPanel');
            panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
        }

        function startGuidedTour() {
            guidedTourActive = true;
            const steps = ['introduction', 'alimentary_canal', 'teeth_structure', 'tongue_anatomy', 'mouth_cavity', 'stomach_structure'];
            let stepIndex = 0;
            
            function tourStep() {
                if (stepIndex < steps.length && guidedTourActive) {
                    loadJourneyStep(steps[stepIndex]);
                    stepIndex++;
                } else {
                    guidedTourActive = false;
                    if (voiceEnabled) {
                        speakText("You've completed your anatomical journey through the human digestive system! You now understand the structure and function of key digestive organs and how they work together to process food efficiently.");
                    }
                }
            }
            
            tourStep();
            window.nextStep = tourStep;
        }

        function showQuiz() {
            const questions = [
                "What are the main components of the alimentary canal?",
                "How do different types of teeth contribute to mechanical digestion?",
                "What are the multiple functions of the tongue in digestion?",
                "How does the mouth cavity coordinate mechanical and chemical digestion?",
                "What structural features allow the stomach to store and process food?"
            ];
            
            const randomQ = questions[Math.floor(Math.random() * questions.length)];
            
            if (voiceEnabled) {
                speakText(`Here's an anatomy question: ${randomQ} Think about the structures and functions we've explored!`);
            }
        }

        function init() {
            initVoiceSystem();
            
            setTimeout(() => {
                const loading = document.getElementById('loadingOverlay');
                loading.style.opacity = '0';
                setTimeout(() => {
                    loading.style.display = 'none';
                    
                    if (voiceEnabled) {
                        speakText("Welcome to your anatomical journey through the human digestive system! We'll explore the incredible structures that make digestion possible, from the specialized tools in your mouth to the complex anatomy of your stomach. Let's discover how form follows function in this remarkable biological system!");
                    }
                }, 1000);
            }, 3000);
            
            document.addEventListener('keydown', (e) => {
                switch(e.key) {
                    case 'v': toggleVoice(); break;
                    case 'i': toggleInfo(); break;
                    case 'g': startGuidedTour(); break;
                    case 'Escape': stopSpeech(); guidedTourActive = false; break;
                    case 'ArrowRight': nextStep && nextStep(); break;
                }
            });
        }

        init();
    </script>
</body>
</html>