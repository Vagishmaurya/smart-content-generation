<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reproductive Health & Contraception - Understanding Health and Responsibility</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tween.js/18.6.4/tween.umd.js"></script>

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            color: white;
            overflow: hidden;
            position: relative;
            height: 100vh;
        }

        /* Animated Background */
        .bg-animation {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 0;
            opacity: 0.1;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320"><path fill="%23ffffff" fill-opacity="0.2" d="M0,96L48,112C96,128,192,160,288,186.7C384,213,480,235,576,213.3C672,192,768,128,864,128C960,128,1056,192,1152,197.3C1248,203,1344,149,1392,122.7L1440,96L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path></svg>') repeat-x;
            animation: wave 20s linear infinite;
        }

        @keyframes wave {
            0% { background-position-x: 0; }
            100% { background-position-x: 1440px; }
        }

        /* Museum Interface - Compact Header */
        .museum-header {
            position: absolute;
            top: 10px;
            left: 20px;
            text-align: left;
            z-index: 1000;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            padding: 10px 18px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        .museum-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 4px;
            background: linear-gradient(45deg, #3498db, #2ecc71);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: titleGlow 3s ease-in-out infinite;
        }

        @keyframes titleGlow {
            0%, 100% { filter: brightness(1); }
            50% { filter: brightness(1.2); }
        }

        .exhibit-subtitle {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.8);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .health-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: #2ecc71;
            border-radius: 50%;
            animation: health-pulse 2s ease-in-out infinite;
        }

        @keyframes health-pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.3); opacity: 0.7; }
        }

        /* Journey Navigation - Enhanced */
        .journey-navigation {
            position: absolute;
            bottom: 20px;
            left: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 1000;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            padding: 15px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            max-width: 320px;
        }

        .journey-title {
            font-size: 14px;
            font-weight: 600;
            color: #3498db;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .journey-steps {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
        }

        .journey-btn {
            background: rgba(52, 152, 219, 0.2);
            border: 1px solid rgba(52, 152, 219, 0.4);
            color: white;
            padding: 6px 10px;
            border-radius: 20px;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 4px;
            white-space: nowrap;
        }

        .journey-btn:hover {
            background: rgba(52, 152, 219, 0.3);
            border-color: #3498db;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3);
        }

        .journey-btn.active {
            background: linear-gradient(135deg, #3498db, #2c3e50);
            border-color: #3498db;
            box-shadow: 0 0 20px rgba(52, 152, 219, 0.5);
            animation: pulse 2s infinite;
        }

        .journey-btn.completed {
            background: rgba(46, 204, 113, 0.3);
            border-color: #2ecc71;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* 3D Model Container */
        .model-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 0;
            overflow: hidden;
            border: none;
            z-index: 100;
        }

        .sketchfab-embed-wrapper {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
        }

        .sketchfab-embed-wrapper iframe {
            width: 100%;
            height: 100%;
            border: none;
            border-radius: 0;
        }

        /* Information Panel - Enhanced */
        .info-panel {
            position: absolute;
            top: 70px;
            right: 20px;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 16px;
            padding: 24px;
            width: 380px;
            max-height: calc(100vh - 140px);
            z-index: 800;
            overflow-y: auto;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }

        .info-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
        }

        .info-icon {
            font-size: 28px;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        .info-title {
            flex: 1;
        }

        .info-title h2 {
            font-size: 18px;
            color: #3498db;
            margin-bottom: 4px;
        }

        .info-subtitle {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
        }

        .info-content {
            color: rgba(255, 255, 255, 0.9);
            font-size: 14px;
            line-height: 1.6;
        }

        /* Progress Tracker */
        .progress-tracker {
            background: linear-gradient(135deg, rgba(52, 152, 219, 0.1), rgba(46, 204, 113, 0.1));
            border: 1px solid rgba(52, 152, 219, 0.3);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 20px;
        }

        .progress-header {
            font-size: 13px;
            font-weight: 600;
            color: #3498db;
            margin-bottom: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .progress-percentage {
            font-size: 18px;
            color: #2ecc71;
            font-weight: 700;
        }

        .progress-bar {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 12px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #3498db, #2ecc71);
            border-radius: 4px;
            transition: width 0.8s ease;
            box-shadow: 0 0 10px rgba(52, 152, 219, 0.5);
        }

        .progress-steps-mini {
            display: flex;
            justify-content: space-between;
            font-size: 8px;
            color: rgba(255, 255, 255, 0.6);
        }

        .step-mini {
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .step-mini.active {
            color: #3498db;
            font-weight: 600;
        }

        .step-mini.completed {
            color: #2ecc71;
        }

        /* Information Cards */
        .info-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 14px;
            margin-bottom: 14px;
        }

        .info-card-title {
            color: #3498db;
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .info-card-content {
            color: rgba(255, 255, 255, 0.85);
            font-size: 12px;
            line-height: 1.5;
        }

        .info-list {
            list-style: none;
            padding: 0;
        }

        .info-list li {
            padding: 6px 0;
            padding-left: 20px;
            position: relative;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.8);
        }

        .info-list li:before {
            content: "‚Üí";
            position: absolute;
            left: 0;
            color: #3498db;
        }

        /* Important Fact Box */
        .important-fact {
            background: linear-gradient(135deg, rgba(46, 204, 113, 0.1), rgba(52, 152, 219, 0.1));
            border: 1px solid rgba(46, 204, 113, 0.3);
            border-radius: 12px;
            padding: 14px;
            margin: 16px 0;
            position: relative;
            overflow: hidden;
        }

        .important-fact:before {
            content: "‚öïÔ∏è";
            position: absolute;
            top: -20px;
            right: -20px;
            font-size: 60px;
            opacity: 0.1;
        }

        .important-fact-title {
            color: #2ecc71;
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 6px;
        }

        .important-fact-text {
            color: rgba(255, 255, 255, 0.9);
            font-size: 12px;
            line-height: 1.5;
            position: relative;
            z-index: 1;
        }

        /* Voice Controls */
        .voice-controls {
            position: absolute;
            top: 10px;
            right: 20px;
            display: flex;
            gap: 8px;
            z-index: 1000;
        }

        .control-btn {
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            position: relative;
        }

        .control-btn:hover {
            background: rgba(52, 152, 219, 0.3);
            border-color: #3498db;
            transform: scale(1.1);
        }

        .control-btn.active {
            background: rgba(52, 152, 219, 0.4);
            border-color: #3498db;
            box-shadow: 0 0 20px rgba(52, 152, 219, 0.5);
        }

        .control-tooltip {
            position: absolute;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.9);
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 10px;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .control-btn:hover .control-tooltip {
            opacity: 1;
        }

        /* Loading Screen */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            transition: opacity 1s ease;
        }

        .loading-content {
            text-align: center;
        }

        .loading-health {
            font-size: 60px;
            animation: health-pulse 2s ease-in-out infinite;
            margin-bottom: 20px;
        }

        .loading-text {
            color: white;
            font-size: 20px;
            margin-bottom: 20px;
        }

        .loading-progress {
            width: 200px;
            height: 4px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 2px;
            overflow: hidden;
        }

        .loading-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #3498db, #2ecc71);
            animation: loading 2s ease-in-out infinite;
        }

        @keyframes loading {
            0% { width: 0%; }
            50% { width: 100%; }
            100% { width: 0%; }
        }

        /* Voice Indicator */
        .voice-indicator {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(52, 152, 219, 0.5);
            border-radius: 30px;
            padding: 14px 28px;
            display: flex;
            align-items: center;
            gap: 12px;
            z-index: 1000;
            opacity: 0;
            transition: all 0.3s ease;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }

        .voice-indicator.visible {
            opacity: 1;
            transform: translateX(-50%) translateY(-10px);
        }

        .voice-waves {
            display: flex;
            align-items: center;
            gap: 3px;
        }

        .voice-wave {
            width: 3px;
            height: 20px;
            background: linear-gradient(180deg, #3498db, #2ecc71);
            border-radius: 2px;
            animation: voice-wave 1s ease-in-out infinite;
        }

        .voice-wave:nth-child(2) { animation-delay: 0.1s; }
        .voice-wave:nth-child(3) { animation-delay: 0.2s; }
        .voice-wave:nth-child(4) { animation-delay: 0.3s; }
        .voice-wave:nth-child(5) { animation-delay: 0.4s; }

        @keyframes voice-wave {
            0%, 100% { transform: scaleY(0.3); }
            50% { transform: scaleY(1); }
        }

        .narration-text {
            color: white;
            font-size: 13px;
            max-width: 300px;
        }

        /* Quick Actions */
        .quick-actions {
            position: absolute;
            bottom: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
            z-index: 1000;
        }

        .action-btn {
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 10px 16px;
            border-radius: 25px;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
        }

        .action-btn:hover {
            background: rgba(52, 152, 219, 0.3);
            border-color: #3498db;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3);
        }

        /* Custom Scrollbar */
        .info-panel::-webkit-scrollbar {
            width: 6px;
        }

        .info-panel::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 3px;
        }

        .info-panel::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, #3498db, #2ecc71);
            border-radius: 3px;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .info-panel {
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                top: auto;
                width: 100%;
                max-height: 50vh;
                border-radius: 20px 20px 0 0;
            }
            
            .journey-navigation {
                bottom: 52vh;
                max-width: calc(100% - 40px);
            }
            
            .voice-controls {
                top: auto;
                bottom: 55vh;
                right: 10px;
            }
            
            .quick-actions {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="bg-animation"></div>

    <!-- Loading Screen -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="loading-health">‚öïÔ∏è</div>
            <div class="loading-text">Preparing Your Health Education...</div>
            <div class="loading-progress">
                <div class="loading-progress-bar"></div>
            </div>
        </div>
    </div>

    <!-- Museum Header -->
    <div class="museum-header">
        <div class="museum-title">Reproductive Health & Contraception</div>
        <div class="exhibit-subtitle">
            <span class="health-indicator"></span>
            Understanding Health and Responsibility
        </div>
    </div>

    <!-- Journey Navigation -->
    <div class="journey-navigation">
        <div class="journey-title">
            <span>‚öïÔ∏è</span>
            <span>Your Health Journey</span>
        </div>
        <div class="journey-steps">
            <button class="journey-btn active" onclick="loadJourneyStep('std')">
                <span>ü¶†</span> STDs
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('barrier')">
                <span>üõ°Ô∏è</span> Barriers
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('copper_iud')">
                <span>üîß</span> Copper IUD
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('hormonal_iud')">
                <span>üíä</span> Hormonal IUD
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('responsibility')">
                <span>üéØ</span> Responsibility
            </button>
        </div>
    </div>

    <!-- 3D Model Container -->
    <div class="model-container">
        <div class="sketchfab-embed-wrapper">
            <iframe id="api-frame"
                    title="STD Bacteria Model" 
                    frameborder="0" 
                    allowfullscreen 
                    mozallowfullscreen="true" 
                    webkitallowfullscreen="true" 
                    allow="autoplay; fullscreen; xr-spatial-tracking"
                    xr-spatial-tracking 
                    execution-while-out-of-viewport 
                    execution-while-not-rendered 
                    web-share 
                    src="https://sketchfab.com/models/440e079f4e7d4532a558db22152ff5f5/embed?autostart=1&internal=1&tracking=0&ui_ar=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0">
            </iframe>
        </div>
    </div>

    <!-- Information Panel -->
    <div class="info-panel" id="infoPanel">
        <div class="info-header">
            <div class="info-icon" id="stepIcon">ü¶†</div>
            <div class="info-title">
                <h2 id="stepTitle">STDs - Understanding Disease Prevention</h2>
                <div class="info-subtitle" id="stepSubtitle">Knowledge for protection</div>
            </div>
        </div>

        <!-- Progress Tracker -->
        <div class="progress-tracker">
            <div class="progress-header">
                <span>Health Education Progress</span>
                <span class="progress-percentage" id="progressPercent">20%</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 20%"></div>
            </div>
            <div class="progress-steps-mini">
                <span class="step-mini active" onclick="loadJourneyStep('std')">STDs</span>
                <span class="step-mini" onclick="loadJourneyStep('barrier')">Barriers</span>
                <span class="step-mini" onclick="loadJourneyStep('copper_iud')">Copper</span>
                <span class="step-mini" onclick="loadJourneyStep('hormonal_iud')">Hormonal</span>
                <span class="step-mini" onclick="loadJourneyStep('responsibility')">Responsibility</span>
            </div>
        </div>

        <div class="info-content" id="mainDescription">
            Sexually transmitted diseases (STDs) are infections spread through sexual contact. Understanding these diseases, their prevention, and treatment is essential for maintaining reproductive health and making informed decisions about sexual activity.
        </div>

        <div class="info-card">
            <div class="info-card-title">
                <span>üî¨</span> Key Health Facts
            </div>
            <div class="info-card-content">
                <ul class="info-list" id="keyConcepts">
                    <li>STDs are caused by bacteria, viruses, or parasites</li>
                    <li>Many STDs are asymptomatic initially</li>
                    <li>Early detection and treatment prevent complications</li>
                    <li>Prevention through safe practices is most effective</li>
                </ul>
            </div>
        </div>

        <div class="important-fact">
            <div class="important-fact-title">Health Information</div>
            <div class="important-fact-text" id="healthFact">
                Regular STD testing is important for sexually active individuals. Many STDs are completely curable with proper medical treatment, while others can be effectively managed.
            </div>
        </div>

        <div class="info-card">
            <div class="info-card-title">
                <span>üéØ</span> Learning Objectives
            </div>
            <div class="info-card-content" id="learningObjectives">
                Understand STD transmission, prevention methods, and the importance of regular health screenings for maintaining reproductive health.
            </div>
        </div>
    </div>

    <!-- Voice Controls -->
    <div class="voice-controls">
        <button class="control-btn active" id="voiceToggle" onclick="toggleVoice()">
            üîä
            <span class="control-tooltip">Voice Narration</span>
        </button>
        <button class="control-btn" onclick="toggleAutoPlay()">
            ‚ñ∂Ô∏è
            <span class="control-tooltip">Auto Journey</span>
        </button>
        <button class="control-btn" onclick="toggleInfo()">
            ‚ÑπÔ∏è
            <span class="control-tooltip">Toggle Info</span>
        </button>
    </div>

    <!-- Quick Actions -->
    <div class="quick-actions">
        <button class="action-btn" onclick="startGuidedTour()">
            <span>üöÄ</span> Guided Tour
        </button>
        <button class="action-btn" onclick="showQuiz()">
            <span>üéØ</span> Test Knowledge
        </button>
    </div>

    <!-- Voice Indicator -->
    <div class="voice-indicator" id="voiceIndicator">
        <div class="voice-waves">
            <div class="voice-wave"></div>
            <div class="voice-wave"></div>
            <div class="voice-wave"></div>
            <div class="voice-wave"></div>
            <div class="voice-wave"></div>
        </div>
        <div class="narration-text" id="narrationText">Narrating...</div>
    </div>

    <script>
        // Journey Step Data with Complete Health Education Content
        const JOURNEY_DATA = {
            std: {
                title: "STDs - Understanding Disease Prevention",
                subtitle: "Knowledge for protection",
                icon: "ü¶†",
                modelUrl: "https://sketchfab.com/models/440e079f4e7d4532a558db22152ff5f5/embed?autostart=1&internal=1&tracking=0&ui_ar=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "Sexually transmitted diseases (STDs) are infections spread through sexual contact. Understanding these diseases, their prevention, and treatment is essential for maintaining reproductive health and making informed decisions about sexual activity.",
                concepts: [
                    "STDs are caused by bacteria, viruses, or parasites",
                    "Many STDs are asymptomatic initially",
                    "Early detection and treatment prevent complications",
                    "Prevention through safe practices is most effective"
                ],
                healthFact: "Regular STD testing is important for sexually active individuals. Many STDs are completely curable with proper medical treatment, while others can be effectively managed.",
                objectives: "Understand STD transmission, prevention methods, and the importance of regular health screenings for maintaining reproductive health.",
                narration: "This model shows Neisseria gonorrhoeae, the bacteria that causes gonorrhea, one of the most common sexually transmitted infections. Understanding STDs is crucial for maintaining reproductive health. STDs are infections transmitted through sexual contact and can be caused by bacteria, viruses, or parasites. Many STDs, particularly in early stages, may not show symptoms, which is why regular testing is important for sexually active individuals. Bacterial STDs like gonorrhea, chlamydia, and syphilis are completely curable with appropriate antibiotic treatment. Viral STDs like herpes and HIV can be effectively managed with medication. The key to STD prevention includes practicing safe sex, using barrier methods consistently, limiting sexual partners, and regular health screenings. Open communication with partners about sexual health is also essential. If diagnosed with an STD, following treatment protocols and notifying partners is important for community health."
            },
            barrier: {
                title: "Barrier Methods - Physical Protection",
                subtitle: "Contraception and STD prevention",
                icon: "üõ°Ô∏è",
                modelUrl: "https://sketchfab.com/3d-models/latex-condoms-sketex-sbs-file-f36df04ac66a43ae9ac9da3744b67737/embed?autostart=1&internal=1&tracking=0&ui_ar=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "Barrier methods provide dual protection against unwanted pregnancy and sexually transmitted infections. These methods work by creating a physical barrier that prevents sperm from reaching the egg and reduces disease transmission.",
                concepts: [
                    "Male and female condoms provide dual protection",
                    "Proper use is essential for effectiveness",
                    "Latex and non-latex options are available",
                    "Single-use only for optimal protection"
                ],
                healthFact: "When used correctly and consistently, male condoms are about 98% effective at preventing pregnancy and significantly reduce STD transmission risk.",
                objectives: "Learn about barrier contraception methods and understand their role in both pregnancy prevention and STD protection.",
                narration: "Barrier methods like condoms are among the most accessible and effective forms of dual protection against both pregnancy and STDs. Male condoms, like those shown in this model, create a physical barrier that prevents sperm from entering the reproductive tract and reduces contact with bodily fluids that can transmit infections. Female condoms provide similar protection and can be inserted before sexual activity. For maximum effectiveness, condoms must be used correctly every time - this means checking expiration dates, avoiding damage during opening, leaving space at the tip, and using throughout the entire sexual encounter. Latex condoms are most common, but non-latex options are available for those with allergies. Water-based or silicone-based lubricants can increase comfort and reduce breakage, but oil-based products should never be used with latex condoms as they can cause breakdown. Barrier methods are unique among contraceptive options because they provide protection against both pregnancy and STDs, making them an important tool for reproductive health."
            },
            copper_iud: {
                title: "Copper IUD - Long-term Protection",
                subtitle: "Non-hormonal contraception",
                icon: "üîß",
                modelUrl: "https://sketchfab.com/3d-models/copper-iud-930890ede6754a729bee647f3ca18a5a/embed?autostart=1&internal=1&tracking=0&ui_ar=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "The copper intrauterine device (IUD) is a highly effective, long-term contraceptive method that works without hormones. It prevents pregnancy through copper's spermicidal effects and can provide protection for up to 10 years.",
                concepts: [
                    "T-shaped device inserted into the uterus",
                    "Copper creates hostile environment for sperm",
                    "Effective for 10 years after insertion",
                    "Reversible - fertility returns after removal"
                ],
                healthFact: "The copper IUD is over 99% effective at preventing pregnancy and can also be used as emergency contraception if inserted within 5 days of unprotected intercourse.",
                objectives: "Understand how copper IUDs work and their advantages as a long-term, reversible contraceptive method.",
                narration: "The copper IUD represents one of the most effective long-term contraceptive methods available. This T-shaped device is inserted into the uterus by a healthcare provider during a brief procedure. The copper wire wrapped around the device creates an environment that is toxic to sperm, preventing fertilization. Additionally, the presence of the device may prevent implantation if fertilization does occur. One of the major advantages of the copper IUD is that it contains no hormones, making it suitable for people who cannot or prefer not to use hormonal contraception. The device can remain effective for up to 10 years, making it highly cost-effective over time. Fertility typically returns quickly after removal, making it a reversible option. The copper IUD can also serve as highly effective emergency contraception if inserted within 5 days of unprotected intercourse. While some people experience heavier menstrual periods initially, this often improves over time. Like all contraceptive methods, the choice to use a copper IUD should be discussed with a healthcare provider to ensure it's appropriate for individual health needs."
            },
            hormonal_iud: {
                title: "Hormonal IUD - Hormone-based Protection",
                subtitle: "Localized hormone delivery",
                icon: "üíä",
                modelUrl: "https://sketchfab.com/3d-models/mirena-iud-478d035f4f4a475c91262bb31bc8f696/embed?autostart=1&internal=1&tracking=0&ui_ar=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "Hormonal IUDs like the Mirena release small amounts of progestin directly into the uterus, providing highly effective contraception while often reducing menstrual bleeding. They combine the convenience of long-term protection with hormonal benefits.",
                concepts: [
                    "Releases progestin hormone locally",
                    "Thickens cervical mucus to block sperm",
                    "Often reduces or stops menstrual periods",
                    "Effective for 3-7 years depending on type"
                ],
                healthFact: "Hormonal IUDs are over 99% effective and may reduce menstrual cramps and bleeding, with many users experiencing very light periods or no periods at all.",
                objectives: "Learn how hormonal IUDs work and understand their contraceptive and menstrual benefits.",
                narration: "The hormonal IUD, such as the Mirena system shown here, represents an advanced contraceptive technology that combines high effectiveness with additional health benefits. This device releases a small amount of the hormone progestin directly into the uterus, which works in multiple ways to prevent pregnancy. The hormone thickens cervical mucus, making it difficult for sperm to travel through the cervix, and it thins the uterine lining, making implantation less likely. In some cases, ovulation may also be suppressed. One significant advantage of hormonal IUDs is their effect on menstruation - many users experience lighter, shorter periods, and some stop having periods entirely while the device is in place. This can be particularly beneficial for people with heavy menstrual bleeding or painful periods. The localized hormone delivery means lower systemic hormone levels compared to birth control pills, potentially reducing side effects. Different hormonal IUDs are effective for different durations - typically 3 to 7 years. Like the copper IUD, fertility generally returns quickly after removal. The decision to use a hormonal IUD should involve discussion with a healthcare provider about individual health history and preferences."
            },
            responsibility: {
                title: "Reproductive Responsibility - Making Informed Choices",
                subtitle: "Health, planning, and population considerations",
                icon: "üéØ",
                modelUrl: "https://sketchfab.com/3d-models/copper-iud-930890ede6754a729bee647f3ca18a5a/embed?autostart=1&internal=1&tracking=0&ui_ar=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "Reproductive responsibility involves making informed decisions about sexual health, family planning, and considering broader implications for individual and community wellbeing. This includes access to education, healthcare, and contraceptive choices.",
                concepts: [
                    "Access to comprehensive health education",
                    "Individual choice in family planning timing",
                    "Partner communication and shared responsibility",
                    "Healthcare access for all reproductive decisions"
                ],
                healthFact: "Family planning allows individuals to decide if, when, and how many children to have, leading to better health outcomes for families and communities.",
                objectives: "Understand the importance of reproductive responsibility, informed decision-making, and access to comprehensive reproductive healthcare.",
                narration: "Reproductive responsibility encompasses the ethical and practical considerations of sexual health and family planning. This includes having access to accurate, comprehensive education about reproduction, contraception, and sexually transmitted infections. Responsible reproductive choices involve considering one's readiness for parenthood - emotionally, financially, and practically. This might mean choosing to prevent pregnancy until conditions are optimal, or it might mean planning for children when the time is right. Access to a full range of contraceptive options allows individuals to make choices that align with their health needs, values, and life circumstances. Communication between partners about sexual health, contraception, and family planning goals is essential. Reproductive responsibility also includes regular healthcare, including STD testing and reproductive health screenings. From a broader perspective, when individuals have access to family planning resources, it can lead to better health outcomes, educational opportunities, and economic stability for families and communities. The goal is ensuring that every person has the information, resources, and healthcare access needed to make informed decisions about their reproductive health throughout their lives."
            }
        };

        // Global Variables
        let currentStep = 'std';
        let voiceEnabled = true;
        let autoPlayEnabled = false;
        let currentSpeech = null;
        let selectedVoice = null;
        let journeyProgress = 0;
        let guidedTourActive = false;

        // Initialize Voice System
        function initVoiceSystem() {
            if (!('speechSynthesis' in window)) {
                console.warn('Speech synthesis not supported');
                voiceEnabled = false;
                document.getElementById('voiceToggle').style.display = 'none';
                return;
            }

            function loadVoices() {
                const voices = speechSynthesis.getVoices();
                if (voices.length === 0) return;

                // Prefer natural-sounding voices
                const preferredVoices = [
                    'Google UK English Female',
                    'Microsoft Sonia',
                    'Microsoft Hazel',
                    'Samantha',
                    'Victoria'
                ];

                for (const name of preferredVoices) {
                    selectedVoice = voices.find(v => v.name.includes(name));
                    if (selectedVoice) break;
                }

                if (!selectedVoice) {
                    selectedVoice = voices.find(v => v.lang.startsWith('en'));
                }
            }

            loadVoices();
            if (speechSynthesis.onvoiceschanged !== undefined) {
                speechSynthesis.onvoiceschanged = loadVoices;
            }
        }

        // Load Journey Step
        function loadJourneyStep(stepId) {
            const stepData = JOURNEY_DATA[stepId];
            if (!stepData) return;

            currentStep = stepId;
            
            // Update model
            document.getElementById('api-frame').src = stepData.modelUrl;
            
            // Update info panel
            document.getElementById('stepIcon').textContent = stepData.icon;
            document.getElementById('stepTitle').textContent = stepData.title;
            document.getElementById('stepSubtitle').textContent = stepData.subtitle;
            document.getElementById('mainDescription').textContent = stepData.description;
            
            // Update key concepts
            const conceptsList = document.getElementById('keyConcepts');
            conceptsList.innerHTML = stepData.concepts.map(c => `<li>${c}</li>`).join('');
            
            // Update health fact
            document.getElementById('healthFact').textContent = stepData.healthFact;
            
            // Update learning objectives
            document.getElementById('learningObjectives').textContent = stepData.objectives;
            
            // Update navigation buttons
            updateNavigationButtons(stepId);
            
            // Update progress
            updateProgress();
            
            // Play narration if enabled
            if (voiceEnabled) {
                speakText(stepData.narration);
            }
        }

        // Update Navigation Buttons
        function updateNavigationButtons(activeStep) {
            const buttons = document.querySelectorAll('.journey-btn');
            const steps = ['std', 'barrier', 'copper_iud', 'hormonal_iud', 'responsibility'];
            const activeIndex = steps.indexOf(activeStep);
            
            buttons.forEach((btn, index) => {
                btn.classList.remove('active', 'completed');
                if (index < activeIndex) {
                    btn.classList.add('completed');
                } else if (index === activeIndex) {
                    btn.classList.add('active');
                }
            });
            
            // Update mini steps
            const miniSteps = document.querySelectorAll('.step-mini');
            miniSteps.forEach((step, index) => {
                step.classList.remove('active', 'completed');
                if (index < activeIndex) {
                    step.classList.add('completed');
                } else if (index === activeIndex) {
                    step.classList.add('active');
                }
            });
        }

        // Update Progress
        function updateProgress() {
            const steps = ['std', 'barrier', 'copper_iud', 'hormonal_iud', 'responsibility'];
            const currentIndex = steps.indexOf(currentStep);
            const progress = ((currentIndex + 1) / steps.length) * 100;
            
            document.getElementById('progressPercent').textContent = Math.round(progress) + '%';
            document.getElementById('progressFill').style.width = progress + '%';
        }

        // Speech Functions
        function speakText(text) {
            if (!voiceEnabled || !text) return;
            
            stopSpeech();
            
            currentSpeech = new SpeechSynthesisUtterance(text);
            if (selectedVoice) {
                currentSpeech.voice = selectedVoice;
            }
            currentSpeech.rate = 0.9;
            currentSpeech.pitch = 1.0;
            currentSpeech.volume = 0.9;
            
            currentSpeech.onstart = () => {
                document.getElementById('voiceIndicator').classList.add('visible');
                document.getElementById('narrationText').textContent = 
                    text.substring(0, 50) + (text.length > 50 ? '...' : '');
            };
            
            currentSpeech.onend = () => {
                document.getElementById('voiceIndicator').classList.remove('visible');
                currentSpeech = null;
                
                // Auto-advance if guided tour is active
                if (guidedTourActive) {
                    setTimeout(nextStep, 2000);
                }
            };
            
            speechSynthesis.speak(currentSpeech);
        }

        function stopSpeech() {
            if (currentSpeech) {
                speechSynthesis.cancel();
                currentSpeech = null;
                document.getElementById('voiceIndicator').classList.remove('visible');
            }
        }

        // Control Functions
        function toggleVoice() {
            voiceEnabled = !voiceEnabled;
            const btn = document.getElementById('voiceToggle');
            btn.textContent = voiceEnabled ? 'üîä' : 'üîá';
            btn.classList.toggle('active', voiceEnabled);
            
            if (!voiceEnabled) {
                stopSpeech();
            }
        }

        function toggleAutoPlay() {
            autoPlayEnabled = !autoPlayEnabled;
            if (autoPlayEnabled) {
                startGuidedTour();
            } else {
                guidedTourActive = false;
            }
        }

        function toggleInfo() {
            const panel = document.getElementById('infoPanel');
            panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
        }

        // Guided Tour
        function startGuidedTour() {
            guidedTourActive = true;
            const steps = ['std', 'barrier', 'copper_iud', 'hormonal_iud', 'responsibility'];
            let stepIndex = 0;
            
            function tourStep() {
                if (stepIndex < steps.length && guidedTourActive) {
                    loadJourneyStep(steps[stepIndex]);
                    stepIndex++;
                } else {
                    guidedTourActive = false;
                    if (voiceEnabled) {
                        speakText("You have completed your health education journey. Remember, making informed decisions about reproductive health requires ongoing education, open communication with healthcare providers, and access to quality medical care.");
                    }
                }
            }
            
            tourStep();
            window.nextStep = tourStep;
        }

        // Quiz Function
        function showQuiz() {
            const questions = [
                "What are the key ways to prevent sexually transmitted diseases?",
                "How do barrier methods provide dual protection?",
                "What are the differences between copper and hormonal IUDs?",
                "Why is reproductive responsibility important for individuals and communities?",
                "What factors should be considered when choosing contraceptive methods?"
            ];
            
            const randomQ = questions[Math.floor(Math.random() * questions.length)];
            
            if (voiceEnabled) {
                speakText(`Here's a question about reproductive health: ${randomQ} Consider what you've learned about making informed health decisions.`);
            }
        }

        // Initialize
        function init() {
            initVoiceSystem();
            
            // Hide loading screen
            setTimeout(() => {
                const loading = document.getElementById('loadingOverlay');
                loading.style.opacity = '0';
                setTimeout(() => {
                    loading.style.display = 'none';
                    
                    // Welcome message
                    if (voiceEnabled) {
                        speakText("Welcome to your reproductive health education journey. We'll explore important topics including disease prevention, contraceptive methods, and responsible decision-making. This information is essential for maintaining good health and making informed choices.");
                    }
                }, 1000);
            }, 3000);
            
            // Keyboard shortcuts
            document.addEventListener('keydown', (e) => {
                switch(e.key) {
                    case 'v': toggleVoice(); break;
                    case 'i': toggleInfo(); break;
                    case 'g': startGuidedTour(); break;
                    case 'Escape': stopSpeech(); guidedTourActive = false; break;
                    case 'ArrowRight': nextStep && nextStep(); break;
                }
            });
        }

        // Start the application
        init();
    </script>
</body>
</html>