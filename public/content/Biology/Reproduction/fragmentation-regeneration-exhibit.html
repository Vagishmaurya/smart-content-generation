<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fragmentation & Regeneration - Nature's Amazing Recovery</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tween.js/18.6.4/tween.umd.js"></script>

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            overflow: hidden;
            position: relative;
            height: 100vh;
        }

        /* Animated Background */
        .bg-animation {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 0;
            opacity: 0.1;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320"><path fill="%23ffffff" fill-opacity="0.2" d="M0,96L48,112C96,128,192,160,288,186.7C384,213,480,235,576,213.3C672,192,768,128,864,128C960,128,1056,192,1152,197.3C1248,203,1344,149,1392,122.7L1440,96L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path></svg>') repeat-x;
            animation: wave 10s linear infinite;
        }

        @keyframes wave {
            0% { background-position-x: 0; }
            100% { background-position-x: 1440px; }
        }

        /* Museum Interface - Compact Header */
        .museum-header {
            position: absolute;
            top: 10px;
            left: 20px;
            text-align: left;
            z-index: 1000;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            padding: 10px 18px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        .museum-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 4px;
            background: linear-gradient(45deg, #11998e, #38ef7d);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: titleGlow 3s ease-in-out infinite;
        }

        @keyframes titleGlow {
            0%, 100% { filter: brightness(1); }
            50% { filter: brightness(1.2); }
        }

        .exhibit-subtitle {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.8);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .regen-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: #38ef7d;
            border-radius: 50%;
            animation: regenerate 2s ease-in-out infinite;
        }

        @keyframes regenerate {
            0% { transform: scale(0.5); opacity: 0.5; }
            50% { transform: scale(1.2); opacity: 1; }
            100% { transform: scale(1); opacity: 0.8; }
        }

        /* Journey Navigation - Enhanced */
        .journey-navigation {
            position: absolute;
            bottom: 20px;
            left: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 1000;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            padding: 15px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            max-width: 320px;
        }

        .journey-title {
            font-size: 14px;
            font-weight: 600;
            color: #38ef7d;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .journey-steps {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
        }

        .journey-btn {
            background: rgba(56, 239, 125, 0.2);
            border: 1px solid rgba(56, 239, 125, 0.4);
            color: white;
            padding: 6px 10px;
            border-radius: 20px;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 4px;
            white-space: nowrap;
        }

        .journey-btn:hover {
            background: rgba(56, 239, 125, 0.3);
            border-color: #38ef7d;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(56, 239, 125, 0.3);
        }

        .journey-btn.active {
            background: linear-gradient(135deg, #11998e, #38ef7d);
            border-color: #38ef7d;
            box-shadow: 0 0 20px rgba(56, 239, 125, 0.5);
            animation: pulseGreen 2s infinite;
        }

        .journey-btn.completed {
            background: rgba(46, 204, 113, 0.3);
            border-color: #2ecc71;
        }

        @keyframes pulseGreen {
            0%, 100% { box-shadow: 0 0 20px rgba(56, 239, 125, 0.5); }
            50% { box-shadow: 0 0 30px rgba(56, 239, 125, 0.8); }
        }

        /* 3D Model Container */
        .model-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 0;
            overflow: hidden;
            border: none;
            z-index: 100;
        }

        .sketchfab-embed-wrapper {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .sketchfab-embed-wrapper iframe {
            width: 100%;
            height: 100%;
            border: none;
            border-radius: 0;
        }

        /* Information Panel - Enhanced */
        .info-panel {
            position: absolute;
            top: 70px;
            right: 20px;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 16px;
            padding: 24px;
            width: 380px;
            max-height: calc(100vh - 140px);
            z-index: 800;
            overflow-y: auto;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }

        .info-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
        }

        .info-icon {
            font-size: 28px;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        .info-title {
            flex: 1;
        }

        .info-title h2 {
            font-size: 18px;
            color: #38ef7d;
            margin-bottom: 4px;
        }

        .info-subtitle {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
        }

        .info-content {
            color: rgba(255, 255, 255, 0.9);
            font-size: 14px;
            line-height: 1.6;
        }

        /* Progress Tracker */
        .progress-tracker {
            background: linear-gradient(135deg, rgba(17, 153, 142, 0.1), rgba(56, 239, 125, 0.1));
            border: 1px solid rgba(56, 239, 125, 0.3);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 20px;
        }

        .progress-header {
            font-size: 13px;
            font-weight: 600;
            color: #38ef7d;
            margin-bottom: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .progress-percentage {
            font-size: 18px;
            color: #11998e;
            font-weight: 700;
        }

        .progress-bar {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 12px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #11998e, #38ef7d);
            border-radius: 4px;
            transition: width 0.8s ease;
            box-shadow: 0 0 10px rgba(56, 239, 125, 0.5);
        }

        .progress-steps-mini {
            display: flex;
            justify-content: space-between;
            font-size: 10px;
            color: rgba(255, 255, 255, 0.6);
            flex-wrap: wrap;
            gap: 5px;
        }

        .step-mini {
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .step-mini.active {
            color: #38ef7d;
            font-weight: 600;
        }

        .step-mini.completed {
            color: #2ecc71;
        }

        /* Information Cards */
        .info-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 14px;
            margin-bottom: 14px;
        }

        .info-card-title {
            color: #38ef7d;
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .info-card-content {
            color: rgba(255, 255, 255, 0.85);
            font-size: 12px;
            line-height: 1.5;
        }

        .info-list {
            list-style: none;
            padding: 0;
        }

        .info-list li {
            padding: 6px 0;
            padding-left: 20px;
            position: relative;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.8);
        }

        .info-list li:before {
            content: "‚Üí";
            position: absolute;
            left: 0;
            color: #38ef7d;
        }

        /* Fun Fact Box */
        .fun-fact {
            background: linear-gradient(135deg, rgba(17, 153, 142, 0.1), rgba(56, 239, 125, 0.1));
            border: 1px solid rgba(46, 204, 113, 0.3);
            border-radius: 12px;
            padding: 14px;
            margin: 16px 0;
            position: relative;
            overflow: hidden;
        }

        .fun-fact:before {
            content: "üí°";
            position: absolute;
            top: -20px;
            right: -20px;
            font-size: 60px;
            opacity: 0.1;
        }

        .fun-fact-title {
            color: #2ecc71;
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 6px;
        }

        .fun-fact-text {
            color: rgba(255, 255, 255, 0.9);
            font-size: 12px;
            line-height: 1.5;
            position: relative;
            z-index: 1;
        }

        /* Comparison Box */
        .comparison-box {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 14px;
            margin: 16px 0;
        }

        .comparison-title {
            color: #38ef7d;
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .comparison-item {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 8px;
            padding: 10px;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .comparison-item-title {
            color: #11998e;
            font-size: 11px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .comparison-item-text {
            color: rgba(255, 255, 255, 0.8);
            font-size: 10px;
            line-height: 1.4;
        }

        /* Voice Controls */
        .voice-controls {
            position: absolute;
            top: 10px;
            right: 20px;
            display: flex;
            gap: 8px;
            z-index: 1000;
        }

        .control-btn {
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            position: relative;
        }

        .control-btn:hover {
            background: rgba(56, 239, 125, 0.3);
            border-color: #38ef7d;
            transform: scale(1.1);
        }

        .control-btn.active {
            background: rgba(56, 239, 125, 0.4);
            border-color: #38ef7d;
            box-shadow: 0 0 20px rgba(56, 239, 125, 0.5);
        }

        .control-tooltip {
            position: absolute;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.9);
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 10px;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .control-btn:hover .control-tooltip {
            opacity: 1;
        }

        /* Loading Screen */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            transition: opacity 1s ease;
        }

        .loading-content {
            text-align: center;
        }

        .loading-regen {
            font-size: 60px;
            animation: regenLoad 2s ease-in-out infinite;
            margin-bottom: 20px;
        }

        @keyframes regenLoad {
            0% { transform: rotate(0deg) scale(1); }
            50% { transform: rotate(180deg) scale(1.2); }
            100% { transform: rotate(360deg) scale(1); }
        }

        .loading-text {
            color: white;
            font-size: 20px;
            margin-bottom: 20px;
        }

        .loading-progress {
            width: 200px;
            height: 4px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 2px;
            overflow: hidden;
        }

        .loading-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #11998e, #38ef7d);
            animation: loading 2s ease-in-out infinite;
        }

        @keyframes loading {
            0% { width: 0%; }
            50% { width: 100%; }
            100% { width: 0%; }
        }

        /* Voice Indicator */
        .voice-indicator {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(56, 239, 125, 0.5);
            border-radius: 30px;
            padding: 14px 28px;
            display: flex;
            align-items: center;
            gap: 12px;
            z-index: 1000;
            opacity: 0;
            transition: all 0.3s ease;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }

        .voice-indicator.visible {
            opacity: 1;
            transform: translateX(-50%) translateY(-10px);
        }

        .voice-waves {
            display: flex;
            align-items: center;
            gap: 3px;
        }

        .voice-wave {
            width: 3px;
            height: 20px;
            background: linear-gradient(180deg, #11998e, #38ef7d);
            border-radius: 2px;
            animation: voice-wave 1s ease-in-out infinite;
        }

        .voice-wave:nth-child(2) { animation-delay: 0.1s; }
        .voice-wave:nth-child(3) { animation-delay: 0.2s; }
        .voice-wave:nth-child(4) { animation-delay: 0.3s; }
        .voice-wave:nth-child(5) { animation-delay: 0.4s; }

        @keyframes voice-wave {
            0%, 100% { transform: scaleY(0.3); }
            50% { transform: scaleY(1); }
        }

        .narration-text {
            color: white;
            font-size: 13px;
            max-width: 300px;
        }

        /* Quick Actions */
        .quick-actions {
            position: absolute;
            bottom: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
            z-index: 1000;
        }

        .action-btn {
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 10px 16px;
            border-radius: 25px;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
        }

        .action-btn:hover {
            background: rgba(56, 239, 125, 0.3);
            border-color: #38ef7d;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(56, 239, 125, 0.3);
        }

        /* Custom Scrollbar */
        .info-panel::-webkit-scrollbar {
            width: 6px;
        }

        .info-panel::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 3px;
        }

        .info-panel::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, #11998e, #38ef7d);
            border-radius: 3px;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .info-panel {
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                top: auto;
                width: 100%;
                max-height: 50vh;
                border-radius: 20px 20px 0 0;
            }
            
            .journey-navigation {
                bottom: 52vh;
                max-width: calc(100% - 40px);
            }
            
            .voice-controls {
                top: auto;
                bottom: 55vh;
                right: 10px;
            }
            
            .quick-actions {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="bg-animation"></div>

    <!-- Loading Screen -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="loading-regen">üîÑ</div>
            <div class="loading-text">Preparing Regeneration Experience...</div>
            <div class="loading-progress">
                <div class="loading-progress-bar"></div>
            </div>
        </div>
    </div>

    <!-- Museum Header -->
    <div class="museum-header">
        <div class="museum-title">Fragmentation & Regeneration</div>
        <div class="exhibit-subtitle">
            <span class="regen-indicator"></span>
            Nature's Amazing Recovery Powers
        </div>
    </div>

    <!-- Journey Navigation -->
    <div class="journey-navigation">
        <div class="journey-title">
            <span>üîÑ</span>
            <span>Journey Through Recovery</span>
        </div>
        <div class="journey-steps">
            <button class="journey-btn active" onclick="loadJourneyStep('introduction')">
                <span>üìö</span> Introduction
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('spirogyra')">
                <span>üåø</span> Spirogyra
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('fragmentation')">
                <span>‚úÇÔ∏è</span> Fragmentation
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('hydra')">
                <span>üêô</span> Hydra
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('planaria')">
                <span>ü™±</span> Planaria
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('regeneration')">
                <span>‚ú®</span> Regeneration
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('comparison')">
                <span>‚öñÔ∏è</span> Compare
            </button>
        </div>
    </div>

    <!-- 3D Model Container -->
    <div class="model-container">
        <div class="sketchfab-embed-wrapper">
            <iframe id="api-frame"
                    title="Organism Model" 
                    frameborder="0" 
                    allowfullscreen 
                    mozallowfullscreen="true" 
                    webkitallowfullscreen="true" 
                    allow="autoplay; fullscreen; xr-spatial-tracking"
                    xr-spatial-tracking 
                    execution-while-out-of-viewport 
                    execution-while-not-rendered 
                    web-share 
                    src="https://sketchfab.com/models/1f1fb223f4044b03aa9938ca886548b4/embed?autostart=1&internal=1&tracking=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0">
            </iframe>
        </div>
    </div>

    <!-- Information Panel -->
    <div class="info-panel" id="infoPanel">
        <div class="info-header">
            <div class="info-icon" id="stepIcon">üìö</div>
            <div class="info-title">
                <h2 id="stepTitle">Introduction to Fragmentation & Regeneration</h2>
                <div class="info-subtitle" id="stepSubtitle">Breaking apart to multiply</div>
            </div>
        </div>

        <!-- Progress Tracker -->
        <div class="progress-tracker">
            <div class="progress-header">
                <span>Journey Progress</span>
                <span class="progress-percentage" id="progressPercent">0%</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 0%"></div>
            </div>
            <div class="progress-steps-mini">
                <span class="step-mini active" onclick="loadJourneyStep('introduction')">Intro</span>
                <span class="step-mini" onclick="loadJourneyStep('spirogyra')">Spirogyra</span>
                <span class="step-mini" onclick="loadJourneyStep('fragmentation')">Fragment</span>
                <span class="step-mini" onclick="loadJourneyStep('hydra')">Hydra</span>
                <span class="step-mini" onclick="loadJourneyStep('planaria')">Planaria</span>
                <span class="step-mini" onclick="loadJourneyStep('regeneration')">Regen</span>
                <span class="step-mini" onclick="loadJourneyStep('comparison')">Compare</span>
            </div>
        </div>

        <div class="info-content" id="mainDescription">
            Fragmentation and regeneration represent nature's most remarkable abilities - the power to create new life from pieces and to regrow lost parts. These processes showcase life's incredible resilience, allowing organisms to survive damage that would be fatal to most creatures and even multiply through breaking apart.
        </div>

        <div class="info-card">
            <div class="info-card-title">
                <span>üî¨</span> Key Concepts
            </div>
            <div class="info-card-content">
                <ul class="info-list" id="keyConcepts">
                    <li>Fragmentation: breaking into pieces that grow into new individuals</li>
                    <li>Regeneration: regrowing lost or damaged body parts</li>
                    <li>Some organisms use both for reproduction</li>
                    <li>Requires specialized cells and growth factors</li>
                </ul>
            </div>
        </div>

        <div class="fun-fact">
            <div class="fun-fact-title">Amazing Fact!</div>
            <div class="fun-fact-text" id="funFact">
                A single planarian flatworm can be cut into as many as 279 pieces, and each piece can regenerate into a complete worm! That's like creating an army from a single soldier!
            </div>
        </div>

        <div class="info-card">
            <div class="info-card-title">
                <span>üéØ</span> Learning Objectives
            </div>
            <div class="info-card-content" id="learningObjectives">
                By exploring this section, you'll understand how organisms use fragmentation for reproduction and regeneration for repair, and learn the crucial differences between these two remarkable processes.
            </div>
        </div>

        <div class="comparison-box" id="comparisonBox" style="display:none;">
            <div class="comparison-title">
                <span>‚öñÔ∏è</span> Fragmentation vs Regeneration
            </div>
            <div class="comparison-grid">
                <div class="comparison-item">
                    <div class="comparison-item-title">Fragmentation</div>
                    <div class="comparison-item-text">Body breaks into pieces, each becomes new organism. Purpose: Reproduction</div>
                </div>
                <div class="comparison-item">
                    <div class="comparison-item-title">Regeneration</div>
                    <div class="comparison-item-text">Regrows lost parts, repairs damage. Purpose: Healing & survival</div>
                </div>
                <div class="comparison-item">
                    <div class="comparison-item-title">Examples</div>
                    <div class="comparison-item-text">Spirogyra, some starfish, some worms</div>
                </div>
                <div class="comparison-item">
                    <div class="comparison-item-title">Examples</div>
                    <div class="comparison-item-text">Hydra, Planaria, lizard tails, human liver</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Voice Controls -->
    <div class="voice-controls">
        <button class="control-btn active" id="voiceToggle" onclick="toggleVoice()">
            üîä
            <span class="control-tooltip">Voice Narration</span>
        </button>
        <button class="control-btn" onclick="toggleAutoPlay()">
            ‚ñ∂Ô∏è
            <span class="control-tooltip">Auto Journey</span>
        </button>
        <button class="control-btn" onclick="toggleInfo()">
            ‚ÑπÔ∏è
            <span class="control-tooltip">Toggle Info</span>
        </button>
    </div>

    <!-- Quick Actions -->
    <div class="quick-actions">
        <button class="action-btn" onclick="startGuidedTour()">
            <span>üöÄ</span> Guided Tour
        </button>
        <button class="action-btn" onclick="showQuiz()">
            <span>üéØ</span> Test Knowledge
        </button>
    </div>

    <!-- Voice Indicator -->
    <div class="voice-indicator" id="voiceIndicator">
        <div class="voice-waves">
            <div class="voice-wave"></div>
            <div class="voice-wave"></div>
            <div class="voice-wave"></div>
            <div class="voice-wave"></div>
            <div class="voice-wave"></div>
        </div>
        <div class="narration-text" id="narrationText">Narrating...</div>
    </div>

    <script>
        // Journey Step Data with Complete Pedagogical Content
        const JOURNEY_DATA = {
            introduction: {
                title: "Introduction to Fragmentation & Regeneration",
                subtitle: "Breaking apart to multiply",
                icon: "üìö",
                modelUrl: "https://sketchfab.com/models/1f1fb223f4044b03aa9938ca886548b4/embed?autostart=1&internal=1&tracking=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "Fragmentation and regeneration represent nature's most remarkable abilities - the power to create new life from pieces and to regrow lost parts. These processes showcase life's incredible resilience, allowing organisms to survive damage that would be fatal to most creatures and even multiply through breaking apart.",
                concepts: [
                    "Fragmentation: breaking into pieces that grow into new individuals",
                    "Regeneration: regrowing lost or damaged body parts",
                    "Some organisms use both for reproduction",
                    "Requires specialized cells and growth factors"
                ],
                funFact: "A single planarian flatworm can be cut into as many as 279 pieces, and each piece can regenerate into a complete worm! That's like creating an army from a single soldier!",
                objectives: "By exploring this section, you'll understand how organisms use fragmentation for reproduction and regeneration for repair, and learn the crucial differences between these two remarkable processes.",
                narration: "Welcome to the incredible world of fragmentation and regeneration! Imagine if you could grow a whole new you from just a piece of your finger, or if breaking apart actually helped you multiply. That's exactly what some organisms can do! These two processes - fragmentation and regeneration - showcase nature's most amazing recovery powers. Fragmentation is when an organism breaks into pieces, and each piece grows into a complete new individual - it's a form of reproduction. Regeneration is the ability to regrow lost or damaged body parts - it's about repair and survival. Some organisms like the ones we'll explore today can do both! Let's discover how these remarkable abilities work and why they're so important for survival."
            },
            spirogyra: {
                title: "Spirogyra - The Spiral Algae",
                subtitle: "Fragmentation champion of ponds",
                icon: "üåø",
                modelUrl: "https://sketchfab.com/models/1f1fb223f4044b03aa9938ca886548b4/embed?autostart=1&internal=1&tracking=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "Spirogyra is a filamentous green algae found in freshwater. Its name comes from the beautiful spiral chloroplasts that wind through each cell like green ribbons. This simple organism demonstrates fragmentation perfectly - when its filaments break, each fragment can grow into a new complete algae.",
                concepts: [
                    "Filamentous structure - cells joined end to end",
                    "Spiral chloroplasts for photosynthesis",
                    "Found in freshwater ponds and streams",
                    "Reproduces by fragmentation and conjugation"
                ],
                funFact: "Spirogyra is sometimes called 'pond silk' or 'water silk' because it forms silky green masses in water that feel slippery to touch - that's millions of tiny filaments together!",
                objectives: "Learn how Spirogyra's simple filamentous structure makes it perfectly suited for reproduction through fragmentation.",
                narration: "Meet Spirogyra - the elegant spiral algae! Look at this beautiful green filament - it's like a chain of rectangular cells joined end to end. See those spiral structures inside each cell? Those are chloroplasts, wound like green springs, giving Spirogyra its name which means 'spiral turn'. This algae is incredibly common in ponds and slow-moving water, where it forms those familiar green, silky masses. Each cell in the filament is nearly identical and self-sufficient, capable of photosynthesis and all life functions. This uniformity is key to its fragmentation ability. When water currents, animals, or environmental stress cause the filament to break, it doesn't die - instead, each broken piece continues to live and grow as a new individual. It's like a train where every car can become its own complete train!"
            },
            fragmentation: {
                title: "Fragmentation Process in Spirogyra",
                subtitle: "Breaking up is easy to do",
                icon: "‚úÇÔ∏è",
                modelUrl: "https://sketchfab.com/models/1f1fb223f4044b03aa9938ca886548b4/embed?autostart=1&internal=1&tracking=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "Fragmentation in Spirogyra occurs when the filament breaks at any point along its length. This can happen due to water turbulence, grazing by aquatic animals, or even cell death. Each fragment, whether it's 2 cells or 200 cells long, can grow into a new filament by cell division at both ends.",
                concepts: [
                    "Breaks can occur between any two cells",
                    "No specialized breaking points needed",
                    "Each fragment must have at least one living cell",
                    "Growth occurs through cell division at fragment ends"
                ],
                funFact: "During favorable conditions, a single Spirogyra fragment can grow into a filament hundreds of cells long in just a few days, potentially covering an entire pond surface!",
                objectives: "Understand how fragmentation works as a reproductive strategy and why it's so effective for organisms like Spirogyra.",
                narration: "Now let's see fragmentation in action! When a Spirogyra filament breaks - imagine snapping a chain - each piece becomes independent. The break might happen when a fish swims through, when water flow increases, or simply when cells age and weaken. Here's the amazing part: there's no special breaking point required. The filament can break between any two cells, and both fragments survive! Once separated, each fragment seals the broken ends and begins growing. The cells at each end start dividing, adding new cells to extend the filament in both directions. A fragment with just 3 or 4 cells can grow into a filament of hundreds of cells within days! This is reproduction at its simplest - no special reproductive structures, no complex processes, just break and grow. It's so efficient that in good conditions, fragmentation can help Spirogyra colonize an entire water body rapidly!"
            },
            hydra: {
                title: "Hydra - The Immortal Polyp",
                subtitle: "Master of regeneration",
                icon: "üêô",
                modelUrl: "https://sketchfab.com/models/52e8a00e381746f8bda2653fccc43c90/embed?autostart=1&internal=1&tracking=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "Hydra is a tiny freshwater polyp with remarkable regenerative abilities. This simple animal can regenerate from small pieces, regrow lost tentacles in days, and even reassemble itself from dissociated cells. It's also famous for budding - a form of asexual reproduction where new individuals grow from the parent's body.",
                concepts: [
                    "Tubular body with tentacles for catching prey",
                    "Two cell layers with specialized cells",
                    "Can regenerate from 1/200th of its body",
                    "Reproduces by budding and regeneration"
                ],
                funFact: "Scientists believe Hydra might be biologically immortal - they show no signs of aging and can potentially live forever if not eaten or destroyed! Their cells constantly renew themselves.",
                objectives: "Discover how Hydra's incredible regenerative abilities allow it to survive extreme damage and reproduce through budding.",
                narration: "Behold the Hydra - one of nature's most remarkable regenerators! This tiny freshwater animal, usually just a few millimeters long, has abilities that seem like science fiction. Look at its simple structure - a tubular body topped with tentacles that wave in the water to catch tiny prey. But this simplicity hides extraordinary powers. Hydra can regenerate from fragments as small as 1/200th of its original body! Cut off its tentacles? They regrow in 2-3 days. Cut it in half? Both halves become complete animals. Even more amazingly, if you separate a Hydra into individual cells and put them together, they can reassemble into a new Hydra! See that bump on its body? That's a bud - a baby Hydra growing from the parent. When ready, it detaches and starts independent life. This combination of budding for reproduction and regeneration for survival makes Hydra nearly indestructible. Scientists think these abilities, powered by stem cells throughout its body, might make Hydra biologically immortal!"
            },
            planaria: {
                title: "Planaria - The Flatworm Wonder",
                subtitle: "Regeneration superstar",
                icon: "ü™±",
                modelUrl: "https://sketchfab.com/models/8e5a7c4e312e4b08b20676608cb2399f/embed?autostart=1&internal=1&tracking=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "Planaria are flatworms with perhaps the most impressive regenerative abilities in the animal kingdom. They can regenerate complete organisms from tiny fragments, including complex structures like their brain, eyes, and digestive system. This ability comes from special stem cells called neoblasts.",
                concepts: [
                    "Flat, bilateral body with distinct head",
                    "Two eye spots for detecting light",
                    "Neoblasts: pluripotent stem cells throughout body",
                    "Can regenerate from pieces as small as 1/279th"
                ],
                funFact: "If you cut a planarian's head in half vertically, it will regenerate into a two-headed worm! Scientists use planaria to study how organisms 'know' what body parts to regenerate where.",
                objectives: "Learn how planaria's neoblast stem cells enable the most extreme regeneration abilities in the animal kingdom.",
                narration: "Meet Planaria - the undisputed champion of regeneration! This small flatworm, typically 3-15 millimeters long, possesses regenerative powers that border on miraculous. Notice its arrow-shaped head with two eye spots that look like crossed eyes? That head contains a simple brain, yet if you cut it off, the planarian grows a new head complete with brain and eyes in about a week! The secret lies in special cells called neoblasts - adult stem cells that make up about 20% of the planarian's body. These cells can become any type of cell needed. Cut a planarian into pieces, and each piece with neoblasts can regenerate missing parts. The piece 'knows' what's missing - a tail piece grows a head, a head piece grows a tail, and a middle piece grows both! Scientists have cut planaria into as many as 279 pieces, and each piece regenerated into a complete worm! Even more amazing, planaria seem to remember things even after their brain is regenerated. They're living proof that nature's regenerative abilities far exceed our imagination!"
            },
            regeneration: {
                title: "The Science of Regeneration",
                subtitle: "How bodies rebuild themselves",
                icon: "‚ú®",
                modelUrl: "https://sketchfab.com/models/8e5a7c4e312e4b08b20676608cb2399f/embed?autostart=1&internal=1&tracking=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "Regeneration involves complex biological processes including stem cell activation, pattern formation, and tissue reorganization. Different organisms use different strategies - from simple cell division to complex morphogenesis involving multiple signaling pathways.",
                concepts: [
                    "Stem cells provide raw material for new tissues",
                    "Chemical signals guide what structures to build",
                    "Positional information tells cells where they are",
                    "Some regeneration involves dedifferentiation"
                ],
                funFact: "Humans can regenerate too! Our liver can regrow to full size even if 75% is removed, and young children can sometimes regenerate fingertips if injured before age 2!",
                objectives: "Understand the biological mechanisms behind regeneration and why some organisms can regenerate while others cannot.",
                narration: "Let's dive into the fascinating science of regeneration! When an organism loses a body part, an incredible cascade of events begins. First, the wound is quickly sealed to prevent infection and fluid loss. Then, depending on the organism, one of two things happens. In organisms like planaria, stem cells called neoblasts migrate to the wound site. These are like biological building blocks that can become any type of cell needed. They receive chemical signals that tell them what to become - muscle, nerve, digestive cells, whatever is missing! In other organisms like some salamanders, something even more amazing happens - dedifferentiation. Mature, specialized cells at the wound site actually reverse their development, becoming stem-like cells again! They form a mass called a blastema, which is like a construction site where the new body part is built. The cells somehow 'know' their position in the body through chemical gradients and rebuild exactly what's missing - not more, not less. This positional information is so precise that a planarian tail fragment knows to build a head at the front end and not another tail!"
            },
            comparison: {
                title: "Fragmentation vs Regeneration",
                subtitle: "Two powers, different purposes",
                icon: "‚öñÔ∏è",
                modelUrl: "https://sketchfab.com/models/52e8a00e381746f8bda2653fccc43c90/embed?autostart=1&internal=1&tracking=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "While fragmentation and regeneration both involve growing from pieces, they serve different purposes. Fragmentation is primarily a reproductive strategy - creating new individuals. Regeneration is primarily a survival mechanism - repairing damage. Some organisms like Hydra and Planaria can do both!",
                concepts: [
                    "Fragmentation = reproduction (making more individuals)",
                    "Regeneration = repair (fixing damage)",
                    "Not all organisms that fragment can regenerate",
                    "Not all regeneration leads to new individuals"
                ],
                funFact: "Starfish were once considered pests by oyster farmers who would chop them up and throw pieces back in the ocean - not realizing each piece could regenerate into a new starfish, making the problem worse!",
                objectives: "Clearly distinguish between fragmentation as a reproductive strategy and regeneration as a repair mechanism, understanding when each is advantageous.",
                narration: "Let's clarify the fascinating difference between fragmentation and regeneration! Think of fragmentation as nature's copy-paste function. When Spirogyra breaks into five pieces, it's not trying to repair damage - it's making five new algae! Each fragment grows independently, increasing the population. This is reproduction, pure and simple. Regeneration, on the other hand, is nature's repair shop. When a lizard loses its tail or a starfish loses an arm, regeneration replaces what was lost. The lizard doesn't become two lizards - it just gets its tail back. Now here's where it gets interesting - some organisms like Hydra and Planaria can do both! If a Planaria is cut accidentally, it uses regeneration to repair itself, with each piece becoming a new individual - that's reproduction through regeneration. But if a Planaria is intact, it doesn't fragment on its own for reproduction. Understanding this difference is crucial: fragmentation is about multiplication, regeneration is about restoration. Some organisms use one, some use both, and sadly, complex organisms like humans have very limited regeneration. Evolution has traded our regenerative abilities for complexity!"
            }
        };

        // Global Variables
        let currentStep = 'introduction';
        let voiceEnabled = true;
        let autoPlayEnabled = false;
        let currentSpeech = null;
        let selectedVoice = null;
        let journeyProgress = 0;
        let guidedTourActive = false;

        // Initialize Voice System
        function initVoiceSystem() {
            if (!('speechSynthesis' in window)) {
                console.warn('Speech synthesis not supported');
                voiceEnabled = false;
                document.getElementById('voiceToggle').style.display = 'none';
                return;
            }

            function loadVoices() {
                const voices = speechSynthesis.getVoices();
                if (voices.length === 0) return;

                // Prefer natural-sounding voices
                const preferredVoices = [
                    'Google UK English Female',
                    'Microsoft Sonia',
                    'Microsoft Hazel',
                    'Samantha',
                    'Victoria'
                ];

                for (const name of preferredVoices) {
                    selectedVoice = voices.find(v => v.name.includes(name));
                    if (selectedVoice) break;
                }

                if (!selectedVoice) {
                    selectedVoice = voices.find(v => v.lang.startsWith('en'));
                }
            }

            loadVoices();
            if (speechSynthesis.onvoiceschanged !== undefined) {
                speechSynthesis.onvoiceschanged = loadVoices;
            }
        }

        // Load Journey Step
        function loadJourneyStep(stepId) {
            const stepData = JOURNEY_DATA[stepId];
            if (!stepData) return;

            currentStep = stepId;
            
            // Update model
            document.getElementById('api-frame').src = stepData.modelUrl;
            
            // Update info panel
            document.getElementById('stepIcon').textContent = stepData.icon;
            document.getElementById('stepTitle').textContent = stepData.title;
            document.getElementById('stepSubtitle').textContent = stepData.subtitle;
            document.getElementById('mainDescription').textContent = stepData.description;
            
            // Update key concepts
            const conceptsList = document.getElementById('keyConcepts');
            conceptsList.innerHTML = stepData.concepts.map(c => `<li>${c}</li>`).join('');
            
            // Update fun fact
            document.getElementById('funFact').textContent = stepData.funFact;
            
            // Update learning objectives
            document.getElementById('learningObjectives').textContent = stepData.objectives;
            
            // Show/hide comparison box
            const compBox = document.getElementById('comparisonBox');
            if (stepId === 'comparison') {
                compBox.style.display = 'block';
            } else {
                compBox.style.display = 'none';
            }
            
            // Update navigation buttons
            updateNavigationButtons(stepId);
            
            // Update progress
            updateProgress();
            
            // Play narration if enabled
            if (voiceEnabled) {
                speakText(stepData.narration);
            }
        }

        // Update Navigation Buttons
        function updateNavigationButtons(activeStep) {
            const buttons = document.querySelectorAll('.journey-btn');
            const steps = ['introduction', 'spirogyra', 'fragmentation', 'hydra', 'planaria', 'regeneration', 'comparison'];
            const activeIndex = steps.indexOf(activeStep);
            
            buttons.forEach((btn, index) => {
                btn.classList.remove('active', 'completed');
                if (index < activeIndex) {
                    btn.classList.add('completed');
                } else if (index === activeIndex) {
                    btn.classList.add('active');
                }
            });
            
            // Update mini steps
            const miniSteps = document.querySelectorAll('.step-mini');
            miniSteps.forEach((step, index) => {
                step.classList.remove('active', 'completed');
                if (index < activeIndex) {
                    step.classList.add('completed');
                } else if (index === activeIndex) {
                    step.classList.add('active');
                }
            });
        }

        // Update Progress
        function updateProgress() {
            const steps = ['introduction', 'spirogyra', 'fragmentation', 'hydra', 'planaria', 'regeneration', 'comparison'];
            const currentIndex = steps.indexOf(currentStep);
            const progress = ((currentIndex + 1) / steps.length) * 100;
            
            document.getElementById('progressPercent').textContent = Math.round(progress) + '%';
            document.getElementById('progressFill').style.width = progress + '%';
        }

        // Speech Functions
        function speakText(text) {
            if (!voiceEnabled || !text) return;
            
            stopSpeech();
            
            currentSpeech = new SpeechSynthesisUtterance(text);
            if (selectedVoice) {
                currentSpeech.voice = selectedVoice;
            }
            currentSpeech.rate = 0.9;
            currentSpeech.pitch = 1.0;
            currentSpeech.volume = 0.9;
            
            currentSpeech.onstart = () => {
                document.getElementById('voiceIndicator').classList.add('visible');
                document.getElementById('narrationText').textContent = 
                    text.substring(0, 50) + (text.length > 50 ? '...' : '');
            };
            
            currentSpeech.onend = () => {
                document.getElementById('voiceIndicator').classList.remove('visible');
                currentSpeech = null;
                
                // Auto-advance if guided tour is active
                if (guidedTourActive) {
                    setTimeout(nextStep, 2000);
                }
            };
            
            speechSynthesis.speak(currentSpeech);
        }

        function stopSpeech() {
            if (currentSpeech) {
                speechSynthesis.cancel();
                currentSpeech = null;
                document.getElementById('voiceIndicator').classList.remove('visible');
            }
        }

        // Control Functions
        function toggleVoice() {
            voiceEnabled = !voiceEnabled;
            const btn = document.getElementById('voiceToggle');
            btn.textContent = voiceEnabled ? 'üîä' : 'üîá';
            btn.classList.toggle('active', voiceEnabled);
            
            if (!voiceEnabled) {
                stopSpeech();
            }
        }

        function toggleAutoPlay() {
            autoPlayEnabled = !autoPlayEnabled;
            if (autoPlayEnabled) {
                startGuidedTour();
            } else {
                guidedTourActive = false;
            }
        }

        function toggleInfo() {
            const panel = document.getElementById('infoPanel');
            panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
        }

        // Guided Tour
        function startGuidedTour() {
            guidedTourActive = true;
            const steps = ['introduction', 'spirogyra', 'fragmentation', 'hydra', 'planaria', 'regeneration', 'comparison'];
            let stepIndex = 0;
            
            function tourStep() {
                if (stepIndex < steps.length && guidedTourActive) {
                    loadJourneyStep(steps[stepIndex]);
                    stepIndex++;
                } else {
                    guidedTourActive = false;
                    if (voiceEnabled) {
                        speakText("Congratulations! You've completed your journey through fragmentation and regeneration. You now understand these amazing survival strategies that allow life to persist and multiply in remarkable ways!");
                    }
                }
            }
            
            tourStep();
            window.nextStep = tourStep;
        }

        // Quiz Function
        function showQuiz() {
            const questions = [
                "What's the main difference between fragmentation and regeneration?",
                "How does Spirogyra use fragmentation to reproduce?",
                "Why is Hydra considered potentially immortal?",
                "What are neoblasts and why are they important for planaria?",
                "Can humans regenerate any body parts?"
            ];
            
            const randomQ = questions[Math.floor(Math.random() * questions.length)];
            
            if (voiceEnabled) {
                speakText(`Here's a question to test your knowledge: ${randomQ} Think about what you've learned in this journey!`);
            }
        }

        // Initialize
        function init() {
            initVoiceSystem();
            
            // Hide loading screen
            setTimeout(() => {
                const loading = document.getElementById('loadingOverlay');
                loading.style.opacity = '0';
                setTimeout(() => {
                    loading.style.display = 'none';
                    
                    // Welcome message
                    if (voiceEnabled) {
                        speakText("Welcome to the amazing world of fragmentation and regeneration! We'll explore how organisms can multiply by breaking apart and regrow lost body parts. Prepare to be amazed by nature's incredible recovery powers!");
                    }
                }, 1000);
            }, 3000);
            
            // Keyboard shortcuts
            document.addEventListener('keydown', (e) => {
                switch(e.key) {
                    case 'v': toggleVoice(); break;
                    case 'i': toggleInfo(); break;
                    case 'g': startGuidedTour(); break;
                    case 'Escape': stopSpeech(); guidedTourActive = false; break;
                    case 'ArrowRight': nextStep && nextStep(); break;
                }
            });
        }

        // Start the application
        init();
    </script>
</body>
</html>