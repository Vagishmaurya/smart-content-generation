<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fertilization, Pregnancy & Birth - The Journey of Human Development</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tween.js/18.6.4/tween.umd.js"></script>

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            color: white;
            overflow: hidden;
            position: relative;
            height: 100vh;
        }

        /* Animated Background */
        .bg-animation {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 0;
            opacity: 0.1;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320"><path fill="%23ffffff" fill-opacity="0.2" d="M0,96L48,112C96,128,192,160,288,186.7C384,213,480,235,576,213.3C672,192,768,128,864,128C960,128,1056,192,1152,197.3C1248,203,1344,149,1392,122.7L1440,96L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path></svg>') repeat-x;
            animation: wave 18s linear infinite;
        }

        @keyframes wave {
            0% { background-position-x: 0; }
            100% { background-position-x: 1440px; }
        }

        /* Museum Interface - Compact Header */
        .museum-header {
            position: absolute;
            top: 10px;
            left: 20px;
            text-align: left;
            z-index: 1000;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            padding: 10px 18px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        .museum-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 4px;
            background: linear-gradient(45deg, #ff6b6b, #feca57);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: titleGlow 3s ease-in-out infinite;
        }

        @keyframes titleGlow {
            0%, 100% { filter: brightness(1); }
            50% { filter: brightness(1.2); }
        }

        .exhibit-subtitle {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.8);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .life-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: #feca57;
            border-radius: 50%;
            animation: life-pulse 2s ease-in-out infinite;
        }

        @keyframes life-pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.3); opacity: 0.7; }
        }

        /* Journey Navigation - Enhanced */
        .journey-navigation {
            position: absolute;
            bottom: 20px;
            left: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 1000;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            padding: 15px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            max-width: 320px;
        }

        .journey-title {
            font-size: 14px;
            font-weight: 600;
            color: #ff6b6b;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .journey-steps {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
        }

        .journey-btn {
            background: rgba(255, 107, 107, 0.2);
            border: 1px solid rgba(255, 107, 107, 0.4);
            color: white;
            padding: 6px 10px;
            border-radius: 20px;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 4px;
            white-space: nowrap;
        }

        .journey-btn:hover {
            background: rgba(255, 107, 107, 0.3);
            border-color: #ff6b6b;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 107, 107, 0.3);
        }

        .journey-btn.active {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            border-color: #ff6b6b;
            box-shadow: 0 0 20px rgba(255, 107, 107, 0.5);
            animation: pulse 2s infinite;
        }

        .journey-btn.completed {
            background: rgba(254, 202, 87, 0.3);
            border-color: #feca57;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* 3D Model Container */
        .model-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 0;
            overflow: hidden;
            border: none;
            z-index: 100;
        }

        .sketchfab-embed-wrapper {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
        }

        .sketchfab-embed-wrapper iframe {
            width: 100%;
            height: 100%;
            border: none;
            border-radius: 0;
        }

        /* Information Panel - Enhanced */
        .info-panel {
            position: absolute;
            top: 70px;
            right: 20px;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 16px;
            padding: 24px;
            width: 380px;
            max-height: calc(100vh - 140px);
            z-index: 800;
            overflow-y: auto;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }

        .info-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
        }

        .info-icon {
            font-size: 28px;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        .info-title {
            flex: 1;
        }

        .info-title h2 {
            font-size: 18px;
            color: #ff6b6b;
            margin-bottom: 4px;
        }

        .info-subtitle {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
        }

        .info-content {
            color: rgba(255, 255, 255, 0.9);
            font-size: 14px;
            line-height: 1.6;
        }

        /* Progress Tracker */
        .progress-tracker {
            background: linear-gradient(135deg, rgba(255, 107, 107, 0.1), rgba(254, 202, 87, 0.1));
            border: 1px solid rgba(255, 107, 107, 0.3);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 20px;
        }

        .progress-header {
            font-size: 13px;
            font-weight: 600;
            color: #ff6b6b;
            margin-bottom: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .progress-percentage {
            font-size: 18px;
            color: #feca57;
            font-weight: 700;
        }

        .progress-bar {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 12px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff6b6b, #feca57);
            border-radius: 4px;
            transition: width 0.8s ease;
            box-shadow: 0 0 10px rgba(255, 107, 107, 0.5);
        }

        .progress-steps-mini {
            display: flex;
            justify-content: space-between;
            font-size: 9px;
            color: rgba(255, 255, 255, 0.6);
        }

        .step-mini {
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .step-mini.active {
            color: #ff6b6b;
            font-weight: 600;
        }

        .step-mini.completed {
            color: #feca57;
        }

        /* Information Cards */
        .info-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 14px;
            margin-bottom: 14px;
        }

        .info-card-title {
            color: #ff6b6b;
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .info-card-content {
            color: rgba(255, 255, 255, 0.85);
            font-size: 12px;
            line-height: 1.5;
        }

        .info-list {
            list-style: none;
            padding: 0;
        }

        .info-list li {
            padding: 6px 0;
            padding-left: 20px;
            position: relative;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.8);
        }

        .info-list li:before {
            content: "‚Üí";
            position: absolute;
            left: 0;
            color: #ff6b6b;
        }

        /* Fun Fact Box */
        .fun-fact {
            background: linear-gradient(135deg, rgba(254, 202, 87, 0.1), rgba(255, 107, 107, 0.1));
            border: 1px solid rgba(254, 202, 87, 0.3);
            border-radius: 12px;
            padding: 14px;
            margin: 16px 0;
            position: relative;
            overflow: hidden;
        }

        .fun-fact:before {
            content: "üåü";
            position: absolute;
            top: -20px;
            right: -20px;
            font-size: 60px;
            opacity: 0.1;
        }

        .fun-fact-title {
            color: #feca57;
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 6px;
        }

        .fun-fact-text {
            color: rgba(255, 255, 255, 0.9);
            font-size: 12px;
            line-height: 1.5;
            position: relative;
            z-index: 1;
        }

        /* Voice Controls */
        .voice-controls {
            position: absolute;
            top: 10px;
            right: 20px;
            display: flex;
            gap: 8px;
            z-index: 1000;
        }

        .control-btn {
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            position: relative;
        }

        .control-btn:hover {
            background: rgba(255, 107, 107, 0.3);
            border-color: #ff6b6b;
            transform: scale(1.1);
        }

        .control-btn.active {
            background: rgba(255, 107, 107, 0.4);
            border-color: #ff6b6b;
            box-shadow: 0 0 20px rgba(255, 107, 107, 0.5);
        }

        .control-tooltip {
            position: absolute;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.9);
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 10px;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .control-btn:hover .control-tooltip {
            opacity: 1;
        }

        /* Loading Screen */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            transition: opacity 1s ease;
        }

        .loading-content {
            text-align: center;
        }

        .loading-life {
            font-size: 60px;
            animation: life-grow 3s ease-in-out infinite;
            margin-bottom: 20px;
        }

        @keyframes life-grow {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }

        .loading-text {
            color: white;
            font-size: 20px;
            margin-bottom: 20px;
        }

        .loading-progress {
            width: 200px;
            height: 4px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 2px;
            overflow: hidden;
        }

        .loading-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #ff6b6b, #feca57);
            animation: loading 2s ease-in-out infinite;
        }

        @keyframes loading {
            0% { width: 0%; }
            50% { width: 100%; }
            100% { width: 0%; }
        }

        /* Voice Indicator */
        .voice-indicator {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 107, 107, 0.5);
            border-radius: 30px;
            padding: 14px 28px;
            display: flex;
            align-items: center;
            gap: 12px;
            z-index: 1000;
            opacity: 0;
            transition: all 0.3s ease;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }

        .voice-indicator.visible {
            opacity: 1;
            transform: translateX(-50%) translateY(-10px);
        }

        .voice-waves {
            display: flex;
            align-items: center;
            gap: 3px;
        }

        .voice-wave {
            width: 3px;
            height: 20px;
            background: linear-gradient(180deg, #ff6b6b, #feca57);
            border-radius: 2px;
            animation: voice-wave 1s ease-in-out infinite;
        }

        .voice-wave:nth-child(2) { animation-delay: 0.1s; }
        .voice-wave:nth-child(3) { animation-delay: 0.2s; }
        .voice-wave:nth-child(4) { animation-delay: 0.3s; }
        .voice-wave:nth-child(5) { animation-delay: 0.4s; }

        @keyframes voice-wave {
            0%, 100% { transform: scaleY(0.3); }
            50% { transform: scaleY(1); }
        }

        .narration-text {
            color: white;
            font-size: 13px;
            max-width: 300px;
        }

        /* Quick Actions */
        .quick-actions {
            position: absolute;
            bottom: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
            z-index: 1000;
        }

        .action-btn {
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 10px 16px;
            border-radius: 25px;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
        }

        .action-btn:hover {
            background: rgba(255, 107, 107, 0.3);
            border-color: #ff6b6b;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 107, 107, 0.3);
        }

        /* Custom Scrollbar */
        .info-panel::-webkit-scrollbar {
            width: 6px;
        }

        .info-panel::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 3px;
        }

        .info-panel::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, #ff6b6b, #feca57);
            border-radius: 3px;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .info-panel {
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                top: auto;
                width: 100%;
                max-height: 50vh;
                border-radius: 20px 20px 0 0;
            }
            
            .journey-navigation {
                bottom: 52vh;
                max-width: calc(100% - 40px);
            }
            
            .voice-controls {
                top: auto;
                bottom: 55vh;
                right: 10px;
            }
            
            .quick-actions {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="bg-animation"></div>

    <!-- Loading Screen -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="loading-life">üå±</div>
            <div class="loading-text">Preparing Your Life Journey...</div>
            <div class="loading-progress">
                <div class="loading-progress-bar"></div>
            </div>
        </div>
    </div>

    <!-- Museum Header -->
    <div class="museum-header">
        <div class="museum-title">Fertilization, Pregnancy & Birth</div>
        <div class="exhibit-subtitle">
            <span class="life-indicator"></span>
            The Journey of Human Development
        </div>
    </div>

    <!-- Journey Navigation -->
    <div class="journey-navigation">
        <div class="journey-title">
            <span>üå±</span>
            <span>Your Life Journey</span>
        </div>
        <div class="journey-steps">
            <button class="journey-btn active" onclick="loadJourneyStep('fertilization')">
                <span>ü•Ñ</span> Fertilization
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('embryo')">
                <span>üå±</span> Development
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('placenta')">
                <span>üîó</span> Placenta
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('fetus')">
                <span>üë∂</span> Fetus
            </button>
        </div>
    </div>

    <!-- 3D Model Container -->
    <div class="model-container">
        <div class="sketchfab-embed-wrapper">
            <iframe id="api-frame"
                    title="Fertilization Process Model" 
                    frameborder="0" 
                    allowfullscreen 
                    mozallowfullscreen="true" 
                    webkitallowfullscreen="true" 
                    allow="autoplay; fullscreen; xr-spatial-tracking"
                    xr-spatial-tracking 
                    execution-while-out-of-viewport 
                    execution-while-not-rendered 
                    web-share 
                    src="https://sketchfab.com/models/3bcbe06b08c444cc868d525d79d8ee4b/embed?autostart=1&internal=1&tracking=0&ui_ar=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0">
            </iframe>
        </div>
    </div>

    <!-- Information Panel -->
    <div class="info-panel" id="infoPanel">
        <div class="info-header">
            <div class="info-icon" id="stepIcon">ü•Ñ</div>
            <div class="info-title">
                <h2 id="stepTitle">Fertilization - The Beginning of Life</h2>
                <div class="info-subtitle" id="stepSubtitle">When sperm meets egg</div>
            </div>
        </div>

        <!-- Progress Tracker -->
        <div class="progress-tracker">
            <div class="progress-header">
                <span>Development Progress</span>
                <span class="progress-percentage" id="progressPercent">25%</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 25%"></div>
            </div>
            <div class="progress-steps-mini">
                <span class="step-mini active" onclick="loadJourneyStep('fertilization')">Fertilization</span>
                <span class="step-mini" onclick="loadJourneyStep('embryo')">Development</span>
                <span class="step-mini" onclick="loadJourneyStep('placenta')">Placenta</span>
                <span class="step-mini" onclick="loadJourneyStep('fetus')">Fetus</span>
            </div>
        </div>

        <div class="info-content" id="mainDescription">
            Fertilization is the remarkable moment when a sperm cell successfully penetrates an egg cell, combining genetic material from both parents to form a unique diploid zygote. This process marks the beginning of human development and the formation of a genetically distinct individual.
        </div>

        <div class="info-card">
            <div class="info-card-title">
                <span>üî¨</span> Key Processes
            </div>
            <div class="info-card-content">
                <ul class="info-list" id="keyConcepts">
                    <li>Sperm penetrates egg's protective layers</li>
                    <li>Nuclei fuse to form diploid zygote</li>
                    <li>Cortical reaction prevents polyspermy</li>
                    <li>First mitotic division begins development</li>
                </ul>
            </div>
        </div>

        <div class="fun-fact">
            <div class="fun-fact-title">Amazing Process!</div>
            <div class="fun-fact-text" id="funFact">
                Of the 200-500 million sperm released during fertilization, only one will successfully fertilize the egg. The journey from fertilization to implantation takes about 6-7 days!
            </div>
        </div>

        <div class="info-card">
            <div class="info-card-title">
                <span>üéØ</span> Learning Objectives
            </div>
            <div class="info-card-content" id="learningObjectives">
                Understand the biological processes of fertilization and how genetic material from two parents combines to create a unique individual.
            </div>
        </div>
    </div>

    <!-- Voice Controls -->
    <div class="voice-controls">
        <button class="control-btn active" id="voiceToggle" onclick="toggleVoice()">
            üîä
            <span class="control-tooltip">Voice Narration</span>
        </button>
        <button class="control-btn" onclick="toggleAutoPlay()">
            ‚ñ∂Ô∏è
            <span class="control-tooltip">Auto Journey</span>
        </button>
        <button class="control-btn" onclick="toggleInfo()">
            ‚ÑπÔ∏è
            <span class="control-tooltip">Toggle Info</span>
        </button>
    </div>

    <!-- Quick Actions -->
    <div class="quick-actions">
        <button class="action-btn" onclick="startGuidedTour()">
            <span>üöÄ</span> Guided Tour
        </button>
        <button class="action-btn" onclick="showQuiz()">
            <span>üéØ</span> Test Knowledge
        </button>
    </div>

    <!-- Voice Indicator -->
    <div class="voice-indicator" id="voiceIndicator">
        <div class="voice-waves">
            <div class="voice-wave"></div>
            <div class="voice-wave"></div>
            <div class="voice-wave"></div>
            <div class="voice-wave"></div>
            <div class="voice-wave"></div>
        </div>
        <div class="narration-text" id="narrationText">Narrating...</div>
    </div>

    <script>
        // Journey Step Data with Complete Pedagogical Content
        const JOURNEY_DATA = {
            fertilization: {
                title: "Fertilization - The Beginning of Life",
                subtitle: "When sperm meets egg",
                icon: "ü•Ñ",
                modelUrl: "https://sketchfab.com/models/3bcbe06b08c444cc868d525d79d8ee4b/embed?autostart=1&internal=1&tracking=0&ui_ar=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "Fertilization is the remarkable moment when a sperm cell successfully penetrates an egg cell, combining genetic material from both parents to form a unique diploid zygote. This process marks the beginning of human development and the formation of a genetically distinct individual.",
                concepts: [
                    "Sperm penetrates egg's protective layers",
                    "Nuclei fuse to form diploid zygote",
                    "Cortical reaction prevents polyspermy",
                    "First mitotic division begins development"
                ],
                funFact: "Of the 200-500 million sperm released during fertilization, only one will successfully fertilize the egg. The journey from fertilization to implantation takes about 6-7 days!",
                objectives: "Understand the biological processes of fertilization and how genetic material from two parents combines to create a unique individual.",
                narration: "Witness the incredible moment of fertilization - the beginning of every human life! This process typically occurs in the fallopian tube when a sperm cell encounters an egg that was released during ovulation. The sperm must first navigate through the corona radiata, the protective layer of cells surrounding the egg. Next, it must penetrate the zona pellucida, a thick glycoprotein layer that acts as a species-specific barrier. When the successful sperm makes contact with the egg membrane, it triggers the acrosome reaction, releasing enzymes that help it penetrate the egg. Once the sperm head enters the egg cytoplasm, the egg immediately undergoes the cortical reaction, hardening its outer layer to prevent other sperm from entering. The sperm and egg nuclei, each containing 23 chromosomes, migrate toward each other and fuse to form a diploid zygote with 46 chromosomes. This moment creates a genetically unique individual with DNA combinations that have never existed before. Within hours, the zygote begins its first mitotic division, starting the remarkable journey of human development."
            },
            embryo: {
                title: "Embryo Development - The Early Stages",
                subtitle: "From zygote to recognizable form",
                icon: "üå±",
                modelUrl: "https://sketchfab.com/models/9fb225b983c14b20b67b639e17126f5b/embed?autostart=1&internal=1&tracking=0&ui_ar=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "Embryonic development encompasses the first eight weeks after fertilization, during which rapid cell division, differentiation, and organ formation occur. This period establishes all major body systems and transforms a single cell into a recognizable human form.",
                concepts: [
                    "Cleavage creates multiple cells from zygote",
                    "Gastrulation forms three primary tissue layers",
                    "Neurulation develops the nervous system",
                    "Organogenesis creates all major organs"
                ],
                funFact: "By the end of the embryonic period at 8 weeks, the developing human is only about 1 inch long but already has all major organs formed and functioning!",
                objectives: "Trace the stages of early human development and understand how complex organisms develop from a single fertilized cell.",
                narration: "Follow the extraordinary transformation during embryonic development! After fertilization, the zygote begins rapidly dividing through a process called cleavage, creating 2, then 4, then 8 cells, and so on. By day 5-6, it becomes a blastocyst with an inner cell mass that will become the embryo proper. Around day 7, implantation occurs as the blastocyst burrows into the uterine wall. During the second week, gastrulation begins - one of the most critical events in development. This process creates three primary germ layers: ectoderm, which will form the nervous system and skin; mesoderm, which develops into muscles, bones, and circulatory system; and endoderm, which creates the digestive and respiratory systems. Neurulation follows, forming the neural tube that becomes the brain and spinal cord. During weeks 3-8, organogenesis occurs as all major organ systems develop. The heart begins beating by week 3, limb buds appear by week 4, and facial features form by week 6. This period demonstrates how genetic information directs the precise choreography of cellular division, migration, and differentiation that creates human complexity from a single cell."
            },
            placenta: {
                title: "Placenta - The Life Support System",
                subtitle: "Connection between mother and developing baby",
                icon: "üîó",
                modelUrl: "https://sketchfab.com/3d-models/placenta-anatomy-430d73f248674d1d865b620fe8e46cff/embed?autostart=1&internal=1&tracking=0&ui_ar=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "The placenta is a remarkable temporary organ that develops during pregnancy to provide life support for the growing fetus. It facilitates the exchange of nutrients, gases, and waste products between maternal and fetal circulation while maintaining separate blood supplies.",
                concepts: [
                    "Chorionic villi maximize surface area for exchange",
                    "Maternal and fetal blood remain separate",
                    "Produces hormones to maintain pregnancy",
                    "Filters harmful substances while allowing nutrients"
                ],
                funFact: "The placenta contains over 200 miles of blood vessels and processes about 12 liters of blood per hour by the end of pregnancy - that's like filtering a bathtub full of blood every hour!",
                objectives: "Understand placental structure and function, and appreciate how this organ supports fetal development throughout pregnancy.",
                narration: "Discover the placenta - one of nature's most sophisticated life support systems! This remarkable organ begins forming during the second week of pregnancy and continues growing throughout gestation. The placenta consists of intricate finger-like projections called chorionic villi that extend into maternal blood spaces, creating an enormous surface area for exchange - roughly equivalent to a tennis court packed into an organ the size of a dinner plate! What makes the placenta truly amazing is that maternal and fetal blood never actually mix. Instead, nutrients, oxygen, antibodies, and hormones pass from mother to baby across thin cellular barriers, while waste products and carbon dioxide move in the opposite direction. The placenta also functions as an endocrine organ, producing hormones like human chorionic gonadotropin (hCG), estrogen, and progesterone that maintain pregnancy and prepare the mother's body for childbirth and nursing. Additionally, it acts as a selective barrier, protecting the fetus from many harmful substances while allowing beneficial materials to pass through. The umbilical cord, containing two arteries and one vein, connects the fetus to this incredible organ that literally sustains life throughout the nine months of development."
            },
            fetus: {
                title: "Fetal Development - Growing in the Womb",
                subtitle: "From embryo to birth-ready baby",
                icon: "üë∂",
                modelUrl: "https://sketchfab.com/3d-models/development-of-fetus-32a0486baf4b419181ff25eec18f09b9/embed?autostart=1&internal=1&tracking=0&ui_ar=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "The fetal period, from 9 weeks until birth, focuses on growth and maturation of organs and systems formed during embryonic development. The fetus develops within the protective amniotic sac, preparing for independent life outside the womb.",
                concepts: [
                    "Organs mature and become functional",
                    "Rapid growth in size and weight",
                    "Brain development and neural connections",
                    "Preparation for birth and independent survival"
                ],
                funFact: "A baby's brain grows so rapidly during fetal development that it creates about 250,000 new neurons every minute! By birth, the brain contains nearly 100 billion neurons.",
                objectives: "Understand fetal growth patterns and development milestones that prepare the baby for life outside the womb.",
                narration: "Experience the remarkable fetal period - the final stage of prenatal development! From week 9 until birth, the focus shifts from organ formation to growth and maturation. During the second trimester, rapid growth occurs as the fetus develops from about 1 inch to 12 inches long. The skeleton begins to harden, facial features become more distinct, and the fetus begins moving actively. Around week 20, many parents first feel these movements, called quickening. The fetus is surrounded by amniotic fluid within the amniotic sac, which provides protection from physical trauma, maintains constant temperature, and allows for movement that promotes proper bone and muscle development. During the third trimester, the most dramatic growth occurs. The fetus gains most of its birth weight, fat deposits develop for temperature regulation, and the lungs mature to prepare for breathing air. Brain development is particularly remarkable during this period, with rapid formation of neural connections and the development of sleep-wake cycles. The fetus also begins practicing essential behaviors like sucking, swallowing, and even breathing movements using amniotic fluid. By full term at 37-40 weeks, the average baby weighs 6-8 pounds and is about 20 inches long, fully prepared for the transition to independent life. This incredible journey from a single cell to a complex, functioning human being demonstrates the remarkable precision of developmental biology."
            }
        };

        // Global Variables
        let currentStep = 'fertilization';
        let voiceEnabled = true;
        let autoPlayEnabled = false;
        let currentSpeech = null;
        let selectedVoice = null;
        let journeyProgress = 0;
        let guidedTourActive = false;

        // Initialize Voice System
        function initVoiceSystem() {
            if (!('speechSynthesis' in window)) {
                console.warn('Speech synthesis not supported');
                voiceEnabled = false;
                document.getElementById('voiceToggle').style.display = 'none';
                return;
            }

            function loadVoices() {
                const voices = speechSynthesis.getVoices();
                if (voices.length === 0) return;

                // Prefer natural-sounding voices
                const preferredVoices = [
                    'Google UK English Female',
                    'Microsoft Sonia',
                    'Microsoft Hazel',
                    'Samantha',
                    'Victoria'
                ];

                for (const name of preferredVoices) {
                    selectedVoice = voices.find(v => v.name.includes(name));
                    if (selectedVoice) break;
                }

                if (!selectedVoice) {
                    selectedVoice = voices.find(v => v.lang.startsWith('en'));
                }
            }

            loadVoices();
            if (speechSynthesis.onvoiceschanged !== undefined) {
                speechSynthesis.onvoiceschanged = loadVoices;
            }
        }

        // Load Journey Step
        function loadJourneyStep(stepId) {
            const stepData = JOURNEY_DATA[stepId];
            if (!stepData) return;

            currentStep = stepId;
            
            // Update model
            document.getElementById('api-frame').src = stepData.modelUrl;
            
            // Update info panel
            document.getElementById('stepIcon').textContent = stepData.icon;
            document.getElementById('stepTitle').textContent = stepData.title;
            document.getElementById('stepSubtitle').textContent = stepData.subtitle;
            document.getElementById('mainDescription').textContent = stepData.description;
            
            // Update key concepts
            const conceptsList = document.getElementById('keyConcepts');
            conceptsList.innerHTML = stepData.concepts.map(c => `<li>${c}</li>`).join('');
            
            // Update fun fact
            document.getElementById('funFact').textContent = stepData.funFact;
            
            // Update learning objectives
            document.getElementById('learningObjectives').textContent = stepData.objectives;
            
            // Update navigation buttons
            updateNavigationButtons(stepId);
            
            // Update progress
            updateProgress();
            
            // Play narration if enabled
            if (voiceEnabled) {
                speakText(stepData.narration);
            }
        }

        // Update Navigation Buttons
        function updateNavigationButtons(activeStep) {
            const buttons = document.querySelectorAll('.journey-btn');
            const steps = ['fertilization', 'embryo', 'placenta', 'fetus'];
            const activeIndex = steps.indexOf(activeStep);
            
            buttons.forEach((btn, index) => {
                btn.classList.remove('active', 'completed');
                if (index < activeIndex) {
                    btn.classList.add('completed');
                } else if (index === activeIndex) {
                    btn.classList.add('active');
                }
            });
            
            // Update mini steps
            const miniSteps = document.querySelectorAll('.step-mini');
            miniSteps.forEach((step, index) => {
                step.classList.remove('active', 'completed');
                if (index < activeIndex) {
                    step.classList.add('completed');
                } else if (index === activeIndex) {
                    step.classList.add('active');
                }
            });
        }

        // Update Progress
        function updateProgress() {
            const steps = ['fertilization', 'embryo', 'placenta', 'fetus'];
            const currentIndex = steps.indexOf(currentStep);
            const progress = ((currentIndex + 1) / steps.length) * 100;
            
            document.getElementById('progressPercent').textContent = Math.round(progress) + '%';
            document.getElementById('progressFill').style.width = progress + '%';
        }

        // Speech Functions
        function speakText(text) {
            if (!voiceEnabled || !text) return;
            
            stopSpeech();
            
            currentSpeech = new SpeechSynthesisUtterance(text);
            if (selectedVoice) {
                currentSpeech.voice = selectedVoice;
            }
            currentSpeech.rate = 0.9;
            currentSpeech.pitch = 1.0;
            currentSpeech.volume = 0.9;
            
            currentSpeech.onstart = () => {
                document.getElementById('voiceIndicator').classList.add('visible');
                document.getElementById('narrationText').textContent = 
                    text.substring(0, 50) + (text.length > 50 ? '...' : '');
            };
            
            currentSpeech.onend = () => {
                document.getElementById('voiceIndicator').classList.remove('visible');
                currentSpeech = null;
                
                // Auto-advance if guided tour is active
                if (guidedTourActive) {
                    setTimeout(nextStep, 2000);
                }
            };
            
            speechSynthesis.speak(currentSpeech);
        }

        function stopSpeech() {
            if (currentSpeech) {
                speechSynthesis.cancel();
                currentSpeech = null;
                document.getElementById('voiceIndicator').classList.remove('visible');
            }
        }

        // Control Functions
        function toggleVoice() {
            voiceEnabled = !voiceEnabled;
            const btn = document.getElementById('voiceToggle');
            btn.textContent = voiceEnabled ? 'üîä' : 'üîá';
            btn.classList.toggle('active', voiceEnabled);
            
            if (!voiceEnabled) {
                stopSpeech();
            }
        }

        function toggleAutoPlay() {
            autoPlayEnabled = !autoPlayEnabled;
            if (autoPlayEnabled) {
                startGuidedTour();
            } else {
                guidedTourActive = false;
            }
        }

        function toggleInfo() {
            const panel = document.getElementById('infoPanel');
            panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
        }

        // Guided Tour
        function startGuidedTour() {
            guidedTourActive = true;
            const steps = ['fertilization', 'embryo', 'placenta', 'fetus'];
            let stepIndex = 0;
            
            function tourStep() {
                if (stepIndex < steps.length && guidedTourActive) {
                    loadJourneyStep(steps[stepIndex]);
                    stepIndex++;
                } else {
                    guidedTourActive = false;
                    if (voiceEnabled) {
                        speakText("You have completed your journey through human development from fertilization to birth. You now understand how life begins and the remarkable processes that transform a single cell into a complex human being ready for independent life!");
                    }
                }
            }
            
            tourStep();
            window.nextStep = tourStep;
        }

        // Quiz Function
        function showQuiz() {
            const questions = [
                "What happens during the fertilization process?",
                "How does embryonic development establish body systems?",
                "What role does the placenta play during pregnancy?",
                "How does the fetus prepare for life outside the womb?",
                "What are the key stages of human prenatal development?"
            ];
            
            const randomQ = questions[Math.floor(Math.random() * questions.length)];
            
            if (voiceEnabled) {
                speakText(`Here's a question to test your developmental biology knowledge: ${randomQ} Think about what you've learned about human development!`);
            }
        }

        // Initialize
        function init() {
            initVoiceSystem();
            
            // Hide loading screen
            setTimeout(() => {
                const loading = document.getElementById('loadingOverlay');
                loading.style.opacity = '0';
                setTimeout(() => {
                    loading.style.display = 'none';
                    
                    // Welcome message
                    if (voiceEnabled) {
                        speakText("Welcome to your journey through human development from fertilization to birth! We'll explore the remarkable biological processes that transform a single fertilized cell into a complex human being. Let's begin with the moment life starts - fertilization!");
                    }
                }, 1000);
            }, 3000);
            
            // Keyboard shortcuts
            document.addEventListener('keydown', (e) => {
                switch(e.key) {
                    case 'v': toggleVoice(); break;
                    case 'i': toggleInfo(); break;
                    case 'g': startGuidedTour(); break;
                    case 'Escape': stopSpeech(); guidedTourActive = false; break;
                    case 'ArrowRight': nextStep && nextStep(); break;
                }
            });
        }

        // Start the application
        init();
    </script>
</body>
</html>