<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Molecular Basis of Heredity - From DNA to Traits</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tween.js/18.6.4/tween.umd.js"></script>

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 50%, #8e44ad 100%);
            color: white;
            overflow: hidden;
            position: relative;
            height: 100vh;
        }

        /* Animated Background */
        .bg-animation {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 0;
            opacity: 0.1;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320"><path fill="%23ffffff" fill-opacity="0.3" d="M0,192L48,208C96,224,192,256,288,245.3C384,235,480,181,576,181.3C672,181,768,235,864,240C960,245,1056,203,1152,181.3C1248,160,1344,160,1392,160L1440,160L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path></svg>') repeat-x;
            animation: molecularWave 18s linear infinite;
        }

        @keyframes molecularWave {
            0% { background-position-x: 0; }
            100% { background-position-x: 1440px; }
        }

        /* Museum Interface - Compact Header */
        .museum-header {
            position: absolute;
            top: 10px;
            left: 20px;
            text-align: left;
            z-index: 1000;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            padding: 10px 18px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        .museum-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 4px;
            background: linear-gradient(45deg, #1e3c72, #2a5298, #8e44ad);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: titleGlow 3s ease-in-out infinite;
        }

        @keyframes titleGlow {
            0%, 100% { filter: brightness(1); }
            50% { filter: brightness(1.2); }
        }

        .exhibit-subtitle {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.8);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .molecular-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: linear-gradient(45deg, #1e3c72, #8e44ad);
            border-radius: 50%;
            animation: molecularPulse 2s ease-in-out infinite;
        }

        @keyframes molecularPulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.3); opacity: 0.7; }
        }

        /* Journey Navigation - Enhanced */
        .journey-navigation {
            position: absolute;
            bottom: 20px;
            left: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 1000;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            padding: 15px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            max-width: 380px;
        }

        .journey-title {
            font-size: 14px;
            font-weight: 600;
            color: #2a5298;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .journey-steps {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
        }

        .journey-btn {
            background: rgba(42, 82, 152, 0.2);
            border: 1px solid rgba(42, 82, 152, 0.4);
            color: white;
            padding: 6px 10px;
            border-radius: 20px;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 4px;
            white-space: nowrap;
        }

        .journey-btn:hover {
            background: rgba(42, 82, 152, 0.3);
            border-color: #2a5298;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(42, 82, 152, 0.3);
        }

        .journey-btn.active {
            background: linear-gradient(135deg, #8e44ad, #9b59b6);
            border-color: #8e44ad;
            box-shadow: 0 0 20px rgba(142, 68, 173, 0.5);
            animation: pulse 2s infinite;
        }

        .journey-btn.completed {
            background: rgba(46, 204, 113, 0.3);
            border-color: #2ecc71;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* 3D Model Container */
        .model-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 0;
            overflow: hidden;
            border: none;
            z-index: 100;
        }

        .sketchfab-embed-wrapper {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 50%, #8e44ad 100%);
        }

        .sketchfab-embed-wrapper iframe {
            width: 100%;
            height: 100%;
            border: none;
            border-radius: 0;
        }

        /* Information Panel - Enhanced */
        .info-panel {
            position: absolute;
            top: 70px;
            right: 20px;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 16px;
            padding: 24px;
            width: 460px;
            max-height: calc(100vh - 140px);
            z-index: 800;
            overflow-y: auto;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }

        .info-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
        }

        .info-icon {
            font-size: 28px;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        .info-title {
            flex: 1;
        }

        .info-title h2 {
            font-size: 18px;
            color: #8e44ad;
            margin-bottom: 4px;
        }

        .info-subtitle {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
        }

        .info-content {
            color: rgba(255, 255, 255, 0.9);
            font-size: 14px;
            line-height: 1.6;
        }

        /* Progress Tracker */
        .progress-tracker {
            background: linear-gradient(135deg, rgba(42, 82, 152, 0.1), rgba(142, 68, 173, 0.1));
            border: 1px solid rgba(42, 82, 152, 0.3);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 20px;
        }

        .progress-header {
            font-size: 13px;
            font-weight: 600;
            color: #2a5298;
            margin-bottom: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .progress-percentage {
            font-size: 18px;
            color: #8e44ad;
            font-weight: 700;
        }

        .progress-bar {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 12px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #1e3c72, #2a5298, #8e44ad);
            border-radius: 4px;
            transition: width 0.8s ease;
            box-shadow: 0 0 10px rgba(142, 68, 173, 0.5);
        }

        .progress-steps-mini {
            display: flex;
            justify-content: space-between;
            font-size: 8px;
            color: rgba(255, 255, 255, 0.6);
        }

        .step-mini {
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 16%;
        }

        .step-mini.active {
            color: #8e44ad;
            font-weight: 600;
        }

        .step-mini.completed {
            color: #2ecc71;
        }

        /* Information Cards */
        .info-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 14px;
            margin-bottom: 14px;
        }

        .info-card-title {
            color: #2a5298;
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .info-card-content {
            color: rgba(255, 255, 255, 0.85);
            font-size: 12px;
            line-height: 1.5;
        }

        .info-list {
            list-style: none;
            padding: 0;
        }

        .info-list li {
            padding: 6px 0;
            padding-left: 20px;
            position: relative;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.8);
        }

        .info-list li:before {
            content: "→";
            position: absolute;
            left: 0;
            color: #8e44ad;
        }

        /* Pathway Display */
        .pathway-display {
            background: linear-gradient(135deg, rgba(142, 68, 173, 0.1), rgba(30, 60, 114, 0.1));
            border: 1px solid rgba(142, 68, 173, 0.3);
            border-radius: 12px;
            padding: 16px;
            margin: 16px 0;
        }

        .pathway-title {
            color: #8e44ad;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 12px;
            text-align: center;
        }

        .pathway-flow {
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 8px;
        }

        .pathway-step {
            background: rgba(42, 82, 152, 0.3);
            border: 1px solid rgba(42, 82, 152, 0.5);
            padding: 8px 12px;
            border-radius: 8px;
            text-align: center;
            font-size: 11px;
            font-weight: bold;
            min-width: 60px;
            flex: 1;
        }

        .pathway-arrow {
            color: #8e44ad;
            font-size: 16px;
            font-weight: bold;
        }

        /* Molecular Structure Display */
        .structure-display {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 16px;
            margin: 16px 0;
        }

        .structure-title {
            color: #2a5298;
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 12px;
            text-align: center;
        }

        .structure-content {
            color: rgba(255, 255, 255, 0.85);
            font-size: 12px;
            line-height: 1.5;
            text-align: center;
        }

        /* Fun Fact Box */
        .fun-fact {
            background: linear-gradient(135deg, rgba(46, 204, 113, 0.1), rgba(52, 152, 219, 0.1));
            border: 1px solid rgba(46, 204, 113, 0.3);
            border-radius: 12px;
            padding: 14px;
            margin: 16px 0;
            position: relative;
            overflow: hidden;
        }

        .fun-fact:before {
            content: "🧬";
            position: absolute;
            top: -20px;
            right: -20px;
            font-size: 60px;
            opacity: 0.1;
        }

        .fun-fact-title {
            color: #2ecc71;
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 6px;
        }

        .fun-fact-text {
            color: rgba(255, 255, 255, 0.9);
            font-size: 12px;
            line-height: 1.5;
            position: relative;
            z-index: 1;
        }

        /* Voice Controls */
        .voice-controls {
            position: absolute;
            top: 10px;
            right: 20px;
            display: flex;
            gap: 8px;
            z-index: 1000;
        }

        .control-btn {
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            position: relative;
        }

        .control-btn:hover {
            background: rgba(142, 68, 173, 0.3);
            border-color: #8e44ad;
            transform: scale(1.1);
        }

        .control-btn.active {
            background: rgba(142, 68, 173, 0.4);
            border-color: #8e44ad;
            box-shadow: 0 0 20px rgba(142, 68, 173, 0.5);
        }

        .control-tooltip {
            position: absolute;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.9);
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 10px;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .control-btn:hover .control-tooltip {
            opacity: 1;
        }

        /* Loading Screen */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 50%, #8e44ad 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            transition: opacity 1s ease;
        }

        .loading-content {
            text-align: center;
        }

        .loading-molecular {
            font-size: 60px;
            animation: molecularPulse 1.5s ease-in-out infinite;
            margin-bottom: 20px;
        }

        .loading-text {
            color: white;
            font-size: 20px;
            margin-bottom: 20px;
        }

        .loading-progress {
            width: 200px;
            height: 4px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 2px;
            overflow: hidden;
        }

        .loading-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #1e3c72, #2a5298, #8e44ad);
            animation: loading 2s ease-in-out infinite;
        }

        @keyframes loading {
            0% { width: 0%; }
            50% { width: 100%; }
            100% { width: 0%; }
        }

        /* Voice Indicator */
        .voice-indicator {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(142, 68, 173, 0.5);
            border-radius: 30px;
            padding: 14px 28px;
            display: flex;
            align-items: center;
            gap: 12px;
            z-index: 1000;
            opacity: 0;
            transition: all 0.3s ease;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }

        .voice-indicator.visible {
            opacity: 1;
            transform: translateX(-50%) translateY(-10px);
        }

        .voice-waves {
            display: flex;
            align-items: center;
            gap: 3px;
        }

        .voice-wave {
            width: 3px;
            height: 20px;
            background: linear-gradient(180deg, #8e44ad, #2a5298);
            border-radius: 2px;
            animation: voice-wave 1s ease-in-out infinite;
        }

        .voice-wave:nth-child(2) { animation-delay: 0.1s; }
        .voice-wave:nth-child(3) { animation-delay: 0.2s; }
        .voice-wave:nth-child(4) { animation-delay: 0.3s; }
        .voice-wave:nth-child(5) { animation-delay: 0.4s; }

        @keyframes voice-wave {
            0%, 100% { transform: scaleY(0.3); }
            50% { transform: scaleY(1); }
        }

        .narration-text {
            color: white;
            font-size: 13px;
            max-width: 300px;
        }

        /* Quick Actions */
        .quick-actions {
            position: absolute;
            bottom: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
            z-index: 1000;
        }

        .action-btn {
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 10px 16px;
            border-radius: 25px;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
        }

        .action-btn:hover {
            background: rgba(42, 82, 152, 0.3);
            border-color: #2a5298;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(42, 82, 152, 0.3);
        }

        /* Custom Scrollbar */
        .info-panel::-webkit-scrollbar {
            width: 6px;
        }

        .info-panel::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 3px;
        }

        .info-panel::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, #8e44ad, #2a5298);
            border-radius: 3px;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .info-panel {
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                top: auto;
                width: 100%;
                max-height: 50vh;
                border-radius: 20px 20px 0 0;
            }
            
            .journey-navigation {
                bottom: 52vh;
                max-width: calc(100% - 40px);
            }
            
            .voice-controls {
                top: auto;
                bottom: 55vh;
                right: 10px;
            }
            
            .quick-actions {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="bg-animation"></div>

    <!-- Loading Screen -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="loading-molecular">🧬</div>
            <div class="loading-text">Exploring Molecular Genetics...</div>
            <div class="loading-progress">
                <div class="loading-progress-bar"></div>
            </div>
        </div>
    </div>

    <!-- Museum Header -->
    <div class="museum-header">
        <div class="museum-title">Molecular Basis of Heredity</div>
        <div class="exhibit-subtitle">
            <span class="molecular-indicator"></span>
            From DNA to Traits
        </div>
    </div>

    <!-- Journey Navigation -->
    <div class="journey-navigation">
        <div class="journey-title">
            <span>🧬</span>
            <span>Your Molecular Journey</span>
        </div>
        <div class="journey-steps">
            <button class="journey-btn active" onclick="loadJourneyStep('dna_structure')">
                <span>🧬</span> DNA
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('chromosome_genes')">
                <span>📊</span> Chromosomes
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('cell_nucleus')">
                <span>🔬</span> Cell
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('ribosome_protein')">
                <span>⚙️</span> Ribosomes
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('enzyme_function')">
                <span>🔧</span> Enzymes
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('protein_structure')">
                <span>🏗️</span> Proteins
            </button>
        </div>
    </div>

    <!-- 3D Model Container -->
    <div class="model-container">
        <div class="sketchfab-embed-wrapper">
            <iframe id="api-frame"
                    title="DNA Double Helix Model" 
                    frameborder="0" 
                    allowfullscreen 
                    mozallowfullscreen="true" 
                    webkitallowfullscreen="true" 
                    allow="autoplay; fullscreen; xr-spatial-tracking"
                    xr-spatial-tracking 
                    execution-while-out-of-viewport 
                    execution-while-not-rendered 
                    web-share 
                    src="https://sketchfab.com/models/d01693952c5a4c9080e778c91080f93e/embed?autostart=1&internal=1&tracking=0&ui_ar=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0">
            </iframe>
        </div>
    </div>

    <!-- Information Panel -->
    <div class="info-panel" id="infoPanel">
        <div class="info-header">
            <div class="info-icon" id="stepIcon">🧬</div>
            <div class="info-title">
                <h2 id="stepTitle">DNA - The Molecular Blueprint</h2>
                <div class="info-subtitle" id="stepSubtitle">How genetic information is stored</div>
            </div>
        </div>

        <!-- Progress Tracker -->
        <div class="progress-tracker">
            <div class="progress-header">
                <span>Journey Progress</span>
                <span class="progress-percentage" id="progressPercent">0%</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 0%"></div>
            </div>
            <div class="progress-steps-mini">
                <span class="step-mini active" onclick="loadJourneyStep('dna_structure')">DNA</span>
                <span class="step-mini" onclick="loadJourneyStep('chromosome_genes')">Chromosome</span>
                <span class="step-mini" onclick="loadJourneyStep('cell_nucleus')">Cell</span>
                <span class="step-mini" onclick="loadJourneyStep('ribosome_protein')">Ribosome</span>
                <span class="step-mini" onclick="loadJourneyStep('enzyme_function')">Enzyme</span>
                <span class="step-mini" onclick="loadJourneyStep('protein_structure')">Protein</span>
            </div>
        </div>

        <div class="info-content" id="mainDescription">
            DNA contains the genetic instructions that control all inherited traits. This molecular blueprint determines how genes work by specifying the sequence of proteins that create our characteristics. Understanding DNA structure reveals how genetic information flows from genes to proteins to observable traits.
        </div>

        <div class="info-card">
            <div class="info-card-title">
                <span>🔬</span> Key Concepts
            </div>
            <div class="info-card-content">
                <ul class="info-list" id="keyConcepts">
                    <li>DNA stores genetic information in nucleotide sequences</li>
                    <li>Genes are specific DNA sections coding for proteins</li>
                    <li>Double helix structure enables accurate replication</li>
                    <li>Base pairing (A-T, G-C) ensures genetic fidelity</li>
                </ul>
            </div>
        </div>

        <div class="pathway-display" id="pathwayDisplay">
            <div class="pathway-title">DNA → Gene → Protein → Trait Pathway</div>
            <div class="pathway-flow">
                <div class="pathway-step">DNA</div>
                <div class="pathway-arrow">→</div>
                <div class="pathway-step">Gene</div>
                <div class="pathway-arrow">→</div>
                <div class="pathway-step">Protein</div>
                <div class="pathway-arrow">→</div>
                <div class="pathway-step">Trait</div>
            </div>
        </div>

        <div class="structure-display" id="structureDisplay">
            <div class="structure-title">DNA Structure Features</div>
            <div class="structure-content">
                The double helix consists of two antiparallel strands connected by complementary base pairs. This structure ensures genetic information can be accurately copied and transmitted to offspring.
            </div>
        </div>

        <div class="fun-fact">
            <div class="fun-fact-title">Molecular Marvel!</div>
            <div class="fun-fact-text" id="funFact">
                If you could unwind all the DNA in a single human cell, it would stretch about 2 meters long, yet it's packed into a nucleus only 6 micrometers across - that's like fitting 20 miles of thread into a tennis ball!
            </div>
        </div>

        <div class="info-card">
            <div class="info-card-title">
                <span>🎯</span> Learning Objectives
            </div>
            <div class="info-card-content" id="learningObjectives">
                Understand how DNA structure enables gene function and learn how genetic information flows from DNA to proteins to create the traits we inherit from our parents.
            </div>
        </div>
    </div>

    <!-- Voice Controls -->
    <div class="voice-controls">
        <button class="control-btn active" id="voiceToggle" onclick="toggleVoice()">
            🔊
            <span class="control-tooltip">Voice Narration</span>
        </button>
        <button class="control-btn" onclick="toggleAutoPlay()">
            ▶️
            <span class="control-tooltip">Auto Journey</span>
        </button>
        <button class="control-btn" onclick="toggleInfo()">
            ℹ️
            <span class="control-tooltip">Toggle Info</span>
        </button>
    </div>

    <!-- Quick Actions -->
    <div class="quick-actions">
        <button class="action-btn" onclick="startGuidedTour()">
            <span>🚀</span> Guided Tour
        </button>
        <button class="action-btn" onclick="showQuiz()">
            <span>🎯</span> Test Knowledge
        </button>
    </div>

    <!-- Voice Indicator -->
    <div class="voice-indicator" id="voiceIndicator">
        <div class="voice-waves">
            <div class="voice-wave"></div>
            <div class="voice-wave"></div>
            <div class="voice-wave"></div>
            <div class="voice-wave"></div>
            <div class="voice-wave"></div>
        </div>
        <div class="narration-text" id="narrationText">Narrating...</div>
    </div>

    <script>
        // Journey Step Data with Complete Pedagogical Content
        const JOURNEY_DATA = {
            dna_structure: {
                title: "DNA - The Molecular Blueprint",
                subtitle: "How genetic information is stored",
                icon: "🧬",
                modelUrl: "https://sketchfab.com/models/d01693952c5a4c9080e778c91080f93e/embed?autostart=1&internal=1&tracking=0&ui_ar=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "DNA contains the genetic instructions that control all inherited traits. This molecular blueprint determines how genes work by specifying the sequence of proteins that create our characteristics. Understanding DNA structure reveals how genetic information flows from genes to proteins to observable traits.",
                concepts: [
                    "DNA stores genetic information in nucleotide sequences",
                    "Genes are specific DNA sections coding for proteins",
                    "Double helix structure enables accurate replication",
                    "Base pairing (A-T, G-C) ensures genetic fidelity"
                ],
                funFact: "If you could unwind all the DNA in a single human cell, it would stretch about 2 meters long, yet it's packed into a nucleus only 6 micrometers across - that's like fitting 20 miles of thread into a tennis ball!",
                objectives: "Understand how DNA structure enables gene function and learn how genetic information flows from DNA to proteins to create the traits we inherit from our parents.",
                pathway: "DNA → Gene → Protein → Trait",
                structure: "The double helix consists of two antiparallel strands connected by complementary base pairs. This structure ensures genetic information can be accurately copied and transmitted to offspring.",
                narration: "Welcome to the molecular foundation of heredity - DNA! This elegant double helix structure is the blueprint for all life. You're looking at the twisted ladder that contains every instruction needed to build and maintain a living organism. The sides of the ladder are made of sugar and phosphate molecules, while the rungs are formed by four different bases: adenine, thymine, guanine, and cytosine. These bases pair specifically - A always with T, and G always with C - creating the complementary base pairing that makes DNA replication possible. Each gene is a specific sequence of these bases that codes for a particular protein. When cells need to make a protein, they read the DNA sequence like a recipe book. The beauty of this system is that it explains how traits are inherited: parents pass their DNA to offspring, and this DNA contains the instructions for making the same proteins, resulting in similar traits. This is the molecular basis of heredity - traits are inherited because the instructions for making them are copied and passed down through generations!"
            },
            chromosome_genes: {
                title: "Chromosomes - Organized Genetic Libraries",
                subtitle: "Where genes are located and organized",
                icon: "📊",
                modelUrl: "https://sketchfab.com/models/cc33bb1ebe6141b08d0d06f1bbebc2b7/embed?autostart=1&internal=1&tracking=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_watermark=0",
                description: "Chromosomes are highly organized structures that package DNA and genes efficiently within the cell nucleus. Each chromosome contains hundreds to thousands of genes, and the organization of genes on chromosomes explains how traits are inherited together and why both parents contribute equally to offspring.",
                concepts: [
                    "Chromosomes organize thousands of genes",
                    "Homologous pairs ensure equal parental contribution",
                    "Gene location determines inheritance patterns",
                    "Chromosome structure enables gene regulation"
                ],
                funFact: "Human chromosome 1 contains over 4,200 genes, while the Y chromosome has only about 200 genes - yet both are essential for human development!",
                objectives: "Learn how genes are organized on chromosomes and understand why this organization is crucial for equal inheritance from both parents.",
                pathway: "Chromosome → Gene Location → Inheritance Pattern",
                structure: "Chromosomes consist of DNA wrapped around histone proteins, creating a compact yet accessible structure for gene expression and inheritance.",
                narration: "Explore the incredible organization of genetic material in chromosomes! What you're seeing is how DNA is packaged into these X-shaped structures during cell division. Each chromosome is like a library containing thousands of genes, with each gene having a specific address or location called a locus. This organization is crucial for heredity because it explains why both parents contribute equally to their offspring's traits. Humans have 23 pairs of chromosomes - one chromosome in each pair comes from the mother, and one from the father. This means every gene exists in two copies, which is why children can inherit different versions of traits from each parent. The chromosome structure also enables proper gene regulation - genes are turned on and off in specific patterns during development. When you inherited your eye color, for example, you received one copy of the eye color gene from your mother's chromosome and another copy from your father's chromosome. The interaction between these two gene copies determines your final eye color. This chromosomal organization ensures that genetic information is distributed fairly between offspring and maintains the genetic diversity essential for species survival!"
            },
            cell_nucleus: {
                title: "Cell Nucleus - The Control Center",
                subtitle: "Where genetic information is housed and accessed",
                icon: "🔬",
                modelUrl: "https://sketchfab.com/models/fff76f2ecadf4fe18eb40290938a5404/embed?autostart=1&internal=1&tracking=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_watermark=0",
                description: "The cell nucleus houses all chromosomes and DNA, serving as the control center where genetic information is stored, accessed, and regulated. Understanding nuclear organization reveals how genes are transcribed into RNA and how this process is controlled in different cell types.",
                concepts: [
                    "Nucleus contains all genetic material",
                    "Nuclear pores control molecular traffic",
                    "Gene transcription occurs in nucleus",
                    "Different cells express different genes"
                ],
                funFact: "Your brain cells and muscle cells contain identical DNA, but they look and function completely differently because they express different sets of genes!",
                objectives: "Understand how the nucleus controls gene expression and how the same genetic information can create different cell types.",
                pathway: "Nucleus → Gene Expression → Cell Specialization",
                structure: "The nucleus is surrounded by a double membrane with pores that regulate the movement of RNA and proteins between nucleus and cytoplasm.",
                narration: "Step inside the cell's command center - the nucleus! This membrane-bound organelle is where all your genetic material resides and where the journey from gene to trait begins. The nucleus is like a secure vault containing your chromosomes, but it's also a busy factory where genes are constantly being read and copied. When a cell needs to make a specific protein, the process starts here with transcription - copying the gene's DNA sequence into RNA. The nuclear membrane acts as a quality control barrier, with nuclear pores that carefully regulate what molecules can enter and exit. This is crucial because it allows the cell to control which genes are active at any given time. What's remarkable is that every cell in your body contains the same DNA in its nucleus, yet liver cells, brain cells, and skin cells are completely different. This happens because different genes are turned on in different cell types. A liver cell expresses genes for liver-specific proteins, while a brain cell expresses genes for neurotransmitters and neural function. This differential gene expression, controlled by the nucleus, is how one genome can create the incredible diversity of cell types that make up your body!"
            },
            ribosome_protein: {
                title: "Ribosomes - The Protein Factories",
                subtitle: "Where genetic instructions become proteins",
                icon: "⚙️",
                modelUrl: "https://sketchfab.com/models/2df1aeea00a64530af37f10daf0210fe/embed?autostart=1&internal=1&tracking=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "Ribosomes are the molecular machines that translate genetic information from RNA into proteins. These complex structures read the genetic code and assemble amino acids in the correct sequence to create functional proteins that determine our traits.",
                concepts: [
                    "Ribosomes translate RNA into proteins",
                    "Genetic code determines amino acid sequence",
                    "Protein synthesis occurs in cytoplasm",
                    "Multiple ribosomes can read same RNA"
                ],
                funFact: "A single ribosome can add about 15 amino acids per second to a growing protein chain, and one RNA molecule can be read by multiple ribosomes simultaneously, like cars on an assembly line!",
                objectives: "Learn how ribosomes convert genetic information into functional proteins and understand the central role of protein synthesis in heredity.",
                pathway: "RNA → Ribosome → Protein Synthesis → Functional Protein",
                structure: "Ribosomes consist of two subunits that come together around RNA to form the translation machinery that reads genetic code.",
                narration: "Welcome to the ribosome - molecular machinery that transforms genetic information into the proteins that create your traits! This complex structure is where the genetic code is finally converted into something functional. The ribosome reads messenger RNA that carries genetic instructions from the nucleus, and uses this information to assemble amino acids in the correct order. Think of the ribosome as a 3D printer for proteins - it reads the genetic blueprint and builds the protein one amino acid at a time. The genetic code is like a language with three-letter words called codons, each specifying which amino acid to add next. What makes this process remarkable is its precision - the ribosome must read the code accurately because even a single wrong amino acid can change a protein's function and thus affect a trait. This is where Mendel's abstract 'factors' become concrete reality. When you inherited the gene for brown eyes, that gene's DNA sequence was transcribed into RNA, and ribosomes used that RNA to make the specific proteins that create brown pigment in your iris. The ribosome is thus the crucial link between the genetic information you inherited and the actual traits you express. Without ribosomes, DNA would just be stored information - it's the ribosome that brings genes to life!"
            },
            enzyme_function: {
                title: "Enzymes - The Molecular Workers",
                subtitle: "How proteins create and control traits",
                icon: "🔧",
                modelUrl: "https://sketchfab.com/models/db26db82e59941aebac307f4b72425cd/embed?autostart=1&internal=1&tracking=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "Enzymes are specialized proteins that catalyze the biochemical reactions responsible for creating traits. Understanding enzyme function reveals how genes control characteristics by producing specific proteins that carry out cellular processes.",
                concepts: [
                    "Enzymes are proteins that speed up reactions",
                    "Gene mutations can affect enzyme function",
                    "Enzyme shape determines its function",
                    "Metabolic pathways create trait molecules"
                ],
                funFact: "The enzyme shown here, triosephosphate isomerase, is so efficient it's considered 'catalytically perfect' - it works at the maximum speed theoretically possible for any enzyme!",
                objectives: "Understand how enzymes link genes to traits by catalyzing the reactions that produce the molecules responsible for inherited characteristics.",
                pathway: "Gene → Enzyme Production → Catalytic Reaction → Trait Molecule",
                structure: "Enzymes have specific three-dimensional shapes with active sites that bind to particular molecules and catalyze specific reactions.",
                narration: "Meet an enzyme - the molecular worker that transforms genetic potential into biological reality! This is triosephosphate isomerase, a crucial enzyme in cellular metabolism, and it perfectly demonstrates how genes control traits through protein function. Enzymes are proteins with very specific shapes that allow them to speed up particular chemical reactions. The connection to heredity is profound: when you inherit a gene, you're really inheriting the instructions to make a specific enzyme or other protein. For example, if you have brown eyes, it's because you inherited genes that produce enzymes capable of making brown pigment molecules. If someone has blue eyes, they inherited slightly different versions of these genes that produce enzymes with altered function, resulting in different pigment production. The enzyme's shape is critical - even small changes in the protein structure can dramatically affect its function. This is why genetic mutations can have such powerful effects on traits. A single base change in DNA can alter one amino acid in the enzyme, potentially changing its shape and function. Some inherited diseases result from enzymes that don't work properly due to genetic variations. The beautiful precision of enzyme function shows how genetic information flows from DNA through proteins to create the incredible diversity of traits we see in living organisms!"
            },
            protein_structure: {
                title: "Protein Structure - The Final Expression",
                subtitle: "How protein shape determines trait function",
                icon: "🏗️",
                modelUrl: "https://sketchfab.com/3d-models/protein-structure-9f71a8c0c1ed4b0895631956d4ddaaa5/embed?autostart=1&internal=1&tracking=0&ui_ar=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "Protein structure determines function, making it the final step in the journey from genes to traits. The complex three-dimensional folding of proteins enables them to carry out the specific functions that create observable characteristics.",
                concepts: [
                    "Protein shape determines its function",
                    "Amino acid sequence controls folding",
                    "Structure-function relationship is crucial",
                    "Protein interactions create traits"
                ],
                funFact: "Proteins can fold into their complex 3D shapes in milliseconds, following instructions encoded in their amino acid sequence - it's like origami, but happening automatically at the molecular level!",
                objectives: "Understand how protein structure represents the final expression of genetic information and determines the traits we observe.",
                pathway: "Gene Sequence → Amino Acids → Protein Folding → Functional Trait",
                structure: "Proteins fold into complex three-dimensional structures with specific regions for binding, catalysis, and interaction with other molecules.",
                narration: "Witness the culmination of the genetic journey - protein structure! This complex, folded molecule represents the final expression of genetic information and the direct cause of inherited traits. The intricate three-dimensional shape you see isn't random - it's precisely determined by the sequence of amino acids, which in turn is specified by the gene's DNA sequence. This structure-function relationship is the key to understanding how genes control traits. Every fold, every curve, every pocket in this protein serves a specific purpose. The protein might be an enzyme that creates pigment molecules for eye color, a structural protein that determines hair texture, or a hormone that affects growth patterns. What's remarkable is that this complex structure forms automatically when the amino acids are assembled by ribosomes - the protein knows how to fold itself! This folding process is so precise that changing even one amino acid can dramatically alter the protein's shape and function, which is why genetic mutations can have such significant effects on traits. The protein structure also explains why both parents contribute equally to inheritance - offspring receive different versions of genes from each parent, producing proteins with potentially different structures and functions. The interaction between these different protein versions creates the unique combination of traits in each individual. This is the molecular explanation for Mendel's observations - traits are inherited because the information to build specific protein structures is passed from parents to offspring through DNA!"
            }
        };

        // Global Variables
        let currentStep = 'dna_structure';
        let voiceEnabled = true;
        let autoPlayEnabled = false;
        let currentSpeech = null;
        let selectedVoice = null;
        let journeyProgress = 0;
        let guidedTourActive = false;

        // Initialize Voice System
        function initVoiceSystem() {
            if (!('speechSynthesis' in window)) {
                console.warn('Speech synthesis not supported');
                voiceEnabled = false;
                document.getElementById('voiceToggle').style.display = 'none';
                return;
            }

            function loadVoices() {
                const voices = speechSynthesis.getVoices();
                if (voices.length === 0) return;

                const preferredVoices = [
                    'Google UK English Female',
                    'Microsoft Sonia',
                    'Microsoft Hazel',
                    'Samantha',
                    'Victoria'
                ];

                for (const name of preferredVoices) {
                    selectedVoice = voices.find(v => v.name.includes(name));
                    if (selectedVoice) break;
                }

                if (!selectedVoice) {
                    selectedVoice = voices.find(v => v.lang.startsWith('en'));
                }
            }

            loadVoices();
            if (speechSynthesis.onvoiceschanged !== undefined) {
                speechSynthesis.onvoiceschanged = loadVoices;
            }
        }

        // Load Journey Step
        function loadJourneyStep(stepId) {
            const stepData = JOURNEY_DATA[stepId];
            if (!stepData) return;

            currentStep = stepId;
            
            // Update model
            document.getElementById('api-frame').src = stepData.modelUrl;
            
            // Update info panel
            document.getElementById('stepIcon').textContent = stepData.icon;
            document.getElementById('stepTitle').textContent = stepData.title;
            document.getElementById('stepSubtitle').textContent = stepData.subtitle;
            document.getElementById('mainDescription').textContent = stepData.description;
            
            // Update key concepts
            const conceptsList = document.getElementById('keyConcepts');
            conceptsList.innerHTML = stepData.concepts.map(c => `<li>${c}</li>`).join('');
            
            // Update fun fact
            document.getElementById('funFact').textContent = stepData.funFact;
            
            // Update learning objectives
            document.getElementById('learningObjectives').textContent = stepData.objectives;
            
            // Update pathway display
            updatePathwayDisplay(stepData);
            
            // Update structure display
            updateStructureDisplay(stepData);
            
            // Update navigation buttons
            updateNavigationButtons(stepId);
            
            // Update progress
            updateProgress();
            
            // Play narration if enabled
            if (voiceEnabled) {
                speakText(stepData.narration);
            }
        }

        // Update Pathway Display
        function updatePathwayDisplay(stepData) {
            const pathwayDisplay = document.getElementById('pathwayDisplay');
            const pathwayFlow = pathwayDisplay.querySelector('.pathway-flow');
            
            // Update pathway based on current step
            const pathways = {
                'dna_structure': ['DNA', '→', 'Gene', '→', 'Protein', '→', 'Trait'],
                'chromosome_genes': ['Chromosome', '→', 'Gene Location', '→', 'Inheritance'],
                'cell_nucleus': ['Nucleus', '→', 'Gene Expression', '→', 'Cell Function'],
                'ribosome_protein': ['RNA', '→', 'Ribosome', '→', 'Protein', '→', 'Function'],
                'enzyme_function': ['Gene', '→', 'Enzyme', '→', 'Reaction', '→', 'Trait'],
                'protein_structure': ['Sequence', '→', 'Folding', '→', 'Structure', '→', 'Function']
            };
            
            const currentPathway = pathways[currentStep] || pathways['dna_structure'];
            pathwayFlow.innerHTML = '';
            
            currentPathway.forEach(item => {
                if (item === '→') {
                    const arrow = document.createElement('div');
                    arrow.className = 'pathway-arrow';
                    arrow.textContent = '→';
                    pathwayFlow.appendChild(arrow);
                } else {
                    const step = document.createElement('div');
                    step.className = 'pathway-step';
                    step.textContent = item;
                    pathwayFlow.appendChild(step);
                }
            });
        }

        // Update Structure Display
        function updateStructureDisplay(stepData) {
            const structureDisplay = document.getElementById('structureDisplay');
            structureDisplay.querySelector('.structure-content').textContent = stepData.structure;
        }

        // Update Navigation Buttons
        function updateNavigationButtons(activeStep) {
            const buttons = document.querySelectorAll('.journey-btn');
            const steps = ['dna_structure', 'chromosome_genes', 'cell_nucleus', 'ribosome_protein', 'enzyme_function', 'protein_structure'];
            const activeIndex = steps.indexOf(activeStep);
            
            buttons.forEach((btn, index) => {
                btn.classList.remove('active', 'completed');
                if (index < activeIndex) {
                    btn.classList.add('completed');
                } else if (index === activeIndex) {
                    btn.classList.add('active');
                }
            });
            
            // Update mini steps
            const miniSteps = document.querySelectorAll('.step-mini');
            miniSteps.forEach((step, index) => {
                step.classList.remove('active', 'completed');
                if (index < activeIndex) {
                    step.classList.add('completed');
                } else if (index === activeIndex) {
                    step.classList.add('active');
                }
            });
        }

        // Update Progress
        function updateProgress() {
            const steps = ['dna_structure', 'chromosome_genes', 'cell_nucleus', 'ribosome_protein', 'enzyme_function', 'protein_structure'];
            const currentIndex = steps.indexOf(currentStep);
            const progress = ((currentIndex + 1) / steps.length) * 100;
            
            document.getElementById('progressPercent').textContent = Math.round(progress) + '%';
            document.getElementById('progressFill').style.width = progress + '%';
        }

        // Speech Functions
        function speakText(text) {
            if (!voiceEnabled || !text) return;
            
            stopSpeech();
            
            currentSpeech = new SpeechSynthesisUtterance(text);
            if (selectedVoice) {
                currentSpeech.voice = selectedVoice;
            }
            currentSpeech.rate = 0.9;
            currentSpeech.pitch = 1.0;
            currentSpeech.volume = 0.9;
            
            currentSpeech.onstart = () => {
                document.getElementById('voiceIndicator').classList.add('visible');
                document.getElementById('narrationText').textContent = 
                    text.substring(0, 50) + (text.length > 50 ? '...' : '');
            };
            
            currentSpeech.onend = () => {
                document.getElementById('voiceIndicator').classList.remove('visible');
                currentSpeech = null;
                
                if (guidedTourActive) {
                    setTimeout(nextStep, 2000);
                }
            };
            
            speechSynthesis.speak(currentSpeech);
        }

        function stopSpeech() {
            if (currentSpeech) {
                speechSynthesis.cancel();
                currentSpeech = null;
                document.getElementById('voiceIndicator').classList.remove('visible');
            }
        }

        // Control Functions
        function toggleVoice() {
            voiceEnabled = !voiceEnabled;
            const btn = document.getElementById('voiceToggle');
            btn.textContent = voiceEnabled ? '🔊' : '🔇';
            btn.classList.toggle('active', voiceEnabled);
            
            if (!voiceEnabled) {
                stopSpeech();
            }
        }

        function toggleAutoPlay() {
            autoPlayEnabled = !autoPlayEnabled;
            if (autoPlayEnabled) {
                startGuidedTour();
            } else {
                guidedTourActive = false;
            }
        }

        function toggleInfo() {
            const panel = document.getElementById('infoPanel');
            panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
        }

        // Guided Tour
        function startGuidedTour() {
            guidedTourActive = true;
            const steps = ['dna_structure', 'chromosome_genes', 'cell_nucleus', 'ribosome_protein', 'enzyme_function', 'protein_structure'];
            let stepIndex = 0;
            
            function tourStep() {
                if (stepIndex < steps.length && guidedTourActive) {
                    loadJourneyStep(steps[stepIndex]);
                    stepIndex++;
                } else {
                    guidedTourActive = false;
                    if (voiceEnabled) {
                        speakText("Congratulations! You've completed your journey through the molecular basis of heredity. You now understand how DNA stores genetic information, how this information flows through genes to proteins, and how proteins create the traits we inherit. This molecular pathway explains how Mendel's abstract factors work at the deepest level of biology!");
                    }
                }
            }
            
            tourStep();
            window.nextStep = tourStep;
        }

        // Quiz Function
        function showQuiz() {
            const questions = [
                "How does DNA structure enable accurate inheritance?",
                "Why do both parents contribute equally to their offspring's traits?",
                "How do ribosomes convert genetic information into functional proteins?",
                "What role do enzymes play in expressing inherited traits?",
                "How does protein structure determine trait function?"
            ];
            
            const randomQ = questions[Math.floor(Math.random() * questions.length)];
            
            if (voiceEnabled) {
                speakText(`Here's a question to test your knowledge: ${randomQ} Think about what you've learned about the molecular basis of heredity!`);
            }
        }

        // Initialize
        function init() {
            initVoiceSystem();
            
            // Hide loading screen
            setTimeout(() => {
                const loading = document.getElementById('loadingOverlay');
                loading.style.opacity = '0';
                setTimeout(() => {
                    loading.style.display = 'none';
                    
                    // Welcome message
                    if (voiceEnabled) {
                        speakText("Welcome to the molecular world of heredity! We're about to explore how genes actually work at the deepest level - from DNA structure to protein function. You'll discover how genetic information flows from DNA to genes to proteins to traits, revealing the molecular mechanisms that make inheritance possible!");
                    }
                }, 1000);
            }, 3000);
            
            // Keyboard shortcuts
            document.addEventListener('keydown', (e) => {
                switch(e.key) {
                    case 'v': toggleVoice(); break;
                    case 'i': toggleInfo(); break;
                    case 'g': startGuidedTour(); break;
                    case 'Escape': stopSpeech(); guidedTourActive = false; break;
                    case 'ArrowRight': nextStep && nextStep(); break;
                }
            });
        }

        // Start the application
        init();
    </script>
</body>
</html>