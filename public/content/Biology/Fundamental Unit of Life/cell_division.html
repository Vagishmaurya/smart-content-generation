<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cell Division and Specialized Processes - Complete Cellular Journey</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tween.js/18.6.4/tween.umd.js"></script>

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #8e44ad 0%, #3498db 100%);
            color: white;
            overflow: hidden;
            position: relative;
            height: 100vh;
        }

        /* Animated Background */
        .bg-animation {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 0;
            opacity: 0.1;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320"><path fill="%23ffffff" fill-opacity="0.2" d="M0,96L48,112C96,128,192,160,288,186.7C384,213,480,235,576,213.3C672,192,768,128,864,128C960,128,1056,192,1152,197.3C1248,203,1344,149,1392,122.7L1440,96L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path></svg>') repeat-x;
            animation: wave 10s linear infinite;
        }

        @keyframes wave {
            0% { background-position-x: 0; }
            100% { background-position-x: 1440px; }
        }

        /* Museum Interface - Compact Header */
        .museum-header {
            position: absolute;
            top: 10px;
            left: 20px;
            text-align: left;
            z-index: 1000;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            padding: 10px 18px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        .museum-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 4px;
            background: linear-gradient(45deg, #8e44ad, #3498db);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: titleGlow 3s ease-in-out infinite;
        }

        @keyframes titleGlow {
            0%, 100% { filter: brightness(1); }
            50% { filter: brightness(1.2); }
        }

        .exhibit-subtitle {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.8);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .division-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: #8e44ad;
            border-radius: 50%;
            animation: divisionPulse 2s ease-in-out infinite;
        }

        @keyframes divisionPulse {
            0%, 100% { transform: scale(1) rotate(0deg); opacity: 1; }
            50% { transform: scale(1.4) rotate(180deg); opacity: 0.6; }
        }

        /* Journey Navigation - Enhanced */
        .journey-navigation {
            position: absolute;
            bottom: 20px;
            left: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 1000;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            padding: 15px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            max-width: 300px;
        }

        .journey-title {
            font-size: 14px;
            font-weight: 600;
            color: #3498db;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .journey-steps {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
        }

        .journey-btn {
            background: rgba(52, 152, 219, 0.2);
            border: 1px solid rgba(52, 152, 219, 0.4);
            color: white;
            padding: 6px 10px;
            border-radius: 20px;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 4px;
            white-space: nowrap;
        }

        .journey-btn:hover {
            background: rgba(52, 152, 219, 0.3);
            border-color: #3498db;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3);
        }

        .journey-btn.active {
            background: linear-gradient(135deg, #8e44ad, #9b59b6);
            border-color: #8e44ad;
            box-shadow: 0 0 20px rgba(142, 68, 173, 0.5);
            animation: divisionActive 2s infinite;
        }

        .journey-btn.completed {
            background: rgba(46, 204, 113, 0.3);
            border-color: #2ecc71;
        }

        @keyframes divisionActive {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* 3D Model Container */
        .model-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 0;
            overflow: hidden;
            border: none;
            z-index: 100;
        }

        .sketchfab-embed-wrapper {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #8e44ad 0%, #3498db 100%);
        }

        .sketchfab-embed-wrapper iframe {
            width: 100%;
            height: 100%;
            border: none;
            border-radius: 0;
        }

        /* Information Panel - Enhanced */
        .info-panel {
            position: absolute;
            top: 70px;
            right: 20px;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 16px;
            padding: 24px;
            width: 380px;
            max-height: calc(100vh - 140px);
            z-index: 800;
            overflow-y: auto;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }

        .info-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
        }

        .info-icon {
            font-size: 28px;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        .info-title {
            flex: 1;
        }

        .info-title h2 {
            font-size: 18px;
            color: #8e44ad;
            margin-bottom: 4px;
        }

        .info-subtitle {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
        }

        .info-content {
            color: rgba(255, 255, 255, 0.9);
            font-size: 14px;
            line-height: 1.6;
        }

        /* Progress Tracker */
        .progress-tracker {
            background: linear-gradient(135deg, rgba(52, 152, 219, 0.1), rgba(142, 68, 173, 0.1));
            border: 1px solid rgba(52, 152, 219, 0.3);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 20px;
        }

        .progress-header {
            font-size: 13px;
            font-weight: 600;
            color: #3498db;
            margin-bottom: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .progress-percentage {
            font-size: 18px;
            color: #8e44ad;
            font-weight: 700;
        }

        .progress-bar {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 12px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #3498db, #8e44ad);
            border-radius: 4px;
            transition: width 0.8s ease;
            box-shadow: 0 0 10px rgba(142, 68, 173, 0.5);
        }

        .progress-steps-mini {
            display: flex;
            justify-content: space-between;
            font-size: 9px;
            color: rgba(255, 255, 255, 0.6);
        }

        .step-mini {
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .step-mini.active {
            color: #8e44ad;
            font-weight: 600;
        }

        .step-mini.completed {
            color: #2ecc71;
        }

        /* Information Cards */
        .info-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 14px;
            margin-bottom: 14px;
        }

        .info-card-title {
            color: #3498db;
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .info-card-content {
            color: rgba(255, 255, 255, 0.85);
            font-size: 12px;
            line-height: 1.5;
        }

        .info-list {
            list-style: none;
            padding: 0;
        }

        .info-list li {
            padding: 6px 0;
            padding-left: 20px;
            position: relative;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.8);
        }

        .info-list li:before {
            content: "🔄";
            position: absolute;
            left: 0;
            color: #8e44ad;
        }

        /* Fun Fact Box */
        .fun-fact {
            background: linear-gradient(135deg, rgba(46, 204, 113, 0.1), rgba(142, 68, 173, 0.1));
            border: 1px solid rgba(46, 204, 113, 0.3);
            border-radius: 12px;
            padding: 14px;
            margin: 16px 0;
            position: relative;
            overflow: hidden;
        }

        .fun-fact:before {
            content: "🔬";
            position: absolute;
            top: -20px;
            right: -20px;
            font-size: 60px;
            opacity: 0.1;
        }

        .fun-fact-title {
            color: #2ecc71;
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 6px;
        }

        .fun-fact-text {
            color: rgba(255, 255, 255, 0.9);
            font-size: 12px;
            line-height: 1.5;
            position: relative;
            z-index: 1;
        }

        /* Voice Controls */
        .voice-controls {
            position: absolute;
            top: 10px;
            right: 20px;
            display: flex;
            gap: 8px;
            z-index: 1000;
        }

        .control-btn {
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            position: relative;
        }

        .control-btn:hover {
            background: rgba(142, 68, 173, 0.3);
            border-color: #8e44ad;
            transform: scale(1.1);
        }

        .control-btn.active {
            background: rgba(142, 68, 173, 0.4);
            border-color: #8e44ad;
            box-shadow: 0 0 20px rgba(142, 68, 173, 0.5);
        }

        .control-tooltip {
            position: absolute;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.9);
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 10px;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .control-btn:hover .control-tooltip {
            opacity: 1;
        }

        /* Loading Screen */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #8e44ad 0%, #3498db 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            transition: opacity 1s ease;
        }

        .loading-content {
            text-align: center;
        }

        .loading-division {
            font-size: 60px;
            animation: divisionSplit 3s ease-in-out infinite;
            margin-bottom: 20px;
        }

        @keyframes divisionSplit {
            0%, 100% { transform: scale(1) rotate(0deg); }
            25% { transform: scale(0.8) rotate(90deg); }
            50% { transform: scale(1.2) rotate(180deg); }
            75% { transform: scale(0.9) rotate(270deg); }
        }

        .loading-text {
            color: white;
            font-size: 20px;
            margin-bottom: 20px;
        }

        .loading-progress {
            width: 200px;
            height: 4px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 2px;
            overflow: hidden;
        }

        .loading-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #8e44ad, #3498db);
            animation: loading 2s ease-in-out infinite;
        }

        @keyframes loading {
            0% { width: 0%; }
            50% { width: 100%; }
            100% { width: 0%; }
        }

        /* Voice Indicator */
        .voice-indicator {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(142, 68, 173, 0.5);
            border-radius: 30px;
            padding: 14px 28px;
            display: flex;
            align-items: center;
            gap: 12px;
            z-index: 1000;
            opacity: 0;
            transition: all 0.3s ease;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }

        .voice-indicator.visible {
            opacity: 1;
            transform: translateX(-50%) translateY(-10px);
        }

        .voice-waves {
            display: flex;
            align-items: center;
            gap: 3px;
        }

        .voice-wave {
            width: 3px;
            height: 20px;
            background: linear-gradient(180deg, #8e44ad, #3498db);
            border-radius: 2px;
            animation: voice-wave 1s ease-in-out infinite;
        }

        .voice-wave:nth-child(2) { animation-delay: 0.1s; }
        .voice-wave:nth-child(3) { animation-delay: 0.2s; }
        .voice-wave:nth-child(4) { animation-delay: 0.3s; }
        .voice-wave:nth-child(5) { animation-delay: 0.4s; }

        @keyframes voice-wave {
            0%, 100% { transform: scaleY(0.3); }
            50% { transform: scaleY(1); }
        }

        .narration-text {
            color: white;
            font-size: 13px;
            max-width: 300px;
        }

        /* Quick Actions */
        .quick-actions {
            position: absolute;
            bottom: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
            z-index: 1000;
        }

        .action-btn {
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 10px 16px;
            border-radius: 25px;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
        }

        .action-btn:hover {
            background: rgba(52, 152, 219, 0.3);
            border-color: #3498db;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3);
        }

        /* Custom Scrollbar */
        .info-panel::-webkit-scrollbar {
            width: 6px;
        }

        .info-panel::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 3px;
        }

        .info-panel::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, #8e44ad, #3498db);
            border-radius: 3px;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .info-panel {
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                top: auto;
                width: 100%;
                max-height: 50vh;
                border-radius: 20px 20px 0 0;
            }
            
            .journey-navigation {
                bottom: 52vh;
                max-width: calc(100% - 40px);
            }
            
            .voice-controls {
                top: auto;
                bottom: 55vh;
                right: 10px;
            }
            
            .quick-actions {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="bg-animation"></div>

    <!-- Loading Screen -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="loading-division">🔄</div>
            <div class="loading-text">Preparing Your Division Journey...</div>
            <div class="loading-progress">
                <div class="loading-progress-bar"></div>
            </div>
        </div>
    </div>

    <!-- Museum Header -->
    <div class="museum-header">
        <div class="museum-title">Cell Division and Specialized Processes</div>
        <div class="exhibit-subtitle">
            <span class="division-indicator"></span>
            Growth, Reproduction, and Specialization
        </div>
    </div>

    <!-- Journey Navigation -->
    <div class="journey-navigation">
        <div class="journey-title">
            <span>🔄</span>
            <span>Your Division Journey</span>
        </div>
        <div class="journey-steps">
            <button class="journey-btn active" onclick="loadJourneyStep('overview')">
                <span>📖</span> Overview
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('mitosis')">
                <span>🔄</span> Mitosis
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('meiosis')">
                <span>🧬</span> Meiosis
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('hepatocyte')">
                <span>🔍</span> Liver Cell
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('membranes')">
                <span>🎭</span> Flexibility
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('integration')">
                <span>🌟</span> Integration
            </button>
        </div>
    </div>

    <!-- 3D Model Container -->
    <div class="model-container">
        <div class="sketchfab-embed-wrapper">
            <iframe id="api-frame"
                    title="Mitosis Animation Model" 
                    frameborder="0" 
                    allowfullscreen 
                    mozallowfullscreen="true" 
                    webkitallowfullscreen="true" 
                    allow="autoplay; fullscreen; xr-spatial-tracking"
                    xr-spatial-tracking 
                    execution-while-out-of-viewport 
                    execution-while-not-rendered 
                    web-share 
                    src="https://sketchfab.com/models/df93411c475c4e4eb450f71437b5ad0d/embed?autostart=1&internal=1&tracking=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0">
            </iframe>
        </div>
    </div>

    <!-- Information Panel -->
    <div class="info-panel" id="infoPanel">
        <div class="info-header">
            <div class="info-icon" id="stepIcon">📖</div>
            <div class="info-title">
                <h2 id="stepTitle">Cell Division - Life's Essential Process</h2>
                <div class="info-subtitle" id="stepSubtitle">Why cells must divide to survive</div>
            </div>
        </div>

        <!-- Progress Tracker -->
        <div class="progress-tracker">
            <div class="progress-header">
                <span>Journey Progress</span>
                <span class="progress-percentage" id="progressPercent">0%</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 0%"></div>
            </div>
            <div class="progress-steps-mini">
                <span class="step-mini active" onclick="loadJourneyStep('overview')">Overview</span>
                <span class="step-mini" onclick="loadJourneyStep('mitosis')">Mitosis</span>
                <span class="step-mini" onclick="loadJourneyStep('meiosis')">Meiosis</span>
                <span class="step-mini" onclick="loadJourneyStep('hepatocyte')">Liver Cell</span>
                <span class="step-mini" onclick="loadJourneyStep('membranes')">Flexibility</span>
                <span class="step-mini" onclick="loadJourneyStep('integration')">Integration</span>
            </div>
        </div>

        <div class="info-content" id="mainDescription">
            Cell division is one of life's most fundamental processes! Every living organism depends on the ability of cells to divide, creating new cells for growth, repair, and reproduction. From the moment you were conceived until now, trillions of cell divisions have shaped your body and kept you alive.
        </div>

        <div class="info-card">
            <div class="info-card-title">
                <span>🔬</span> Why Cells Divide
            </div>
            <div class="info-card-content">
                <ul class="info-list" id="keyConcepts">
                    <li>Growth - creating more cells to increase organism size</li>
                    <li>Repair - replacing damaged or dead cells</li>
                    <li>Reproduction - creating gametes for sexual reproduction</li>
                    <li>Surface area to volume ratio maintenance</li>
                </ul>
            </div>
        </div>

        <div class="fun-fact">
            <div class="fun-fact-title">Amazing Fact!</div>
            <div class="fun-fact-text" id="funFact">
                Your body performs about 25 million cell divisions every second! In just one day, you create more new cells than there are people on Earth.
            </div>
        </div>

        <div class="info-card">
            <div class="info-card-title">
                <span>🎯</span> Learning Objectives
            </div>
            <div class="info-card-content" id="learningObjectives">
                By exploring this section, you'll understand why cell division is essential for life and how different types serve different purposes.
            </div>
        </div>
    </div>

    <!-- Voice Controls -->
    <div class="voice-controls">
        <button class="control-btn active" id="voiceToggle" onclick="toggleVoice()">
            🔊
            <span class="control-tooltip">Voice Narration</span>
        </button>
        <button class="control-btn" onclick="toggleAutoPlay()">
            ▶️
            <span class="control-tooltip">Auto Journey</span>
        </button>
        <button class="control-btn" onclick="toggleInfo()">
            ℹ️
            <span class="control-tooltip">Toggle Info</span>
        </button>
    </div>

    <!-- Quick Actions -->
    <div class="quick-actions">
        <button class="action-btn" onclick="startGuidedTour()">
            <span>🚀</span> Guided Tour
        </button>
        <button class="action-btn" onclick="showQuiz()">
            <span>🎯</span> Test Knowledge
        </button>
    </div>

    <!-- Voice Indicator -->
    <div class="voice-indicator" id="voiceIndicator">
        <div class="voice-waves">
            <div class="voice-wave"></div>
            <div class="voice-wave"></div>
            <div class="voice-wave"></div>
            <div class="voice-wave"></div>
            <div class="voice-wave"></div>
        </div>
        <div class="narration-text" id="narrationText">Narrating...</div>
    </div>

    <script>
        // Journey Step Data with Complete Pedagogical Content
        const JOURNEY_DATA = {
            overview: {
                title: "Cell Division - Life's Essential Process",
                subtitle: "Why cells must divide to survive",
                icon: "📖",
                modelUrl: "https://sketchfab.com/models/df93411c475c4e4eb450f71437b5ad0d/embed?autostart=1&internal=1&tracking=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "Cell division is one of life's most fundamental processes! Every living organism depends on the ability of cells to divide, creating new cells for growth, repair, and reproduction. From the moment you were conceived until now, trillions of cell divisions have shaped your body and kept you alive.",
                concepts: [
                    "Growth - creating more cells to increase organism size",
                    "Repair - replacing damaged or dead cells", 
                    "Reproduction - creating gametes for sexual reproduction",
                    "Surface area to volume ratio maintenance"
                ],
                funFact: "Your body performs about 25 million cell divisions every second! In just one day, you create more new cells than there are people on Earth.",
                objectives: "By exploring this section, you'll understand why cell division is essential for life and how different types serve different purposes.",
                narration: "Welcome to the fascinating world of cell division - one of the most important processes in all of biology! Every moment of your life, millions of your cells are dividing to keep you healthy, growing, and alive. Cell division isn't just about making more cells; it's about survival. As cells grow larger, their surface area to volume ratio becomes problematic - they can't efficiently exchange materials with their environment. Division solves this by creating smaller, more efficient cells. There are two main types of cell division: mitosis, which creates identical diploid cells for growth and repair, and meiosis, which creates genetically diverse haploid gametes for reproduction. But cell division is more than just splitting - it requires precise duplication of genetic material, careful distribution of organelles, and perfect coordination of countless molecular processes. The cell cycle is tightly regulated because errors can lead to cancer or cell death. Let's explore this incredible process that has been shaping life for billions of years!"
            },
            mitosis: {
                title: "Mitosis - Growth and Repair",
                subtitle: "Creating identical daughter cells",
                icon: "🔄",
                modelUrl: "https://sketchfab.com/models/df93411c475c4e4eb450f71437b5ad0d/embed?autostart=1&internal=1&tracking=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "Mitosis is the cellular process that creates two identical daughter cells from one parent cell. This precisely choreographed dance ensures that each new cell receives an exact copy of the parent's genetic material, making it essential for growth, development, and tissue repair.",
                concepts: [
                    "Prophase - chromosomes condense and nuclear envelope breaks down",
                    "Metaphase - chromosomes align at cell center",
                    "Anaphase - sister chromatids separate and move to poles",
                    "Telophase - nuclear envelopes reform around chromosome sets"
                ],
                funFact: "The entire mitosis process takes only 1-2 hours, but the cell spends 90% of its life in interphase preparing for this brief but crucial event!",
                objectives: "Learn how mitosis ensures each daughter cell receives identical genetic information and understand its role in growth and repair.",
                narration: "Watch mitosis in action - nature's most precise copying process! This animation shows the intricate steps that ensure perfect genetic replication. It begins in prophase, where the loosely organized chromatin condenses into visible chromosomes, each consisting of two sister chromatids held together at the centromere. The nuclear envelope breaks down, and the mitotic spindle begins to form from the centrosomes. In metaphase, all chromosomes align perfectly at the cell's equator, forming the metaphase plate. This alignment is crucial - the cell won't proceed until every chromosome is properly attached to spindle fibers from both poles. Anaphase is the moment of separation, where sister chromatids are pulled apart and move to opposite poles of the cell. Finally, in telophase, new nuclear envelopes form around each set of chromosomes, which begin to decondense. The result? Two daughter cells with identical genetic information. This process is so important that multiple checkpoints exist to prevent errors that could lead to cancer or cell death."
            },
            meiosis: {
                title: "Meiosis - Creating Genetic Diversity",
                subtitle: "Gamete formation and reproduction",
                icon: "🧬",
                modelUrl: "https://sketchfab.com/models/1772cb63102b4f1c9ff5e607643cde83/embed?autostart=1&internal=1&tracking=0&ui_ar=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "Meiosis is the specialized cell division that creates gametes (sex cells) for sexual reproduction. Unlike mitosis, meiosis involves two sequential divisions that reduce chromosome number by half and generate genetic diversity through crossing over and independent assortment.",
                concepts: [
                    "Two sequential divisions (meiosis I and II)",
                    "Reduces chromosome number from diploid to haploid",
                    "Crossing over creates genetic recombination",
                    "Independent assortment increases genetic diversity"
                ],
                funFact: "Meiosis can produce over 8 million genetically different gametes from a single human due to crossing over and independent assortment - and that's before fertilization adds even more variation!",
                objectives: "Understand how meiosis creates genetic diversity and why sexual reproduction requires specialized cell division.",
                narration: "Welcome to meiosis - the cellular process that makes sexual reproduction possible and creates the genetic diversity that drives evolution! Unlike mitosis, meiosis consists of two consecutive divisions that transform one diploid cell into four haploid gametes. The first division, meiosis I, is where the magic happens. During prophase I, homologous chromosomes pair up in a process called synapsis, forming structures called bivalents. This is when crossing over occurs - homologous chromosomes exchange genetic material, creating new combinations of genes. During metaphase I, these paired chromosomes align at the cell center, but their orientation is random - this independent assortment creates additional genetic variation. In anaphase I, entire chromosomes (not sister chromatids) move to opposite poles, reducing the chromosome number by half. Meiosis II resembles mitosis, separating sister chromatids to produce four haploid gametes, each genetically unique. This process is essential for sexual reproduction and explains why siblings aren't identical copies of each other!"
            },
            hepatocyte: {
                title: "Hepatocyte - The Liver's Specialist",
                subtitle: "Detoxification and specialized functions",
                icon: "🔍",
                modelUrl: "https://sketchfab.com/models/bdc08e44201b4b77bf4030609256d739/embed?autostart=1&internal=1&tracking=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "Hepatocytes are the liver's specialized workhorses, performing over 500 different functions including detoxification, protein synthesis, and metabolism. These cells showcase how specialized structures enable specialized functions, particularly through extensive smooth endoplasmic reticulum.",
                concepts: [
                    "Extensive smooth ER for detoxification",
                    "Multiple nuclei from incomplete cell division",
                    "Peroxisomes for breaking down fatty acids",
                    "Specialized metabolism and storage functions"
                ],
                funFact: "Liver cells can regenerate so effectively that you can lose 75% of your liver and it will grow back to full size within a few months!",
                objectives: "Explore how cellular specialization creates cells adapted for specific functions and understand the liver's crucial detoxification role.",
                narration: "Meet the hepatocyte - one of your body's most versatile and hardworking cells! These liver cells are true cellular multitaskers, performing over 500 different functions that keep you alive. What makes hepatocytes special is their incredible specialization. Notice the extensive smooth endoplasmic reticulum - this organelle can occupy up to 60% of the cell's volume in liver cells, compared to just a few percent in most other cells. This massive smooth ER is packed with enzymes that detoxify alcohol, drugs, and metabolic waste products. Hepatocytes also have unusual features like multiple nuclei, often resulting from incomplete cell division that allows the cell to grow larger and more metabolically active. The cytoplasm is filled with peroxisomes that break down fatty acids and neutralize harmful hydrogen peroxide. These cells store glycogen for energy, synthesize most of your blood proteins including albumin and clotting factors, and produce bile for fat digestion. The liver's amazing regenerative ability comes from hepatocytes' capacity to rapidly divide when needed - it's the only organ that can completely regenerate from just 25% of its original mass!"
            },
            membranes: {
                title: "Membrane Flexibility - Cellular Adaptability",
                subtitle: "How membranes enable cellular activities",
                icon: "🎭",
                modelUrl: "https://sketchfab.com/models/bdc08e44201b4b77bf4030609256d739/embed?autostart=1&internal=1&tracking=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "Cell membranes are remarkably flexible structures that enable countless cellular activities. From cell division to endocytosis, membrane flexibility allows cells to change shape, engulf materials, and reorganize their internal structure while maintaining integrity.",
                concepts: [
                    "Fluid mosaic model allows membrane flexibility",
                    "Enables cell division and organelle formation",
                    "Facilitates endocytosis and exocytosis",
                    "Membrane fusion and fission processes"
                ],
                funFact: "Cell membranes are so flexible that they can stretch up to 3% of their original size without breaking, and they can reseal themselves within seconds if punctured!",
                objectives: "Understand how membrane properties enable dynamic cellular processes and support specialized cellular functions.",
                narration: "Discover the remarkable flexibility of cell membranes - the unsung heroes that make cellular life possible! Membranes aren't rigid barriers, but dynamic, fluid structures that constantly adapt to cellular needs. The fluid mosaic model describes membranes as a sea of phospholipids with embedded proteins that can move laterally, giving membranes their crucial flexibility. This flexibility enables fundamental processes like cell division - imagine trying to split a cell with a rigid shell! During cytokinesis, the cell membrane must pinch inward and eventually separate to create two daughter cells. Membrane flexibility also enables endocytosis, where cells engulf materials by wrapping membrane around them, and exocytosis, where vesicles fuse with the cell membrane to release contents. The temperature and cholesterol content affect membrane fluidity - too rigid and cellular processes fail, too fluid and the membrane loses integrity. Specialized cells modify their membrane composition for specific functions: nerve cells have membranes optimized for electrical signaling, while liver cells have membranes rich in enzymes for detoxification. This membrane flexibility is essential for everything from muscle contraction to neurotransmitter release!"
            },
            integration: {
                title: "Integration - The Dance of Life",
                subtitle: "How division and specialization work together",
                icon: "🌟",
                modelUrl: "https://sketchfab.com/models/df93411c475c4e4eb450f71437b5ad0d/embed?autostart=1&internal=1&tracking=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "Cell division and specialization work together in the magnificent symphony of life. From a single fertilized egg, precise patterns of division and differentiation create the incredible diversity of specialized cells that make complex multicellular organisms possible.",
                concepts: [
                    "Development requires both division and differentiation",
                    "Stem cells balance self-renewal and specialization",
                    "Tissue maintenance through controlled division",
                    "Regeneration combines division with specialization"
                ],
                funFact: "Your body contains over 200 different types of specialized cells, all derived from a single fertilized egg through the coordinated processes of division and differentiation!",
                objectives: "Synthesize understanding of how cell division and specialization work together to create and maintain complex multicellular life.",
                narration: "Welcome to the grand finale - understanding how cell division and specialization work together to create the miracle of multicellular life! It all begins with a single fertilized egg that undergoes rapid mitotic divisions to create a ball of identical cells. But then something extraordinary happens - these cells begin to specialize through a process called differentiation. Some become nerve cells with long axons, others become muscle cells with contractile proteins, and still others become hepatocytes with extensive detoxification machinery. This specialization is controlled by turning different genes on and off, even though all cells have the same DNA. Throughout your life, this dance continues. Stem cells maintain the ability to both divide and differentiate, replacing worn-out specialized cells. When you cut yourself, skin cells divide rapidly to close the wound, then differentiate to restore the skin's barrier function. In your intestines, cells divide every few days and differentiate as they migrate up the villi. Even in your liver, hepatocytes can dedifferentiate back to a more stem-like state to enable regeneration after injury. This integration of division and specialization is what allows a single cell to become a complex organism with trillions of cells working in perfect harmony!"
            }
        };

        // Global Variables
        let currentStep = 'overview';
        let voiceEnabled = true;
        let autoPlayEnabled = false;
        let currentSpeech = null;
        let selectedVoice = null;
        let journeyProgress = 0;
        let guidedTourActive = false;

        // Initialize Voice System
        function initVoiceSystem() {
            if (!('speechSynthesis' in window)) {
                console.warn('Speech synthesis not supported');
                voiceEnabled = false;
                document.getElementById('voiceToggle').style.display = 'none';
                return;
            }

            function loadVoices() {
                const voices = speechSynthesis.getVoices();
                if (voices.length === 0) return;

                // Prefer natural-sounding voices
                const preferredVoices = [
                    'Google UK English Female',
                    'Microsoft Sonia',
                    'Microsoft Hazel',
                    'Samantha',
                    'Victoria'
                ];

                for (const name of preferredVoices) {
                    selectedVoice = voices.find(v => v.name.includes(name));
                    if (selectedVoice) break;
                }

                if (!selectedVoice) {
                    selectedVoice = voices.find(v => v.lang.startsWith('en'));
                }
            }

            loadVoices();
            if (speechSynthesis.onvoiceschanged !== undefined) {
                speechSynthesis.onvoiceschanged = loadVoices;
            }
        }

        // Load Journey Step
        function loadJourneyStep(stepId) {
            const stepData = JOURNEY_DATA[stepId];
            if (!stepData) return;

            currentStep = stepId;
            
            // Update model
            document.getElementById('api-frame').src = stepData.modelUrl;
            
            // Update info panel
            document.getElementById('stepIcon').textContent = stepData.icon;
            document.getElementById('stepTitle').textContent = stepData.title;
            document.getElementById('stepSubtitle').textContent = stepData.subtitle;
            document.getElementById('mainDescription').textContent = stepData.description;
            
            // Update key concepts
            const conceptsList = document.getElementById('keyConcepts');
            conceptsList.innerHTML = stepData.concepts.map(c => `<li>${c}</li>`).join('');
            
            // Update fun fact
            document.getElementById('funFact').textContent = stepData.funFact;
            
            // Update learning objectives
            document.getElementById('learningObjectives').textContent = stepData.objectives;
            
            // Update navigation buttons
            updateNavigationButtons(stepId);
            
            // Update progress
            updateProgress();
            
            // Play narration if enabled
            if (voiceEnabled) {
                speakText(stepData.narration);
            }
        }

        // Update Navigation Buttons
        function updateNavigationButtons(activeStep) {
            const buttons = document.querySelectorAll('.journey-btn');
            const steps = ['overview', 'mitosis', 'meiosis', 'hepatocyte', 'membranes', 'integration'];
            const activeIndex = steps.indexOf(activeStep);
            
            buttons.forEach((btn, index) => {
                btn.classList.remove('active', 'completed');
                if (index < activeIndex) {
                    btn.classList.add('completed');
                } else if (index === activeIndex) {
                    btn.classList.add('active');
                }
            });
            
            // Update mini steps
            const miniSteps = document.querySelectorAll('.step-mini');
            miniSteps.forEach((step, index) => {
                step.classList.remove('active', 'completed');
                if (index < activeIndex) {
                    step.classList.add('completed');
                } else if (index === activeIndex) {
                    step.classList.add('active');
                }
            });
        }

        // Update Progress
        function updateProgress() {
            const steps = ['overview', 'mitosis', 'meiosis', 'hepatocyte', 'membranes', 'integration'];
            const currentIndex = steps.indexOf(currentStep);
            const progress = ((currentIndex + 1) / steps.length) * 100;
            
            document.getElementById('progressPercent').textContent = Math.round(progress) + '%';
            document.getElementById('progressFill').style.width = progress + '%';
        }

        // Speech Functions
        function speakText(text) {
            if (!voiceEnabled || !text) return;
            
            stopSpeech();
            
            currentSpeech = new SpeechSynthesisUtterance(text);
            if (selectedVoice) {
                currentSpeech.voice = selectedVoice;
            }
            currentSpeech.rate = 0.9;
            currentSpeech.pitch = 1.0;
            currentSpeech.volume = 0.9;
            
            currentSpeech.onstart = () => {
                document.getElementById('voiceIndicator').classList.add('visible');
                document.getElementById('narrationText').textContent = 
                    text.substring(0, 50) + (text.length > 50 ? '...' : '');
            };
            
            currentSpeech.onend = () => {
                document.getElementById('voiceIndicator').classList.remove('visible');
                currentSpeech = null;
                
                // Auto-advance if guided tour is active
                if (guidedTourActive) {
                    setTimeout(nextStep, 2000);
                }
            };
            
            speechSynthesis.speak(currentSpeech);
        }

        function stopSpeech() {
            if (currentSpeech) {
                speechSynthesis.cancel();
                currentSpeech = null;
                document.getElementById('voiceIndicator').classList.remove('visible');
            }
        }

        // Control Functions
        function toggleVoice() {
            voiceEnabled = !voiceEnabled;
            const btn = document.getElementById('voiceToggle');
            btn.textContent = voiceEnabled ? '🔊' : '🔇';
            btn.classList.toggle('active', voiceEnabled);
            
            if (!voiceEnabled) {
                stopSpeech();
            }
        }

        function toggleAutoPlay() {
            autoPlayEnabled = !autoPlayEnabled;
            if (autoPlayEnabled) {
                startGuidedTour();
            } else {
                guidedTourActive = false;
            }
        }

        function toggleInfo() {
            const panel = document.getElementById('infoPanel');
            panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
        }

        // Guided Tour
        function startGuidedTour() {
            guidedTourActive = true;
            const steps = ['overview', 'mitosis', 'meiosis', 'hepatocyte', 'membranes', 'integration'];
            let stepIndex = 0;
            
            function tourStep() {
                if (stepIndex < steps.length && guidedTourActive) {
                    loadJourneyStep(steps[stepIndex]);
                    stepIndex++;
                } else {
                    guidedTourActive = false;
                    if (voiceEnabled) {
                        speakText("Congratulations! You've completed your journey through cell division and specialized processes. You now understand how cells divide, differentiate, and work together to create complex life!");
                    }
                }
            }
            
            tourStep();
            window.nextStep = tourStep;
        }

        // Quiz Function
        function showQuiz() {
            const questions = [
                "What's the difference between mitosis and meiosis?",
                "Why do cells need to divide regularly?",
                "How do hepatocytes specialize for detoxification?",
                "What makes cell membranes flexible?",
                "How do division and specialization work together?"
            ];
            
            const randomQ = questions[Math.floor(Math.random() * questions.length)];
            
            if (voiceEnabled) {
                speakText(`Here's a question to test your knowledge: ${randomQ} Think about what you've learned in this division journey!`);
            }
        }

        // Initialize
        function init() {
            initVoiceSystem();
            
            // Hide loading screen
            setTimeout(() => {
                const loading = document.getElementById('loadingOverlay');
                loading.style.opacity = '0';
                setTimeout(() => {
                    loading.style.display = 'none';
                    
                    // Welcome message
                    if (voiceEnabled) {
                        speakText("Welcome to your journey through cell division and specialized processes! We'll explore how cells multiply, differentiate, and develop the specialized functions that make complex life possible. Let's start with understanding why cell division is so essential for life!");
                    }
                }, 1000);
            }, 3000);
            
            // Keyboard shortcuts
            document.addEventListener('keydown', (e) => {
                switch(e.key) {
                    case 'v': toggleVoice(); break;
                    case 'i': toggleInfo(); break;
                    case 'g': startGuidedTour(); break;
                    case 'Escape': stopSpeech(); guidedTourActive = false; break;
                    case 'ArrowRight': nextStep && nextStep(); break;
                }
            });
        }

        // Start the application
        init();
    </script>
</body>
</html>