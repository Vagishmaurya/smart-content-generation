<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Sound of Music - Interactive English Lesson</title>
    <link rel="stylesheet" href="css/styles.css">
    <meta name="description" content="Interactive English lesson based on 'The Sound of Music' from Beehive Class 9">
</head>
<body>
    <!-- Navigation -->
    <nav class="nav-menu" role="navigation" aria-label="Main navigation">
        <div class="nav-items">
            <button class="nav-item active" onclick="showModule('intro')" data-module="intro" aria-pressed="true">📚 Introduction</button>
            <button class="nav-item" onclick="showModule('prereading')" data-module="prereading" aria-pressed="false">📝 Let's Begin</button>
            <button class="nav-item" onclick="showModule('story')" data-module="story" aria-pressed="false">📖 The Story</button>
            <button class="nav-item" onclick="showModule('poem')" data-module="poem" aria-pressed="false">🎭 The Poem</button>
            <button class="nav-item" onclick="showModule('thinking-text')" data-module="thinking-text" aria-pressed="false">❓ Reading Comprehension</button>
            <button class="nav-item" onclick="showModule('thinking-language')" data-module="thinking-language" aria-pressed="false">🔤 Vocabulary & Grammar</button>
        </div>
    </nav>

    <!-- Audio Control -->
    <div class="audio-control">
        <button id="audioBtn" class="audio-btn" onclick="toggleAudio(); trackUserInteraction();" aria-label="Toggle audio narration">🔊</button>
    </div>

    <!-- Achievement Popup -->
    <div id="achievementPopup" class="achievement-popup" aria-live="polite">
        <div class="achievement-title">🏆 Achievement Unlocked!</div>
        <div class="achievement-desc" id="achievementDesc">You've completed a module!</div>
    </div>

    <div class="container">
        <!-- Header -->
        <header class="header">
            <h1 class="title">📚 The Sound of Music</h1>
            <p class="subtitle">Beehive - Class IX</p>
            <p class="reprint">Reprint 2025-26</p>
        </header>

        <!-- Progress Tracker -->
        <div class="progress-container">
            <div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
                <div class="progress-fill" id="progressBar">0%</div>
            </div>
            <div class="progress-stats">
                <span>📖 Modules: <span id="modulesComplete">0</span>/6</span>
                <span>⭐ Score: <span id="totalScore">0</span></span>
                <span>⏱️ Time: <span id="timeSpent">0:00</span></span>
            </div>
        </div>

        <!-- Introduction Module -->
        <div class="module active" id="intro">
            <div class="exercise-card">
                <h2 class="exercise-title">
                    <span class="exercise-icon">🌟</span>
                    Welcome to "The Sound of Music"
                </h2>
                <div class="content-block">
                    <p>This chapter consists of two parts. Part I is about Evelyn Glennie, a multi-percussionist who overcame the challenge of being profoundly deaf to become one of the world's most accomplished musicians. Part II is about another musician, Ustad Bismillah Khan, a shehnai maestro.</p>
                    <p>Through these two accounts, we'll explore how music transcends barriers, how dedicated individuals pursue their passion against all odds, and how music remains an integral part of our cultural heritage.</p>
                </div>
                <div class="button-container">
                    <button class="interactive-btn" onclick="startJourney()" aria-label="Begin the lesson">
                        🚀 Start Your Learning Journey
                    </button>
                </div>
            </div>
        </div>

        <!-- Let's Begin Module -->
        <div class="module" id="prereading">
            <div class="exercise-card">
                <h2 class="exercise-title">
                    <span class="exercise-icon">📝</span>
                    Let's Begin
                </h2>
                <div class="content-block">
                    <p>"God may have taken her hearing but he has given her back something extraordinary. What we hear, she feels — far more deeply than any of us. That is why she expresses music so beautifully."</p>
                    <p>In this chapter, you will read about a person who fought against a physical disability and made her life a success story.</p>
                </div>
                
                <h3 class="activity-title">Pre-Reading Activity: Overcoming Challenges</h3>
                <div class="content-block">
                    <p>Think about people who have overcome significant challenges in their lives. What qualities do you think help them succeed despite their difficulties?</p>
                    <p>Have you ever faced a challenge that seemed insurmountable at first? How did you approach it? What did you learn from the experience?</p>
                </div>
                
                <div class="reflection-exercise">
                    <textarea id="reflectionText" rows="5" placeholder="Write your reflection here..."></textarea>
                    <button class="interactive-btn" onclick="saveReflection()">
                        Save Reflection
                    </button>
                    <div id="reflectionFeedback" class="feedback-message" aria-live="polite"></div>
                </div>
            </div>
        </div>

        <!-- Story Module -->
        <div class="module" id="story">
            <div class="story-reader">
                <h2 class="section-title">THE SOUND OF MUSIC</h2>
                
                <div class="story-controls">
                    <button class="reading-mode-btn" onclick="toggleReadAloud()" aria-label="Read the text aloud">
                        🔊 Read Aloud
                    </button>
                    <button class="reading-mode-btn" onclick="highlightVocabulary()" aria-label="Highlight vocabulary words">
                        ✨ Highlight Vocabulary
                    </button>
                    <button class="reading-mode-btn" onclick="togglePrintMode()" aria-label="Toggle print-friendly mode">
                        🖨️ Print Mode
                    </button>
                </div>
                
                <div class="story-content" id="storyContent">
                    <!-- Story content will be loaded dynamically via JavaScript -->
                </div>
            </div>
        </div>

        <!-- Poem Module -->
        <div class="module" id="poem">
            <div class="story-reader">
                <h2 class="section-title">WIND</h2>
                
                <div class="story-controls">
                    <button class="reading-mode-btn" onclick="readPoemAloud()" aria-label="Read the poem aloud">
                        🔊 Read Aloud
                    </button>
                    <button class="reading-mode-btn" onclick="highlightPoemVocabulary()" aria-label="Highlight vocabulary words">
                        ✨ Highlight Vocabulary
                    </button>
                    <button class="reading-mode-btn" onclick="togglePrintMode()" aria-label="Toggle print-friendly mode">
                        🖨️ Print Mode
                    </button>
                </div>
                
                <div class="poem-content" id="poemContent">
                    <!-- Poem content will be loaded dynamically via JavaScript -->
                </div>
            </div>
        </div>

        <!-- Reading Comprehension Module -->
        <div class="module" id="thinking-text">
            <div class="exercise-card">
                <h2 class="exercise-title">
                    <span class="exercise-icon">❓</span>
                    Reading Comprehension Questions
                </h2>
                
                <div class="story-navigation">
                    <button class="story-nav-btn active" onclick="showQuestionSet('story-questions')" aria-pressed="true">Story Questions</button>
                    <button class="story-nav-btn" onclick="showQuestionSet('poem-questions')" aria-pressed="false">Poem Questions</button>
                </div>
                
                <div id="textQuestions" class="question-section">
                    <!-- Questions will be loaded dynamically -->
                </div>
            </div>
        </div>

        <!-- Vocabulary & Grammar Module -->
        <div class="module" id="thinking-language">
            <div class="exercise-card">
                <h2 class="exercise-title">
                    <span class="exercise-icon">🔍</span>
                    Working with Words
                </h2>
                <div class="content-block">
                    <p>Look at these sentences from the text:</p>
                    <blockquote>• "I have just got to work..." said Evelyn.</blockquote>
                    <blockquote>• She has brought percussion to the front of the orchestra.</blockquote>
                    <p>The verb <strong>get</strong> is used in many different ways. Similarly, the verb <strong>bring</strong> can be used in various contexts with different meanings.</p>
                </div>
                
                <div class="vocabulary-exercise">
                    <h3>Match the verbs with their meanings:</h3>
                    <div class="vocab-question">
                        <p>1. "I got sick last night." <select id="vocab1">
                            <option value="">Select</option>
                            <option value="became">became</option>
                            <option value="received">received</option>
                            <option value="understood">understood</option>
                            <option value="achieved">achieved</option>
                        </select></p>
                    </div>
                    <div class="vocab-question">
                        <p>2. "She got a letter from her friend." <select id="vocab2">
                            <option value="">Select</option>
                            <option value="became">became</option>
                            <option value="received">received</option>
                            <option value="understood">understood</option>
                            <option value="achieved">achieved</option>
                        </select></p>
                    </div>
                    <div class="vocab-question">
                        <p>3. "I finally got the answer." <select id="vocab3">
                            <option value="">Select</option>
                            <option value="became">became</option>
                            <option value="received">received</option>
                            <option value="understood">understood</option>
                            <option value="achieved">achieved</option>
                        </select></p>
                    </div>
                    <div class="vocab-question">
                        <p>4. "She got what she wanted." <select id="vocab4">
                            <option value="">Select</option>
                            <option value="became">became</option>
                            <option value="received">received</option>
                            <option value="understood">understood</option>
                            <option value="achieved">achieved</option>
                        </select></p>
                    </div>
                    <button class="interactive-btn" id="checkVocabBtn">Check Answers</button>
                    <script>
                        document.getElementById('checkVocabBtn').addEventListener('click', function() {
                            console.log('Button clicked');
                            if (typeof window.checkVocabulary === 'function') {
                                console.log('Function exists, calling it');
                                window.checkVocabulary();
                            } else {
                                console.error('checkVocabulary is not defined');
                                alert('Function not available. Please check console for details.');
                            }
                        });
                    </script>
                    <div id="vocabFeedback" class="feedback-message" aria-live="polite"></div>
                </div>
            </div>

            <div class="exercise-card">
                <h2 class="exercise-title">
                    <span class="exercise-icon">📚</span>
                    Dictionary Work
                </h2>
                <div class="content-block">
                    <p>The adjective <strong>auspicious</strong> can occur after the verb be as in:</p>
                    <blockquote>The sound of the shehnai is auspicious.</blockquote>
                    <p>It can also occur before a noun as in:</p>
                    <blockquote>The auspicious sound of the shehnai is usually heard at marriages.</blockquote>
                    <p>But there are some adjectives that can be used after the verb be and not before a noun.</p>
                </div>
                
                <div class="matching-game">
                    <h3>Adjective Position: Type one of these exact answers:</h3>
                    <div style="margin-bottom: 15px; padding: 10px; background-color: #f9f9f9; border-radius: 5px;">
                        <ul style="list-style-type: none; padding-left: 0; margin: 0;">
                            <li><strong>"only before noun"</strong> - Can only appear before a noun (e.g., "an outdoor cafe")</li>
                            <li><strong>"not before noun"</strong> - Can only appear after the verb "be" (e.g., "She is afraid")</li>
                            <li><strong>"both positions"</strong> - Can appear in either position</li>
                        </ul>
                    </div>
                    
                    <div class="contraction-item">
                        <p>1. impressed: <input type="text" class="contraction-input" data-answer="not before noun" placeholder="Type answer here"></p>
                    </div>
                    <div class="contraction-item">
                        <p>2. afraid: <input type="text" class="contraction-input" data-answer="not before noun" placeholder="Type answer here"></p>
                    </div>
                    <div class="contraction-item">
                        <p>3. outdoor: <input type="text" class="contraction-input" data-answer="only before noun" placeholder="Type answer here"></p>
                    </div>
                    <div class="contraction-item">
                        <p>4. paternal: <input type="text" class="contraction-input" data-answer="only before noun" placeholder="Type answer here"></p>
                    </div>
                    <div class="contraction-item">
                        <p>5. countless: <input type="text" class="contraction-input" data-answer="only before noun" placeholder="Type answer here"></p>
                    </div>
                    
                    <button class="interactive-btn" onclick="checkAdjectiveUse()">Check Answers</button>
                    <div id="adjectivesFeedback" class="feedback-message" aria-live="polite"></div>
                </div>
            </div>
        </div>
    </div>

    <footer>
        <p>&copy; 2025 Interactive English Lesson - The Sound of Music</p>
    </footer>

    <script>
        // Define vocabulary answers and check function directly in HTML to ensure availability
        const vocabAnswers = {
            vocab1: 'became',
            vocab2: 'received',
            vocab3: 'understood',
            vocab4: 'achieved'
        };
        
        function checkVocabulary() {
            console.log("checkVocabulary function called from inline script");
            let correctCount = 0;
            let total = Object.keys(vocabAnswers).length;
            
            // Check each answer
            for (let id in vocabAnswers) {
                const select = document.getElementById(id);
                if (select && select.value === vocabAnswers[id]) {
                    correctCount++;
                    select.style.borderColor = '#4caf50';
                } else if (select) {
                    select.style.borderColor = '#f44336';
                }
            }
            
            // Show feedback
            const feedback = document.getElementById('vocabFeedback');
            if (feedback) {
                if (correctCount === total) {
                    feedback.textContent = 'Excellent! All answers are correct!';
                    feedback.className = 'feedback-message success show';
                    if (typeof updateScore === 'function') updateScore(10);
                } else {
                    feedback.textContent = `You got ${correctCount} out of ${total} correct. Try again!`;
                    feedback.className = 'feedback-message error show';
                }
            }
        }
    </script>
    <script src="js/activities.js"></script>
    <script src="js/main.js"></script>
    <script src="js/the-sound-of-music-story.js"></script>
    <script src="js/the-sound-of-music-story-part2.js"></script>
    <script src="js/the-sound-of-music-story-part3.js"></script>
    <script src="js/the-sound-of-music-story-part4.js"></script>
    <script src="js/the-sound-of-music-story-loader.js"></script>
    <script src="js/questions.js"></script>
</body>
</html>
