<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Describing Motion - Physics in Motion</title>
    <!-- GSAP for animations -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            color: white;
            overflow-x: hidden;
            min-height: 100vh;
        }

        /* Audio Control */
        #audio-control {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }

        .control-btn {
            background: rgba(16, 185, 129, 0.9);
            border: none;
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .control-btn:hover {
            transform: scale(1.1);
            background: rgba(16, 185, 129, 1);
        }

        .control-btn.muted .unmute-icon { display: none; }
        .control-btn:not(.muted) .mute-icon { display: none; }

        /* Main Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 30px 20px;
        }

        /* Header */
        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .header h1 {
            font-size: 3rem;
            background: linear-gradient(45deg, #10b981, #34d399, #6ee7b7);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.95;
            max-width: 800px;
            margin: 0 auto;
            line-height: 1.6;
        }

        /* Demo Stage */
        .demo-stage {
            background: linear-gradient(to bottom, #1e293b, #334155, #475569);
            border-radius: 25px;
            min-height: 500px;
            position: relative;
            margin: 40px 0;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5);
            overflow: hidden;
            border: 3px solid rgba(16, 185, 129, 0.4);
            padding: 40px;
        }

        /* Reference Point Demo */
        .reference-demo {
            display: none;
            position: relative;
            width: 100%;
            height: 500px;
        }

        .reference-demo.active {
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
        }

        .landscape {
            width: 100%;
            height: 120px;
            background: linear-gradient(to bottom, #4ade80, #22c55e);
            border-top: 3px solid #16a34a;
            margin-top: auto;
        }

        .reference-content {
            position: relative;
            width: 100%;
            height: 300px;
            margin-bottom: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .railway-station {
            position: absolute;
            bottom: 20px;
            left: calc(50% - 150px);
            transform: translateX(-50%);
            font-size: 4rem;
            text-align: center;
            text-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            z-index: 10;
        }

        .school {
            position: absolute;
            bottom: 20px;
            left: calc(50% + 150px);
            transform: translateX(-50%);
            font-size: 4rem;
            text-align: center;
            text-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            z-index: 10;
        }

        .distance-line {
            position: absolute;
            bottom: 50px;
            left: calc(50% - 150px);
            width: 300px;
            height: 3px;
            background: #fbbf24;
            opacity: 0;
            transform-origin: left center;
        }

        .distance-label {
            position: absolute;
            bottom: 70px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: #fbbf24;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: bold;
            opacity: 0;
            border: 2px solid #fbbf24;
            white-space: nowrap;
            z-index: 20;
        }

        .direction-arrow {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            color: #10b981;
            font-size: 2rem;
            opacity: 0;
            animation: bounce 1s ease-in-out infinite;
            z-index: 15;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        /* Motion Path Demo */
        .motion-demo {
            display: none;
            position: relative;
            width: 100%;
            height: 500px;
        }

        .motion-demo.active {
            display: block;
        }

        .motion-path {
            position: absolute;
            top: 50%;
            left: 10%;
            width: 80%;
            height: 4px;
            background: linear-gradient(to right, #6b7280, #9ca3af);
            border-radius: 2px;
            transform: translateY(-50%);
        }

        .position-marker {
            position: absolute;
            width: 20px;
            height: 20px;
            background: #10b981;
            border-radius: 50%;
            top: 50%;
            transform: translateY(-50%);
            border: 3px solid white;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }

        .position-o { left: 10%; }
        .position-c { left: 30%; }
        .position-b { left: 50%; }
        .position-a { left: 90%; }

        .position-label {
            position: absolute;
            top: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 5px 10px;
            border-radius: 10px;
            font-weight: bold;
            font-size: 0.9rem;
        }

        .moving-object {
            position: absolute;
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #f59e0b, #d97706);
            border-radius: 50%;
            top: 50%;
            left: 10%;
            transform: translateY(-50%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            border: 3px solid #92400e;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            z-index: 10;
        }

        .distance-info {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.8);
            padding: 15px 20px;
            border-radius: 15px;
            border: 2px solid #10b981;
            opacity: 0;
        }

        .displacement-info {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.8);
            padding: 15px 20px;
            border-radius: 15px;
            border: 2px solid #3b82f6;
            opacity: 0;
        }

        /* Uniform Motion Demo */
        .uniform-demo {
            display: none;
            position: relative;
            width: 100%;
            height: 500px;
        }

        .uniform-demo.active {
            display: block;
        }

        .motion-track {
            position: absolute;
            top: 30%;
            left: 5%;
            right: 5%;
            height: 6px;
            background: linear-gradient(to right, #374151, #6b7280);
            border-radius: 3px;
        }

        .time-markers {
            position: absolute;
            top: 35%;
            left: 5%;
            right: 5%;
            height: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .time-marker {
            width: 2px;
            height: 20px;
            background: #9ca3af;
            position: relative;
        }

        .time-label {
            position: absolute;
            top: 25px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.8rem;
            color: #9ca3af;
        }

        .uniform-object {
            position: absolute;
            width: 30px;
            height: 30px;
            background: linear-gradient(135deg, #10b981, #059669);
            border-radius: 50%;
            top: 30%;
            left: 5%;
            transform: translateY(-50%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            font-size: 0.8rem;
            border: 2px solid #047857;
            z-index: 10;
        }

        .non-uniform-object {
            position: absolute;
            width: 30px;
            height: 30px;
            background: linear-gradient(135deg, #ef4444, #dc2626);
            border-radius: 50%;
            top: 70%;
            left: 5%;
            transform: translateY(-50%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            font-size: 0.8rem;
            border: 2px solid #b91c1c;
            z-index: 10;
        }

        .motion-info {
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            padding: 15px 25px;
            border-radius: 15px;
            text-align: center;
            border: 2px solid #10b981;
        }

        /* Activity Demo */
        .activity-demo {
            display: none;
            padding: 30px;
        }

        .activity-demo.active {
            display: block;
        }

        .activity-container {
            position: relative;
            margin: 15px 0;
            overflow: hidden;
            height: auto; /* Change from calc(100vh - 250px) */
    min-height: 590px; /* Add minimum height */
    max-height: 80vh; /* Prevent overflow */
            display: flex;
            flex-direction: column;
            width: 100%;
        }

        .activity-slider {
            display: flex;
            transition: transform 0.5s ease;
            flex: 1;
            width: 300%;
        }

        .activity-card {
            flex: 0 0 33.333%;
            background: rgba(16, 185, 129, 0.1);
            padding: 15px;
            border-radius: 15px;
            border: 2px solid rgba(16, 185, 129, 0.3);
            transition: all 0.3s ease;
            height: 100%;
            max-height: 70vh; /* Add max height */
    min-height: 500px; /* Add min height */
            overflow-y: auto;
            box-sizing: border-box;
        }

        .activity-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 20px;
            gap: 10px;
        }

        .activity-nav-btn {
            background: linear-gradient(135deg, #10b981, #059669);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .activity-nav-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 5px 15px rgba(16, 185, 129, 0.4);
        }

        .activity-nav-btn:disabled {
            background: #6b7280;
            cursor: not-allowed;
            transform: scale(1);
            box-shadow: none;
        }

        .activity-indicators {
            display: flex;
            gap: 8px;
        }

        .activity-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(16, 185, 129, 0.3);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .activity-indicator.active {
            background: #10b981;
            transform: scale(1.2);
        }

        .activity-animation {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            height: 250px;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .activity-explanation {
            margin-top: 10px;
            padding: 10px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            border-left: 4px solid #10b981;
            font-size: 0.95rem;
            max-height: 200px;
            overflow-y: auto;
        }

        .activity-title {
            color: #10b981;
            font-size: 1.2rem;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .activity-steps {
            list-style: none;
            padding: 0;
            margin: 10px 0;
        }

        .activity-steps li {
            padding: 5px 0;
            padding-left: 20px;
            position: relative;
            line-height: 1.4;
            font-size: 0.95rem;
        }

        .activity-steps li:before {
            content: '•';
            position: absolute;
            left: 0;
            color: #10b981;
            font-size: 1.2rem;
        }

        /* Questions Demo */
        .questions-demo {
            display: none;
            padding: 30px;
        }

        .questions-demo.active {
            display: block;
        }

        .questions-container {
            position: relative;
            margin: 15px 0;
            overflow: hidden;
            height: 500px;
            display: flex;
            flex-direction: column;
            width: 100%;
            max-width: 100%;
        }

        .questions-slider {
            display: flex;
            transition: transform 0.5s ease;
            flex: 1;
            width: 300%;
        }

        .question-card {
            flex: 0 0 100%;
            background: rgba(0, 0, 0, 0.3);
            padding: 20px;
            border-radius: 15px;
            border-left: 4px solid #10b981;
            height: 100%;
            overflow-y: auto;
            overflow-x: hidden;
            box-sizing: border-box;
            margin: 0;
            display: flex;
            flex-direction: column;
            position: relative;
            width: 100%;
            max-width: 100%;
        }

        .questions-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 20px;
            gap: 10px;
        }

        .question-nav-btn {
            background: linear-gradient(135deg, #10b981, #059669);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .question-nav-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 5px 15px rgba(16, 185, 129, 0.4);
        }

        .question-nav-btn:disabled {
            background: #6b7280;
            cursor: not-allowed;
            transform: scale(1);
            box-shadow: none;
        }

        .question-indicators {
            display: flex;
            gap: 8px;
        }

        .question-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(16, 185, 129, 0.3);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .question-indicator.active {
            background: #10b981;
            transform: scale(1.2);
        }

        .question-number {
            color: #10b981;
            font-weight: bold;
            font-size: 1.2rem;
            margin-bottom: 10px;
            flex-shrink: 0;
        }

        .question-text {
            font-size: 1.1rem;
            line-height: 1.6;
            max-width: 32%;
            margin-bottom: 15px;
            flex-grow: 1;
        }

        .show-answer-btn {
            background: linear-gradient(135deg, #10b981, #059669);
            border: none;
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            margin-bottom: 10px;
            align-self: flex-start;
            flex-shrink: 0;
        }

        .answer-section {
            background: rgba(16, 185, 129, 0.1);
            padding: 15px;
            border-radius: 10px;
            border: 1px solid rgba(16, 185, 129, 0.3);
            opacity: 0;
            transform: translateY(-10px);
            transition: all 0.5s ease;
            margin-top: 15px;
            max-height: 200px;
            max-width: 32%;
            overflow-y: auto;
            box-sizing: border-box;
            width: calc(100% - 2px);
            margin-left: 0;
            margin-right: 0;
        }

        .answer-section.show {
            opacity: 1;
            transform: translateY(0);
        }

        .show-answer-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(16, 185, 129, 0.4);
        }

        /* Data Table Demo */
        .data-demo {
            display: none;
            padding: 30px;
        }

        .data-demo.active {
            display: block;
        }

        .data-table {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            overflow-x: auto;
        }

        .data-table table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table th,
        .data-table td {
            padding: 12px;
            text-align: center;
            border: 1px solid rgba(16, 185, 129, 0.3);
        }

        .data-table th {
            background: rgba(16, 185, 129, 0.2);
            color: #10b981;
            font-weight: 600;
        }

        .data-table td {
            color: #e2e8f0;
        }

        .uniform-row {
            background: rgba(16, 185, 129, 0.1);
        }

        .non-uniform-row {
            background: rgba(239, 68, 68, 0.1);
        }

        /* Controls */
        .controls {
            text-align: center;
            margin: 40px 0;
        }

        .controls-title {
            font-size: 1.8rem;
            margin-bottom: 25px;
            color: #10b981;
            font-weight: 600;
        }

        .demo-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
            margin: 25px 0;
        }

        .demo-btn {
            background: linear-gradient(135deg, #10b981, #059669);
            border: none;
            color: white;
            padding: 14px 24px;
            border-radius: 30px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 20px rgba(16, 185, 129, 0.3);
            min-width: 150px;
        }

        .demo-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 25px rgba(16, 185, 129, 0.4);
        }

        .demo-btn.active {
            background: linear-gradient(135deg, #3b82f6, #2563eb);
            box-shadow: 0 8px 20px rgba(59, 130, 246, 0.4);
        }

        /* Theory Section */
        .theory-section {
            background: rgba(15, 23, 42, 0.9);
            border-radius: 25px;
            padding: 35px;
            margin: 35px 0;
            border: 3px solid rgba(16, 185, 129, 0.4);
            backdrop-filter: blur(15px);
        }

        .concept-box {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.2), rgba(52, 211, 153, 0.2));
            padding: 25px;
            border-radius: 20px;
            margin: 20px 0;
            border: 1px solid rgba(16, 185, 129, 0.3);
        }

        .concept-title {
            font-size: 1.5rem;
            color: #10b981;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .concept-text {
            font-size: 1.1rem;
            line-height: 1.8;
            color: #e2e8f0;
        }

        .formula-box {
            background: rgba(251, 191, 36, 0.1);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            margin: 20px 0;
            border: 2px solid rgba(251, 191, 36, 0.3);
        }

        .formula {
            font-size: 1.8rem;
            color: #fbbf24;
            font-family: 'Courier New', monospace;
            margin: 15px 0;
            text-shadow: 0 0 20px rgba(251, 191, 36, 0.5);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .header h1 { font-size: 2.2rem; }
            .demo-stage { padding: 30px 20px; min-height: 400px; }
            .demo-buttons { flex-direction: column; align-items: center; }
            .activity-container { grid-template-columns: 1fr; }
            .railway-station { left: calc(50% - 100px); }
            .school { left: calc(50% + 100px); }
            .distance-line { width: 200px; }
        }

        @media (max-width: 480px) {
            .container { padding: 20px 15px; }
            .header h1 { font-size: 1.8rem; }
            .demo-stage { padding: 20px 15px; }
            .theory-section { padding: 20px; }
            .railway-station { left: calc(50% - 70px); font-size: 3rem; }
            .school { left: calc(50% + 70px); font-size: 3rem; }
            .distance-line { width: 140px; }
        }
    </style>
</head>
<body>
    <!-- Audio Control -->
    <div id="audio-control">
        <button id="mute-btn" class="control-btn">
            <span class="unmute-icon">🔊</span>
            <span class="mute-icon">🔇</span>
        </button>
    </div>

    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>Describing Motion</h1>
            <p>Explore how we describe the location and movement of objects using reference points, distance, displacement, and different types of motion!</p>
        </div>

        <!-- Demo Stage -->
        <div class="demo-stage" id="stage">
            <!-- Reference Point Demo -->
            <div class="reference-demo" id="reference-demo">
                <div class="reference-content">
                    <div class="railway-station" id="railway-station">🚉</div>
                    <div class="school" id="school">🏫</div>
                <div class="distance-line" id="distance-line"></div>
                <div class="distance-label" id="distance-label">2 km North</div>
                <div class="direction-arrow" id="direction-arrow">↑</div>
                </div>
                <div class="landscape"></div>
            </div>

            <!-- Motion Path Demo -->
            <div class="motion-demo" id="motion-demo">
                <div class="motion-path"></div>
                
                <!-- Position markers -->
                <div class="position-marker position-o">
                    <div class="position-label">O (Origin)<br>0 km</div>
                </div>
                <div class="position-marker position-c">
                    <div class="position-label">C<br>25 km</div>
                </div>
                <div class="position-marker position-b">
                    <div class="position-label">B<br>35 km</div>
                </div>
                <div class="position-marker position-a">
                    <div class="position-label">A<br>60 km</div>
                </div>

                <!-- Moving object -->
                <div class="moving-object" id="moving-object">📦</div>

                <!-- Information panels -->
                <div class="distance-info" id="distance-info">
                    <h3 style="color: #10b981; margin-bottom: 10px;">Distance</h3>
                    <p>Total path length covered</p>
                    <div style="font-size: 1.2rem; font-weight: bold; margin-top: 10px;" id="distance-value">0 km</div>
                </div>

                <div class="displacement-info" id="displacement-info">
                    <h3 style="color: #3b82f6; margin-bottom: 10px;">Displacement</h3>
                    <p>Shortest distance from initial to final position</p>
                    <div style="font-size: 1.2rem; font-weight: bold; margin-top: 10px;" id="displacement-value">0 km</div>
                </div>
            </div>

            <!-- Uniform Motion Demo -->
            <div class="uniform-demo" id="uniform-demo">
                <div class="motion-info">
                    <h3 style="color: #10b981; margin-bottom: 10px;">Uniform vs Non-Uniform Motion</h3>
                    <p>Watch how objects move with constant and varying speeds</p>
                </div>

                <!-- Uniform motion track -->
                <div class="motion-track" style="top: 25%;"></div>
                <div class="time-markers" style="top: 30%;">
                    <div class="time-marker" id="uniform-marker-0"><div class="time-label" id="uniform-time-0">0s</div></div>
                    <div class="time-marker" id="uniform-marker-1" style="opacity: 0;"><div class="time-label" id="uniform-time-1" style="opacity: 0;">1s</div></div>
                    <div class="time-marker" id="uniform-marker-2" style="opacity: 0;"><div class="time-label" id="uniform-time-2" style="opacity: 0;">2s</div></div>
                    <div class="time-marker" id="uniform-marker-3" style="opacity: 0;"><div class="time-label" id="uniform-time-3" style="opacity: 0;">3s</div></div>
                    <div class="time-marker" id="uniform-marker-4" style="opacity: 0;"><div class="time-label" id="uniform-time-4" style="opacity: 0;">4s</div></div>
                </div>
                <div class="uniform-object" id="uniform-object">U</div>

                <!-- Non-uniform motion track -->
                <div class="motion-track" style="top: 65%;"></div>
                <div class="time-markers non-uniform-markers" style="top: 70%;">
                    <div class="time-marker" id="non-uniform-marker-0" style="left: 0%"><div class="time-label" id="non-uniform-time-0">0s</div></div>
                    <div class="time-marker" id="non-uniform-marker-1" style="opacity: 0; left: -13%"><div class="time-label" id="non-uniform-time-1" style="opacity: 0;">1s</div></div>
                    <div class="time-marker" id="non-uniform-marker-2" style="opacity: 0; left: -15%"><div class="time-label" id="non-uniform-time-2" style="opacity: 0;">2s</div></div>
                    <div class="time-marker" id="non-uniform-marker-3" style="opacity: 0; left: -8%"><div class="time-label" id="non-uniform-time-3" style="opacity: 0;">3s</div></div>
                    <div class="time-marker" id="non-uniform-marker-4" style="opacity: 0;"><div class="time-label" id="non-uniform-time-4" style="opacity: 0;">4s</div></div>
                </div>
                <div class="non-uniform-object" id="non-uniform-object">N</div>

                <!-- Legend -->
                <div style="position: absolute; bottom: 20px; left: 20px; background: rgba(0, 0, 0, 0.8); padding: 15px; border-radius: 10px;">
                    <div style="margin-bottom: 10px;"><span style="color: #10b981;">●</span> Uniform Motion (equal distances in equal time)</div>
                    <div><span style="color: #ef4444;">●</span> Non-Uniform Motion (varying speeds and distances)</div>
                </div>
            </div>

            <!-- Activities Demo -->
            <div class="activity-demo" id="activity-demo">
                <h2 style="color: #10b981; text-align: center; margin-bottom: 30px;">NCERT Activities</h2>
                
                <div class="activity-container">
                    <div class="activity-slider" id="activity-slider">
                        <!-- Activity 1 -->
                    <div class="activity-card">
                        <div class="activity-title">Activity 7.3: Basketball Court</div>
                            
                            <div class="activity-animation">
                                <div style="width: 100%; height: 100%; position: relative; display: flex; flex-direction: column; align-items: center; justify-content: center;">
                                    <div style="width: 91%; height: 80%; border: 3px solid #10b981; background: rgba(16, 185, 129, 0.1); position: relative; border-radius: 10px; display: flex; align-items: center; justify-content: center;">
                                        <!-- Basketball court container -->
                                        <div style="width: 90%; height: 90%; position: relative;">
                                            <!-- Start and End labels -->
                                            <div style="position: absolute; top: 10px; left: 10px; font-weight: bold; color: #10b981; font-size: 14px;">Start</div>
                                            <div style="position: absolute; bottom: 10px; right: 10px; font-weight: bold; color: #ef4444; font-size: 14px;">End</div>
                                            
                                            <!-- Horizontal path -->
                                            <div id="court-path-horizontal" style="position: absolute; top: 30px; left: 30px; width: 0; height: 3px; background: #fbbf24; background-image: repeating-linear-gradient(90deg, transparent, transparent 5px, rgba(255,255,255,0.3) 5px, rgba(255,255,255,0.3) 10px); max-width: calc(100% - 60px);"></div>
                                            
                                            <!-- Vertical path -->
                                            <div id="court-path-vertical" style="position: absolute; top: 30px; left: 30px; width: 3px; height: 0; background: #fbbf24; background-image: repeating-linear-gradient(0deg, transparent, transparent 5px, rgba(255,255,255,0.3) 5px, rgba(255,255,255,0.3) 10px); max-height: calc(100% - 60px);"></div>
                                            
                                            <!-- Diagonal displacement -->
                                            <div id="court-displacement" style="position: absolute; top: 30px; left: 30px; width: 0; height: 0; border-right: 3px solid #3b82f6; transform: rotate(45deg); transform-origin: top left; opacity: 0; max-width: calc(100% - 60px);"></div>
                                            
                                            <!-- Person emoji -->
                                            <div id="court-person" style="position: absolute; top: 15px; left: 15px; font-size: 28px; z-index: 10; text-shadow: 0 2px 4px rgba(0,0,0,0.5);">🧍</div>
                                        </div>
                                    </div>
                                    
                                    <div style="display: flex; justify-content: space-around; width: 80%; margin-top: 10px;">
                                        <div id="court-distance" style="font-weight: bold; color: #fbbf24; font-size: 0.9rem;">Distance: 0 m</div>
                                        <div id="court-displacement-value" style="font-weight: bold; color: #3b82f6; font-size: 0.9rem;">Displacement: 0 m</div>
                                    </div>
                                    
                                    <button id="court-demo-btn" class="demo-btn" style="margin-top: 5px; padding: 8px 16px; font-size: 0.9rem;">Run Demonstration</button>
                                </div>
                            </div>
                            
                        <ul class="activity-steps">
                            <li>Take a metre scale and a long rope</li>
                            <li>Walk from one corner of a basketball court to its opposite corner along its sides</li>
                            <li>Measure the distance covered by you and magnitude of the displacement</li>
                            <li>What difference would you notice between the two in this case?</li>
                        </ul>
                            
                            <div class="activity-explanation">
                                <p><strong>Explanation:</strong> This activity demonstrates the difference between distance and displacement. When you walk along the sides of a basketball court from one corner to the diagonally opposite corner, you cover a greater distance than the straight-line displacement between those points.</p>
                                <p>If the court is a square with sides of length 'a', then:</p>
                                <p>- Distance covered = 2a (sum of two sides)</p>
                                <p>- Displacement = a√2 (diagonal of the square)</p>
                                <p>This shows that distance is always greater than or equal to displacement.</p>
                        </div>
                    </div>

                        <!-- Activity 2 -->
                    <div class="activity-card">
                        <div class="activity-title">Activity 7.4: Odometer Reading</div>
                            
                            <div class="activity-animation">
                                <div style="width: 100%; height: 100%; position: relative; display: flex; flex-direction: column; align-items: center; justify-content: center;">
                                    <div style="width: 80%; height: 80%; background: rgba(16, 185, 129, 0.1); position: relative; border-radius: 10px; border: 2px dashed #10b981; overflow: hidden; display: flex; align-items: center; justify-content: center;">
                                        <div style="width: 90%; height: 90%; position: relative;">
                                            <!-- Map representation -->
                                            <div style="position: absolute; bottom: 20px; left: 20px; font-weight: bold; color: white; text-shadow: 1px 1px 2px rgba(0,0,0,0.7);">Bhubaneshwar</div>
                                            <div style="position: absolute; top: 20px; right: 20px; font-weight: bold; color: white; text-shadow: 1px 1px 2px rgba(0,0,0,0.7);">New Delhi</div>
                                            
                                            <!-- Road path (zigzag/curved) -->
                                            <svg id="road-path" width="100%" height="100%" style="position: absolute; top: 0; left: 0;">
                                                <path id="road-curve" d="M 30,170 L 80,120 L 130,140 L 180,80 L 230,100 L 280,40" stroke="#fbbf24" stroke-width="4" stroke-dasharray="8,4" fill="none" stroke-dashoffset="0" opacity="0"/>
                                            </svg>
                                            
                                            <!-- Straight displacement -->
                                            <svg id="direct-path" width="100%" height="100%" style="position: absolute; top: 0; left: 0;">
                                                <line id="direct-line" x1="30" y1="170" x2="280" y2="40" stroke="#3b82f6" stroke-width="3" opacity="0"/>
                                            </svg>
                                            
                                            <!-- Car emoji -->
                                            <div id="map-car" style="position: absolute; bottom: 20px; left: 20px; font-size: 24px; transform: rotate(0deg); z-index: 5;">🚗</div>
                                        </div>
                                    </div>
                                    
                                    <div style="display: flex; justify-content: space-around; width: 80%; margin-top: 10px;">
                                        <div id="odometer-reading" style="font-weight: bold; color: #fbbf24; font-size: 0.9rem;">Odometer: 0 km</div>
                                        <div id="map-displacement-value" style="font-weight: bold; color: #3b82f6; font-size: 0.9rem;">Displacement: 0 km</div>
                                    </div>
                                    
                                    <button id="odometer-demo-btn" class="demo-btn" style="margin-top: 5px; padding: 8px 16px; font-size: 0.9rem;">Run Demonstration</button>
                                </div>
                            </div>
                            
                        <ul class="activity-steps">
                            <li>Automobiles are fitted with a device that shows the distance travelled (odometer)</li>
                            <li>A car is driven from Bhubaneshwar to New Delhi</li>
                            <li>The difference between final and initial odometer reading is 1850 km</li>
                            <li>Find the magnitude of displacement using Road Map of India</li>
                        </ul>
                            
                            <div class="activity-explanation">
                                <p><strong>Explanation:</strong> This activity illustrates how an odometer measures the total distance traveled, which is different from displacement. When driving from Bhubaneshwar to New Delhi:</p>
                                <p>- The odometer records 1850 km (total path length along roads)</p>
                                <p>- The displacement is approximately 1500 km (straight-line distance)</p>
                                <p>The odometer reading is always greater than or equal to the displacement because roads rarely follow a straight line between two cities.</p>
                        </div>
                    </div>

                        <!-- Activity 3 -->
                    <div class="activity-card">
                        <div class="activity-title">Activity 7.5: Motion Analysis</div>
                            
                            <div class="activity-animation">
                                <div style="width: 100%; height: 100%; position: relative; display: flex; flex-direction: column; align-items: center; justify-content: center;">
                                    <div style="width: 80%; height: 80%; background: rgba(0, 0, 0, 0.3); position: relative; border-radius: 10px; overflow: hidden; border: 2px solid rgba(255, 255, 255, 0.1); display: flex; align-items: center; justify-content: center;">
                                        <div style="width: 90%; height: 90%; position: relative;">
                                            <!-- Graph axes -->
                                            <div style="position: absolute; left: 40px; top: 10px; width: 2px; height: 140px; background: white;"></div>
                                            <div style="position: absolute; left: 40px; bottom: 30px; width: calc(100% - 50px); height: 2px; background: white;"></div>
                                            
                                            <!-- Axis labels -->
                                            <div style="position: absolute; left: 10px; top: 75px; transform: rotate(-90deg); font-size: 12px; color: white; text-shadow: 1px 1px 2px rgba(0,0,0,0.7);">Distance (m)</div>
                                            <div style="position: absolute; left: 50%; bottom: 10px; transform: translateX(-50%); font-size: 12px; color: white; text-shadow: 1px 1px 2px rgba(0,0,0,0.7);">Time</div>
                                            
                                            <!-- Object A line (uniform) -->
                                            <svg id="graph-line-a" width="calc(100% - 50px)" height="130" style="position: absolute; left: 40px; bottom: 30px;">
                                                <line x1="0" y1="130" x2="100%" y2="0" stroke="#10b981" stroke-width="3" stroke-dasharray="1000" stroke-dashoffset="1000"/>
                                            </svg>
                                            
                                           
                                           <!-- Object B line (non-uniform) -->
<svg id="graph-line-b" width="calc(100% - 50px)" height="130" style="position: absolute; left: 40px; bottom: 30px;">
    <path d="M0,130 Q 220,120 420,56 T 800,0" stroke="#ef4444" stroke-width="3" stroke-dasharray="1000" stroke-dashoffset="1000" fill="none"/>
</svg>
                                            
                                            <!-- Legend -->
                                            <div style="position: absolute; right: 10px; top: 10px; font-size: 11px; text-align: left; background: rgba(0, 0, 0, 0.7); padding: 6px; border-radius: 5px;">
                                                <div style="margin-bottom: 4px; color: white;"><span style="display: inline-block; width: 10px; height: 10px; background: #10b981; margin-right: 5px;"></span>Object A (Uniform)</div>
                                                <div style="color: white;"><span style="display: inline-block; width: 10px; height: 10px; background: #ef4444; margin-right: 5px;"></span>Object B (Non-uniform)</div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <button id="graph-demo-btn" class="demo-btn" style="margin-top: 5px; padding: 8px 16px; font-size: 0.9rem;">Run Demonstration</button>
                                </div>
                            </div>
                            
                        <ul class="activity-steps">
                            <li>Examine the data for two different objects A and B</li>
                            <li>Object A covers equal distances in equal time intervals</li>
                            <li>Object B covers unequal distances in equal time intervals</li>
                            <li>Determine whether motion is uniform or non-uniform</li>
                        </ul>
                            
                            <div class="activity-explanation">
                                <p><strong>Explanation:</strong> This activity helps distinguish between uniform and non-uniform motion by analyzing distance-time data:</p>
                                <p>- <strong>Object A:</strong> Covers 10m every 15 minutes consistently. On a distance-time graph, this creates a straight line with constant slope, indicating uniform motion.</p>
                                <p>- <strong>Object B:</strong> Covers varying distances (7m, 4m, 12m, etc.) in equal time intervals. On a distance-time graph, this creates a curved line with varying slope, indicating non-uniform motion.</p>
                                <p>The slope of a distance-time graph represents the speed of the object. A constant slope means constant speed (uniform motion), while a changing slope indicates changing speed (non-uniform motion).</p>
                        </div>
                        </div>
                    </div>
                    
                    <!-- Activity Navigation Controls -->
                    <div class="activity-controls">
                        <button id="prev-activity" class="activity-nav-btn" disabled>&lt;</button>
                        <div class="activity-indicators">
                            <div class="activity-indicator active" data-index="0"></div>
                            <div class="activity-indicator" data-index="1"></div>
                            <div class="activity-indicator" data-index="2"></div>
                        </div>
                        <button id="next-activity" class="activity-nav-btn">&gt;</button>
                    </div>
                </div>
            </div>

            <!-- Data Table Demo -->
            <div class="data-demo" id="data-demo">
                <h2 style="color: #10b981; text-align: center; margin-bottom: 30px;">Table 7.1: Motion Data Analysis</h2>
                
                <div class="data-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Time</th>
                                <th>Distance travelled by Object A (m)</th>
                                <th>Distance travelled by Object B (m)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="uniform-row">
                                <td>9:30 am</td>
                                <td>10</td>
                                <td>12</td>
                            </tr>
                            <tr class="uniform-row">
                                <td>9:45 am</td>
                                <td>20</td>
                                <td>19</td>
                            </tr>
                            <tr class="uniform-row">
                                <td>10:00 am</td>
                                <td>30</td>
                                <td>23</td>
                            </tr>
                            <tr class="uniform-row">
                                <td>10:15 am</td>
                                <td>40</td>
                                <td>35</td>
                            </tr>
                            <tr class="uniform-row">
                                <td>10:30 am</td>
                                <td>50</td>
                                <td>37</td>
                            </tr>
                            <tr class="uniform-row">
                                <td>10:45 am</td>
                                <td>60</td>
                                <td>41</td>
                            </tr>
                            <tr class="uniform-row">
                                <td>11:00 am</td>
                                <td>70</td>
                                <td>44</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 30px;">
                    <div class="concept-box">
                        <div class="concept-title">Object A Analysis</div>
                        <div class="concept-text">
                            Object A covers 10m every 15 minutes consistently. This is <strong>uniform motion</strong> 
                            because equal distances are covered in equal time intervals.
                        </div>
                    </div>
                    <div class="concept-box">
                        <div class="concept-title">Object B Analysis</div>
                        <div class="concept-text">
                            Object B covers varying distances (7m, 4m, 12m, 2m, 4m, 3m) in equal time intervals. 
                            This is <strong>non-uniform motion</strong>.
                        </div>
                    </div>
                </div>
            </div>

            <!-- Questions Demo -->
            <div class="questions-demo" id="questions-demo">
                <h2 style="color: #10b981; text-align: center; margin-bottom: 30px;">Practice Questions</h2>
                
                <div class="questions-container">
                    <div class="questions-slider" id="questions-slider">
                        <!-- Question 1 -->
                <div class="question-card">
                    <div class="question-number">Q1.</div>
                    <div class="question-text">
                        An object has moved through a distance. Can it have zero displacement? If yes, support your answer with an example.
                    </div>
                    <button class="show-answer-btn" onclick="showAnswer(1)">Show Answer</button>
                    <div class="answer-section" id="answer-1">
                        <strong>Answer:</strong> Yes, an object can have zero displacement even after moving through a distance. 
                        <br><br><strong>Example:</strong> If you walk around a circular track and return to your starting point, 
                        you have covered a distance equal to the circumference of the track, but your displacement is zero 
                        because your initial and final positions are the same.
                    </div>
                </div>
                
                        <!-- Question 2 -->
                <div class="question-card">
                    <div class="question-number">Q2.</div>
                    <div class="question-text">
                        A farmer moves along the boundary of a square field of side 10 m in 40 s. What will be the magnitude 
                        of displacement of the farmer at the end of 2 minutes 20 seconds from his initial position?
                    </div>
                    <button class="show-answer-btn" onclick="showAnswer(2)">Show Answer</button>
                    <div class="answer-section" id="answer-2">
                        <strong>Solution:</strong><br>
                        • Perimeter of square field = 4 × 10 = 40 m<br>
                        • Time to complete one round = 40 s<br>
                        • Total time = 2 min 20 s = 140 s<br>
                        • Number of complete rounds = 140 ÷ 40 = 3.5 rounds<br>
                        • After 3.5 rounds, farmer is at the opposite corner<br>
                        • <strong>Displacement = diagonal of square = 10√2 = 14.14 m</strong>
                    </div>
                </div>
                
                        <!-- Question 3 -->
                <div class="question-card">
                    <div class="question-number">Q3.</div>
                    <div class="question-text">
                        Which of the following is true for displacement?<br>
                        (a) It cannot be zero<br>
                        (b) Its magnitude is greater than the distance travelled by the object
                    </div>
                    <button class="show-answer-btn" onclick="showAnswer(3)">Show Answer</button>
                    <div class="answer-section" id="answer-3">
                        <strong>Answer:</strong> Neither (a) nor (b) is correct.<br><br>
                        <strong>Explanation:</strong><br>
                        • (a) is false: Displacement can be zero when initial and final positions are the same<br>
                        • (b) is false: Displacement magnitude is always less than or equal to distance travelled<br>
                        • The magnitude of displacement equals distance only when motion is in a straight line without changing direction
                            </div>
                        </div>
                    </div>
                    
                    <!-- Question Navigation Controls -->
                    <div class="questions-controls">
                        <button id="prev-question" class="question-nav-btn" disabled>&lt;</button>
                        <div class="question-indicators">
                            <div class="question-indicator active" data-index="0"></div>
                            <div class="question-indicator" data-index="1"></div>
                            <div class="question-indicator" data-index="2"></div>
                        </div>
                        <button id="next-question" class="question-nav-btn">&gt;</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Controls -->
        <div class="controls">
            <div class="controls-title" id="demo-title">Explore Motion Concepts</div>
            
            <div class="demo-buttons">
                <button class="demo-btn" onclick="playCompleteLesson()">📚 Complete Lesson</button>
                <button class="demo-btn" onclick="showReferencePoint()">📍 Reference Point</button>
                <button class="demo-btn" onclick="showMotionPath()">🛤️ Distance vs Displacement</button>
                <button class="demo-btn" onclick="showUniformMotion()">⚡ Uniform Motion</button>
                <button class="demo-btn" onclick="showActivities()">🔬 NCERT Activities</button>
                <button class="demo-btn" onclick="showDataAnalysis()">📊 Data Analysis</button>
                <button class="demo-btn" onclick="showQuestions()">❓ Questions</button>
                <button class="demo-btn" onclick="resetAllClick()">🔄 Reset</button>
            </div>
        </div>

        <!-- Theory Section -->
        <div class="theory-section">
            <div class="concept-box">
                <div class="concept-title">Key Concepts of Motion</div>
                <div class="concept-text">
                    To describe the position of an object, we need to specify a <strong>reference point</strong> called the origin. 
                    Motion is described relative to this reference point, and different reference points can be chosen based on convenience.
                </div>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;">
                <div class="formula-box">
                    <h3 style="color: #fbbf24; margin-bottom: 15px;">Distance</h3>
                    <div class="concept-text">
                        • Total path length covered<br>
                        • Always positive<br>
                        • Scalar quantity<br>
                        • Can never be zero for a moving object
                    </div>
                </div>
                <div class="formula-box">
                    <h3 style="color: #fbbf24; margin-bottom: 15px;">Displacement</h3>
                    <div class="concept-text">
                        • Shortest distance from initial to final position<br>
                        • Can be positive, negative, or zero<br>
                        • Vector quantity<br>
                        • Magnitude ≤ Distance
                    </div>
                </div>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;">
                <div class="concept-box">
                    <div class="concept-title">Uniform Motion</div>
                    <div class="concept-text">
                        An object is in uniform motion when it covers <strong>equal distances in equal intervals of time</strong>, 
                        regardless of how small the time intervals are.
                    </div>
                </div>
                <div class="concept-box">
                    <div class="concept-title">Non-Uniform Motion</div>
                    <div class="concept-text">
                        An object is in non-uniform motion when it covers <strong>unequal distances in equal intervals of time</strong>. 
                        Most real-world motions are non-uniform.
                    </div>
                </div>
            </div>

            <div class="concept-box">
                <div class="concept-title">Important Points to Remember</div>
                <div class="concept-text">
                    • The magnitude of displacement can be equal to distance only when motion is in a straight line without changing direction<br>
                    • For circular motion, displacement can be zero while distance is non-zero<br>
                    • Motion is always described relative to a reference point<br>
                    • Time intervals should be small when analyzing uniform motion
                </div>
            </div>
        </div>
    </div>

    <script>
        // Voice Teacher System
        class PhysicsTeacher {
            constructor() {
                this.isEnabled = globalAudioEnabled;
                this.currentUtterance = null;
                this.settings = { rate: 0.9, pitch: 1.0, volume: 0.85 };
                this.isDestroyed = false;
            }

            async speak(text, delay = 0) {
                if (!this.isEnabled || !text || this.isDestroyed) return;
                
                return new Promise((resolve) => {
                    setTimeout(() => {
                        if (this.isDestroyed) {
                            resolve();
                            return;
                        }
                        this.stop();
                        const utterance = new SpeechSynthesisUtterance(text);
                        Object.assign(utterance, this.settings);
                        
                        utterance.onend = resolve;
                        utterance.onerror = resolve;
                        
                        this.currentUtterance = utterance;
                        speechSynthesis.speak(utterance);
                    }, delay);
                });
            }

            stop() {
                speechSynthesis.cancel();
                this.currentUtterance = null;
            }

            destroy() {
                this.isDestroyed = true;
                this.stop();
                this.currentUtterance = null;
                this.settings = null;
            }
        }

        // Global state management
        let globalAudioEnabled = true;
        let currentTeacher = null;
        let isPlaying = false;
        let animationTimeline = null;
        let currentDemoAborted = false;
        let activeAnimations = [];
        let currentRunId = 0;
        let currentTaskId = null;

        // State management functions
        function createNewTimeline() {
            if (animationTimeline) {
                animationTimeline.kill();
                animationTimeline = null;
            }
            activeAnimations.forEach(anim => {
                if (anim) anim.kill();
            });
            activeAnimations = [];
            gsap.killTweensOf("*");
            
            const newTimeline = gsap.timeline();
            animationTimeline = newTimeline;
            return newTimeline;
        }

        function trackAnimation(animation) {
            if (animation) {
                activeAnimations.push(animation);
            }
            return animation;
        }

        function stopCurrentDemo() {
            currentDemoAborted = true;
            currentRunId++;
            currentTaskId = null; // Clear current task
            
            // Stop teacher
            if (currentTeacher) {
                currentTeacher.destroy();
                currentTeacher = null;
            }
            
            // Kill all animations
            if (animationTimeline) {
                animationTimeline.kill();
                animationTimeline = null;
            }
            
            activeAnimations.forEach(anim => {
                if (anim) anim.kill();
            });
            activeAnimations = [];
            
            gsap.killTweensOf("*");
            
            // Hide all demos
            document.querySelectorAll('.reference-demo, .motion-demo, .uniform-demo, .activity-demo, .data-demo, .questions-demo').forEach(demo => {
                demo.classList.remove('active');
            });
            
            isPlaying = false;
        }

        function shouldContinue(taskId = null) {
            // If no taskId provided, use old behavior
            if (taskId === null) {
                return !currentDemoAborted;
            }
            // If taskId provided, check if it matches current task
            return !currentDemoAborted && currentTaskId === taskId;
        }

        function generateTaskId() {
            return Date.now() + Math.random();
        }

        function createNewTeacher() {
            if (currentTeacher) {
                currentTeacher.destroy();
                currentTeacher = null;
            }
            currentDemoAborted = false;
            currentTeacher = new PhysicsTeacher();
            return currentTeacher;
        }

        // Initialize
        window.addEventListener('load', () => {
            const teacher = createNewTeacher();
            teacher.speak("Welcome to Describing Motion! Let's explore how we describe the location and movement of objects using reference points and understand the difference between distance and displacement!");
        });

        // Complete Lesson
        async function playCompleteLesson() {
            stopCurrentDemo();
            isPlaying = true;
            setActiveButton(3);
            
            // Generate unique task ID for this lesson
            const taskId = generateTaskId();
            currentTaskId = taskId;
            
            const teacher = createNewTeacher();
            
            await resetAll();
            await wait(100);
            if (!shouldContinue(taskId)) return;
            
            updateTitle("📚 Complete Motion Lesson");
            
            await teacher.speak("Let's begin our complete lesson on Describing Motion from NCERT Chapter 7. We'll understand reference points, distance, displacement, and types of motion.");
            if (!shouldContinue(taskId)) return;
            
            // Start with reference point
            await showReferencePointInternal(teacher, taskId);
            if (!shouldContinue(taskId)) return;
            
            await wait(2000);
            
            // Show motion path and distance vs displacement
            await teacher.speak("Now let's understand the difference between distance and displacement using a practical example.");
            if (!shouldContinue(taskId)) return;
            await showMotionPathInternal(teacher, taskId);
            if (!shouldContinue(taskId)) return;
            
            await wait(2000);
            
            // Show uniform motion
            await teacher.speak("Next, let's explore uniform and non-uniform motion.");
            if (!shouldContinue(taskId)) return;
            await showUniformMotionInternal(teacher, taskId);
            if (!shouldContinue(taskId)) return;
            
            await wait(2000);
            
            // Show activities
            await teacher.speak("Let's look at the NCERT activities that help us understand these concepts.");
            if (!shouldContinue(taskId)) return;
            await showActivitiesInternal(teacher, taskId);
            if (!shouldContinue(taskId)) return;
            
            await wait(2000);
            
            // Show data analysis
            await teacher.speak("Now let's analyze motion data to identify uniform and non-uniform motion.");
            if (!shouldContinue(taskId)) return;
            await showDataAnalysisInternal(teacher, taskId);
            if (!shouldContinue(taskId)) return;
            
            await teacher.speak("Excellent! You now understand how to describe motion using reference points, the difference between distance and displacement, and how to identify uniform and non-uniform motion!");
            
            isPlaying = false;
        }

        // Reference Point Demo
        async function showReferencePoint() {
            stopCurrentDemo();
            isPlaying = true;
            setActiveButton(4);
            
            // Generate unique task ID for this demo
            const taskId = generateTaskId();
            currentTaskId = taskId;
            
            const teacher = createNewTeacher();
            await showReferencePointInternal(teacher, taskId);
            
            isPlaying = false;
        }

        async function showReferencePointInternal(teacher, taskId = null) {
            await resetAll();
            await wait(50);
            if (!shouldContinue(taskId)) return;
            
            updateTitle("📍 Understanding Reference Points");
            
            document.getElementById('reference-demo').classList.add('active');
            await wait(50);
            if (!shouldContinue(taskId)) return;
            
            await teacher.speak("To describe the location of an object, we need to specify a reference point. Let's see an example.");
            if (!shouldContinue(taskId)) return;
            
            await wait(1000);
            
            // Highlight railway station
            trackAnimation(gsap.to('#railway-station', {
                duration: 0.8,
                scale: 1.1,
                boxShadow: "0 0 30px rgba(239, 68, 68, 0.8)",
                ease: "power2.out"
            }));
            
            await wait(1000);
            
            await teacher.speak("Here we have a railway station. This will be our reference point or origin.");
            if (!shouldContinue(taskId)) return;
            
            await wait(1500);
            
            // Show distance line
            trackAnimation(gsap.to('#distance-line', {
                duration: 1.5,
                opacity: 1,
                scaleX: 1,
                ease: "power2.out"
            }));
            
            await wait(500);
            
            // Show distance label
            trackAnimation(gsap.to('#distance-label', {
                duration: 0.8,
                opacity: 1,
                scale: 1,
                ease: "back.out(1.7)"
            }));
            
            await wait(500);
            
            // Show direction arrow
            trackAnimation(gsap.to('#direction-arrow', {
                duration: 0.8,
                opacity: 1,
                ease: "power2.out"
            }));
            
            await wait(1000);
            
            await teacher.speak("The school is located 2 kilometers north of the railway station. We have described the school's position using the railway station as our reference point.");
            if (!shouldContinue(taskId)) return;
            
            await wait(2000);
            
            // Highlight school
            trackAnimation(gsap.to('#school', {
                duration: 0.8,
                scale: 1.1,
                boxShadow: "0 0 30px rgba(59, 130, 246, 0.8)",
                ease: "power2.out"
            }));
            
            await wait(1000);
            
            await teacher.speak("We could have chosen other reference points according to our convenience. The key is that we need a reference point called the origin to describe any object's position.");
        }

        // Motion Path Demo
        async function showMotionPath() {
            stopCurrentDemo();
            isPlaying = true;
            setActiveButton(5);
            
            // Generate unique task ID for this demo
            const taskId = generateTaskId();
            currentTaskId = taskId;
            
            const teacher = createNewTeacher();
            await showMotionPathInternal(teacher, taskId);
            
            isPlaying = false;
        }

        async function showMotionPathInternal(teacher, taskId = null) {
            await resetAll();
            await wait(50);
            if (!shouldContinue(taskId)) return;
            
            updateTitle("🛤️ Distance vs Displacement");
            
            document.getElementById('motion-demo').classList.add('active');
            await wait(50);
            if (!shouldContinue(taskId)) return;
            
            await teacher.speak("Let's understand the difference between distance and displacement using an object moving along a straight path.");
            if (!shouldContinue(taskId)) return;
            
            await wait(1000);
            
            // Show info panels
            trackAnimation(gsap.to('#distance-info', {
                duration: 0.8,
                opacity: 1,
                y: 0,
                ease: "power2.out"
            }));
            
            trackAnimation(gsap.to('#displacement-info', {
                duration: 0.8,
                opacity: 1,
                y: 0,
                ease: "power2.out",
                delay: 0.3
            }));
            
            await wait(1500);
            
            await teacher.speak("The object starts at O and moves to A, covering 60 kilometers.");
            if (!shouldContinue(taskId)) return;
            
            // Move object from O to A
            trackAnimation(gsap.to('#moving-object', {
                duration: 2,
                left: '90%',
                ease: "power2.inOut",
                onUpdate: function() {
                    const progress = this.progress();
                    const distance = progress * 60;
                    const displacement = progress * 60;
                    document.getElementById('distance-value').textContent = distance.toFixed(1) + ' km';
                    document.getElementById('displacement-value').textContent = displacement.toFixed(1) + ' km';
                }
            }));
            
            await wait(2500);
            
            await teacher.speak("Now it moves back from A to C, covering an additional 35 kilometers.");
            if (!shouldContinue(taskId)) return;
            
            // Move object from A to C
            trackAnimation(gsap.to('#moving-object', {
                duration: 2,
                left: '30%',
                ease: "power2.inOut",
                onUpdate: function() {
                    const progress = this.progress();
                    const additionalDistance = progress * 35;
                    const totalDistance = 60 + additionalDistance;
                    const displacement = 60 - (progress * 35); // From O to A = 60km, decreasing to 25km at C
                    document.getElementById('distance-value').textContent = totalDistance.toFixed(1) + ' km';
                    document.getElementById('displacement-value').textContent = displacement.toFixed(1) + ' km';
                }
            }));
            
            await wait(2500);
            
            await teacher.speak("The total distance covered is 60 plus 35 equals 95 kilometers. But the displacement is only 25 kilometers - the shortest distance from the initial position O to the final position C.");
            if (!shouldContinue(taskId)) return;
            
            await wait(2000);
            
            await teacher.speak("Notice that distance is always the total path length, while displacement is the shortest distance between initial and final positions. Displacement can even be zero if the object returns to its starting point!");
        }

        // Uniform Motion Demo
        async function showUniformMotion() {
            stopCurrentDemo();
            isPlaying = true;
            setActiveButton(6);
            
            // Generate unique task ID for this demo
            const taskId = generateTaskId();
            currentTaskId = taskId;
            
            const teacher = createNewTeacher();
            await showUniformMotionInternal(teacher, taskId);
            
            isPlaying = false;
        }

        async function showUniformMotionInternal(teacher, taskId = null) {
            await resetAll();
            await wait(50);
            if (!shouldContinue(taskId)) return;
            
            updateTitle("⚡ Uniform vs Non-Uniform Motion");
            
            document.getElementById('uniform-demo').classList.add('active');
            await wait(50);
            if (!shouldContinue(taskId)) return;
            
            await teacher.speak("Let's compare uniform and non-uniform motion. Watch these two objects move differently.");
            if (!shouldContinue(taskId)) return;
            
            await wait(1000);
            
            await teacher.speak("The green object shows uniform motion - it covers 5 meters every second consistently.");
            if (!shouldContinue(taskId)) return;
            
            // Animate uniform motion with time markers appearing in real-time
            const uniformPositions = ['5%', '27.5%', '50%', '72.5%', '95%'];
            for (let i = 0; i < uniformPositions.length - 1; i++) {
                // Animate to next position
                trackAnimation(gsap.to('#uniform-object', {
                    duration: 1,
                    left: uniformPositions[i+1],
                    ease: "none"
                }));
                
                // Show next time marker and interval line with animation
                trackAnimation(gsap.to(`#uniform-marker-${i+1}`, {
                    duration: 0.3,
                    opacity: 1,
                    ease: "power2.out"
                }));
                
                trackAnimation(gsap.to(`#uniform-time-${i+1}`, {
                    duration: 0.3,
                    opacity: 1,
                    scale: 1.2,
                    ease: "back.out(1.7)",
                    onComplete: function() {
                        gsap.to(`#uniform-time-${i+1}`, {
                            duration: 0.2,
                            scale: 1
                        });
                    }
                }));
                
                await wait(1000);
                if (!shouldContinue(taskId)) return;
            }
            
            await wait(500);
            
            await teacher.speak("Now watch the red object - it shows non-uniform motion with varying speeds. ");
            if (!shouldContinue(taskId)) return;
            
                        // Reset and animate non-uniform motion with progressively increasing distances
            gsap.set('#non-uniform-object', { left: '5%' });
            
            // Create a single animation with increasing distances between time markers
            const nonUniformTimeline = gsap.timeline();
            
            // First segment: slow (0s to 1s marker) - covers small distance
            nonUniformTimeline.to('#non-uniform-object', {
                duration: 1,
                left: '15%', // Small distance in first second
                ease: "power1.out",
                onComplete: function() {
                    // Show 1s time marker and interval line
                    gsap.to('#non-uniform-marker-1', {
                        duration: 0.3,
                        opacity: 1,
                        ease: "power2.out"
                    });
                    
                    gsap.to('#non-uniform-time-1', {
                        duration: 0.3,
                        opacity: 1,
                        scale: 1.2,
                        ease: "back.out(1.7)",
                        onComplete: function() {
                            gsap.to('#non-uniform-time-1', {
                                duration: 0.2,
                                scale: 1
                            });
                        }
                    });
                }
            });
            
            // Second segment: slightly faster (1s to 2s marker) - covers more distance
            nonUniformTimeline.to('#non-uniform-object', {
                duration: 1, 
                left: '35%', // More distance in second second
                ease: "power2.in", 
                onComplete: function() {
                    // Show 2s time marker and interval line
                    gsap.to('#non-uniform-marker-2', {
                        duration: 0.3,
                        opacity: 1,
                        ease: "power2.out"
                    });
                    
                    gsap.to('#non-uniform-time-2', {
                        duration: 0.3,
                        opacity: 1,
                        scale: 1.2,
                        ease: "back.out(1.7)",
                        onComplete: function() {
                            gsap.to('#non-uniform-time-2', {
                                duration: 0.2,
                                scale: 1
                            });
                        }
                    });
                }
            });
            
            // Third segment: even faster (2s to 3s marker) - covers even more distance
            nonUniformTimeline.to('#non-uniform-object', {
                duration: 1,
                left: '65%', // Even more distance in third second
                ease: "power3.in", 
                onComplete: function() {
                    // Show 3s time marker and interval line
                    gsap.to('#non-uniform-marker-3', {
                        duration: 0.3,
                        opacity: 1,
                        ease: "power2.out"
                    });
                    
                    gsap.to('#non-uniform-time-3', {
                        duration: 0.3,
                        opacity: 1,
                        scale: 1.2,
                        ease: "back.out(1.7)",
                        onComplete: function() {
                            gsap.to('#non-uniform-time-3', {
                                duration: 0.2,
                                scale: 1
                            });
                        }
                    });
                }
            });
            
            // Fourth segment: fastest (3s to 4s marker) - covers the most distance
            nonUniformTimeline.to('#non-uniform-object', {
                duration: 1, 
                left: '95%', // Maximum distance in fourth second
                ease: "power4.in", // Rapid acceleration
                onComplete: function() {
                    // Show 4s time marker and interval line
                    gsap.to('#non-uniform-marker-4', {
                        duration: 0.3,
                        opacity: 1,
                        ease: "power2.out"
                    });
                    
                    gsap.to('#non-uniform-time-4', {
                        duration: 0.3,
                        opacity: 1,
                        scale: 1.2,
                        ease: "back.out(1.7)",
                        onComplete: function() {
                            gsap.to('#non-uniform-time-4', {
                                duration: 0.2,
                                scale: 1
                            });
                        }
                    });
                }
            });
            
            // Play the timeline
            trackAnimation(nonUniformTimeline.play());
            
            // Wait for animation to complete
            await wait(4.5);
            if (!shouldContinue(taskId)) return;
            
            await wait(1000);
            
            await teacher.speak("In uniform motion, equal distances are covered in equal time intervals - that's why the time markers are evenly spaced. In non-uniform motion, unequal distances are covered in equal time intervals - notice how the red object moves progressively faster, covering more distance in each time interval. Most real-world motions are non-uniform!");
        }

        // Activities Demo
        async function showActivities() {
            stopCurrentDemo();
            isPlaying = true;
            setActiveButton(7);
            
            // Generate unique task ID for this demo
            const taskId = generateTaskId();
            currentTaskId = taskId;
            
            const teacher = createNewTeacher();
            await showActivitiesInternal(teacher, taskId);
            
            isPlaying = false;
        }

        async function showActivitiesInternal(teacher, taskId = null) {
            await resetAll();
            await wait(50);
            if (!shouldContinue(taskId)) return;
            
            updateTitle("🔬 NCERT Activities");
            
            document.getElementById('activity-demo').classList.add('active');
            await wait(50);
            if (!shouldContinue(taskId)) return;
            
            await teacher.speak("Let's explore the NCERT activities that help us understand motion concepts practically. You can use the navigation controls to move between activities.");
            if (!shouldContinue(taskId)) return;
            
            // Initialize activity slider
            initializeActivitySlider();
            
            await wait(1500);
            
            await teacher.speak("Activity 7.3 demonstrates the difference between distance and displacement using a basketball court. Walking along the sides gives you the distance, while the diagonal gives you the displacement.");
        }
        
        // Function to initialize activity slider
        function initializeActivitySlider() {
            let currentActivityIndex = 0;
            const activitySlider = document.getElementById('activity-slider');
            const prevButton = document.getElementById('prev-activity');
            const nextButton = document.getElementById('next-activity');
            const indicators = document.querySelectorAll('.activity-indicator');
            const totalActivities = 3;
            
            // Set up slider navigation
            prevButton.addEventListener('click', () => {
                if (currentActivityIndex > 0) {
                    currentActivityIndex--;
                    updateActivitySlider();
                }
            });
            
            nextButton.addEventListener('click', () => {
                if (currentActivityIndex < totalActivities - 1) {
                    currentActivityIndex++;
                    updateActivitySlider();
                }
            });
            
            indicators.forEach((indicator, index) => {
                indicator.addEventListener('click', () => {
                    currentActivityIndex = index;
                    updateActivitySlider();
                });
            });
            
            function updateActivitySlider() {
                // Since each card is 33.333% of the slider width, we need to translate by 33.333% for each activity
                activitySlider.style.transform = `translateX(-${currentActivityIndex * 33.333}%)`;
                
                // Update buttons state
                prevButton.disabled = currentActivityIndex === 0;
                nextButton.disabled = currentActivityIndex === totalActivities - 1;
                
                // Update indicators
                indicators.forEach((indicator, index) => {
                    indicator.classList.toggle('active', index === currentActivityIndex);
                });
                
                // Speak about current activity
                const activityDescriptions = [
                    "Activity 7.3 demonstrates the difference between distance and displacement using a basketball court. Walking along the sides gives you the distance, while the diagonal gives you the displacement.",
                    "Activity 7.4 uses an odometer to show that the distance traveled by road is different from the straight-line displacement between two cities.",
                    "Activity 7.5 helps you analyze motion data to determine whether motion is uniform or non-uniform by examining distance patterns over time."
                ];
                
                if (currentTeacher && currentTeacher.isEnabled) {
                    currentTeacher.speak(activityDescriptions[currentActivityIndex]);
                }
            }
            
            // Set up demo buttons for each activity
            setupDemoButtons();
        }
        
        // Setup demo button event listeners
        function setupDemoButtons() {
            // Remove any existing event listeners to prevent duplicates
            const courtBtn = document.getElementById('court-demo-btn');
            const odometerBtn = document.getElementById('odometer-demo-btn');
            const graphBtn = document.getElementById('graph-demo-btn');
            
            if (courtBtn) {
                courtBtn.replaceWith(courtBtn.cloneNode(true));
                document.getElementById('court-demo-btn').addEventListener('click', runBasketballCourtDemo);
            }
            
            if (odometerBtn) {
                odometerBtn.replaceWith(odometerBtn.cloneNode(true));
                document.getElementById('odometer-demo-btn').addEventListener('click', runOdometerDemo);
            }
            
            if (graphBtn) {
                graphBtn.replaceWith(graphBtn.cloneNode(true));
                document.getElementById('graph-demo-btn').addEventListener('click', runGraphDemo);
            }
        }

        // Basketball court demo animation
        function runBasketballCourtDemo() {
            try {
                const person = document.getElementById('court-person');
                const pathHorizontal = document.getElementById('court-path-horizontal');
                const pathVertical = document.getElementById('court-path-vertical');
                const displacement = document.getElementById('court-displacement');
                const distanceDisplay = document.getElementById('court-distance');
                const displacementDisplay = document.getElementById('court-displacement-value');
                
                if (!person || !pathHorizontal || !pathVertical || !displacement || !distanceDisplay || !displacementDisplay) {
                    console.error('Basketball court demo elements not found');
                    return;
                }
                
                // Find the court container more reliably
                const courtContainer = person.closest('.activity-animation').querySelector('div > div > div');
                if (!courtContainer) {
                    console.error('Court container not found');
                    return;
                }
                
                const courtWidth = courtContainer.offsetWidth;
                const courtHeight = courtContainer.offsetHeight;
                
                // Reset - align person with the start of horizontal line (exact path coordinates)
                gsap.set(person, { top: 30 - 14, left: 30 - 14 }); // Start at horizontal path start, offset by half emoji size
                gsap.set(pathHorizontal, { width: 0 });
                gsap.set(pathVertical, { height: 0 });
                gsap.set(displacement, { width: 0, opacity: 0 });
                distanceDisplay.textContent = "Distance: 0 m";
                displacementDisplay.textContent = "Displacement: 0 m";
                
                // Create timeline
                const tl = gsap.timeline();
                
                // Calculate the available space within the court container
                const availableWidth = courtWidth - 60; // 30px margin on each side
                const availableHeight = courtHeight - 60; // 30px margin on each side
                
                // Calculate the right and bottom positions to stay within bounds
                const rightPos = Math.min(availableWidth, Math.max(availableWidth * 0.8, 50));
                const bottomPos = Math.min(availableHeight, Math.max(availableHeight * 0.8, 50));
                
                // Calculate the exact end position of horizontal path (where vertical path starts)
                const horizontalEndX = 30 + rightPos; // horizontal path start + width
                const verticalStartX = horizontalEndX; // vertical path should start where horizontal ends
                
                // Step 1: Draw horizontal line (stays at top)
                tl.to(pathHorizontal, { 
                    width: rightPos,
                    duration: 1,
                    ease: "power2.out"
                });
                
                // Step 2: Move person horizontally along the top line to the end
                tl.to(person, { 
                    left: horizontalEndX - 14, // Move to end of horizontal path, centered on emoji
                    duration: 2,
                    ease: "power2.inOut",
                    onUpdate: function() {
                        const progress = this.progress();
                        const distance = Math.round(progress * 100);
                        distanceDisplay.textContent = `Distance: ${distance} m`;
                    }
                }, "-=0.5");
                
                // Step 3: Position and draw vertical line (from where horizontal ends, going down)
                tl.set(pathVertical, { 
                    left: horizontalEndX - 1.5 // Position vertical path at end of horizontal (center the 3px width)
                });
                
                tl.to(pathVertical, { 
                    height: bottomPos,
                    duration: 1,
                    ease: "power2.out"
                });
                
                // Step 4: Move person vertically down along the vertical line
                tl.to(person, { 
                    top: 30 + bottomPos - 70, // Move down along vertical path, centered on emoji
                    duration: 2,
                    ease: "power2.inOut",
                    onUpdate: function() {
                        const progress = this.progress();
                        const prevDistance = 100;
                        const additionalDistance = Math.round(progress * 100);
                        const totalDistance = prevDistance + additionalDistance;
                        distanceDisplay.textContent = `Distance: ${totalDistance} m`;
                    }
                }, "-=0.5");
                
                // Step 5: Show diagonal displacement from start to end
                const diagonalLength = Math.sqrt(Math.pow(rightPos, 2) + Math.pow(bottomPos, 2));
                tl.to(displacement, {
                    width: diagonalLength,
                    opacity: 1,
                    duration: 1,
                    ease: "power2.out",
                    onUpdate: function() {
                        const progress = this.progress();
                        const disp = Math.round(progress * 141); // √(100² + 100²) ≈ 141
                        displacementDisplay.textContent = `Displacement: ${disp} m`;
                    }
                });
                
                // Final state
                tl.to({}, {
                    duration: 1,
                    onComplete: function() {
                        distanceDisplay.textContent = "Distance: 200 m";
                        displacementDisplay.textContent = "Displacement: 141 m";
                        
                        if (currentTeacher && currentTeacher.isEnabled) {
                            currentTeacher.speak("Notice that the distance traveled along the sides is 200 meters, while the displacement (straight-line distance) is only 141 meters.");
                        }
                    }
                });
                
            } catch (error) {
                console.error('Error in basketball court demo:', error);
            }
        }
        
        // Odometer demo animation
        function runOdometerDemo() {
            try {
                const car = document.getElementById('map-car');
                const roadCurve = document.getElementById('road-curve');
                const directLine = document.getElementById('direct-line');
                const odometerDisplay = document.getElementById('odometer-reading');
                const displacementDisplay = document.getElementById('map-displacement-value');
                
                if (!car || !roadCurve || !directLine || !odometerDisplay || !displacementDisplay) {
                    console.error('Odometer demo elements not found');
                    return;
                }
                
                // Find the map container more reliably
                const divs = car.closest('.activity-animation').querySelectorAll('div > div > div');
                const mapContainer = divs[2];
                if (!mapContainer) {
                    console.error('Map container not found');
                    return;
                }
                
                // Get container dimensions for responsive path
                const containerWidth = mapContainer.offsetWidth;
                const containerHeight = mapContainer.offsetHeight;
                
                // Define waypoints for zigzag road (responsive)
                const waypoints = [
                    { x: 30, y: containerHeight - 30 },  // Start: Bhubaneshwar
                    { x: containerWidth * 0.25, y: containerHeight * 0.6 },
                    { x: containerWidth * 0.4, y: containerHeight * 0.7 },
                    { x: containerWidth * 0.6, y: containerHeight * 0.4 },
                    { x: containerWidth * 0.75, y: containerHeight * 0.5 },
                    { x: containerWidth - 30, y: 30 }    // End: New Delhi
                ];
                
                // Create zigzag path
                let pathData = `M ${waypoints[0].x},${waypoints[0].y}`;
                for (let i = 1; i < waypoints.length; i++) {
                    pathData += ` L ${waypoints[i].x},${waypoints[i].y}`;
                }
                
                // Update paths with responsive coordinates
                roadCurve.setAttribute('d', pathData);
                directLine.setAttribute('x1', waypoints[0].x);
                directLine.setAttribute('y1', waypoints[0].y);
                directLine.setAttribute('x2', waypoints[waypoints.length - 1].x);
                directLine.setAttribute('y2', waypoints[waypoints.length - 1].y);
                
                // Calculate path length for animation
                const pathLength = roadCurve.getTotalLength();
                
                // Reset elements
                gsap.set(car, { 
                    left: waypoints[0].x - 12, 
                    top: waypoints[0].y - 12, 
                    rotation: 0 
                });
                gsap.set(roadCurve, { 
                    opacity: 0,
                    strokeDasharray: pathLength,
                    strokeDashoffset: pathLength 
                });
                gsap.set(directLine, { opacity: 0 });
                odometerDisplay.textContent = "Odometer: 0 km";
                displacementDisplay.textContent = "Displacement: 0 km";
                
                // Create timeline
                const tl = gsap.timeline();
                
                // Step 1: Show the zigzag road path
                tl.to(roadCurve, {
                    opacity: 1,
                    duration: 0.5,
                    ease: "power2.out"
                });
                
                // Step 2: Animate road path drawing
                tl.to(roadCurve, {
                    strokeDashoffset: 0,
                    duration: 2,
                    ease: "power1.inOut"
                });
                
                // Step 3: Move car along the zigzag path
                for (let i = 1; i < waypoints.length; i++) {
                    const segmentDuration = 0.8;
                    const prevPoint = waypoints[i - 1];
                    const currentPoint = waypoints[i];
                    
                    // Calculate rotation angle for this segment
                    const angle = Math.atan2(currentPoint.y - prevPoint.y, currentPoint.x - prevPoint.x) * 180 / Math.PI;
                    
                    tl.to(car, {
                        left: currentPoint.x - 12,
                        top: currentPoint.y - 12,
                        rotation: angle,
                        duration: segmentDuration,
                        ease: "power2.inOut",
                        onUpdate: function() {
                            // Update odometer reading based on overall progress
                            const totalProgress = (i - 1 + this.progress()) / (waypoints.length - 1);
                            const distance = Math.round(totalProgress * 1850);
                            odometerDisplay.textContent = `Odometer: ${distance} km`;
                        }
                    }, i === 1 ? "-=1.5" : "-=0.2"); // Overlap with path drawing for first segment
                }
                
                // Step 4: Show displacement line
                tl.to(directLine, {
                    opacity: 1,
                    duration: 1,
                    ease: "power2.out",
                    onUpdate: function() {
                        const progress = this.progress();
                        const disp = Math.round(progress * 1500);
                        displacementDisplay.textContent = `Displacement: ${disp} km`;
                    }
                });
                
                // Final state
                tl.to({}, {
                    duration: 0.5,
                    onComplete: function() {
                        odometerDisplay.textContent = "Odometer: 1850 km";
                        displacementDisplay.textContent = "Displacement: 1500 km";
                        
                        if (currentTeacher && currentTeacher.isEnabled) {
                            currentTeacher.speak("The odometer shows the total road distance of 1850 kilometers, while the displacement (straight-line distance) is approximately 1500 kilometers.");
                        }
                    }
                });
                
            } catch (error) {
                console.error('Error in odometer demo:', error);
            }
        }
        
        // Graph demo animation
        function runGraphDemo() {
            try {
                const lineA = document.getElementById('graph-line-a');
                const lineB = document.getElementById('graph-line-b');
                
                if (!lineA || !lineB) {
                    console.error('Graph demo elements not found');
                    return;
                }
                
                // Find the graph container more reliably
                const divs = lineA.closest('.activity-animation').querySelectorAll('div > div > div');
                const graphContainer = divs[2];
                console.log('Graph container:', graphContainer);
                if (!graphContainer) {
                    console.error('Graph container not found');
                    return;
                }
                
                // Get the actual width and calculate proper dasharray length
                const graphWidth = graphContainer.offsetWidth;
                const graphHeight = graphContainer.offsetHeight;
                const pathLength = Math.max(Math.sqrt(Math.pow(graphWidth, 2) + Math.pow(graphHeight, 2)), 300);
                
                // Reset with proper path length
                console.log('Graph container size:', graphWidth, graphHeight , graphContainer);
                console.log('Calculated path length:', pathLength);
                gsap.set(lineA.querySelector('line'), { strokeDasharray: pathLength, strokeDashoffset: pathLength });
                gsap.set(lineB.querySelector('path'), { strokeDasharray: pathLength, strokeDashoffset: pathLength });
                
                // Create timeline
                const tl = gsap.timeline();
                
                // Draw line A (uniform motion)
                tl.to(lineA.querySelector('line'), {
                    strokeDashoffset: 0,
                    duration: 2,
                    ease: "linear"
                });
                
                // Draw line B (non-uniform motion)
                tl.to(lineB.querySelector('path'), {
                    strokeDashoffset: 0,
                    duration: 2,
                    ease: "power1.inOut"
                }, "-=1.2");
                
                // Final state
                tl.to({}, {
                    duration: 1,
                    onComplete: function() {
                        if (currentTeacher && currentTeacher.isEnabled) {
                            currentTeacher.speak("The green line shows uniform motion with a constant slope, meaning equal distances in equal times. The red line shows non-uniform motion with varying slope, meaning different distances in equal time intervals.");
                        }
                    }
                });
                
            } catch (error) {
                console.error('Error in graph demo:', error);
            }
        }

        // Data Analysis Demo
        async function showDataAnalysis() {
            stopCurrentDemo();
            isPlaying = true;
            setActiveButton(8);
            
            // Generate unique task ID for this demo
            const taskId = generateTaskId();
            currentTaskId = taskId;
            
            const teacher = createNewTeacher();
            await showDataAnalysisInternal(teacher, taskId);
            
            isPlaying = false;
        }

        async function showDataAnalysisInternal(teacher, taskId = null) {
            await resetAll();
            await wait(50);
            if (!shouldContinue(taskId)) return;
            
            updateTitle("📊 Motion Data Analysis");
            
            document.getElementById('data-demo').classList.add('active');
            await wait(50);
            if (!shouldContinue(taskId)) return;
            
            await teacher.speak("Let's analyze the motion data from Table 7.1 to understand uniform and non-uniform motion.");
            if (!shouldContinue(taskId)) return;
            
            await wait(2000);
            
            await teacher.speak("Object A covers exactly 10 meters every 15 minutes - from 10 to 20, then 20 to 30, and so on. This is uniform motion because equal distances are covered in equal time intervals.");
            if (!shouldContinue(taskId)) return;
            
            await wait(3000);
            
            await teacher.speak("Object B covers varying distances - 7 meters, then 4 meters, then 12 meters, and so on. This irregular pattern indicates non-uniform motion.");
            if (!shouldContinue(taskId)) return;
            
            await wait(2500);
            
            await teacher.speak("By examining motion data this way, we can easily identify whether an object is in uniform or non-uniform motion.");
        }

        // Questions Demo
        async function showQuestions() {
            stopCurrentDemo();
            isPlaying = true;
            setActiveButton(9);
            
            // Generate unique task ID for this demo
            const taskId = generateTaskId();
            currentTaskId = taskId;
            
            const teacher = createNewTeacher();
            await showQuestionsInternal(teacher, taskId);
            
            isPlaying = false;
        }

        async function showQuestionsInternal(teacher, taskId = null) {
            await resetAll();
            await wait(50);
            if (!shouldContinue(taskId)) return;
            
            updateTitle("❓ Practice Questions");
            
            document.getElementById('questions-demo').classList.add('active');
            await wait(50);
            if (!shouldContinue(taskId)) return;
            
            // Initialize questions slider
            initializeQuestionsSlider();
            
            await teacher.speak("Let's test your understanding with some practice questions from the NCERT textbook.");
            if (!shouldContinue(taskId)) return;
            
            await wait(1500);
            
            await teacher.speak("These questions will help you apply the concepts of distance, displacement, and motion types to real-world scenarios. Click 'Show Answer' to see detailed explanations.");
        }
        
        // Function to initialize questions slider
        function initializeQuestionsSlider() {
            let currentQuestionIndex = 0;
            const questionsSlider = document.getElementById('questions-slider');
            const prevButton = document.getElementById('prev-question');
            const nextButton = document.getElementById('next-question');
            const indicators = document.querySelectorAll('.question-indicator');
            const totalQuestions = 3;
            
            // Remove any existing event listeners by cloning elements
            if (prevButton) {
                const newPrevButton = prevButton.cloneNode(true);
                prevButton.parentNode.replaceChild(newPrevButton, prevButton);
            }
            
            if (nextButton) {
                const newNextButton = nextButton.cloneNode(true);
                nextButton.parentNode.replaceChild(newNextButton, nextButton);
            }
            
            // Get the new button references
            const prevBtn = document.getElementById('prev-question');
            const nextBtn = document.getElementById('next-question');
            const newIndicators = document.querySelectorAll('.question-indicator');
            
            function updateQuestionsSlider() {
                if (!questionsSlider) return;
                
                // Since each card is 100% of the container width, we need to translate by 100% for each question
                questionsSlider.style.transform = `translateX(-${currentQuestionIndex * 100}%)`;
                
                // Update buttons state
                if (prevBtn) {
                    prevBtn.disabled = currentQuestionIndex === 0;
                }
                if (nextBtn) {
                    nextBtn.disabled = currentQuestionIndex === totalQuestions - 1;
                }
                
                // Update indicators
                newIndicators.forEach((indicator, index) => {
                    indicator.classList.toggle('active', index === currentQuestionIndex);
                });
                
                // Speak about current question
                const questionDescriptions = [
                    "Question 1 asks about whether an object can have zero displacement after moving through a distance.",
                    "Question 2 is a calculation problem about a farmer moving around a square field.",
                    "Question 3 tests your understanding of displacement properties with multiple choice options."
                ];
                
                if (currentTeacher && currentTeacher.isEnabled) {
                    currentTeacher.speak(questionDescriptions[currentQuestionIndex]);
                }
            }
            
            // Set up slider navigation with new elements
            if (prevBtn) {
                prevBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    console.log('Previous button clicked, current index:', currentQuestionIndex);
                    if (currentQuestionIndex > 0) {
                        currentQuestionIndex--;
                        updateQuestionsSlider();
                    }
                });
            }
            
            if (nextBtn) {
                nextBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    console.log('Next button clicked, current index:', currentQuestionIndex);
                    if (currentQuestionIndex < totalQuestions - 1) {
                        currentQuestionIndex++;
                        updateQuestionsSlider();
                    }
                });
            }
            
            newIndicators.forEach((indicator, index) => {
                indicator.addEventListener('click', (e) => {
                    e.preventDefault();
                    console.log('Indicator clicked, index:', index);
                    currentQuestionIndex = index;
                    updateQuestionsSlider();
                });
            });
            
            // Initialize first state
            updateQuestionsSlider();
            
            console.log('Questions slider initialized with', totalQuestions, 'questions');
        }

        // Show answer function
        function showAnswer(questionNumber) {
            const answerSection = document.getElementById(`answer-${questionNumber}`);
            answerSection.classList.add('show');
            
            if (currentTeacher) {
                const answers = {
                    1: "Yes, displacement can be zero even when distance is covered, like when returning to the starting point.",
                    2: "After 3.5 rounds around the square field, the farmer is at the opposite corner, giving a displacement of 14.14 meters.",
                    3: "Neither option is correct. Displacement can be zero and its magnitude is always less than or equal to distance."
                };
                currentTeacher.speak(answers[questionNumber]);
            }
        }

        // Helper Functions
        async function resetAll() {
            if (animationTimeline) {
                animationTimeline.kill();
                animationTimeline = null;
            }
            gsap.killTweensOf("*");
            
            activeAnimations.forEach(anim => {
                if (anim) anim.kill();
            });
            activeAnimations = [];
            
            if (currentTeacher) {
                currentTeacher.stop();
            }
            
            // Hide all demos
            document.querySelectorAll('.reference-demo, .motion-demo, .uniform-demo, .activity-demo, .data-demo, .questions-demo').forEach(demo => {
                demo.classList.remove('active');
            });
            
            
            updateTitle("Explore Motion Concepts");
            
            // Reset reference demo elements
            gsap.set('#railway-station', { scale: 1, boxShadow: "0 5px 15px rgba(0, 0, 0, 0.3)" });
            gsap.set('#school', { scale: 1, boxShadow: "0 5px 15px rgba(0, 0, 0, 0.3)" });
            gsap.set('#distance-line', { opacity: 0, scaleX: 0 });
            gsap.set('#distance-label', { opacity: 0, scale: 0.8 });
            gsap.set('#direction-arrow', { opacity: 0 });
            
            // Reset motion demo elements
            gsap.set('#moving-object', { left: '10%' });
            gsap.set('#distance-info', { opacity: 0, y: -20 });
            gsap.set('#displacement-info', { opacity: 0, y: -20 });
            document.getElementById('distance-value').textContent = '0 km';
            document.getElementById('displacement-value').textContent = '0 km';
            
            // Reset uniform motion elements
            gsap.set('#uniform-object', { left: '5%' });
            gsap.set('#non-uniform-object', { left: '5%' });
            
            // Reset answer sections
            document.querySelectorAll('.answer-section').forEach(section => {
                section.classList.remove('show');
            });
            
            await wait(500);
        }

        function updateTitle(title) {
            document.getElementById('demo-title').textContent = title;
        }

        function setActiveButton(index) {
            document.querySelectorAll('.demo-btn').forEach((btn, i) => {
                btn.classList.toggle('active', i === index);
            });
        }

        function wait(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        // Reset Button Handler
        async function resetAllClick() {
            stopCurrentDemo();
            isPlaying = false;
            await resetAll();
             document.querySelectorAll('.demo-btn').forEach(demo => {
                demo.classList.remove('active');
            });
        }

        // Audio Control
        document.getElementById('mute-btn').addEventListener('click', () => {
            globalAudioEnabled = !globalAudioEnabled;
            document.getElementById('mute-btn').classList.toggle('muted', !globalAudioEnabled);
            
            if (!globalAudioEnabled && currentTeacher) {
                currentTeacher.stop();
            }
        });
    </script>
</body>
</html>