<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Power - Rate of Doing Work - Physics in Motion</title>
    <!-- GSAP for animations -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            color: white;
            overflow-x: hidden;
            min-height: 100vh;
        }

        /* Audio Control */
        #audio-control {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }

        .control-btn {
            background: rgba(16, 185, 129, 0.9);
            border: none;
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .control-btn:hover {
            transform: scale(1.1);
            background: rgba(16, 185, 129, 1);
        }

        .control-btn.muted .unmute-icon { display: none; }
        .control-btn:not(.muted) .mute-icon { display: none; }

        /* Main Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 30px 20px;
        }

        /* Header */
        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .header h1 {
            font-size: 3rem;
            background: linear-gradient(45deg, #10b981, #34d399, #6ee7b7);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.95;
            max-width: 800px;
            margin: 0 auto;
            line-height: 1.6;
        }

        /* Demo Stage */
        .demo-stage {
            background: linear-gradient(to bottom, #1a1a2e, #16213e, #0f3460);
            border-radius: 25px;
            min-height: 750px;
            position: relative;
            margin: 40px 0;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5);
            overflow: hidden;
            border: 3px solid rgba(16, 185, 129, 0.4);
            padding: 40px;
        }

        /* Welcome Animation Demo */
        .welcome-demo {
            display: none;
            position: relative;
            width: 100%;
            height: 450px;
            text-align: center;
        }

        .welcome-demo.active {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .power-visual {
            position: relative;
            width: 100%;
            height: 300px;
            margin: 20px 0;
        }

        .energy-flow {
            position: absolute;
            top: 50%;
            left: 10%;
            right: 10%;
            height: 8px;
            background: linear-gradient(90deg, #10b981, #34d399, #6ee7b7, #10b981);
            background-size: 200% 100%;
            border-radius: 4px;
            animation: energyFlow 2s linear infinite;
            box-shadow: 0 0 20px rgba(16, 185, 129, 0.5);
        }

        @keyframes energyFlow {
            0% { background-position: 0% 50%; }
            100% { background-position: 200% 50%; }
        }

        .power-icons {
            display: flex;
            justify-content: space-around;
            align-items: center;
            width: 100%;
            height: 100%;
            position: relative;
        }

        .power-element {
            display: flex;
            flex-direction: column;
            align-items: center;
            opacity: 0;
            transform: scale(0.5);
            transition: all 0.8s ease;
        }

        .power-element.visible {
            opacity: 1;
            transform: scale(1);
        }

        .power-element-icon {
            font-size: 4rem;
            margin-bottom: 15px;
            filter: drop-shadow(0 0 10px rgba(16, 185, 129, 0.3));
        }

        .power-element-label {
            color: #10b981;
            font-weight: bold;
            font-size: 1.1rem;
            text-align: center;
            background: rgba(0, 0, 0, 0.7);
            padding: 8px 15px;
            border-radius: 15px;
            border: 2px solid rgba(16, 185, 129, 0.3);
        }

        .welcome-title {
            font-size: 2.5rem;
            color: #10b981;
            margin: 30px 0 20px 0;
            font-weight: bold;
            text-shadow: 0 0 20px rgba(16, 185, 129, 0.5);
        }

        .welcome-subtitle {
            font-size: 1.3rem;
            color: #e2e8f0;
            line-height: 1.6;
            max-width: 800px;
            margin-top: 30px;
        }

        .power-definition-card {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.15), rgba(34, 197, 94, 0.15));
            border: 2px solid #10b981;
            border-radius: 20px;
            padding: 25px;
            margin: 30px auto;
            max-width: 900px;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.8s ease;
        }

        .power-definition-card.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .definition-title {
            font-size: 1.8rem;
            color: #10b981;
            margin-bottom: 20px;
            font-weight: bold;
            text-align: left;
        }

        .definition-text {
            font-size: 1.2rem;
            color: #e2e8f0;
            line-height: 1.8;
            text-align: left;
            margin-bottom: 25px;
        }

        .formula-section {
            background: rgba(251, 191, 36, 0.1);
            border: 2px solid rgba(251, 191, 36, 0.3);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            margin-top: 20px;
        }

        .formula-large {
            font-size: 3rem;
            color: #fbbf24;
            font-family: 'Courier New', monospace;
            margin: 15px 0;
            text-shadow: 0 0 20px rgba(251, 191, 36, 0.5);
        }

        .formula-variables {
            color: #e2e8f0;
            font-size: 1.1rem;
            line-height: 1.8;
            text-align: left;
            margin-top: 15px;
        }

        .formula-variables strong {
            color: #fbbf24;
        }

        /* Climbing Demo */
        .climbing-demo {
            display: none;
            position: relative;
            width: 100%;
            height: 600px;
        }

        .climbing-demo.active {
            display: block;
        }

        .climbing-stage {
            display: flex;
            justify-content: space-around;
            align-items: flex-end;
            height: 100%;
            position: relative;
        }

        .climber-section {
            width: 300px;
            height: 450px;
            position: relative;
            background: linear-gradient(to bottom, #e5e7eb 0%, #9ca3af 100%);
            border-radius: 10px;
            border: 2px solid #6b7280;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .rope {
            width: 10px;
            height: 100%;
            background: linear-gradient(to bottom, #92400e, #b45309);
            margin: 0 auto;
            border-radius: 5px;
            position: relative;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
        }

        .climber {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 30px;
            transition: all 0.3s ease;
            z-index: 10;
            border: 3px solid #1e40af;
        }

        .climber.climbing {
            animation: none; /* Will be controlled by GSAP */
        }

        .climber-label {
            position: absolute;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.7);
            padding: 8px 15px;
            border-radius: 15px;
            font-weight: bold;
            font-size: 1.1rem;
            border: 2px solid #10b981;
        }

        .height-marker {
            position: absolute;
            right: -60px;
            top: -60px;
            background: rgba(16, 185, 129, 0.2);
            padding: 10px;
            border-radius: 10px;
            border: 2px solid #10b981;
            font-weight: bold;
        }

        .timer-display {
            position: absolute;
            top: -60px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(239, 68, 68, 0.9);
            padding: 10px 20px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 1.1rem;
            opacity: 0;
            transition: all 0.5s ease;
            white-space: nowrap;
            min-width: 100px;
            text-align: center;
        }

        .timer-display.visible {
            opacity: 1;
        }

        .power-result {
            position: absolute;
            bottom: -90px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #10b981, #059669);
            padding: 12px 20px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 1.1rem;
            opacity: 0;
            transition: all 0.5s ease;
            border: 2px solid #047857;
            white-space: nowrap;
            min-width: 120px;
            text-align: center;
        }

        .power-result.visible {
            opacity: 1;
            transform: translateX(-50%) scale(1.05);
        }

        /* Staircase Demo */
        .staircase-demo {
            display: none;
            position: relative;
            width: 100%;
            height: 600px;
            overflow: scroll;
            min-height: 600px;
            padding: 20px 0;
        }

        .staircase-demo.active {
            display: block;
        }
        
        .example-title {
            text-align: center;
            font-size: 1.5rem;
            color: #10b981;
            margin-bottom: 20px;
            font-weight: bold;
        }

        .staircase-container {
            position: relative;
            width: 95%;
            height: 100%;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            gap: 30px;
            padding: 20px 0;
        }
        
        .staircase-top-row {
            display: flex;
            flex-direction: row;
            justify-content: space-between;
            align-items: flex-start;
            gap: 40px;
            margin-bottom: 30px;
        }

        .staircase {
            position: relative;
            width: 45%;
            height: 350px;
            background: linear-gradient(135deg, 
                rgba(248, 250, 252, 0.9) 0%,
                rgba(241, 245, 249, 0.8) 50%,
                rgba(226, 232, 240, 0.7) 100%);
            border-radius: 20px;
            border: 2px solid rgba(148, 163, 184, 0.3);
            overflow: hidden;
            box-shadow: 
                0 20px 40px rgba(0, 0, 0, 0.1),
                0 8px 16px rgba(0, 0, 0, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.8);
            transition: all 0.3s ease;
        }
        
        .staircase:hover {
            box-shadow: 
                0 25px 50px rgba(0, 0, 0, 0.15),
                0 12px 24px rgba(0, 0, 0, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.9);
            transform: translateY(-2px);
        }

        .step {
            position: absolute;
            background: linear-gradient(135deg, 
                #e2e8f0 0%,
                #cbd5e1 50%,
                #94a3b8 100%);
            border: 1px solid #cbd5e1;
            border-radius: 6px;
            box-shadow: 
                0 2px 4px rgba(0, 0, 0, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.5);
        }

        .runner {
            position: absolute;
            bottom: 15px;
            left: 25px;
            width: 55px;
            height: 55px;
            background: linear-gradient(135deg, 
                #fbbf24 0%,
                #f59e0b 50%,
                #d97706 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 26px;
            z-index: 20;
            border: 3px solid #f59e0b;
            box-shadow: 
                0 4px 8px rgba(0, 0, 0, 0.2),
                0 2px 4px rgba(0, 0, 0, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
        }

        .runner.running {
            animation: none; /* Will be controlled by GSAP */
        }

        .staircase-info {
            position: relative;
            background: linear-gradient(135deg, 
                rgba(255, 255, 255, 0.95) 0%,
                rgba(248, 250, 252, 0.9) 100%);
            padding: 20px;
            border-radius: 16px;
            border: 2px solid rgba(16, 185, 129, 0.3);
            width: 40%;
            font-size: 0.85rem;
            backdrop-filter: blur(10px);
            box-shadow: 
                0 15px 30px rgba(0, 0, 0, 0.1),
                0 6px 12px rgba(0, 0, 0, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.8);
            transition: all 0.3s ease;
        }
        
        .staircase-info:hover {
            box-shadow: 
                0 25px 50px rgba(0, 0, 0, 0.15),
                0 12px 24px rgba(0, 0, 0, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.9);
            transform: translateY(-2px);
            border-color: rgba(16, 185, 129, 0.5);
        }

        .info-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 10px 0;
            padding: 8px 12px;
            border-bottom: 1px solid rgba(148, 163, 184, 0.2);
            border-radius: 6px;
            transition: all 0.3s ease;
        }
        
        .info-item:hover {
            background-color: rgba(16, 185, 129, 0.05);
            border-bottom-color: rgba(16, 185, 129, 0.3);
            transform: translateX(4px);
        }

        .info-label {
            color: #475569;
            font-weight: 600;
            font-size: 0.8rem;
        }

        .info-value {
            color: #10b981;
            font-weight: 700;
            font-size: 0.9rem;
            position: relative;
            padding: 4px 8px;
            border-radius: 6px;
            background: linear-gradient(135deg, 
                rgba(16, 185, 129, 0.1) 0%,
                rgba(16, 185, 129, 0.05) 100%);
            border: 1px solid rgba(16, 185, 129, 0.2);
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
        }

        .explanation-panel {
            position: relative;
            display: flex;
            gap: 25px;
            justify-content: center;
            flex-wrap: wrap;
            width: 100%;
            margin-top: 40px;
            padding: 20px 0;
        }

        .explanation-card {
            background: linear-gradient(135deg, 
                rgba(255, 255, 255, 0.95) 0%,
                rgba(248, 250, 252, 0.9) 100%);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(16, 185, 129, 0.3);
            border-radius: 16px;
            padding: 24px;
            color: #1e293b;
            min-width: 200px;
            max-width: 240px;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.8s ease;
            font-size: 0.95rem;
            margin: 15px;
            box-shadow: 
                0 15px 35px rgba(0, 0, 0, 0.1),
                0 8px 16px rgba(0, 0, 0, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.8);
            position: relative;
            overflow: hidden;
        }
        
        .explanation-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                90deg, 
                transparent, 
                rgba(255, 255, 255, 0.1), 
                transparent
            );
            transition: all 0.6s ease;
        }
        
        .explanation-card:hover::before {
            left: 100%;
        }
        
        .explanation-card:hover {
            box-shadow: 
                0 20px 40px rgba(0, 0, 0, 0.15),
                0 12px 24px rgba(0, 0, 0, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.9);
            transform: translateY(-4px);
            border-color: rgba(16, 185, 129, 0.5);
        }

        .explanation-card.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .explanation-card h3 {
            color: #10b981;
            margin: 0 0 16px 0;
            font-size: 18px;
            font-weight: 700;
            text-align: center;
            padding-bottom: 8px;
            border-bottom: 2px solid rgba(16, 185, 129, 0.2);
            position: relative;
        }
        
        .explanation-card h3::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 50%;
            height: 2px;
            background: linear-gradient(to right, rgba(0, 255, 157, 0.8), transparent);
        }

        .explanation-card div {
            margin: 10px 0;
            font-size: 14px;
            line-height: 1.5;
            letter-spacing: 0.3px;
            position: relative;
            padding-left: 5px;
        }

        .calc-step {
            opacity: 0;
            transform: translateX(-10px);
            transition: all 0.6s ease;
            color: #ffd700;
            font-weight: 500;
            padding: 6px 10px;
            border-left: 2px solid rgba(255, 215, 0, 0.3);
            margin-left: 5px;
            position: relative;
        }
        
        .calc-step::before {
            content: 'â†’';
            position: absolute;
            left: -15px;
            color: rgba(255, 215, 0, 0.6);
            font-weight: bold;
            opacity: 0;
            transition: all 0.3s ease;
        }
        
        .calc-step:hover::before {
            opacity: 1;
            left: -10px;
        }

        .calc-step.visible {
            opacity: 1;
            transform: translateX(0);
        }

        .final-answer {
            color: #1b5e45;
            font-size: 16px;
            font-weight: bold;
            text-align: center;
            padding: 12px;
            background: rgba(0, 255, 157, 0.2);
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 255, 157, 0.15),
                        inset 0 1px 2px rgba(255, 255, 255, 0.1);
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(0, 255, 157, 0.3);
            letter-spacing: 0.5px;
        }

        .result-highlight {
            position: relative;
            background: linear-gradient(135deg, 
                #10b981 0%,
                #059669 50%,
                #047857 100%);
            color: white;
            padding: 0px 30px 35px 30px;
            border-radius: 24px;
            font-size: 28px;
            font-weight: 700;
            text-align: center;
            box-shadow: 
                0 20px 40px rgba(16, 185, 129, 0.3),
                0 10px 20px rgba(0, 0, 0, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
            opacity: 0;
            transform: scale(0.8);
            transition: all 0.8s ease;
            margin: 50px auto 0;
            max-width: fit-content;
            border: 2px solid rgba(255, 255, 255, 0.2);
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            letter-spacing: 0.5px;
        }
        
        .result-highlight::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(
                circle,
                rgba(255, 255, 255, 0.1) 0%,
                transparent 70%
            );
            opacity: 0;
            transition: opacity 0.8s ease;
        }
        
        .result-highlight:hover::after {
            opacity: 1;
        }

        .result-highlight.visible {
            opacity: 1;
            transform: scale(1);
        }

        /* Numerical Problems Slideshow */
        .numerical-demo {
            display: none;
            position: relative;
            width: 100%;
            height: 850px;
            overflow: hidden;
        }

        .numerical-demo.active {
            display: block;
        }

        .numerical-slideshow {
            position: relative;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }

        .numerical-container {
            display: flex;
            width: 300%;
            height: 100%;
            transition: transform 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .numerical-card {
            width: 33.333%;
            height: 100%;
            padding: 20px;
            box-sizing: border-box;
            flex-shrink: 0;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
        }

        .problem-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(0, 255, 157, 0.3);
            border-radius: 20px;
            padding: 30px;
            height: 100%;
            color: white;
            overflow-y: auto;
            margin: 0 10px;
        }

        .problem-title {
            color: #00ff9d;
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 20px;
            text-align: center;
        }

        .problem-statement {
            background: rgba(0, 100, 255, 0.1);
            border: 2px solid rgba(0, 100, 255, 0.3);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            font-size: 16px;
            line-height: 1.6;
        }

        .solution-section {
            margin-top: 20px;
        }

        .solution-title {
            color: #ffd700;
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .solution-step {
            background: rgba(255, 215, 0, 0.1);
            border-left: 4px solid #ffd700;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            opacity: 0;
            transform: translateY(10px);
            transition: all 0.6s ease;
        }

        .solution-step.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .solution-step strong {
            color: #ffd700;
        }

        .final-result {
            background: linear-gradient(135deg, #00ff9d, #00bcd4);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            font-size: 20px;
            font-weight: bold;
            margin-top: 20px;
            opacity: 0;
            transform: scale(0.9);
            transition: all 0.8s ease;
        }

        .final-result.visible {
            opacity: 1;
            transform: scale(1);
        }

        .numerical-nav {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .numerical-nav button {
            background: rgba(0, 255, 157, 0.2);
            border: 2px solid #00ff9d;
            color: #00ff9d;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            font-size: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .numerical-nav button:hover {
            background: rgba(0, 255, 157, 0.4);
            transform: scale(1.1);
        }

        .numerical-indicators {
            display: flex;
            gap: 10px;
        }

        .numerical-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .numerical-indicator.active {
            background: #00ff9d;
            transform: scale(1.3);
        }

        /* Activity 10.17 Slideshow */
        .activity1017-demo {
            display: none;
            position: relative;
            width: 100%;
            height: 600px;
        }

        .activity1017-demo.active {
            display: block;
        }

        .activity1017-slideshow {
            position: relative;
            width: 100%;
            height: 100%;
            overflow: hidden;
            border-radius: 15px;
        }

        .activity1017-container {
            display: flex;
            width: 500%;
            height: 100%;
            transition: transform 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .activity1017-card {
            width: 20%;
            height: 100%;
            padding: 20px;
            box-sizing: border-box;
            flex-shrink: 0;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
        }

        .activity1017-slide {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(0, 255, 157, 0.3);
            border-radius: 20px;
            padding: 30px;
            height: 100%;
            color: white;
            overflow-y: auto;
            margin: 0 10px;
        }

        .activity1017-title {
            color: #00ff9d;
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 20px;
            text-align: center;
        }

        .meter-visualization {
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 20px 0;
            height: 150px;
        }

        .electric-meter {
            width: 200px;
            height: 120px;
            background: linear-gradient(145deg, #2a2a2a, #1a1a1a);
            border: 3px solid #444;
            border-radius: 10px;
            position: relative;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .meter-display {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #000;
            color: #00ff00;
            padding: 10px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 18px;
            font-weight: bold;
            border: 1px solid #333;
        }

        .meter-label {
            position: absolute;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            color: #ccc;
            font-size: 12px;
            font-weight: bold;
        }

        .reading-table {
            margin: 20px 0;
            width: 100%;
            border-collapse: collapse;
        }

        .reading-table th,
        .reading-table td {
            border: 1px solid rgba(0, 255, 157, 0.3);
            padding: 10px;
            text-align: center;
        }

        .reading-table th {
            background: rgba(0, 255, 157, 0.2);
            color: #00ff9d;
            font-weight: bold;
        }

        .reading-table td {
            background: rgba(0, 0, 0, 0.2);
        }

        .key-concepts {
            background: rgba(0, 255, 157, 0.1);
            border-left: 4px solid #00ff9d;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }

        .concept-item {
            margin: 10px 0;
            padding: 10px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 5px;
        }

        .concept-number {
            color: #ffd700;
            font-weight: bold;
            margin-right: 10px;
        }

        .appliance-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .appliance-item {
            background: rgba(0, 100, 255, 0.1);
            border: 1px solid rgba(0, 100, 255, 0.3);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
        }

        .appliance-icon {
            font-size: 30px;
            margin-bottom: 10px;
        }

        .appliance-name {
            color: #00bcd4;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .appliance-power {
            color: #ffd700;
            font-size: 14px;
        }


        /* Activity 10.17 Indicators */
        .activity1017-indicators {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 40px;
            margin-bottom: 20px;
        }

        .activity1017-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .activity1017-indicator.active {
            background: #00ff9d;
            transform: scale(1.3);
        }

        /* Power Types Explanation Slideshow */
        .power-types-demo {
            display: none;
            position: relative;
            width: 100%;
            height: 640px;
        }

        .power-types-demo.active {
            display: block;
        }

        .power-types-slideshow {
            position: relative;
            width: 100%;
            height: 100%;
            overflow: hidden;
            border-radius: 15px;
        }

        .power-types-container {
            display: flex;
            width: 300%;
            height: 100%;
            transition: transform 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .power-types-card {
            width: 33.333%;
            height: 100%;
            padding: 20px;
            box-sizing: border-box;
            flex-shrink: 0;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
        }

        .power-types-slide {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(16, 185, 129, 0.3);
            border-radius: 20px;
            padding: 30px;
            min-height: 100%;
            height: auto;
            color: white;
            text-align: center;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            overflow-y: auto;
        }

        .power-type-icon {
            font-size: 80px;
            margin-bottom: 20px;
        }

        .power-types-title {
            color: #10b981;
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 20px;
        }

        .power-type-content {
            text-align: left;
        }

        .power-type-description {
            font-size: 16px;
            line-height: 1.6;
            margin-bottom: 25px;
            color: #e2e8f0;
        }

        .numerical-example {
            background: rgba(16, 185, 129, 0.1);
            border-left: 4px solid #10b981;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }

        .numerical-example h4 {
            color: #10b981;
            margin: 0 0 15px 0;
            font-size: 18px;
        }

        .example-item {
            color: #ffd700;
            font-size: 14px;
            margin: 8px 0;
            font-weight: 500;
        }

        .formula-highlight {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            font-size: 20px;
            font-weight: bold;
            font-family: 'Courier New', monospace;
            margin-top: 20px;
        }

        /* Power Types Navigation */
        .power-types-nav {
            position: relative;
            margin-top: 40px;
            margin-bottom: 20px;
            display: flex;
            justify-content: center;
            gap: 20px;
            align-items: center;
        }
        
        .power-types-nav button {
            background: rgba(16, 185, 129, 0.2);
            border: 2px solid #10b981;
            color: #10b981;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            font-size: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .power-types-nav button:hover {
            background: rgba(16, 185, 129, 0.4);
            transform: scale(1.1);
        }

        /* Power Types Indicators */
        .power-types-indicators {
            display: flex;
            gap: 10px;
        }

        .power-types-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .power-types-indicator.active {
            background: #10b981;
            transform: scale(1.3);
        }

        /* Power Sources Visual */
        .power-sources-visual {
            padding: 20px 0;
        }

        .power-sources-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 30px;
            margin: 20px 0;
        }

        .power-source-item {
            background: rgba(0, 255, 157, 0.1);
            border: 2px solid rgba(0, 255, 157, 0.3);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .power-source-item:hover {
            transform: translateY(-5px);
            border-color: rgba(0, 255, 157, 0.6);
            box-shadow: 0 10px 20px rgba(0, 255, 157, 0.2);
        }

        .power-source-icon {
            font-size: 48px;
            margin-bottom: 15px;
        }

        .power-source-label {
            color: #00ff9d;
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .power-source-desc {
            color: #e2e8f0;
            font-size: 14px;
            line-height: 1.5;
        }

        /* Power Comparison Demo */
        .power-comparison-demo {
            display: none;
            position: relative;
            width: 100%;
            height: 500px;
        }

        .power-comparison-demo.active {
            display: block;
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 30px;
            height: 100%;
            align-items: center;
        }

        .power-card {
            background: rgba(15, 23, 42, 0.9);
            padding: 25px;
            border-radius: 20px;
            text-align: center;
            border: 2px solid rgba(16, 185, 129, 0.3);
            transition: all 0.3s ease;
            height: 300px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .power-card:hover {
            transform: translateY(-5px);
            border-color: #10b981;
            box-shadow: 0 15px 30px rgba(16, 185, 129, 0.3);
        }

        .power-icon {
            font-size: 4rem;
            margin-bottom: 20px;
        }

        .power-title {
            font-size: 1.3rem;
            color: #10b981;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .power-value {
            font-size: 2rem;
            font-weight: bold;
            color: #fbbf24;
            margin-bottom: 10px;
        }

        .power-description {
            color: #e2e8f0;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        /* Formula Demo */
        .formula-demo {
            display: none;
            padding: 30px;
        }

        .formula-demo.active {
            display: block;
        }

        .formula-container {
            background: rgba(0, 0, 0, 0.4);
            padding: 30px;
            border-radius: 20px;
            border: 3px solid rgba(16, 185, 129, 0.4);
            text-align: center;
        }

        .main-formula {
            font-size: 3rem;
            color: #fbbf24;
            font-family: 'Courier New', monospace;
            margin: 20px 0;
            text-shadow: 0 0 20px rgba(251, 191, 36, 0.5);
        }

        .formula-explanation {
            font-size: 1.2rem;
            line-height: 1.8;
            color: #e2e8f0;
            margin: 20px 0;
        }

        .unit-info {
            background: rgba(16, 185, 129, 0.1);
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            border: 2px solid rgba(16, 185, 129, 0.3);
        }

        /* Calculator Demo */
        .calculator-demo {
            display: none;
            padding: 30px;
        }

        .calculator-demo.active {
            display: block;
        }

        .calculator-container {
            background: rgba(15, 23, 42, 0.9);
            padding: 30px;
            border-radius: 20px;
            border: 2px solid rgba(16, 185, 129, 0.4);
            max-width: 600px;
            margin: 0 auto;
        }

        .calculator-title {
            color: #10b981;
            font-size: 1.5rem;
            margin-bottom: 25px;
            text-align: center;
            font-weight: 600;
        }

        .input-group {
            margin: 20px 0;
        }

        .input-label {
            display: block;
            color: #e2e8f0;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .input-field {
            width: 100%;
            padding: 12px 15px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(16, 185, 129, 0.3);
            border-radius: 10px;
            color: white;
            font-size: 1.1rem;
            text-align: center;
        }

        .input-field:focus {
            outline: none;
            border-color: #10b981;
            box-shadow: 0 0 10px rgba(16, 185, 129, 0.3);
        }

        .calculate-btn {
            background: linear-gradient(135deg, #10b981, #059669);
            border: none;
            color: white;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            margin: 20px 0;
        }

        .calculate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(16, 185, 129, 0.4);
        }

        .result-display {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.2), rgba(34, 197, 94, 0.2));
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            font-size: 1.4rem;
            font-weight: bold;
            color: #10b981;
            margin-top: 20px;
            border: 2px solid rgba(16, 185, 129, 0.4);
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Controls */
        .controls {
            text-align: center;
            margin: 40px 0;
        }

        .controls-title {
            font-size: 1.8rem;
            margin-bottom: 25px;
            color: #10b981;
            font-weight: 600;
        }

        .demo-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
            margin: 25px 0;
        }

        .demo-btn {
            background: linear-gradient(135deg, #10b981, #059669);
            border: none;
            color: white;
            padding: 14px 24px;
            border-radius: 30px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 20px rgba(16, 185, 129, 0.3);
            min-width: 150px;
        }

        .demo-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 25px rgba(16, 185, 129, 0.4);
        }

        .demo-btn.active {
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            box-shadow: 0 8px 20px rgba(251, 191, 36, 0.4);
        }

        /* Theory Section */
        .theory-section {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 25px;
            padding: 35px;
            margin: 35px 0;
            border: 3px solid rgba(16, 185, 129, 0.4);
            backdrop-filter: blur(15px);
        }

        .concept-statement {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.15), rgba(34, 197, 94, 0.15));
            border-radius: 20px;
            padding: 25px;
            margin: 20px 0;
            border-left: 5px solid #10b981;
        }

        .concept-title {
            font-size: 1.4rem;
            color: #34d399;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .concept-content {
            font-size: 1.1rem;
            line-height: 1.8;
            color: #e2e8f0;
        }

        .formula-box {
            background: rgba(251, 191, 36, 0.1);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            margin: 20px 0;
            border: 2px solid rgba(251, 191, 36, 0.3);
        }

        .activity-card {
            background: rgba(16, 185, 129, 0.1);
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            border-left: 4px solid #10b981;
        }

        .activity-title {
            color: #10b981;
            font-size: 1.2rem;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .activity-steps {
            list-style: none;
            padding: 0;
        }

        .activity-steps li {
            padding: 8px 0;
            padding-left: 20px;
            position: relative;
        }

        .activity-steps li:before {
            content: 'â€¢';
            position: absolute;
            left: 0;
            color: #10b981;
            font-size: 1.2rem;
        }

        .example-card {
            background: rgba(59, 130, 246, 0.1);
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
            border-left: 4px solid #3b82f6;
        }

        .example-title {
            color: #3b82f6;
            font-size: 1.3rem;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .example-problem {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            color: #e2e8f0;
            line-height: 1.6;
        }

        .solution-steps {
            margin: 15px 0;
        }

        .solution-step {
            margin: 10px 0;
            padding: 10px;
            background: rgba(16, 185, 129, 0.1);
            border-radius: 8px;
        }

        .step-label {
            color: #10b981;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .calculation {
            font-family: 'Courier New', monospace;
            color: #fbbf24;
            font-size: 1.1rem;
            margin: 5px 0;
        }

        .answer {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.2), rgba(34, 197, 94, 0.2));
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            font-size: 1.2rem;
            font-weight: bold;
            color: #10b981;
            margin: 15px 0;
            border: 2px solid rgba(16, 185, 129, 0.4);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .header h1 { font-size: 2.2rem; }
            .demo-stage { padding: 30px 20px; min-height: 500px; }
            .demo-buttons { flex-direction: column; align-items: center; }
            .comparison-grid { grid-template-columns: 1fr; gap: 20px; }
            .climbing-stage { flex-direction: column; gap: 20px; }
            .main-formula { font-size: 2rem; }
            .power-icons { flex-wrap: wrap; gap: 20px; }
            .power-element { margin: 10px; }
            .welcome-title { font-size: 2rem; }
            .welcome-subtitle { font-size: 1.1rem; }
            .staircase-info { 
                max-width: 100%; 
                margin: 20px auto; 
                width: 100%;
                padding: 20px;
            }
            .staircase-top-row {
                flex-direction: column;
                gap: 30px;
            }
            .staircase {
                width: 100%;
                height: 300px;
            }
            .explanation-panel {
                gap: 20px;
                margin-top: 30px;
                max-width: 100%;
            }
            .explanation-card {
                min-width: 150px;
                max-width: 100%;
                font-size: 0.8rem;
                padding: 10px;
            }
            .timer-display, .power-result {
                font-size: 1rem;
                padding: 8px 15px;
            }
            .power-definition-card {
                margin: 20px auto;
                padding: 20px;
            }
            .definition-title {
                font-size: 1.5rem;
            }
            .definition-text {
                font-size: 1.1rem;
            }
            .formula-large {
                font-size: 2.5rem;
            }
        }

        @media (max-width: 480px) {
            .container { padding: 20px 15px; }
            .header h1 { font-size: 1.8rem; }
            .demo-stage { padding: 20px 15px; min-height: 450px; }
            .theory-section { padding: 20px; }
            .main-formula { font-size: 1.5rem; }
            .welcome-title { font-size: 1.8rem; }
            .welcome-subtitle { font-size: 1rem; }
            .power-element-icon { font-size: 3rem; }
            .power-element-label { font-size: 0.9rem; }
            .climber-section { width: 250px; height: 350px; }
            .staircase {
                height: 250px;
            }
            .staircase-info {
                padding: 15px;
                font-size: 0.8rem;
            }
            .explanation-card {
                min-width: 150px;
                max-width: 200px;
                padding: 18px;
                font-size: 0.85rem;
            }
            .result-highlight {
                padding: 20px 40px;
                font-size: 22px;
            }
            .timer-display { top: -50px; font-size: 0.9rem; }
            .power-result { bottom: -70px; font-size: 0.9rem; }
            .power-definition-card {
                margin: 15px auto;
                padding: 15px;
            }
            .definition-title {
                font-size: 1.3rem;
            }
            .definition-text {
                font-size: 1rem;
            }
            .formula-large {
                font-size: 2rem;
            }
            .formula-variables {
                font-size: 1rem;
            }
        }
    </style>
</head>
<body>
    <!-- Audio Control -->
    <div id="audio-control">
        <button id="mute-btn" class="control-btn">
            <span class="unmute-icon">ðŸ”Š</span>
            <span class="mute-icon">ðŸ”‡</span>
        </button>
    </div>

    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>âš¡ Power - Rate of Doing Work</h1>
            <p>Explore how power measures the speed of energy transfer and discover why some machines and people work faster than others!</p>
        </div>

        <!-- Demo Stage -->
        <div class="demo-stage" id="stage">
            <!-- Welcome Demo -->
            <div class="welcome-demo" id="welcome-demo">
                <div class="welcome-title">Power - Rate of Doing Work</div>
                <div class="welcome-subtitle">
                    Exploring how power measures the speed of energy transfer in our world
                </div>
                
                <!-- Power Definition Card -->
                <div class="power-definition-card" id="definition-card">
                    <div class="definition-title">What is Power?</div>
                    <div class="definition-text">
                        Power is the rate of doing work or the rate of energy transfer. It measures how fast work is done.
                    </div>
                    
                    <div class="formula-section">
                        <div class="formula-large">P = W/t</div>
                        <div class="formula-variables">
                            <strong>Where:</strong><br>
                            P = Power (Watts), W = Work (Joules), t = Time (Seconds)
                        </div>
                    </div>
                </div>
                
                <div class="power-visual">
                    <div class="energy-flow"></div>
                    <div class="power-icons">
                        <div class="power-element" id="element-1">
                            <div class="power-element-icon">ðŸƒ</div>
                            <div class="power-element-label">Human</div>
                        </div>
                        
                        <div class="power-element" id="element-2">
                            <div class="power-element-icon">ðŸ’¡</div>
                            <div class="power-element-label">Electrical</div>
                        </div>
                        
                        <div class="power-element" id="element-3">
                            <div class="power-element-icon">ðŸš—</div>
                            <div class="power-element-label">Mechanical</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Power Types Explanation Slideshow -->
            <div class="power-types-demo" id="power-types-demo">
                <div class="power-types-slideshow">
                    <div class="power-types-container" id="power-types-container">
                        <!-- Slide 1: Human Power -->
                        <div class="power-types-card">
                            <div class="power-types-slide">
                                <div class="power-type-icon">ðŸƒ</div>
                                <div class="power-types-title">Human Power</div>
                                <div class="power-type-content">
                                    <div class="power-type-description">
                                        Human power is generated through muscle activity and physical effort. When we climb stairs, lift objects, or exercise, our muscles convert chemical energy from food into mechanical work.
                                    </div>
                                    <div class="numerical-example">
                                        <h4>Example:</h4>
                                        <div class="example-item">â€¢ A person climbing stairs: 100-200 W</div>
                                        <div class="example-item">â€¢ Professional cyclist: 300-400 W</div>
                                        <div class="example-item">â€¢ Olympic sprinter: 1500-2000 W (peak)</div>
                                    </div>
                                    <div class="formula-highlight">
                                        P = mgh/t (for climbing)
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Slide 2: Electrical Power -->
                        <div class="power-types-card">
                            <div class="power-types-slide">
                                <div class="power-type-icon">ðŸ’¡</div>
                                <div class="power-types-title">Electrical Power</div>
                                <div class="power-type-content">
                                    <div class="power-type-description">
                                        Electrical power is consumed by lights, computers, and appliances. It's the rate at which electrical energy is converted into other forms like light, heat, or motion.
                                    </div>
                                    <div class="numerical-example">
                                        <h4>Common Appliances:</h4>
                                        <div class="example-item">â€¢ LED bulb: 9-15 W</div>
                                        <div class="example-item">â€¢ Laptop: 50-100 W</div>
                                        <div class="example-item">â€¢ Microwave: 800-1200 W</div>
                                        <div class="example-item">â€¢ Air conditioner: 1500-3000 W</div>
                                    </div>
                                    <div class="formula-highlight">
                                        P = VI (Voltage Ã— Current)
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Slide 3: Mechanical Power -->
                        <div class="power-types-card">
                            <div class="power-types-slide">
                                <div class="power-type-icon">ðŸš—</div>
                                <div class="power-types-title">Mechanical Power</div>
                                <div class="power-type-content">
                                    <div class="power-type-description">
                                        Mechanical power is found in cars, motorcycles, and industrial machines. It involves the conversion of fuel energy into motion and work output.
                                    </div>
                                    <div class="numerical-example">
                                        <h4>Vehicle Examples:</h4>
                                        <div class="example-item">â€¢ Small car: 50-100 kW (67-134 HP)</div>
                                        <div class="example-item">â€¢ Sports car: 200-400 kW (268-536 HP)</div>
                                        <div class="example-item">â€¢ Motorcycle: 15-150 kW (20-200 HP)</div>
                                        <div class="example-item">â€¢ Industrial motor: 1-1000 kW</div>
                                    </div>
                                    <div class="formula-highlight">
                                        P = F Ã— v (Force Ã— Velocity)
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Navigation Controls -->
                <div class="power-types-nav">
                    <!-- <button onclick="previousPowerType()">â€¹</button>
                    <div class="power-types-indicators">
                        <div class="power-types-indicator active" onclick="goToPowerType(0)"></div>
                        <div class="power-types-indicator" onclick="goToPowerType(1)"></div>
                        <div class="power-types-indicator" onclick="goToPowerType(2)"></div>
                    </div>
                    <button onclick="nextPowerType()">â€º</button> -->
                </div>
            </div>

            <!-- Climbing Demo (Activity 10.16) -->
            <div class="climbing-demo" id="climbing-demo">
                <div class="climbing-stage">
                    <div class="climber-section">
                        <div class="height-marker">Height: 8m</div>
                        <div class="rope">
                            <div class="climber" id="climber-a">ðŸ§’</div>
                        </div>
                        <div class="climber-label">Child A</div>
                        <div class="timer-display" id="timer-a">Time: 15s</div>
                        <div class="power-result" id="power-a">Power: 52.3 W</div>
                    </div>

                    <div class="climber-section">
                        <div class="height-marker">Height: 8m</div>
                        <div class="rope">
                            <div class="climber" id="climber-b">ðŸ§’</div>
                        </div>
                        <div class="climber-label">Child B</div>
                        <div class="timer-display" id="timer-b">Time: 20s</div>
                        <div class="power-result" id="power-b">Power: 39.2 W</div>
                    </div>
                </div>
            </div>

            <!-- Staircase Demo (Example 10.8) -->
            <div class="staircase-demo" id="staircase-demo">
                <div class="example-title">Example 10.8: Boy Running Upstairs</div>
                <div class="staircase-container">
                    <!-- Top Row with Staircase and Info side by side -->
                    <div class="staircase-top-row">
                        <!-- Staircase Visualization -->
                        <div class="staircase" id="staircase">
                            <div class="runner" id="runner">ðŸƒ</div>
                        </div>
                        
                        <!-- Info Panel -->
                        <div class="staircase-info">
                            <div class="info-item">
                                <span class="info-label">Boy's Mass:</span>
                                <span class="info-value">50 kg</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Total Steps:</span>
                                <span class="info-value">45</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Step Height:</span>
                                <span class="info-value">15 cm</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Total Height:</span>
                                <span class="info-value">6.75 m</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Time Taken:</span>
                                <span class="info-value">9 s</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Power:</span>
                                <span class="info-value">375 W</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Explanation Cards -->
                    <div class="explanation-panel" id="explanation-panel">
                        <div class="explanation-card" id="given-card">
                            <h3>Given:</h3>
                            <div>Mass = 50 kg, Steps = 45, Step height = 15 cm</div>
                            <div>Time = 9 s, g = 10 m/sÂ²</div>
                        </div>
                        <div class="explanation-card" id="calculations-card">
                            <h3>Calculations:</h3>
                            <div class="calc-step" id="weight-calc">Weight = mg = 50 Ã— 10 = 500 N</div>
                            <div class="calc-step" id="height-calc">Total height = 45 Ã— 0.15 = 6.75 m</div>
                            <div class="calc-step" id="work-calc">Work = mgh = 500 Ã— 6.75 = 3375 J</div>
                            <div class="calc-step" id="power-calc">Power = Work/Time = 3375/9 = 375 W</div>
                        </div>
                        <div class="explanation-card" id="answer-card">
                            <h3>Power:</h3>
                            <div class="final-answer">P = mgh/t = (500 Ã— 6.75)/9 = 375 W</div>
                        </div>
                    </div>
                    
                    <!-- Final Result -->
                    <div class="result-highlight" id="power-result-highlight">
                        Power = 375 W
                    </div>
                </div>
            </div>

            <!-- Power Comparison Demo -->
            <div class="power-comparison-demo" id="power-comparison-demo">
                <div class="comparison-grid">
                    <div class="power-card">
                        <div class="power-icon">ðŸ’¡</div>
                        <div class="power-title">Light Bulb</div>
                        <div class="power-value">60 W</div>
                        <div class="power-description">Converts electrical energy to light and heat at 60 joules per second</div>
                    </div>

                    <div class="power-card">
                        <div class="power-icon">ðŸï¸</div>
                        <div class="power-title">Motorcycle</div>
                        <div class="power-value">15 kW</div>
                        <div class="power-description">Engine converts fuel energy to mechanical work at 15,000 joules per second</div>
                    </div>

                    <div class="power-card">
                        <div class="power-icon">ðŸš—</div>
                        <div class="power-title">Car Engine</div>
                        <div class="power-value">100 kW</div>
                        <div class="power-description">High-power engine transfers energy at 100,000 joules per second</div>
                    </div>
                </div>
            </div>

            <!-- Formula Demo -->
            <div class="formula-demo" id="formula-demo">
                <div class="formula-container">
                    <h3 style="color: #10b981; margin-bottom: 20px;">Power Formula Derivation</h3>
                    
                    <div class="main-formula">P = W/t</div>
                    
                    <div class="formula-explanation">
                        Power is defined as the rate of doing work or the rate of energy transfer.
                        It measures how fast work is done or energy is consumed.
                    </div>
                    
                    <div class="unit-info">
                        <h4 style="color: #10b981; margin-bottom: 15px;">Units of Power</h4>
                        <div class="calculation">1 Watt = 1 Joule/second</div>
                        <div class="calculation">1 W = 1 J sâ»Â¹</div>
                        <div class="calculation">1 kilowatt = 1000 watts</div>
                        <div class="calculation">1 kW = 1000 J sâ»Â¹</div>
                    </div>
                    
                    <div style="margin-top: 20px; color: #e2e8f0; line-height: 1.6;">
                        <strong>Named after James Watt (1736-1819):</strong> The unit honors the Scottish inventor 
                        who improved the steam engine and contributed significantly to the Industrial Revolution.
                    </div>
                </div>
            </div>
            
        <!-- Problem 1: Example 10.7 -->
        <div class="numerical-demo" id="problem1-demo">
            <div class="problem-card">
                <div class="problem-title">Example 10.7: Girls Climbing Rope</div>
                <div class="problem-statement">
                    Two girls, each of weight 400 N climb up a rope through a height of 8 m. Girl A takes 20 s while Girl B takes 50 s to accomplish this task. What is the power expended by each girl?
                </div>
                <div class="solution-section">
                    <div class="solution-title">Solution:</div>
                    <div class="solution-step" id="prob1-step1">
                        <strong>Given:</strong><br>
                        Weight of each girl = 400 N<br>
                        Height climbed = 8 m<br>
                        Time for Girl A = 20 s<br>
                        Time for Girl B = 50 s
                    </div>
                    <div class="solution-step" id="prob1-step2">
                        <strong>For Girl A:</strong><br>
                        Work done = Weight Ã— Height = 400 N Ã— 8 m = 3200 J
                    </div>
                    <div class="solution-step" id="prob1-step3">
                        <strong>Power of Girl A:</strong><br>
                        P = Work/Time = 3200 J / 20 s = 160 W
                    </div>
                    <div class="solution-step" id="prob1-step4">
                        <strong>For Girl B:</strong><br>
                        Work done = Weight Ã— Height = 400 N Ã— 8 m = 3200 J
                    </div>
                    <div class="solution-step" id="prob1-step5">
                        <strong>Power of Girl B:</strong><br>
                        P = Work/Time = 3200 J / 50 s = 64 W
                    </div>
                    <div class="final-result" id="prob1-result">
                        Girl A: 160 W &nbsp;&nbsp;&nbsp; Girl B: 64 W
                    </div>
                </div>
            </div>
        </div>

        <!-- Problem 2: Practice Problem -->
        <div class="numerical-demo" id="problem2-demo">
            <div class="problem-card">
                <div class="problem-title">Practice Problem 1</div>
                <div class="problem-statement">
                    A lamp consumes 1000 J of electrical energy in 10 s. What is its power?
                </div>
                <div class="solution-section">
                    <div class="solution-title">Solution:</div>
                    <div class="solution-step" id="prob2-step1">
                        <strong>Given:</strong><br>
                        Energy consumed (Work done) = 1000 J<br>
                        Time taken = 10 s
                    </div>
                    <div class="solution-step" id="prob2-step2">
                        <strong>Formula:</strong><br>
                        Power = Work done / Time taken<br>
                        P = W / t
                    </div>
                    <div class="solution-step" id="prob2-step3">
                        <strong>Calculation:</strong><br>
                        P = 1000 J / 10 s = 100 W
                    </div>
                    <div class="final-result" id="prob2-result">
                        Power of the lamp = 100 W
                    </div>
                </div>
            </div>
        </div>

        <!-- Problem 3: Advanced Problem -->
        <div class="numerical-demo" id="problem3-demo">
            <div class="problem-card">
                <div class="problem-title">Practice Problem 2</div>
                <div class="problem-statement">
                    A motor pumps 200 kg of water to a height of 10 m in 25 s. Calculate the power of the motor. (Take g = 10 m/sÂ²)
                </div>
                <div class="solution-section">
                    <div class="solution-title">Solution:</div>
                    <div class="solution-step" id="prob3-step1">
                        <strong>Given:</strong><br>
                        Mass of water = 200 kg<br>
                        Height = 10 m<br>
                        Time = 25 s<br>
                        g = 10 m/sÂ²
                    </div>
                    <div class="solution-step" id="prob3-step2">
                        <strong>Weight of water:</strong><br>
                        Weight = mg = 200 kg Ã— 10 m/sÂ² = 2000 N
                    </div>
                    <div class="solution-step" id="prob3-step3">
                        <strong>Work done against gravity:</strong><br>
                        Work = Weight Ã— Height = 2000 N Ã— 10 m = 20000 J
                    </div>
                    <div class="solution-step" id="prob3-step4">
                        <strong>Power calculation:</strong><br>
                        P = Work / Time = 20000 J / 25 s = 800 W
                    </div>
                    <div class="final-result" id="prob3-result">
                        Power of the motor = 800 W = 0.8 kW
                    </div>
                </div>
            </div>
        </div>

        <!-- Activity 10.17 Slideshow -->
        <div class="activity1017-demo" id="activity1017-demo">
            <div class="activity1017-slideshow">
                <div class="activity1017-container" id="activity1017-container">
                    <!-- Slide 1: Introduction -->
                    <div class="activity1017-card">
                        <div class="activity1017-slide">
                            <div class="activity1017-title">Activity 10.17: Electric Meter Reading</div>
                            <div class="meter-visualization">
                                <div class="electric-meter">
                                    <div class="meter-display">12345</div>
                                    <div class="meter-label">kWh</div>
                                </div>
                            </div>
                            <div style="text-align: center; margin: 20px 0;">
                                <h3 style="color: #00ff9d; margin-bottom: 15px;">Learning Objectives:</h3>
                                <ul style="text-align: left; max-width: 400px; margin: 0 auto;">
                                    <li> Observe your home's electric meter features closely</li>
                                    <li> Take readings at 6:30 AM and 6:30 PM daily for a week</li>
                                    <li> Calculate units consumed during day and night</li>
                                    <li> Tabulate observations and draw inferences</li>
                                    <li> Compare with monthly electricity bill</li>
                                    <li> Estimate consumption by specific appliances based on their wattage</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Slide 2: Power Sources -->
                    <div class="activity1017-card">
                        <div class="activity1017-slide">
                            <div class="activity1017-title">Types of Power Sources</div>
                            <div class="power-sources-visual">
                                <div class="power-sources-grid">
                                    <div class="power-source-item">
                                        <div class="power-source-icon">ðŸƒ</div>
                                        <div class="power-source-label">Human</div>
                                        <div class="power-source-desc">Generated through muscle activity and physical effort</div>
                                    </div>
                                    
                                    <div class="power-source-item">
                                        <div class="power-source-icon">ðŸ’¡</div>
                                        <div class="power-source-label">Electrical</div>
                                        <div class="power-source-desc">Consumed by lights, computers, and appliances</div>
                                    </div>
                                    
                                    <div class="power-source-item">
                                        <div class="power-source-icon">ðŸš—</div>
                                        <div class="power-source-label">Mechanical</div>
                                        <div class="power-source-desc">In cars, motorcycles, and industrial machines</div>
                                    </div>
                                </div>
                                <div style="text-align: center; margin-top: 30px;">
                                    <p><strong>All these power sources follow the same fundamental principle:</strong></p>
                                    <div style="background: rgba(0, 255, 157, 0.1); border: 2px solid #00ff9d; border-radius: 10px; padding: 20px; margin: 20px 0;">
                                        <div style="font-size: 24px; color: #ffd700; font-family: 'Courier New', monospace;">P = W/t</div>
                                        <div style="margin-top: 10px;">Power = Work done Ã· Time taken</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Slide 3: Data Collection -->
                    <div class="activity1017-card">
                        <div class="activity1017-slide">
                            <div class="activity1017-title">Week-long Data Collection</div>
                            <table class="reading-table">
                                <thead>
                                    <tr>
                                        <th>Day</th>
                                        <th>6:30 AM Reading</th>
                                        <th>6:30 PM Reading</th>
                                        <th>Day Units</th>
                                        <th>Night Units</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Monday</td>
                                        <td>12345</td>
                                        <td>12365</td>
                                        <td>20</td>
                                        <td>15</td>
                                    </tr>
                                    <tr>
                                        <td>Tuesday</td>
                                        <td>12360</td>
                                        <td>12382</td>
                                        <td>22</td>
                                        <td>16</td>
                                    </tr>
                                    <tr>
                                        <td>Wednesday</td>
                                        <td>12376</td>
                                        <td>12396</td>
                                        <td>20</td>
                                        <td>14</td>
                                    </tr>
                                    <tr>
                                        <td>Thursday</td>
                                        <td>12390</td>
                                        <td>12412</td>
                                        <td>22</td>
                                        <td>17</td>
                                    </tr>
                                    <tr>
                                        <td>Friday</td>
                                        <td>12407</td>
                                        <td>12430</td>
                                        <td>23</td>
                                        <td>18</td>
                                    </tr>
                                    <tr>
                                        <td>Saturday</td>
                                        <td>12425</td>
                                        <td>12448</td>
                                        <td>23</td>
                                        <td>19</td>
                                    </tr>
                                    <tr>
                                        <td>Sunday</td>
                                        <td>12444</td>
                                        <td>12466</td>
                                        <td>22</td>
                                        <td>16</td>
                                    </tr>
                                </tbody>
                            </table>
                            <div style="text-align: center; margin-top: 20px;">
                                <p><strong>Total Week Consumption: 152 units (Day: 152, Night: 115)</strong></p>
                            </div>
                        </div>
                    </div>

                    <!-- Slide 4: Appliance Power Consumption -->
                    <div class="activity1017-card">
                        <div class="activity1017-slide">
                            <div class="activity1017-title">Appliance Power Consumption</div>
                            <div class="appliance-list">
                                <div class="appliance-item">
                                    <div class="appliance-icon">ðŸ’¡</div>
                                    <div class="appliance-name">LED Bulb</div>
                                    <div class="appliance-power">9W</div>
                                </div>
                                <div class="appliance-item">
                                    <div class="appliance-icon">ðŸ’¡</div>
                                    <div class="appliance-name">CFL Bulb</div>
                                    <div class="appliance-power">15W</div>
                                </div>
                                <div class="appliance-item">
                                    <div class="appliance-icon">ðŸŒ€</div>
                                    <div class="appliance-name">Ceiling Fan</div>
                                    <div class="appliance-power">75W</div>
                                </div>
                                <div class="appliance-item">
                                    <div class="appliance-icon">ðŸ“º</div>
                                    <div class="appliance-name">LED TV</div>
                                    <div class="appliance-power">120W</div>
                                </div>
                                <div class="appliance-item">
                                    <div class="appliance-icon">â„ï¸</div>
                                    <div class="appliance-name">Refrigerator</div>
                                    <div class="appliance-power">300W</div>
                                </div>
                                <div class="appliance-item">
                                    <div class="appliance-icon">ðŸŒ€</div>
                                    <div class="appliance-name">Air Conditioner</div>
                                    <div class="appliance-power">1500W</div>
                                </div>
                                <div class="appliance-item">
                                    <div class="appliance-icon">ðŸ”¥</div>
                                    <div class="appliance-name">Water Heater</div>
                                    <div class="appliance-power">2000W</div>
                                </div>
                                <div class="appliance-item">
                                    <div class="appliance-icon">ðŸ‘”</div>
                                    <div class="appliance-name">Iron</div>
                                    <div class="appliance-power">1200W</div>
                                </div>
                            </div>
                            <div style="text-align: center; margin-top: 15px;">
                                <p><strong>Formula: Energy (kWh) = Power (kW) Ã— Time (hours)</strong></p>
                            </div>
                        </div>
                    </div>

                    <!-- Slide 5: Key Concepts -->
                    <div class="activity1017-card">
                        <div class="activity1017-slide">
                            <div class="activity1017-title">Key Concepts</div>
                            <div class="key-concepts">
                                <div class="concept-item">
                                    <span class="concept-number">1.</span>
                                    <strong>Average Power:</strong> Total energy consumed divided by total time taken
                                </div>
                                <div class="concept-item">
                                    <span class="concept-number">2.</span>
                                    <strong>Power varies with time:</strong> An agent may work at different rates at different times
                                </div>
                                <div class="concept-item">
                                    <span class="concept-number">3.</span>
                                    <strong>Higher power = faster work:</strong> More powerful machines complete tasks quicker
                                </div>
                            </div>
                            <div style="margin-top: 30px;">
                                <h3 style="color: #00ff9d; margin-bottom: 15px;">Observations:</h3>
                                <ul style="line-height: 1.8;">
                                    <li> Day consumption is generally higher than night</li>
                                    <li> Weekends show different patterns due to lifestyle changes</li>
                                    <li> High-power appliances significantly impact consumption</li>
                                    <li> Energy-efficient appliances reduce overall consumption</li>
                                    <li> Peak hours (evening) show maximum usage</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Progress Indicators (Read-only) -->
            <div class="activity1017-indicators">
                <div class="activity1017-indicator active"></div>
                <div class="activity1017-indicator"></div>
                <div class="activity1017-indicator"></div>
                <div class="activity1017-indicator"></div>
                <div class="activity1017-indicator"></div>
            </div>
        </div>
        

            <!-- Calculator Demo -->
            <div class="calculator-demo" id="calculator-demo">
                <div class="calculator-container">
                    <div class="calculator-title">âš¡ Power Calculator</div>
                    
                    <div class="input-group">
                        <label class="input-label">Work Done (Joules):</label>
                        <input type="number" class="input-field" id="work-input" placeholder="Enter work in joules">
                    </div>
                    
                    <div class="input-group">
                        <label class="input-label">Time Taken (Seconds):</label>
                        <input type="number" class="input-field" id="time-input" placeholder="Enter time in seconds">
                    </div>
                    
                    <button class="calculate-btn" onclick="calculatePower()">Calculate Power</button>
                    
                    <div class="result-display" id="power-result">
                        Enter work and time values to calculate power
                    </div>
                </div>
            </div>
                </div>
        <!-- Controls -->
        <div class="controls">
            <div class="controls-title" id="demo-title">Explore Power and Energy Transfer Rate</div>
            
            <div class="demo-buttons">
                <button class="demo-btn" onclick="playCompleteLesson()">ðŸ“š Complete Lesson</button>
                <button class="demo-btn" onclick="showPowerTypesDemo()">âš¡ Power Types</button>
                <button class="demo-btn" onclick="showClimbingDemo()">ðŸ§— Activity 10.16</button>
                <button class="demo-btn" onclick="showStaircaseDemo()">ðŸƒ Example 10.8</button>
                <button class="demo-btn" onclick="showPowerComparison()">âš¡ Power Examples</button>
                <button class="demo-btn" onclick="showFormula()">ðŸ“ Formula</button>
                <button class="demo-btn" onclick="showCalculator()">ðŸ§® Calculator</button>
                <button class="demo-btn" onclick="showActivity1017()">âš¡ Activity 10.17</button>
                <button class="demo-btn" onclick="showProblem1()">ðŸ“ Example 10.7</button>
                <button class="demo-btn" onclick="showProblem2()">ðŸ“ Practice Problem 1</button>
                <button class="demo-btn" onclick="showProblem3()">ðŸ“ Practice Problem 2</button>
                <button class="demo-btn" onclick="resetAllClick()">ðŸ”„ Reset</button>
            </div>
        </div>

        <!-- Theory Section -->
        <div class="theory-section">
            <div class="concept-statement">
                <div class="concept-title">What is Power?</div>
                <div class="concept-content">
                    Power is the rate of doing work or the rate of energy transfer. It measures how quickly 
                    work is done or how fast energy is consumed or converted from one form to another. 
                    A more powerful agent can do the same amount of work in less time.
                </div>
            </div>

            <div class="formula-box">
                <div class="main-formula" style="font-size: 2rem;">P = W/t</div>
                <div style="margin-top: 15px; line-height: 1.8; color: #e2e8f0;">
                    <strong>Where:</strong><br>
                    P = Power (Watts, W)<br>
                    W = Work done (Joules, J)<br>
                    t = Time taken (Seconds, s)
                </div>
            </div>

            <div class="activity-card">
                <div class="activity-title">Activity 10.16: Climbing Comparison</div>
                <ul class="activity-steps">
                    <li>Two children A and B of same weight climb a rope to 8m height</li>
                    <li>Child A takes 15 seconds, Child B takes 20 seconds</li>
                    <li>Both do the same work (W = mgh), but at different rates</li>
                    <li>Child A has higher power as they complete work faster</li>
                    <li>Power shows who does more work per unit time</li>
                </ul>
            </div>

            <div class="example-card">
                <div class="example-title">Example 10.7: Two Girls Climbing</div>
                <div class="example-problem">
                    <strong>Problem:</strong> Two girls, each weighing 400 N, climb 8m high. 
                    Girl A takes 20s, Girl B takes 50s. Find the power expended by each.
                </div>
                <div class="solution-steps">
                    <div class="solution-step">
                        <div class="step-label">Given:</div>
                        Weight = 400 N, Height = 8 m<br>
                        Time A = 20 s, Time B = 50 s
                    </div>
                    <div class="solution-step">
                        <div class="step-label">Girl A's Power:</div>
                        <div class="calculation">P = mgh/t = (400 Ã— 8)/20 = 160 W</div>
                    </div>
                    <div class="solution-step">
                        <div class="step-label">Girl B's Power:</div>
                        <div class="calculation">P = mgh/t = (400 Ã— 8)/50 = 64 W</div>
                    </div>
                </div>
                <div class="answer">Girl A: 160 W, Girl B: 64 W</div>
            </div>

            <div class="example-card">
                <div class="example-title">Example 10.8: Boy Running Upstairs</div>
                <div class="example-problem">
                    <strong>Problem:</strong> A 50 kg boy runs up 45 steps in 9s. 
                    Each step is 15 cm high. Find his power. (g = 10 m/sÂ²)
                </div>
                <div class="solution-steps">
                    <div class="solution-step">
                        <div class="step-label">Given:</div>
                        Mass = 50 kg, Steps = 45, Step height = 15 cm<br>
                        Time = 9 s, g = 10 m/sÂ²
                    </div>
                    <div class="solution-step">
                        <div class="step-label">Calculations:</div>
                        <div class="calculation">Weight = mg = 50 Ã— 10 = 500 N</div>
                        <div class="calculation">Total height = 45 Ã— 0.15 = 6.75 m</div>
                    </div>
                    <div class="solution-step">
                        <div class="step-label">Power:</div>
                        <div class="calculation">P = mgh/t = (500 Ã— 6.75)/9 = 375 W</div>
                    </div>
                </div>
                <div class="answer">Power = 375 W</div>
            </div>

            <div class="activity-card">
                <div class="activity-title">Activity 10.17: Electric Meter Reading</div>
                <ul class="activity-steps">
                    <li>Observe your home's electric meter features closely</li>
                    <li>Take readings at 6:30 AM and 6:30 PM daily for a week</li>
                    <li>Calculate units consumed during day and night</li>
                    <li>Tabulate observations and draw inferences</li>
                    <li>Compare with monthly electricity bill</li>
                    <li>Estimate consumption by specific appliances based on their wattage</li>
                </ul>
            </div>

            <div class="concept-statement">
                <div class="concept-title">Key Concepts</div>
                <div class="concept-content">
                    <strong>1. Average Power:</strong> Total energy consumed divided by total time taken<br><br>
                    <strong>2. Power varies with time:</strong> An agent may work at different rates at different times<br><br>
                    <strong>3. Higher power = faster work:</strong> More powerful machines complete tasks quicker<br><br>
                    <strong>4. Applications:</strong> Power ratings help classify vehicles, appliances, and machines
                </div>
            </div>
        </div>
    </div>

    <script>
        // Voice Teacher System
        class PhysicsTeacher {
            constructor() {
                this.isEnabled = globalAudioEnabled;
                this.currentUtterance = null;
                this.settings = { rate: 0.9, pitch: 1.0, volume: 0.85 };
                this.isDestroyed = false;
            }

            async speak(text, delay = 0) {
                if (!this.isEnabled || !text || this.isDestroyed) return;
                
                return new Promise((resolve) => {
                    setTimeout(() => {
                        if (this.isDestroyed) {
                            resolve();
                            return;
                        }
                        this.stop();
                        const utterance = new SpeechSynthesisUtterance(text);
                        Object.assign(utterance, this.settings);
                        
                        utterance.onend = resolve;
                        utterance.onerror = resolve;
                        
                        this.currentUtterance = utterance;
                        speechSynthesis.speak(utterance);
                    }, delay);
                });
            }

            stop() {
                speechSynthesis.cancel();
                this.currentUtterance = null;
            }

            destroy() {
                this.isDestroyed = true;
                this.stop();
                this.currentUtterance = null;
                this.settings = null;
            }
        }

        // Global state management
        let globalAudioEnabled = true;
        let currentTeacher = null;
        let isPlaying = false;
        let animationTimeline = null;
        let currentDemoAborted = false;
        let activeAnimations = [];
        let currentRunId = 0;
        let currentTaskId = null; // Track current task ID
        let isNarrationInProgress = false; // Track if narration is currently in progress

        // Numerical slideshow state
        let currentNumericalIndex = 0;
        let numericalAutoTimer = null;
        const totalNumericalSlides = 3;
        const numericalSlideDuration = 30000; // 30 seconds per slide - much longer to ensure narration completes

        // Activity 10.17 slideshow state
        let currentActivity1017Index = 0;
        let activity1017AutoTimer = null;
        const totalActivity1017Slides = 5;
        const activity1017SlideDuration = 15000; // 8 seconds per slide
        let activity1017Completed = false;

        // Power Types slideshow state
        let currentPowerTypesIndex = 0;
        let powerTypesAutoTimer = null;
        const totalPowerTypesSlides = 3;
        const powerTypesSlideDuration = 10000; // 10 seconds per slide

        // Function to create new animation timeline
        function createNewTimeline() {
            if (animationTimeline) {
                animationTimeline.kill();
                animationTimeline = null;
            }
            activeAnimations.forEach(anim => {
                if (anim) anim.kill();
            });
            activeAnimations = [];
            gsap.killTweensOf("*");
            
            const newTimeline = gsap.timeline();
            animationTimeline = newTimeline;
            return newTimeline;
        }

        function trackAnimation(animation) {
            if (animation) {
                activeAnimations.push(animation);
            }
            return animation;
        }

        function stopCurrentDemo() {
            currentDemoAborted = true;
            currentRunId++;
            
            // Clear current task ID
            currentTaskId = null;
            
            document.querySelectorAll('.welcome-demo, .power-types-demo, .climbing-demo, .staircase-demo, .power-comparison-demo, .formula-demo, .calculator-demo, .numerical-demo, .activity1017-demo').forEach(demo => {
                demo.classList.remove('active');
            });
            
            // Stop slideshows
            stopNumericalAutoSlideshow();
            stopActivity1017AutoSlideshow();
            stopPowerTypesAutoSlideshow();
            
            if (currentTeacher) {
                currentTeacher.destroy();
                currentTeacher = null;
            }
            
            if (animationTimeline) {
                animationTimeline.kill();
                animationTimeline = null;
            }
            
            activeAnimations.forEach(anim => {
                if (anim) anim.kill();
            });
            activeAnimations = [];
            
            gsap.killTweensOf("*");
            
            isPlaying = false;
        }

        function shouldContinue(taskId = null) {
            // If a specific task ID is provided, check if it matches current task
            if (taskId && currentTaskId && taskId !== currentTaskId) {
                return false;
            }
            return !currentDemoAborted;
        }

        function createNewTeacher(taskId = null) {
            if (currentTeacher) {
                currentTeacher.destroy();
                currentTeacher = null;
            }
            currentDemoAborted = false;
            currentTaskId = taskId;
            currentTeacher = new PhysicsTeacher();
            return currentTeacher;
        }

        // Initialize
        window.addEventListener('load', () => {
            createStaircase();
            showWelcomeDemo();
        });

        // Welcome Demo
        async function showWelcomeDemo() {
            const taskId = 'welcome-demo';
            stopCurrentDemo();
            isPlaying = true;
            
            const teacher = createNewTeacher(taskId);
            
            updateTitle("Welcome to Power - Rate of Doing Work");
            document.getElementById('welcome-demo').classList.add('active');
            
            await teacher.speak("Welcome to Power - the Rate of Doing Work! Let's explore how power measures the speed of energy transfer in our world.");
            if (!shouldContinue(taskId)) return;
            
            await wait(500);
            
            // Show definition card
            document.getElementById('definition-card').classList.add('visible');
            await wait(1000);
            if (!shouldContinue(taskId)) return;
            
            await teacher.speak("Power is the rate of doing work or the rate of energy transfer. It measures how quickly work is done or how fast energy is consumed.");
            if (!shouldContinue(taskId)) return;
            
            await wait(1500);
            
            // Animate power elements appearing one by one
            const elements = ['element-1', 'element-2', 'element-3'];
            const descriptions = [
                "Human power - generated through muscle activity",
                "Electrical power - consumed by devices and appliances", 
                "Mechanical power - in vehicles and machines"
            ];
            
            for (let i = 0; i < elements.length; i++) {
                if (!shouldContinue(taskId)) return;
                
                document.getElementById(elements[i]).classList.add('visible');
                await wait(800);
                if (!shouldContinue(taskId)) return;
                
                await teacher.speak(descriptions[i]);
                await wait(1000);
            }
            
            await wait(1500);
            if (!shouldContinue(taskId)) return;
            
            await teacher.speak("Power is defined as the rate of doing work or the rate of energy transfer. It tells us how fast energy flows from one form to another!");
            
            isPlaying = false;
        }

        // Welcome Demo Internal (for complete lesson)
        async function showWelcomeDemoInternal(teacher, taskId = null) {
            await resetAll();
            await wait(50);
            if (!shouldContinue(taskId)) return;
            
            updateTitle("ðŸ”‹ Introduction to Power");
            document.getElementById('welcome-demo').classList.add('active');
            await wait(50);
            if (!shouldContinue(taskId)) return;
            
            await teacher.speak("Power is everywhere around us - from the muscle power in our bodies to the electrical power in our devices.");
            if (!shouldContinue(taskId)) return;
            
            await wait(500);
            
            // Show definition card first
            document.getElementById('definition-card').classList.add('visible');
            await wait(1000);
            if (!shouldContinue(taskId)) return;
            
            await teacher.speak("Let me show you the precise definition of power. Power is the rate of doing work, expressed by the formula P equals W divided by t.");
            if (!shouldContinue(taskId)) return;
            
            await wait(1500);
            
            // Animate power elements appearing
            const elements = ['element-1', 'element-2', 'element-3'];
            const descriptions = [
                "Human power - like when you climb stairs or lift objects",
                "Electrical power - consumed by lights, computers, and appliances", 
                "Mechanical power - in cars, motorcycles, and industrial machines"
            ];
            
            for (let i = 0; i < elements.length; i++) {
                if (!shouldContinue(taskId)) return;
                
                document.getElementById(elements[i]).classList.add('visible');
                await wait(800);
                if (!shouldContinue(taskId)) return;
                
                await teacher.speak(descriptions[i]);
                await wait(1500);
            }
            
            await wait(1000);
            if (!shouldContinue(taskId)) return;
            
            await teacher.speak("Now let's dive deeper into the science of power with NCERT activities and examples!");
        }

        // Complete Lesson
        async function playCompleteLesson() {
            const taskId = 'complete-lesson';
            stopCurrentDemo();
            isPlaying = true;
            setActiveButton(0);
            
            const teacher = createNewTeacher(taskId);
            
            await resetAll();
            await wait(100);
            if (!shouldContinue(taskId)) return;
            
            updateTitle("ðŸ“š Complete NCERT Lesson: Power");
            
            await teacher.speak("Let's begin our complete lesson on Power from NCERT Chapter 10. We'll understand what power is and how it measures the rate of doing work.");
            if (!shouldContinue(taskId)) return;
            
            // Welcome Introduction
            await teacher.speak("First, let me introduce you to the concept of power and energy transfer.");
            if (!shouldContinue(taskId)) return;
            await showWelcomeDemoInternal(teacher, taskId);
            if (!shouldContinue(taskId)) return;
            await wait(2000);

            // power types
            await teacher.speak("Now let's explore the different types of power.");
            if (!shouldContinue(taskId)) return;
            await showPowerTypesDemoInternal(teacher, taskId);
            if (!shouldContinue(taskId)) return;
            await wait(2000);
            
            // Reset between demos to ensure clean display
            await resetAll();
            await wait(50);
            if (!shouldContinue(taskId)) return;
            
            // Climbing Demo
            await teacher.speak("Now let's explore Activity 10.16 - comparing two children climbing a rope.");
            if (!shouldContinue(taskId)) return;
            await showClimbingDemoInternal(teacher, taskId);
            if (!shouldContinue(taskId)) return;
            await wait(2000);
            
            // Staircase Demo
            await teacher.speak("Now let's solve Example 10.8 about a boy running up stairs.");
            if (!shouldContinue(taskId)) return;
            await showStaircaseDemoInternal(teacher, taskId);
            if (!shouldContinue(taskId)) return;
            await wait(2000);
            
            // Reset between demos
            await resetAll();
            await wait(50);
            if (!shouldContinue(taskId)) return;
            
            // Power Comparison
            await teacher.speak("Let's compare power ratings of different devices and machines.");
            if (!shouldContinue(taskId)) return;
            await showPowerComparisonInternal(teacher, taskId);
            if (!shouldContinue(taskId)) return;
            await wait(2000);
            
            // Reset between demos
            await resetAll();
            await wait(50);
            if (!shouldContinue(taskId)) return;
            
            // Formula
            await teacher.speak("Now let's understand the mathematical foundation of power.");
            if (!shouldContinue(taskId)) return;
            await showFormulaInternal(teacher, taskId);
            if (!shouldContinue(taskId)) return;
            await wait(2000);
            
            // Reset between demos
            await resetAll();
            await wait(50);
            if (!shouldContinue(taskId)) return;
            
            // Calculator
            await teacher.speak("Now let's use our power calculator to solve problems.");
            if (!shouldContinue(taskId)) return;
            await showCalculatorInternal(teacher, taskId);
            if (!shouldContinue(taskId)) return;
            
            // Reset between demos
            await resetAll();
            await wait(50);
            if (!shouldContinue(taskId)) return;

            // activity 10.17
            await teacher.speak("Now let's explore Activity 10.17.");
            if (!shouldContinue(taskId)) return;
            await showActivity1017Internal(teacher, taskId);
            if (!shouldContinue(taskId)) return;
            
            // Wait for Activity 10.17 to complete
            while (!isActivity1017Completed() && shouldContinue(taskId)) {
                await wait(100);
            }
            if (!shouldContinue(taskId)) return;
            
            // Reset between demos
            await resetAll();
            await wait(50);
            if (!shouldContinue(taskId)) return;
            
            // Problem 1
            await teacher.speak("Now let's solve Example 10.7 about girls climbing a rope.");
            if (!shouldContinue(taskId)) return;
            await showProblemInternal(1, teacher, taskId);
            if (!shouldContinue(taskId)) return;
            await wait(2000);
            
            // Reset between demos
            await resetAll();
            await wait(50);
            if (!shouldContinue(taskId)) return;
            
            // Problem 2
            await teacher.speak("Now let's solve a practice problem about a lamp's power.");
            if (!shouldContinue(taskId)) return;
            await showProblemInternal(2, teacher, taskId);
            if (!shouldContinue(taskId)) return;
            await wait(2000);
            
            // Reset between demos
            await resetAll();
            await wait(50);
            if (!shouldContinue(taskId)) return;
            
            // Problem 3
            await teacher.speak("Now let's solve another practice problem about a water pump's power.");
            if (!shouldContinue(taskId)) return;
            await showProblemInternal(3, teacher, taskId);
            if (!shouldContinue(taskId)) return;
            await wait(2000);

            await teacher.speak("Excellent! You now understand that power measures how fast work is done. It's the key to comparing the efficiency of machines, vehicles, and even human performance!");
            
            isPlaying = false;
        }

        // Climbing Demo (Activity 10.16)
        async function showClimbingDemo() {
            const taskId = 'climbing-demo';
            stopCurrentDemo();
            isPlaying = true;
            setActiveButton(2);
            
            const teacher = createNewTeacher(taskId);
            await showClimbingDemoInternal(teacher, taskId);
            
            isPlaying = false;
        }

        async function showClimbingDemoInternal(teacher, taskId = null) {
            // Make sure all demos are hidden first
            document.querySelectorAll('.welcome-demo, .climbing-demo, .staircase-demo, .power-comparison-demo, .formula-demo, .calculator-demo, .numerical-demo, #problem1-demo, #problem2-demo, #problem3-demo, .power-types-demo, .activity1017-demo').forEach(demo => {
                demo.classList.remove('active');
            });
            
            await wait(50);
            if (!shouldContinue(taskId)) return;
            
            updateTitle("ðŸ§— Activity 10.16: Rope Climbing Comparison");
            
            document.getElementById('climbing-demo').classList.add('active');
            await wait(50);
            if (!shouldContinue(taskId)) return;
            
            await teacher.speak("This is Activity 10.16. Two children of the same weight climb a rope to 8 meters height. Let's see who has more power!");
            if (!shouldContinue(taskId)) return;
            
            await wait(1000);
            
            // Show Child A climbing
            await teacher.speak("Child A starts climbing. Watch carefully!");
            if (!shouldContinue(taskId)) return;
            
            document.getElementById('timer-a').classList.add('visible');
            trackAnimation(gsap.to('#climber-a', {
                duration: 1.5,
                bottom: '360px',
                ease: "power4.out"
            }));
            
            await wait(2000);
            if (!shouldContinue(taskId)) return;
            
            await teacher.speak("Child A reaches the top in 15 seconds! Now let's see Child B.");
            if (!shouldContinue(taskId)) return;
            
            // Show Child B climbing
            document.getElementById('timer-b').classList.add('visible');
            trackAnimation(gsap.to('#climber-b', {
                duration: 4,
                bottom: '360px',
                ease: "power2.out"
            }));
            
            await wait(4500);
            if (!shouldContinue(taskId)) return;
            
            await teacher.speak("Child B takes 20 seconds. Both do the same work - climbing 8 meters against gravity. But who has more power?");
            if (!shouldContinue(taskId)) return;
            
            // Show power calculations
            await wait(500);
            document.getElementById('power-a').classList.add('visible');
            await wait(1500);
            document.getElementById('power-b').classList.add('visible');
            await wait(1500);
            if (!shouldContinue(taskId)) return;
            
            await teacher.speak("Child A has more power! Power equals work divided by time. Since A did the same work in less time, A has higher power - 52.3 watts compared to B's 39.2 watts!");
        }

        // Staircase Demo (Example 10.8)
        async function showStaircaseDemo() {
            const taskId = 'staircase-demo';
            stopCurrentDemo();
            isPlaying = true;
            setActiveButton(3);
            
            const teacher = createNewTeacher(taskId);
            await showStaircaseDemoInternal(teacher, taskId);
            
            isPlaying = false;
        }

        async function showStaircaseDemoInternal(teacher, taskId = null) {
            await resetAll();
            await wait(50);
            if (!shouldContinue(taskId)) return;
            
            updateTitle("ðŸƒ Example 10.8: Boy Running Upstairs");
            
            document.getElementById('staircase-demo').classList.add('active');
            await wait(50);
            if (!shouldContinue(taskId)) return;
            
            await teacher.speak("This is Example 10.8. A 50 kilogram boy runs up 45 steps in 9 seconds. Each step is 15 centimeters high. Let's calculate his power!");
            if (!shouldContinue(taskId)) return;
            
            await wait(1000);
            
            await teacher.speak("First, let's calculate the total height. 45 steps times 15 centimeters equals 6.75 meters.");
            if (!shouldContinue(taskId)) return;
            
            await wait(1500);
            
            await teacher.speak("Now watch him run up the stairs!");
            if (!shouldContinue(taskId)) return;
            
            // Animate runner going up stairs step by step
            const runner = document.getElementById('runner');
            const staircase = document.getElementById('staircase');
            const staircaseWidth = staircase.offsetWidth;
            const staircaseHeight = staircase.offsetHeight;
            
            // Calculate boundaries to keep runner within the staircase
            const runnerWidth = 55; // Runner width
            const runnerHeight = 55; // Runner height
            const padding = 20; // Padding from edges
            
            const maxX = staircaseWidth - runnerWidth - padding; // Keep runner within right edge
            const maxY = -(staircaseHeight - runnerHeight - padding); // Keep runner within top edge
            
            trackAnimation(gsap.to(runner, {
                duration: 4.5,
                x: maxX,
                y: maxY,
                ease: "power2.out",
                onComplete: function() {
                    // Ensure runner stays within bounds at the end
                    gsap.set(runner, {
                        x: Math.min(runner._gsap.x, maxX),
                        y: Math.max(runner._gsap.y, maxY)
                    });
                }
            }));
            
            await wait(5000);
            if (!shouldContinue(taskId)) return;
            
            // Show given values first
            await teacher.speak("Let's start with our given values and solve this step by step.");
            document.getElementById('given-card').classList.add('visible');
            await wait(2000);
            if (!shouldContinue(taskId)) return;
            
            await teacher.speak("Now let's solve this with detailed calculations.");
            
            // Show calculations card
            document.getElementById('calculations-card').classList.add('visible');
            await wait(1000);
            if (!shouldContinue(taskId)) return;
            
            await teacher.speak("First, we calculate his weight. Weight equals mass times gravity. 50 kilograms times 10 meters per second squared equals 500 Newtons.");
            document.getElementById('weight-calc').classList.add('visible');
            await wait(2500);
            if (!shouldContinue(taskId)) return;
            
            await teacher.speak("Next, the total height. 45 steps times 15 centimeters per step equals 6.75 meters.");
            document.getElementById('height-calc').classList.add('visible');
            await wait(2500);
            if (!shouldContinue(taskId)) return;
            
            await teacher.speak("Now we calculate the work done. Work equals weight times height. 500 Newtons times 6.75 meters equals 3375 joules.");
            document.getElementById('work-calc').classList.add('visible');
            await wait(3000);
            if (!shouldContinue(taskId)) return;
            
            await teacher.speak("Finally, power equals work divided by time. 3375 joules divided by 9 seconds equals 375 watts!");
            document.getElementById('power-calc').classList.add('visible');
            await wait(2500);
            if (!shouldContinue(taskId)) return;
            
            // Show final answer
            await teacher.speak("Here's our complete solution!");
            document.getElementById('answer-card').classList.add('visible');
            await wait(2000);
            if (!shouldContinue(taskId)) return;
            
            // Show result highlight
            await teacher.speak("The boy's power is 375 watts! This means he can do 375 joules of work every second.");
            document.getElementById('power-result-highlight').classList.add('visible');
            await wait(2000);
        }

        // Power Comparison Demo
        async function showPowerComparison() {
            const taskId = 'power-comparison';
            stopCurrentDemo();
            isPlaying = true;
            setActiveButton(4);
            
            const teacher = createNewTeacher(taskId);
            await showPowerComparisonInternal(teacher, taskId);
            
            isPlaying = false;
        }

        async function showPowerComparisonInternal(teacher, taskId = null) {
            await resetAll();
            await wait(50);
            if (!shouldContinue(taskId)) return;
            
            updateTitle("âš¡ Power Examples in Daily Life");
            
            document.getElementById('power-comparison-demo').classList.add('active');
            await wait(50);
            if (!shouldContinue(taskId)) return;
            
            await teacher.speak("Let's compare the power ratings of different devices and machines we encounter daily.");
            if (!shouldContinue(taskId)) return;
            
            await wait(1000);
            
            await teacher.speak("A light bulb consumes 60 watts - it converts electrical energy to light and heat at 60 joules per second.");
            if (!shouldContinue(taskId)) return;
            
            await wait(2000);
            
            await teacher.speak("A motorcycle engine has about 15 kilowatts of power - that's 15,000 joules per second! Much more powerful than a light bulb.");
            if (!shouldContinue(taskId)) return;
            
            await wait(2500);
            
            await teacher.speak("A car engine can have 100 kilowatts or more - that's 100,000 joules per second! This high power allows cars to accelerate quickly and climb hills.");
            if (!shouldContinue(taskId)) return;
            
            await wait(2000);
            
            await teacher.speak("Higher power means faster energy transfer. That's why powerful vehicles can complete journeys faster than less powerful ones!");
        }

        // Formula Demo
        async function showFormula() {
            const taskId = 'formula-demo';
            stopCurrentDemo();
            isPlaying = true;
            setActiveButton(5);
            
            const teacher = createNewTeacher(taskId);
            await showFormulaInternal(teacher, taskId);
            
            isPlaying = false;
        }

        async function showFormulaInternal(teacher, taskId = null) {
            await resetAll();
            await wait(50);
            if (!shouldContinue(taskId)) return;
            
            updateTitle("ðŸ“ Power Formula and Units");
            
            document.getElementById('formula-demo').classList.add('active');
            await wait(50);
            if (!shouldContinue(taskId)) return;
            
            await teacher.speak("Power is defined as the rate of doing work or the rate of energy transfer. The formula is P equals W divided by t.");
            if (!shouldContinue(taskId)) return;
            
            await wait(2000);
            
            await teacher.speak("The unit of power is the watt, named after James Watt who improved the steam engine. One watt equals one joule per second.");
            if (!shouldContinue(taskId)) return;
            
            await wait(2500);
            
            await teacher.speak("For larger power ratings, we use kilowatts. One kilowatt equals 1000 watts, or 1000 joules per second.");
            if (!shouldContinue(taskId)) return;
            
            await wait(2000);
            
            await teacher.speak("This formula helps us understand why powerful machines work faster - they transfer more energy per unit time!");
        }

        // Calculator Demo
        async function showCalculator() {
            const taskId = 'calculator-demo';
            stopCurrentDemo();
            isPlaying = true;
            setActiveButton(6);
            
            const teacher = createNewTeacher(taskId);
            await showCalculatorInternal(teacher, taskId);
            
            isPlaying = false;
        }

        async function showCalculatorInternal(teacher, taskId = null) {
            await resetAll();
            await wait(50);
            if (!shouldContinue(taskId)) return;
            
            updateTitle("ðŸ§® Power Calculator");
            
            document.getElementById('calculator-demo').classList.add('active');
            await wait(50);
            if (!shouldContinue(taskId)) return;
            
            await teacher.speak("Use this calculator to solve power problems. Enter the work done in joules and the time taken in seconds, then click calculate!");
            if (!shouldContinue(taskId)) return;
            
            await wait(2000);
            
            await teacher.speak("Try calculating the power for different scenarios. Remember, higher work in less time means higher power!");
        }

        // Power Calculator Function
        function calculatePower() {
            const work = parseFloat(document.getElementById('work-input').value);
            const time = parseFloat(document.getElementById('time-input').value);
            const resultDiv = document.getElementById('power-result');
            
            if (isNaN(work) || isNaN(time) || work <= 0 || time <= 0) {
                resultDiv.innerHTML = 'âš ï¸ Please enter valid positive values for work and time';
                if (currentTeacher) {
                    currentTeacher.speak("Please enter valid positive values for work and time.");
                }
                return;
            }
            
            const power = work / time;
            let powerDisplay, unit;
            
            if (power >= 1000) {
                powerDisplay = (power / 1000).toFixed(2);
                unit = 'kW (kilowatts)';
            } else {
                powerDisplay = power.toFixed(2);
                unit = 'W (watts)';
            }
            
            resultDiv.innerHTML = `
                <div>
                    <strong>Power = ${powerDisplay} ${unit}</strong><br>
                    <small>Calculation: ${work} J Ã· ${time} s = ${power.toFixed(2)} W</small>
                </div>
            `;
            
            if (currentTeacher) {
                currentTeacher.speak(`The power is ${powerDisplay} ${unit}. This means ${powerDisplay} joules of energy are transferred every second.`);
            }
        }

        // Helper function to create staircase
        function createStaircase() {
            const staircase = document.getElementById('staircase');
            if (!staircase) return;
            
            const stepWidth = 20;
            const stepHeight = 12;
            const totalSteps = 25; // More realistic visual representation of 45 steps
            
            for (let i = 0; i < totalSteps; i++) {
                const step = document.createElement('div');
                step.className = 'step';
                step.style.width = stepWidth + 'px';
                step.style.height = stepHeight + 'px';
                step.style.left = (i * stepWidth) + 'px';
                step.style.bottom = (i * stepHeight) + 'px';
                staircase.appendChild(step);
            }
        }

        // Individual Problem Functions
        async function showProblem1() {
            const taskId = 'problem1-demo';
            stopCurrentDemo();
            isPlaying = true;
            setActiveButton(8);
            
            const teacher = createNewTeacher(taskId);
            await showProblemInternal(1, teacher, taskId);
            
            isPlaying = false;
        }
        
        async function showProblem2() {
            const taskId = 'problem2-demo';
            stopCurrentDemo();
            isPlaying = true;
            setActiveButton(9);
            
            const teacher = createNewTeacher(taskId);
            await showProblemInternal(2, teacher, taskId);
            
            isPlaying = false;
        }
        
        async function showProblem3() {
            const taskId = 'problem3-demo';
            stopCurrentDemo();
            isPlaying = true;
            setActiveButton(10);
            
            const teacher = createNewTeacher(taskId);
            await showProblemInternal(3, teacher, taskId);
            
            isPlaying = false;
        }

        async function showProblemInternal(problemNumber, teacher, taskId = null) {
            // Make sure all demos are hidden first
            document.querySelectorAll('.welcome-demo, .climbing-demo, .staircase-demo, .power-comparison-demo, .formula-demo, .calculator-demo, .numerical-demo, #problem1-demo, #problem2-demo, #problem3-demo, .power-types-demo, .activity1017-demo').forEach(demo => {
                demo.classList.remove('active');
            });
            
            await wait(50);
            if (!shouldContinue(taskId)) return;
            
            const problemTitles = {
                1: "Example 10.7: Girls Climbing Rope",
                2: "Practice Problem 1: Lamp Power",
                3: "Practice Problem 2: Water Pump Power"
            };
            
            updateTitle(`ðŸ“ ${problemTitles[problemNumber]}`);
            
            document.getElementById(`problem${problemNumber}-demo`).classList.add('active');
            await wait(50);
            if (!shouldContinue(taskId)) return;
            
            // Get the problem statement
            const problemStatement = document.querySelector(`#problem${problemNumber}-demo .problem-statement`).textContent.trim();
            
            // Introduce the problem
            await teacher.speak(`Let's solve ${problemTitles[problemNumber]}. ${problemStatement}`);
            if (!shouldContinue(taskId)) return;
            
            await wait(1000);
            
            // Show solution steps with narration
            await showProblemSolution(problemNumber, teacher, taskId);
        }
        
        async function showProblemSolution(problemNumber, teacher, taskId = null) {
            // Show each solution step with narration
            const steps = document.querySelectorAll(`#prob${problemNumber}-step1, #prob${problemNumber}-step2, #prob${problemNumber}-step3, #prob${problemNumber}-step4, #prob${problemNumber}-step5`);
            
            // Show steps one by one with narration
            for (let i = 0; i < steps.length; i++) {
                if (!shouldContinue(taskId)) return;
                
                // Make the step visible
                steps[i].classList.add('visible');
                
                // Get step content for narration
                const stepContent = steps[i].textContent.trim()
                    .replace(/Ã—/g, ' times ')
                    .replace(/Ã·/g, ' divided by ')
                    .replace(/=/g, ' equals ')
                    .replace(/m\/sÂ²/g, ' meters per second squared ')
                    .replace(/\bN\b/g, ' Newtons ')
                    .replace(/\bJ\b/g, ' Joules ')
                    .replace(/\bW\b/g, ' Watts ')
                    .replace(/\bkW\b/g, ' kilowatts ')
                    .replace(/\bkg\b/g, ' kilograms ')
                    .replace(/\bm\b/g, ' meters ')
                    .replace(/\bs\b/g, ' seconds ');
                
                // Narrate the step
                await teacher.speak(stepContent);
                
                // Wait between steps
                await wait(1000);
            }
            
            // Show final result
            if (!shouldContinue(taskId)) return;
            
            const result = document.getElementById(`prob${problemNumber}-result`);
            if (result) {
                result.classList.add('visible');
                
                const resultContent = result.textContent.trim()
                    .replace(/Ã—/g, ' times ')
                    .replace(/Ã·/g, ' divided by ')
                    .replace(/=/g, ' equals ')
                    .replace(/\bW\b/g, ' Watts ')
                    .replace(/\bkW\b/g, ' kilowatts ');
                
                await teacher.speak(`The final answer is: ${resultContent}`);
            }
        }


        function updateNumericalPosition() {
            const container = document.getElementById('numerical-container');
            if (container) {
                // Calculate exact position - each slide is 33.333% wide
                const slideWidth = 33.333;
                const translateX = -(currentNumericalIndex * slideWidth);
                container.style.transform = `translateX(${translateX}%)`;
            }
        }

        function updateNumericalIndicators() {
            document.querySelectorAll('.numerical-indicator').forEach((indicator, index) => {
                if (index === currentNumericalIndex) {
                    indicator.classList.add('active');
                } else {
                    indicator.classList.remove('active');
                }
            });
        }

        function nextNumerical() {
            // Check if we're at the last slide
            if (currentNumericalIndex >= totalNumericalSlides - 1) {
                return;
            }
            
            // If narration is in progress, stop it
            if (isNarrationInProgress && currentTeacher) {
                currentTeacher.stop();
                isNarrationInProgress = false;
            }
            
            // Move to the next slide (no wrap-around)
            currentNumericalIndex = Math.min(currentNumericalIndex + 1, totalNumericalSlides - 1);
            updateNumericalPosition();
            updateNumericalIndicators();
            showNumericalSolution(currentNumericalIndex, true); // Force narration on manual navigation
        }

        function previousNumerical() {
            // Check if we're at the first slide
            if (currentNumericalIndex <= 0) {
                return;
            }
            
            // If narration is in progress, stop it
            if (isNarrationInProgress && currentTeacher) {
                currentTeacher.stop();
                isNarrationInProgress = false;
            }
            
            // Move to the previous slide (no wrap-around)
            currentNumericalIndex = Math.max(currentNumericalIndex - 1, 0);
            updateNumericalPosition();
            updateNumericalIndicators();
            showNumericalSolution(currentNumericalIndex, true); // Force narration on manual navigation
        }

        function goToNumerical(index) {
            // If narration is in progress, stop it
            if (isNarrationInProgress && currentTeacher) {
                currentTeacher.stop();
                isNarrationInProgress = false;
            }
            
            // Ensure index is within bounds
            index = Math.max(0, Math.min(index, totalNumericalSlides - 1));
            
            // Don't do anything if we're already on this slide
            if (index === currentNumericalIndex) {
                return;
            }
            
            currentNumericalIndex = index;
            updateNumericalPosition();
            updateNumericalIndicators();
            showNumericalSolution(currentNumericalIndex, true); // Force narration on manual navigation
        }
        
        // Function to show solution steps for numerical problems
        function showNumericalSolution(index, forceNarration = false) {
            // If narration is in progress and we're forcing a new narration, stop the current one
            if (isNarrationInProgress && forceNarration && currentTeacher) {
                currentTeacher.stop();
                isNarrationInProgress = false;
            }
            // Don't proceed if narration is in progress and we're not forcing it
            else if (isNarrationInProgress && !forceNarration) {
                return;
            }
            
            // Clear any existing timeouts for showing steps
            if (window.stepTimeouts) {
                window.stepTimeouts.forEach(timeout => clearTimeout(timeout));
            }
            window.stepTimeouts = [];
            
            // Hide all solution steps first
            document.querySelectorAll('.solution-step, .final-result').forEach(el => {
                el.classList.remove('visible');
            });
            
            // Show solution steps for the current problem
            const problemPrefix = `prob${index + 1}`;
            const steps = document.querySelectorAll(`[id^="${problemPrefix}-step"]`);
            const result = document.getElementById(`${problemPrefix}-result`);
            
            // Only narrate if specifically requested (manual navigation)
            if (forceNarration && (currentTeacher && isPlaying)) {
                // Show steps synchronized with narration
                const stepDelay = 2500; // 2.5 seconds per step to match narration
                
                // Show steps with timing to match narration
                steps.forEach((step, i) => {
                    const timeout = setTimeout(() => {
                        // Only show if we're still on the same slide
                        if (currentNumericalIndex === index) {
                            step.classList.add('visible');
                        }
                    }, (i + 1) * stepDelay + 4000); // 4 second delay to account for problem statement + intro
                    
                    window.stepTimeouts.push(timeout);
                });
                
                // Show result after all steps with extra delay
                if (result) {
                    const timeout = setTimeout(() => {
                        // Only show if we're still on the same slide
                        if (currentNumericalIndex === index) {
                            result.classList.add('visible');
                        }
                    }, (steps.length + 1) * stepDelay + 5000); // Extra delay for final result
                    
                    window.stepTimeouts.push(timeout);
                }
                
                // Start narration
                if (currentTeacher && currentTeacher.stop) {
                    currentTeacher.stop();
                    // Small delay to ensure speech synthesis has fully stopped
                    setTimeout(() => {
                        narrateNumericalSolution(index);
                    }, 300);
                } else {
                    narrateNumericalSolution(index);
                }
            } else {
                // Just show all steps immediately without narration
                steps.forEach(step => {
                    step.classList.add('visible');
                });
                
                if (result) {
                    result.classList.add('visible');
                }
            }
        }

        function startNumericalAutoSlideshow() {
            // Auto slideshow is disabled for numerical problems
            // Users must manually navigate between problems
            stopNumericalAutoSlideshow();
        }

        function stopNumericalAutoSlideshow() {
            if (numericalAutoTimer) {
                // Clear both interval and timeout to be safe
                clearInterval(numericalAutoTimer);
                clearTimeout(numericalAutoTimer);
                numericalAutoTimer = null;
            }

        }

        function resetNumericalAutoSlideshow() {
            // Auto slideshow is disabled for numerical problems
            // No need to restart anything
            stopNumericalAutoSlideshow();
        }
        
        // Function to narrate numerical solutions
        async function narrateNumericalSolution(index) {
            if (!currentTeacher) return;
            
            // Set narration flag to true
            isNarrationInProgress = true;
            
            // Stop any ongoing narration
            currentTeacher.stop();
            
            try {
                // Wait a moment before starting narration
                await wait(500);
                
                // Get the numerical cards
                const numericalCards = document.querySelectorAll('.numerical-card');
                
                // Make sure we have the card for this index
                if (index >= numericalCards.length) {
                    console.error("Invalid index for numerical card:", index);
                    return;
                }
                
                // Get the current card that should be visible
                const currentCard = numericalCards[index];
                
                // Get problem title and statement directly from the DOM
                const problemTitle = currentCard.querySelector('.problem-title')?.textContent?.trim() || `Problem ${index + 1}`;
                const problemStatement = currentCard.querySelector('.problem-statement')?.textContent?.trim() || "";
                
                // Narrate the problem title and statement
                await currentTeacher.speak(`${problemTitle}. ${problemStatement}`);
                
                // Wait before starting the solution narration
                await wait(1500);
                
                // Get all solution steps for this problem from the DOM
                const problemPrefix = `prob${index + 1}`;
                const steps = document.querySelectorAll(`[id^="${problemPrefix}-step"]`);
                
                // Narrate "Let's solve this step by step"
                await currentTeacher.speak("Let's solve this step by step.");
                await wait(1000);
                
                // Narrate each step as it appears
                for (let i = 0; i < steps.length; i++) {
                    // Check if we should continue (user hasn't switched slides)
                    if (currentNumericalIndex !== index) {
                        break;
                    }
                    
                    // Get the step content directly from the DOM
                    const stepContent = steps[i].textContent?.trim() || "";
                    
                    // Skip empty steps
                    if (!stepContent) continue;
                    
                    // Clean up the content for better narration
                    let cleanContent = stepContent
                        .replace(/Ã—/g, ' times ')
                        .replace(/Ã·/g, ' divided by ')
                        .replace(/=/g, ' equals ')
                        .replace(/m\/sÂ²/g, ' meters per second squared ')
                        .replace(/\bN\b/g, ' Newtons ')
                        .replace(/\bJ\b/g, ' Joules ')
                        .replace(/\bW\b/g, ' Watts ')
                        .replace(/\bkW\b/g, ' kilowatts ')
                        .replace(/\bkg\b/g, ' kilograms ')
                        .replace(/\bm\b/g, ' meters ')
                        .replace(/\bs\b/g, ' seconds ');
                    
                    // Narrate the step content
                    await currentTeacher.speak(cleanContent);
                    
                    // Wait between steps
                    await wait(1500);
                }
                
                // Get the final result from the DOM
                const result = document.getElementById(`${problemPrefix}-result`);
                if (result && currentNumericalIndex === index) {
                    const resultContent = result.textContent?.trim() || "";
                    if (resultContent) {
                        // Clean up the result content for narration
                        let cleanResult = resultContent
                            .replace(/Ã—/g, ' times ')
                            .replace(/Ã·/g, ' divided by ')
                            .replace(/=/g, ' equals ')
                            .replace(/\bW\b/g, ' Watts ')
                            .replace(/\bkW\b/g, ' kilowatts ');
                        
                        // Wait a bit before narrating the final result
                        await wait(500);
                        await currentTeacher.speak(`The final answer is: ${cleanResult}`);
                    }
                }
                
            } finally {
                // Set narration flag to false when done, even if there was an error
                isNarrationInProgress = false;
            }
        }

        // Activity 10.17 Slideshow Functions
        async function showActivity1017() {
            const taskId = 'activity1017-demo';
            stopCurrentDemo();
            isPlaying = true;
            setActiveButton(7);
            
            const teacher = createNewTeacher(taskId);
            await showActivity1017Internal(teacher, taskId);
            
            isPlaying = false;
        }

        async function showActivity1017Internal(teacher, taskId = null) {
            // Make sure all demos are hidden first
            document.querySelectorAll('.welcome-demo, .climbing-demo, .staircase-demo, .power-comparison-demo, .formula-demo, .calculator-demo, .numerical-demo, #problem1-demo, #problem2-demo, #problem3-demo, .power-types-demo, .activity1017-demo').forEach(demo => {
                demo.classList.remove('active');
            });
            
            await wait(50);
            if (!shouldContinue(taskId)) return;
            
            updateTitle("âš¡ Activity 10.17: Electric Meter Reading");
            
            document.getElementById('activity1017-demo').classList.add('active');
            await wait(50);
            if (!shouldContinue(taskId)) return;
            
            // Reset completion flag and initialize slideshow
            activity1017Completed = false;
            initializeActivity1017Slideshow();
            
            await teacher.speak("Let's explore Activity 10.17! We'll learn how to read electric meters and understand power consumption patterns in our homes.");
            if (!shouldContinue(taskId)) return;
            
            await wait(1000);
            
            // Narrate each slide with content
            await narrateActivity1017Slides(teacher, taskId);
        }
        
        async function narrateActivity1017Slides(teacher, taskId = null) {
            // Slide 1: Introduction
            if (!shouldContinue(taskId)) return;
            currentActivity1017Index = 0;
            updateActivity1017Position();
            updateActivity1017Indicators();
            
            await teacher.speak("Activity 10.17 teaches us how to read electric meters and track power consumption in our homes. We'll observe meter readings, collect data, and analyze patterns.");
            if (!shouldContinue(taskId)) return;
            
            await wait(1000);
            
            // Move to slide 2: Power Sources
            if (!shouldContinue(taskId)) return;
            currentActivity1017Index = 1;
            updateActivity1017Position();
            updateActivity1017Indicators();
            
            await teacher.speak("There are different types of power sources in our homes. Human power, electrical power, and mechanical power all follow the same principle: Power equals work divided by time.");
            if (!shouldContinue(taskId)) return;
            
            await wait(1000);
            
            // Move to slide 3: Data Collection
            if (!shouldContinue(taskId)) return;
            currentActivity1017Index = 2;
            updateActivity1017Position();
            updateActivity1017Indicators();
            
            await teacher.speak("In this activity, we collect meter readings at 6:30 AM and 6:30 PM daily for a week. This helps us understand our power consumption patterns during day and night.");
            if (!shouldContinue(taskId)) return;
            
            await wait(1000);
            
            // Move to slide 4: Appliance Power
            if (!shouldContinue(taskId)) return;
            currentActivity1017Index = 3;
            updateActivity1017Position();
            updateActivity1017Indicators();
            
            await teacher.speak("Different appliances consume different amounts of power. LED bulbs use just 9 watts, while air conditioners can use up to 1500 watts! Understanding these ratings helps us manage electricity usage.");
            if (!shouldContinue(taskId)) return;
            
            await wait(1000);
            
            // Move to slide 5: Key Concepts
            if (!shouldContinue(taskId)) return;
            currentActivity1017Index = 4;
            updateActivity1017Position();
            updateActivity1017Indicators();
            
            await teacher.speak("The key concepts from this activity are: Average power is total energy divided by time, power varies with time, and higher power means faster work. These principles help us understand and manage electricity usage efficiently.");
            if (!shouldContinue(taskId)) return;
            
            // Mark activity as completed
            activity1017Completed = true;
            
            // We stay on the last slide - no more automatic rotation
        }

        function initializeActivity1017Slideshow() {
            currentActivity1017Index = 0;
            updateActivity1017Position();
            updateActivity1017Indicators();
        }

        function updateActivity1017Position() {
            const container = document.getElementById('activity1017-container');
            if (container) {
                // Calculate exact position - each slide is 20% wide
                const slideWidth = 20;
                const translateX = -(currentActivity1017Index * slideWidth);
                container.style.transform = `translateX(${translateX}%)`;
            }
        }

        function updateActivity1017Indicators() {
            document.querySelectorAll('.activity1017-indicator').forEach((indicator, index) => {
                if (index === currentActivity1017Index) {
                    indicator.classList.add('active');
                } else {
                    indicator.classList.remove('active');
                }
            });
        }


        // These functions are kept for manual navigation but auto slideshow is disabled
        function startActivity1017AutoSlideshow() {
            // Auto slideshow is disabled - narration controls the slides
            stopActivity1017AutoSlideshow();
        }

        function stopActivity1017AutoSlideshow() {
            if (activity1017AutoTimer) {
                clearInterval(activity1017AutoTimer);
                activity1017AutoTimer = null;
            }
        }

        // Function to check if Activity 10.17 is completed
        function isActivity1017Completed() {
            return activity1017Completed;
        }

        function resetActivity1017AutoSlideshow() {
            // Auto slideshow is disabled - do nothing
        }

        // Power Types Slideshow Functions
        async function showPowerTypesDemo() {
            const taskId = 'power-types-demo';
            stopCurrentDemo();
            isPlaying = true;
            setActiveButton(1);
            
            const teacher = createNewTeacher(taskId);
            await showPowerTypesDemoInternal(teacher, taskId);
            
            isPlaying = false;
        }

        async function showPowerTypesDemoInternal(teacher, taskId = null) {
            // Make sure all demos are hidden first
            document.querySelectorAll('.welcome-demo, .climbing-demo, .staircase-demo, .power-comparison-demo, .formula-demo, .calculator-demo, .numerical-demo, #problem1-demo, #problem2-demo, #problem3-demo, .power-types-demo, .activity1017-demo').forEach(demo => {
                demo.classList.remove('active');
            });
            
            await wait(50);
            if (!shouldContinue(taskId)) return;
            
            updateTitle("âš¡ Types of Power - Detailed Explanations");
            
            document.getElementById('power-types-demo').classList.add('active');
            await wait(50);
            if (!shouldContinue(taskId)) return;
            
            // Initialize slideshow (but don't start auto slideshow)
            initializePowerTypesSlideshow();
            
            await teacher.speak("Let's explore the different types of power in detail! Each type has unique characteristics and real-world applications with specific numerical values.");
            if (!shouldContinue(taskId)) return;
            
            await wait(1000);
            
            await teacher.speak("I'll guide you through human power, electrical power, and mechanical power with examples and calculations.");
            if (!shouldContinue(taskId)) return;
            
            // Narrate each slide with content
            await narratePowerTypeSlides(teacher, taskId);
        }
        
        async function narratePowerTypeSlides(teacher, taskId = null) {
            // Slide 1: Human Power
            if (!shouldContinue(taskId)) return;
            currentPowerTypesIndex = 0;
            updatePowerTypesPosition();
            updatePowerTypesIndicators();
            
            await teacher.speak("Human power is generated through muscle activity and physical effort. When we climb stairs, lift objects, or exercise, our muscles convert chemical energy from food into mechanical work.");
            if (!shouldContinue(taskId)) return;
            
            await wait(1000);
            
            await teacher.speak("For example, a person climbing stairs generates about 100 to 200 watts of power. Professional cyclists can sustain 300 to 400 watts, while Olympic sprinters can reach peaks of 1500 to 2000 watts!");
            if (!shouldContinue(taskId)) return;
            
            await wait(1000);
            
            // Move to slide 2: Electrical Power
            if (!shouldContinue(taskId)) return;
            currentPowerTypesIndex = 1;
            updatePowerTypesPosition();
            updatePowerTypesIndicators();
            
            await teacher.speak("Electrical power is consumed by lights, computers, and appliances. It's the rate at which electrical energy is converted into other forms like light, heat, or motion.");
            if (!shouldContinue(taskId)) return;
            
            await wait(1000);
            
            await teacher.speak("Common household appliances have different power ratings. An LED bulb uses just 9 to 15 watts, while a laptop uses 50 to 100 watts. A microwave oven needs 800 to 1200 watts, and an air conditioner can use 1500 to 3000 watts!");
            if (!shouldContinue(taskId)) return;
            
            await wait(1000);
            
            // Move to slide 3: Mechanical Power
            if (!shouldContinue(taskId)) return;
            currentPowerTypesIndex = 2;
            updatePowerTypesPosition();
            updatePowerTypesIndicators();
            
            await teacher.speak("Mechanical power is found in cars, motorcycles, and industrial machines. It involves the conversion of fuel energy into motion and work output.");
            if (!shouldContinue(taskId)) return;
            
            await wait(1000);
            
            await teacher.speak("A small car engine produces about 50 to 100 kilowatts of power, while a sports car can generate 200 to 400 kilowatts. That's equivalent to thousands of watts - much more powerful than human power!");
            if (!shouldContinue(taskId)) return;
            
            // We stay on the last slide - no more automatic rotation
        }

        function initializePowerTypesSlideshow() {
            currentPowerTypesIndex = 0;
            updatePowerTypesPosition();
            updatePowerTypesIndicators();
        }

        function updatePowerTypesPosition() {
            const container = document.getElementById('power-types-container');
            if (container) {
                // Calculate exact position - each slide is 33.333% wide
                const slideWidth = 33.333;
                const translateX = -(currentPowerTypesIndex * slideWidth);
                container.style.transform = `translateX(${translateX}%)`;
            }
        }

        function updatePowerTypesIndicators() {
            document.querySelectorAll('.power-types-indicator').forEach((indicator, index) => {
                if (index === currentPowerTypesIndex) {
                    indicator.classList.add('active');
                } else {
                    indicator.classList.remove('active');
                }
            });
        }

        function nextPowerType() {
            // Don't go past the last slide
            if (currentPowerTypesIndex < totalPowerTypesSlides - 1) {
                currentPowerTypesIndex++;
                updatePowerTypesPosition();
                updatePowerTypesIndicators();
            }
        }

        function previousPowerType() {
            // Don't go before the first slide
            if (currentPowerTypesIndex > 0) {
                currentPowerTypesIndex--;
                updatePowerTypesPosition();
                updatePowerTypesIndicators();
            }
        }

        function goToPowerType(index) {
            // Make sure index is within bounds
            if (index >= 0 && index < totalPowerTypesSlides) {
                currentPowerTypesIndex = index;
                updatePowerTypesPosition();
                updatePowerTypesIndicators();
            }
        }

        // These functions are kept for manual navigation but auto slideshow is disabled
        function startPowerTypesAutoSlideshow() {
            // Auto slideshow is disabled - narration controls the slides
            stopPowerTypesAutoSlideshow();
        }

        function stopPowerTypesAutoSlideshow() {
            if (powerTypesAutoTimer) {
                clearInterval(powerTypesAutoTimer);
                powerTypesAutoTimer = null;
            }
        }

        function resetPowerTypesAutoSlideshow() {
            // Auto slideshow is disabled - do nothing
        }

        // Helper Functions
        async function resetAll() {
            if (animationTimeline) {
                animationTimeline.kill();
                animationTimeline = null;
            }
            gsap.killTweensOf("*");
            
            activeAnimations.forEach(anim => {
                if (anim) anim.kill();
            });
            activeAnimations = [];
            
            if (currentTeacher) {
                currentTeacher.stop();
            }
            
            // Hide all demos
            document.querySelectorAll('.welcome-demo, .climbing-demo, .staircase-demo, .power-comparison-demo, .formula-demo, .calculator-demo, .numerical-demo, #problem1-demo, #problem2-demo, #problem3-demo').forEach(demo => {
                demo.classList.remove('active');
            });
            
            updateTitle("Explore Power and Energy Transfer Rate");
            
            // Reset welcome demo elements
            document.querySelectorAll('.power-element').forEach(element => {
                element.classList.remove('visible');
            });
            
            // Reset definition card
            const definitionCard = document.getElementById('definition-card');
            if (definitionCard) {
                definitionCard.classList.remove('visible');
            }
            
            // Reset climbing demo
            gsap.set('#climber-a', { bottom: '20px' });
            gsap.set('#climber-b', { bottom: '20px' });
            document.querySelectorAll('.timer-display, .power-result').forEach(el => {
                el.classList.remove('visible');
            });
            
            // Reset staircase demo
            gsap.set('#runner', { x: 0, y: 0, bottom: '10px', left: '20px' });
            document.querySelectorAll('.explanation-card, .calc-step, .result-highlight').forEach(el => {
                el.classList.remove('visible');
            });

            // Reset numerical demo
            stopNumericalAutoSlideshow();
            currentNumericalIndex = 0;
            const numericalContainer = document.getElementById('numerical-container');
            if (numericalContainer) {
                numericalContainer.style.transform = 'translateX(0%)';
            }
            document.querySelectorAll('.numerical-indicator').forEach((indicator, index) => {
                indicator.classList.toggle('active', index === 0);
            });
            document.querySelectorAll('.solution-step, .final-result').forEach(el => {
                el.classList.remove('visible');
            });

            // Reset Activity 10.17 demo
            stopActivity1017AutoSlideshow();
            currentActivity1017Index = 0;
            activity1017Completed = false;
            const activity1017Container = document.getElementById('activity1017-container');
            if (activity1017Container) {
                activity1017Container.style.transform = 'translateX(0%)';
            }
            document.querySelectorAll('.activity1017-indicator').forEach((indicator, index) => {
                indicator.classList.toggle('active', index === 0);
            });

            // Reset Power Types demo
            stopPowerTypesAutoSlideshow();
            currentPowerTypesIndex = 0;
            const powerTypesContainer = document.getElementById('power-types-container');
            if (powerTypesContainer) {
                powerTypesContainer.style.transform = 'translateX(0%)';
            }
            document.querySelectorAll('.power-types-indicator').forEach((indicator, index) => {
                indicator.classList.toggle('active', index === 0);
            });
            
            // Clear calculator
            document.getElementById('work-input').value = '';
            document.getElementById('time-input').value = '';
            document.getElementById('power-result').innerHTML = 'Enter work and time values to calculate power';
            
            await wait(300);
        }

        function updateTitle(title) {
            document.getElementById('demo-title').textContent = title;
        }

        function setActiveButton(index) {
            document.querySelectorAll('.demo-btn').forEach((btn, i) => {
                btn.classList.toggle('active', i === index);
            });
        }

        function wait(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        // Reset Button Handler
        async function resetAllClick() {
            stopCurrentDemo();
            isPlaying = false;
            await resetAll();
        }

        // Audio Control
        document.getElementById('mute-btn').addEventListener('click', () => {
            globalAudioEnabled = !globalAudioEnabled;
            document.getElementById('mute-btn').classList.toggle('muted', !globalAudioEnabled);
            
            if (!globalAudioEnabled && currentTeacher) {
                currentTeacher.stop();
            }
        });

        // Keyboard support for calculator
        document.getElementById('work-input').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                calculatePower();
            }
        });

        document.getElementById('time-input').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                calculatePower();
            }
        });
    </script>
</body>
</html>

