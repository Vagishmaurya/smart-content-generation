<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crop Improvement and Breeding - Complete Genetics Journey</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tween.js/18.6.4/tween.umd.js"></script>

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #1565C0 0%, #42A5F5 50%, #81C784 100%);
            color: white;
            overflow: hidden;
            position: relative;
            height: 100vh;
        }

        /* Animated Background */
        .bg-animation {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 0;
            opacity: 0.1;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320"><path fill="%23ffffff" fill-opacity="0.2" d="M0,160L48,144C96,128,192,96,288,112C384,128,480,192,576,208C672,224,768,192,864,176C960,160,1056,160,1152,170.7C1248,181,1344,203,1392,213.3L1440,224L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path></svg>') repeat-x;
            animation: wave 12s linear infinite;
        }

        @keyframes wave {
            0% { background-position-x: 0; }
            100% { background-position-x: 1440px; }
        }

        /* Museum Interface - Compact Header */
        .museum-header {
            position: absolute;
            top: 10px;
            left: 20px;
            text-align: left;
            z-index: 1000;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            padding: 10px 18px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        .museum-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 4px;
            background: linear-gradient(45deg, #42A5F5, #1565C0);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: titleGlow 3s ease-in-out infinite;
        }

        @keyframes titleGlow {
            0%, 100% { filter: brightness(1); }
            50% { filter: brightness(1.2); }
        }

        .exhibit-subtitle {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.8);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .dna-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: #42A5F5;
            border-radius: 50%;
            animation: dna-pulse 2s ease-in-out infinite;
        }

        @keyframes dna-pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.3); opacity: 0.7; }
        }

        /* Journey Navigation - Enhanced */
        .journey-navigation {
            position: absolute;
            bottom: 20px;
            left: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 1000;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            padding: 15px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            max-width: 320px;
        }

        .journey-title {
            font-size: 14px;
            font-weight: 600;
            color: #42A5F5;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .journey-steps {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
        }

        .journey-btn {
            background: rgba(66, 165, 245, 0.2);
            border: 1px solid rgba(66, 165, 245, 0.4);
            color: white;
            padding: 6px 10px;
            border-radius: 20px;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 4px;
            white-space: nowrap;
        }

        .journey-btn:hover {
            background: rgba(66, 165, 245, 0.3);
            border-color: #42A5F5;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(66, 165, 245, 0.3);
        }

        .journey-btn.active {
            background: linear-gradient(135deg, #FFC107, #FF9800);
            border-color: #FFC107;
            box-shadow: 0 0 20px rgba(255, 193, 7, 0.5);
            animation: pulse 2s infinite;
        }

        .journey-btn.completed {
            background: rgba(21, 101, 192, 0.3);
            border-color: #1565C0;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* 3D Model Container */
        .model-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 0;
            overflow: hidden;
            border: none;
            z-index: 100;
        }

        .sketchfab-embed-wrapper {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #1565C0 0%, #42A5F5 50%, #81C784 100%);
        }

        .sketchfab-embed-wrapper iframe {
            width: 100%;
            height: 100%;
            border: none;
            border-radius: 0;
        }

        /* Information Panel - Enhanced */
        .info-panel {
            position: absolute;
            top: 70px;
            right: 20px;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 16px;
            padding: 24px;
            width: 380px;
            max-height: calc(100vh - 140px);
            z-index: 800;
            overflow-y: auto;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }

        .info-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
        }

        .info-icon {
            font-size: 28px;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        .info-title {
            flex: 1;
        }

        .info-title h2 {
            font-size: 18px;
            color: #42A5F5;
            margin-bottom: 4px;
        }

        .info-subtitle {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
        }

        .info-content {
            color: rgba(255, 255, 255, 0.9);
            font-size: 14px;
            line-height: 1.6;
        }

        /* Progress Tracker */
        .progress-tracker {
            background: linear-gradient(135deg, rgba(66, 165, 245, 0.1), rgba(129, 199, 132, 0.1));
            border: 1px solid rgba(66, 165, 245, 0.3);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 20px;
        }

        .progress-header {
            font-size: 13px;
            font-weight: 600;
            color: #42A5F5;
            margin-bottom: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .progress-percentage {
            font-size: 18px;
            color: #FFC107;
            font-weight: 700;
        }

        .progress-bar {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 12px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #42A5F5, #FFC107);
            border-radius: 4px;
            transition: width 0.8s ease;
            box-shadow: 0 0 10px rgba(255, 193, 7, 0.5);
        }

        .progress-steps-mini {
            display: flex;
            justify-content: space-between;
            font-size: 10px;
            color: rgba(255, 255, 255, 0.6);
        }

        .step-mini {
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .step-mini.active {
            color: #FFC107;
            font-weight: 600;
        }

        .step-mini.completed {
            color: #42A5F5;
        }

        /* Information Cards */
        .info-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 14px;
            margin-bottom: 14px;
        }

        .info-card-title {
            color: #42A5F5;
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .info-card-content {
            color: rgba(255, 255, 255, 0.85);
            font-size: 12px;
            line-height: 1.5;
        }

        .info-list {
            list-style: none;
            padding: 0;
        }

        .info-list li {
            padding: 6px 0;
            padding-left: 20px;
            position: relative;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.8);
        }

        .info-list li:before {
            content: "🧬";
            position: absolute;
            left: 0;
            color: #42A5F5;
        }

        /* Fun Fact Box */
        .fun-fact {
            background: linear-gradient(135deg, rgba(255, 193, 7, 0.1), rgba(66, 165, 245, 0.1));
            border: 1px solid rgba(255, 193, 7, 0.3);
            border-radius: 12px;
            padding: 14px;
            margin: 16px 0;
            position: relative;
            overflow: hidden;
        }

        .fun-fact:before {
            content: "🔬";
            position: absolute;
            top: -20px;
            right: -20px;
            font-size: 60px;
            opacity: 0.1;
        }

        .fun-fact-title {
            color: #FFC107;
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 6px;
        }

        .fun-fact-text {
            color: rgba(255, 255, 255, 0.9);
            font-size: 12px;
            line-height: 1.5;
            position: relative;
            z-index: 1;
        }

        /* Voice Controls */
        .voice-controls {
            position: absolute;
            top: 10px;
            right: 20px;
            display: flex;
            gap: 8px;
            z-index: 1000;
        }

        .control-btn {
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            position: relative;
        }

        .control-btn:hover {
            background: rgba(66, 165, 245, 0.3);
            border-color: #42A5F5;
            transform: scale(1.1);
        }

        .control-btn.active {
            background: rgba(66, 165, 245, 0.4);
            border-color: #42A5F5;
            box-shadow: 0 0 20px rgba(66, 165, 245, 0.5);
        }

        .control-tooltip {
            position: absolute;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.9);
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 10px;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .control-btn:hover .control-tooltip {
            opacity: 1;
        }

        /* Loading Screen */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #1565C0 0%, #42A5F5 50%, #81C784 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            transition: opacity 1s ease;
        }

        .loading-content {
            text-align: center;
        }

        .loading-heart {
            font-size: 60px;
            animation: dna-pulse 1.5s ease-in-out infinite;
            margin-bottom: 20px;
        }

        .loading-text {
            color: white;
            font-size: 20px;
            margin-bottom: 20px;
        }

        .loading-progress {
            width: 200px;
            height: 4px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 2px;
            overflow: hidden;
        }

        .loading-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #42A5F5, #FFC107);
            animation: loading 2s ease-in-out infinite;
        }

        @keyframes loading {
            0% { width: 0%; }
            50% { width: 100%; }
            100% { width: 0%; }
        }

        /* Voice Indicator */
        .voice-indicator {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(66, 165, 245, 0.5);
            border-radius: 30px;
            padding: 14px 28px;
            display: flex;
            align-items: center;
            gap: 12px;
            z-index: 1000;
            opacity: 0;
            transition: all 0.3s ease;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }

        .voice-indicator.visible {
            opacity: 1;
            transform: translateX(-50%) translateY(-10px);
        }

        .voice-waves {
            display: flex;
            align-items: center;
            gap: 3px;
        }

        .voice-wave {
            width: 3px;
            height: 20px;
            background: linear-gradient(180deg, #42A5F5, #FFC107);
            border-radius: 2px;
            animation: voice-wave 1s ease-in-out infinite;
        }

        .voice-wave:nth-child(2) { animation-delay: 0.1s; }
        .voice-wave:nth-child(3) { animation-delay: 0.2s; }
        .voice-wave:nth-child(4) { animation-delay: 0.3s; }
        .voice-wave:nth-child(5) { animation-delay: 0.4s; }

        @keyframes voice-wave {
            0%, 100% { transform: scaleY(0.3); }
            50% { transform: scaleY(1); }
        }

        .narration-text {
            color: white;
            font-size: 13px;
            max-width: 300px;
        }

        /* Quick Actions */
        .quick-actions {
            position: absolute;
            bottom: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
            z-index: 1000;
        }

        .action-btn {
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 10px 16px;
            border-radius: 25px;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
        }

        .action-btn:hover {
            background: rgba(66, 165, 245, 0.3);
            border-color: #42A5F5;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(66, 165, 245, 0.3);
        }

        /* Custom Scrollbar */
        .info-panel::-webkit-scrollbar {
            width: 6px;
        }

        .info-panel::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 3px;
        }

        .info-panel::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, #42A5F5, #FFC107);
            border-radius: 3px;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .info-panel {
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                top: auto;
                width: 100%;
                max-height: 50vh;
                border-radius: 20px 20px 0 0;
            }
            
            .journey-navigation {
                bottom: 52vh;
                max-width: calc(100% - 40px);
            }
            
            .voice-controls {
                top: auto;
                bottom: 55vh;
                right: 10px;
            }
            
            .quick-actions {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="bg-animation"></div>

    <!-- Loading Screen -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="loading-heart">🧬</div>
            <div class="loading-text">Preparing Your Breeding Laboratory...</div>
            <div class="loading-progress">
                <div class="loading-progress-bar"></div>
            </div>
        </div>
    </div>

    <!-- Museum Header -->
    <div class="museum-header">
        <div class="museum-title">Crop Improvement and Breeding</div>
        <div class="exhibit-subtitle">
            <span class="dna-indicator"></span>
            The Science of Better Plants
        </div>
    </div>

    <!-- Journey Navigation -->
    <div class="journey-navigation">
        <div class="journey-title">
            <span>🔬</span>
            <span>Breeding Journey</span>
        </div>
        <div class="journey-steps">
            <button class="journey-btn active" onclick="loadJourneyStep('introduction')">
                <span>🌱</span> Intro
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('hybridization')">
                <span>🔬</span> Hybrid
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('genetics')">
                <span>🧬</span> Genetics
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('traits')">
                <span>⭐</span> Traits
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('development')">
                <span>🚀</span> Develop
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('drought')">
                <span>🌵</span> Drought
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('adaptation')">
                <span>🌍</span> Adapt
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('future')">
                <span>🔮</span> Future
            </button>
        </div>
    </div>

    <!-- 3D Model Container -->
    <div class="model-container">
        <div class="sketchfab-embed-wrapper">
            <iframe id="api-frame"
                    title="Plant Breeding Model" 
                    frameborder="0" 
                    allowfullscreen 
                    mozallowfullscreen="true" 
                    webkitallowfullscreen="true" 
                    allow="autoplay; fullscreen; xr-spatial-tracking"
                    xr-spatial-tracking 
                    execution-while-out-of-viewport 
                    execution-while-not-rendered 
                    web-share 
                    src="https://sketchfab.com/models/68d536840b0743238a939c3fd44621ad/embed?autostart=1&internal=1&tracking=0&ui_ar=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0">
            </iframe>
        </div>
    </div>

    <!-- Information Panel -->
    <div class="info-panel" id="infoPanel">
        <div class="info-header">
            <div class="info-icon" id="stepIcon">🌱</div>
            <div class="info-title">
                <h2 id="stepTitle">Introduction to Crop Improvement</h2>
                <div class="info-subtitle" id="stepSubtitle">The art and science of better plants</div>
            </div>
        </div>

        <!-- Progress Tracker -->
        <div class="progress-tracker">
            <div class="progress-header">
                <span>Research Progress</span>
                <span class="progress-percentage" id="progressPercent">0%</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 0%"></div>
            </div>
            <div class="progress-steps-mini">
                <span class="step-mini active" onclick="loadJourneyStep('introduction')">Int</span>
                <span class="step-mini" onclick="loadJourneyStep('hybridization')">Hyb</span>
                <span class="step-mini" onclick="loadJourneyStep('genetics')">Gen</span>
                <span class="step-mini" onclick="loadJourneyStep('traits')">Tra</span>
                <span class="step-mini" onclick="loadJourneyStep('development')">Dev</span>
                <span class="step-mini" onclick="loadJourneyStep('drought')">Dro</span>
                <span class="step-mini" onclick="loadJourneyStep('adaptation')">Ada</span>
                <span class="step-mini" onclick="loadJourneyStep('future')">Fut</span>
            </div>
        </div>

        <div class="info-content" id="mainDescription">
            Crop improvement is the systematic enhancement of plants through scientific breeding methods. By combining traditional techniques with modern biotechnology, scientists create varieties with higher yields, better nutrition, disease resistance, and climate adaptability.
        </div>

        <div class="info-card">
            <div class="info-card-title">
                <span>🎯</span> Key Goals
            </div>
            <div class="info-card-content">
                <ul class="info-list" id="keyConcepts">
                    <li>Increase crop yields to feed growing population</li>
                    <li>Enhance nutritional content and quality</li>
                    <li>Develop disease and pest resistance</li>
                    <li>Create climate-resilient varieties</li>
                </ul>
            </div>
        </div>

        <div class="fun-fact">
            <div class="fun-fact-title">Scientific Breakthrough!</div>
            <div class="fun-fact-text" id="funFact">
                Modern hybrid corn varieties can produce 6-10 times more grain per plant than their wild ancestors, demonstrating the power of selective breeding!
            </div>
        </div>

        <div class="info-card">
            <div class="info-card-title">
                <span>🔬</span> Learning Objectives
            </div>
            <div class="info-card-content" id="learningObjectives">
                Understand how plant breeders use genetics and biotechnology to develop improved crop varieties for sustainable agriculture.
            </div>
        </div>
    </div>

    <!-- Voice Controls -->
    <div class="voice-controls">
        <button class="control-btn active" id="voiceToggle" onclick="toggleVoice()">
            🔊
            <span class="control-tooltip">Voice Narration</span>
        </button>
        <button class="control-btn" onclick="toggleAutoPlay()">
            ▶️
            <span class="control-tooltip">Auto Journey</span>
        </button>
        <button class="control-btn" onclick="toggleInfo()">
            ℹ️
            <span class="control-tooltip">Toggle Info</span>
        </button>
    </div>

    <!-- Quick Actions -->
    <div class="quick-actions">
        <button class="action-btn" onclick="startGuidedTour()">
            <span>🚀</span> Guided Tour
        </button>
        <button class="action-btn" onclick="showQuiz()">
            <span>🎯</span> Test Knowledge
        </button>
    </div>

    <!-- Voice Indicator -->
    <div class="voice-indicator" id="voiceIndicator">
        <div class="voice-waves">
            <div class="voice-wave"></div>
            <div class="voice-wave"></div>
            <div class="voice-wave"></div>
            <div class="voice-wave"></div>
            <div class="voice-wave"></div>
        </div>
        <div class="narration-text" id="narrationText">Narrating...</div>
    </div>

    <script>
        // Journey Step Data with Complete Breeding Content
        const JOURNEY_DATA = {
            introduction: {
                title: "Introduction to Crop Improvement",
                subtitle: "The art and science of better plants",
                icon: "🌱",
                modelUrl: "https://sketchfab.com/models/68d536840b0743238a939c3fd44621ad/embed?autostart=1&internal=1&tracking=0&ui_ar=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "Crop improvement is the systematic enhancement of plants through scientific breeding methods. By combining traditional techniques with modern biotechnology, scientists create varieties with higher yields, better nutrition, disease resistance, and climate adaptability.",
                concepts: [
                    "Increase crop yields to feed growing population",
                    "Enhance nutritional content and quality",
                    "Develop disease and pest resistance",
                    "Create climate-resilient varieties"
                ],
                funFact: "Modern hybrid corn varieties can produce 6-10 times more grain per plant than their wild ancestors, demonstrating the power of selective breeding!",
                objectives: "Understand how plant breeders use genetics and biotechnology to develop improved crop varieties for sustainable agriculture.",
                narration: "Welcome to the fascinating world of crop improvement! You're looking at a hybrid corn plant - the result of decades of careful breeding and scientific innovation. This corn represents one of humanity's greatest agricultural achievements. While wild corn, called teosinte, produced tiny seeds the size of wheat grains, modern hybrid corn can produce massive ears with hundreds of kernels. Plant breeders work like genetic architects, combining the best traits from different varieties to create superior plants. They select for higher yields to feed our growing population, better nutrition to combat malnutrition, resistance to diseases that destroy crops, and tolerance to climate stresses like drought. This hybrid corn showcases how science transforms agriculture - each plant can produce 6 to 10 times more food than its ancestors!"
            },
            hybridization: {
                title: "Hybridization - Crossing for Excellence",
                subtitle: "Combining the best traits",
                icon: "🔬",
                modelUrl: "https://sketchfab.com/models/68d536840b0743238a939c3fd44621ad/embed?autostart=1&internal=1&tracking=0&ui_ar=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "Hybridization involves crossing two genetically different parent plants to produce offspring with desirable traits from both parents. This process combines beneficial characteristics like high yield from one parent and disease resistance from another.",
                concepts: [
                    "Cross-pollination between selected parent varieties",
                    "Combines beneficial traits from both parents",
                    "First generation (F1) often shows hybrid vigor",
                    "Controlled breeding ensures desired characteristics"
                ],
                funFact: "Hybrid vigor, or heterosis, can increase crop yields by 15-50% compared to the parent varieties - nature's bonus for genetic diversity!",
                objectives: "Learn how controlled crossing creates hybrid varieties that outperform their parent plants.",
                narration: "This hybrid corn is the perfect example of hybridization success! Plant breeders carefully selected two different parent varieties - perhaps one with excellent yield and another with strong disease resistance. By controlled cross-pollination, they combined the best traits of both parents in the offspring. The process starts when breeders remove the tassels from one parent plant to prevent self-pollination, then transfer pollen from the selected male parent to the female parent's silk. The resulting seeds grow into hybrid plants that often display 'hybrid vigor' or heterosis - they're actually better than either parent! This corn plant might be 20-50% more productive than its parents, demonstrating how hybridization unlocks genetic potential. The uniformity you see in modern corn fields comes from this precise breeding process, where every plant has the same superior genetic combination."
            },
            genetics: {
                title: "Genetic Modification - Precision Engineering",
                subtitle: "Direct DNA manipulation",
                icon: "🧬",
                modelUrl: "https://sketchfab.com/models/1e4643b88a1f4683a9765287ff2871cb/embed?autostart=1&internal=1&tracking=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "Genetic modification allows scientists to directly insert beneficial genes from other organisms into crop plants. This precision technique can add traits that are impossible to achieve through traditional breeding alone.",
                concepts: [
                    "Direct insertion of beneficial genes",
                    "Can add traits from any organism",
                    "Faster than traditional breeding methods",
                    "Enables traits impossible through crossing"
                ],
                funFact: "Scientists have created wheat varieties with genes from bacteria that help plants survive extreme cold temperatures down to -40°C!",
                objectives: "Understand how genetic engineering creates crop varieties with entirely new capabilities.",
                narration: "This wheat plant represents the cutting edge of genetic modification! Unlike traditional breeding that shuffles existing genes, genetic engineering allows scientists to add completely new capabilities to plants. Researchers can take a gene from bacteria that produces a natural insecticide and insert it directly into wheat DNA, creating plants that protect themselves from pests. They've even added genes from arctic fish to help crops survive freezing temperatures! The process involves using molecular tools to cut and paste genetic code with incredible precision. One breakthrough involves adding genes from bacteria that fix nitrogen from air, potentially reducing fertilizer needs by 50%. While traditional breeding might take 10-15 years to develop a new variety, genetic modification can add specific traits much faster. This wheat could carry genes for drought tolerance from desert plants, or nutritional enhancements from other crops - possibilities limited only by scientific imagination!"
            },
            traits: {
                title: "Desirable Traits - The Breeder's Wishlist",
                subtitle: "Yield, quality, and resistance",
                icon: "⭐",
                modelUrl: "https://sketchfab.com/models/2c0dfe7f2dca4a4da76d54a44d49df98/embed?autostart=1&internal=1&tracking=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "Plant breeders focus on three main categories of traits: agronomic traits like yield and maturity, quality traits like nutrition and taste, and resistance traits against diseases, pests, and environmental stresses.",
                concepts: [
                    "Yield: More food per plant and per acre",
                    "Quality: Better nutrition, taste, and shelf life",
                    "Disease resistance: Protection from pathogens",
                    "Stress tolerance: Surviving harsh conditions"
                ],
                funFact: "Golden Rice contains beta-carotene genes that could prevent blindness in 500,000 children annually - breeding for humanitarian impact!",
                objectives: "Identify the key traits that make crop varieties successful and beneficial for farmers and consumers.",
                narration: "This healthy, vigorous plant exemplifies the ideal traits breeders seek! Every characteristic you see has been carefully selected over generations. The thick, strong stem indicates good lodging resistance - it won't fall over in storms. The large, dense leaves suggest efficient photosynthesis for higher yields. The robust root system means excellent nutrient and water uptake. But breeders also work on traits you can't see - like protein content in the seeds, disease resistance genes that fight off pathogens, and stress tolerance that helps plants survive droughts or floods. Some varieties are bred for specific qualities: wheat with stronger gluten for better bread, rice with more vitamin A to prevent blindness, or corn with natural pest resistance. Modern breeders use molecular markers to track invisible traits, ensuring that beneficial genes are present even when they can't be seen. This plant represents thousands of genetic decisions, each one making it more valuable to farmers and nutritious for consumers!"
            },
            development: {
                title: "Variety Development - From Lab to Field",
                subtitle: "The breeding pipeline",
                icon: "🚀",
                modelUrl: "https://sketchfab.com/models/2c0dfe7f2dca4a4da76d54a44d49df98/embed?autostart=1&internal=1&tracking=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "Developing a new crop variety is a systematic process that takes 8-15 years. It involves crossing parents, selecting promising offspring, extensive field testing, and regulatory approval before release to farmers.",
                concepts: [
                    "8-15 years from initial cross to market release",
                    "Multi-location field trials test performance",
                    "Regulatory approval ensures safety",
                    "Seed multiplication provides supply to farmers"
                ],
                funFact: "A single new crop variety costs $10-15 million to develop and must be tested in over 100 different locations before release!",
                objectives: "Follow the comprehensive process that transforms genetic crosses into commercial crop varieties.",
                narration: "This robust plant represents years of careful development work! The journey from initial genetic cross to this final variety took at least 8-15 years of systematic breeding. It started in a greenhouse where scientists made controlled crosses between parent plants. In the first few generations, breeders selected thousands of individual plants, keeping only those with the most promising traits. Then came years of field testing - this variety was grown in over 100 different locations across various climates, soil types, and farming conditions. Researchers measured everything: yield, disease resistance, stress tolerance, and quality parameters. They compared it against existing varieties to prove its superiority. If genetically modified, it underwent additional safety testing and regulatory review. Finally, the variety entered seed multiplication programs where specially trained farmers grow acres of pure seed for distribution. The plant you see represents millions of dollars in research investment and the combined expertise of geneticists, pathologists, agronomists, and field technicians - all working together to bring better crops to farmers!"
            },
            drought: {
                title: "Drought Tolerance - Surviving Water Stress",
                subtitle: "Plants that thrive with less water",
                icon: "🌵",
                modelUrl: "https://sketchfab.com/models/3df6babfa64442af83f90652324ba680/embed?autostart=1&internal=1&tracking=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "Drought tolerance is becoming increasingly important as climate change brings more frequent water shortages. Breeders develop plants with deeper roots, waxy leaves, and efficient water use to survive dry conditions.",
                concepts: [
                    "Deeper root systems access water reserves",
                    "Waxy leaf coatings reduce water loss",
                    "Efficient water use produces more with less",
                    "Osmotic adjustment maintains cell function"
                ],
                funFact: "Drought-tolerant crops can maintain 80% of normal yield with only 50% of typical rainfall - a crucial adaptation for climate change!",
                objectives: "Understand how plants adapt to water stress and how breeders enhance drought tolerance.",
                narration: "This plant demonstrates the harsh reality of drought stress, but also the remarkable adaptations that help plants survive! When water becomes scarce, plants like this one activate sophisticated survival mechanisms. The roots grow deeper, sometimes reaching twice their normal depth to access groundwater reserves. The leaves may appear smaller and more waxy to reduce water loss through transpiration. Inside the cells, special proteins protect vital processes while the plant conserves every drop of moisture. Drought-tolerant varieties developed by breeders can maintain 80% of their normal yield with only half the usual rainfall! Scientists study plants like those in desert regions, extracting genes that help them survive extreme conditions. They've created crops with improved water-use efficiency - plants that produce more grain per drop of water consumed. Some varieties can actually pause their growth during severe drought, then resume when water returns. As climate change brings more frequent droughts, these resilient varieties become lifelines for farming communities, ensuring food security even in the harshest conditions!"
            },
            adaptation: {
                title: "Climate Adaptability - Plants for All Conditions",
                subtitle: "Varieties for diverse environments",
                icon: "🌍",
                modelUrl: "https://sketchfab.com/models/4de451492c94452bb0e3eb07a1866f78/embed?autostart=1&internal=1&tracking=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "Climate adaptability ensures crops can thrive across diverse environments - from mountain highlands to coastal plains, from tropical regions to temperate zones. This flexibility is essential for global food security.",
                concepts: [
                    "Temperature tolerance for different climates",
                    "Day-length sensitivity for various latitudes",
                    "Altitude adaptation for mountain farming",
                    "Soil tolerance for diverse conditions"
                ],
                funFact: "Some wheat varieties can grow from sea level to 4,500 meters altitude in the Himalayas - that's higher than most commercial aircraft fly!",
                objectives: "Explore how crop varieties are adapted to succeed in vastly different environmental conditions worldwide.",
                narration: "This tall, healthy plant represents the incredible adaptability of modern crop varieties! Plants must survive vastly different conditions around the world - scorching deserts, freezing tundra, high mountain valleys, and humid tropical lowlands. Breeders create varieties specifically adapted to each environment. This plant might carry genes for cold tolerance from Arctic varieties, allowing it to survive unexpected frosts. Or it could have heat-shock proteins that protect cellular functions during extreme heat waves. Day-length sensitivity is crucial too - plants grown near the equator experience 12 hours of daylight year-round, while those in northern regions get 20 hours in summer and only 4 in winter. Some varieties are adapted to grow on acidic soils that would kill other plants, while others thrive in salty coastal conditions. The most remarkable adaptation is altitude tolerance - some wheat varieties grow successfully at 4,500 meters in the Himalayas, higher than most airplanes fly! This adaptability ensures that no matter where you live on Earth, there's likely a crop variety that can provide food for your community."
            },
            future: {
                title: "Future of Breeding - Next Generation Tools",
                subtitle: "Technology-enhanced agriculture",
                icon: "🔮",
                modelUrl: "https://sketchfab.com/models/2c0dfe7f2dca4a4da76d54a44d49df98/embed?autostart=1&internal=1&tracking=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "The future of crop breeding combines artificial intelligence, gene editing, and precision agriculture. New technologies like CRISPR gene editing and machine learning are revolutionizing how we develop better crops.",
                concepts: [
                    "CRISPR gene editing for precise modifications",
                    "AI and machine learning predict best crosses",
                    "Genomic selection accelerates breeding",
                    "Digital farming optimizes crop management"
                ],
                funFact: "CRISPR gene editing can create new crop varieties in just 2-3 years instead of the traditional 10-15 years - a revolution in breeding speed!",
                objectives: "Discover cutting-edge technologies that are transforming crop improvement and agricultural sustainability.",
                narration: "This healthy plant represents the future of agriculture powered by revolutionary technologies! CRISPR gene editing now allows scientists to make precise genetic changes in just 2-3 years instead of the traditional 10-15 years of breeding. It's like having molecular scissors that can cut and edit DNA with incredible precision - removing unwanted genes or inserting beneficial ones exactly where needed. Artificial intelligence analyzes millions of genetic combinations to predict which crosses will produce the best offspring, dramatically accelerating the breeding process. Machine learning algorithms process data from thousands of field trials, identifying patterns invisible to human researchers. Genomic selection lets breeders predict plant performance from DNA analysis alone, selecting winners before they even grow to maturity. The future holds even more exciting possibilities: plants that communicate with farmers through sensors, crops that adjust their own nutrition based on soil conditions, and varieties that can capture atmospheric carbon to fight climate change. Vertical farms with LED lights and precise nutrition could grow crops in urban environments, while space agriculture prepares for growing food on Mars! This integration of biology and technology promises to feed 10 billion people sustainably while protecting our planet's resources."
            }
        };

        // Global Variables
        let currentStep = 'introduction';
        let voiceEnabled = true;
        let autoPlayEnabled = false;
        let currentSpeech = null;
        let selectedVoice = null;
        let journeyProgress = 0;
        let guidedTourActive = false;

        // Initialize Voice System
        function initVoiceSystem() {
            if (!('speechSynthesis' in window)) {
                console.warn('Speech synthesis not supported');
                voiceEnabled = false;
                document.getElementById('voiceToggle').style.display = 'none';
                return;
            }

            function loadVoices() {
                const voices = speechSynthesis.getVoices();
                if (voices.length === 0) return;

                // Prefer natural-sounding voices
                const preferredVoices = [
                    'Google UK English Female',
                    'Microsoft Sonia',
                    'Microsoft Hazel',
                    'Samantha',
                    'Victoria'
                ];

                for (const name of preferredVoices) {
                    selectedVoice = voices.find(v => v.name.includes(name));
                    if (selectedVoice) break;
                }

                if (!selectedVoice) {
                    selectedVoice = voices.find(v => v.lang.startsWith('en'));
                }
            }

            loadVoices();
            if (speechSynthesis.onvoiceschanged !== undefined) {
                speechSynthesis.onvoiceschanged = loadVoices;
            }
        }

        // Load Journey Step
        function loadJourneyStep(stepId) {
            const stepData = JOURNEY_DATA[stepId];
            if (!stepData) return;

            currentStep = stepId;
            
            // Update model
            document.getElementById('api-frame').src = stepData.modelUrl;
            
            // Update info panel
            document.getElementById('stepIcon').textContent = stepData.icon;
            document.getElementById('stepTitle').textContent = stepData.title;
            document.getElementById('stepSubtitle').textContent = stepData.subtitle;
            document.getElementById('mainDescription').textContent = stepData.description;
            
            // Update key concepts
            const conceptsList = document.getElementById('keyConcepts');
            conceptsList.innerHTML = stepData.concepts.map(c => `<li>${c}</li>`).join('');
            
            // Update fun fact
            document.getElementById('funFact').textContent = stepData.funFact;
            
            // Update learning objectives
            document.getElementById('learningObjectives').textContent = stepData.objectives;
            
            // Update navigation buttons
            updateNavigationButtons(stepId);
            
            // Update progress
            updateProgress();
            
            // Play narration if enabled
            if (voiceEnabled) {
                speakText(stepData.narration);
            }
        }

        // Update Navigation Buttons
        function updateNavigationButtons(activeStep) {
            const buttons = document.querySelectorAll('.journey-btn');
            const steps = ['introduction', 'hybridization', 'genetics', 'traits', 'development', 'drought', 'adaptation', 'future'];
            const activeIndex = steps.indexOf(activeStep);
            
            buttons.forEach((btn, index) => {
                btn.classList.remove('active', 'completed');
                if (index < activeIndex) {
                    btn.classList.add('completed');
                } else if (index === activeIndex) {
                    btn.classList.add('active');
                }
            });
            
            // Update mini steps
            const miniSteps = document.querySelectorAll('.step-mini');
            miniSteps.forEach((step, index) => {
                step.classList.remove('active', 'completed');
                if (index < activeIndex) {
                    step.classList.add('completed');
                } else if (index === activeIndex) {
                    step.classList.add('active');
                }
            });
        }

        // Update Progress
        function updateProgress() {
            const steps = ['introduction', 'hybridization', 'genetics', 'traits', 'development', 'drought', 'adaptation', 'future'];
            const currentIndex = steps.indexOf(currentStep);
            const progress = ((currentIndex + 1) / steps.length) * 100;
            
            document.getElementById('progressPercent').textContent = Math.round(progress) + '%';
            document.getElementById('progressFill').style.width = progress + '%';
        }

        // Speech Functions
        function speakText(text) {
            if (!voiceEnabled || !text) return;
            
            stopSpeech();
            
            currentSpeech = new SpeechSynthesisUtterance(text);
            if (selectedVoice) {
                currentSpeech.voice = selectedVoice;
            }
            currentSpeech.rate = 0.9;
            currentSpeech.pitch = 1.0;
            currentSpeech.volume = 0.9;
            
            currentSpeech.onstart = () => {
                document.getElementById('voiceIndicator').classList.add('visible');
                document.getElementById('narrationText').textContent = 
                    text.substring(0, 50) + (text.length > 50 ? '...' : '');
            };
            
            currentSpeech.onend = () => {
                document.getElementById('voiceIndicator').classList.remove('visible');
                currentSpeech = null;
                
                // Auto-advance if guided tour is active
                if (guidedTourActive) {
                    setTimeout(nextStep, 2000);
                }
            };
            
            speechSynthesis.speak(currentSpeech);
        }

        function stopSpeech() {
            if (currentSpeech) {
                speechSynthesis.cancel();
                currentSpeech = null;
                document.getElementById('voiceIndicator').classList.remove('visible');
            }
        }

        // Control Functions
        function toggleVoice() {
            voiceEnabled = !voiceEnabled;
            const btn = document.getElementById('voiceToggle');
            btn.textContent = voiceEnabled ? '🔊' : '🔇';
            btn.classList.toggle('active', voiceEnabled);
            
            if (!voiceEnabled) {
                stopSpeech();
            }
        }

        function toggleAutoPlay() {
            autoPlayEnabled = !autoPlayEnabled;
            if (autoPlayEnabled) {
                startGuidedTour();
            } else {
                guidedTourActive = false;
            }
        }

        function toggleInfo() {
            const panel = document.getElementById('infoPanel');
            panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
        }

        // Guided Tour
        function startGuidedTour() {
            guidedTourActive = true;
            const steps = ['introduction', 'hybridization', 'genetics', 'traits', 'development', 'drought', 'adaptation', 'future'];
            let stepIndex = 0;
            
            function tourStep() {
                if (stepIndex < steps.length && guidedTourActive) {
                    loadJourneyStep(steps[stepIndex]);
                    stepIndex++;
                } else {
                    guidedTourActive = false;
                    if (voiceEnabled) {
                        speakText("Congratulations! You've completed your journey through crop improvement and breeding. You now understand how scientists create better plants through hybridization, genetic modification, and advanced breeding techniques. The future of agriculture depends on this crucial science!");
                    }
                }
            }
            
            tourStep();
            window.nextStep = tourStep;
        }

        // Quiz Function
        function showQuiz() {
            const questions = [
                "What is the difference between hybridization and genetic modification?",
                "How long does it typically take to develop a new crop variety?",
                "What are the main desirable traits breeders select for?",
                "How do plants adapt to drought conditions?",
                "What new technologies are revolutionizing crop breeding?"
            ];
            
            const randomQ = questions[Math.floor(Math.random() * questions.length)];
            
            if (voiceEnabled) {
                speakText(`Here's a question to test your breeding knowledge: ${randomQ} Think about what you've learned about plant genetics and improvement!`);
            }
        }

        // Initialize
        function init() {
            initVoiceSystem();
            
            // Hide loading screen
            setTimeout(() => {
                const loading = document.getElementById('loadingOverlay');
                loading.style.opacity = '0';
                setTimeout(() => {
                    loading.style.display = 'none';
                    
                    // Welcome message
                    if (voiceEnabled) {
                        speakText("Welcome to the fascinating world of crop improvement and breeding! We'll explore how scientists use genetics, hybridization, and cutting-edge technology to create better plants that feed the world. Let's begin with the foundations of plant breeding science!");
                    }
                }, 1000);
            }, 3000);
            
            // Keyboard shortcuts
            document.addEventListener('keydown', (e) => {
                switch(e.key) {
                    case 'v': toggleVoice(); break;
                    case 'i': toggleInfo(); break;
                    case 'g': startGuidedTour(); break;
                    case 'Escape': stopSpeech(); guidedTourActive = false; break;
                    case 'ArrowRight': nextStep && nextStep(); break;
                }
            });
        }

        // Start the application
        init();
    </script>
</body>
</html>