<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Discovery and Basic Structure of Cells</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tween.js/18.6.4/tween.umd.js"></script>

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #0f766e 0%, #14b8a6 100%);
            color: white;
            overflow: hidden;
            position: relative;
            height: 100vh;
        }

        /* Animated Background */
        .bg-animation {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 0;
            opacity: 0.1;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320"><path fill="%23ffffff" fill-opacity="0.2" d="M0,96L48,112C96,128,192,160,288,186.7C384,213,480,235,576,213.3C672,192,768,128,864,128C960,128,1056,192,1152,197.3C1248,203,1344,149,1392,122.7L1440,96L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path></svg>') repeat-x;
            animation: wave 10s linear infinite;
        }

        @keyframes wave {
            0% { background-position-x: 0; }
            100% { background-position-x: 1440px; }
        }

        /* Museum Interface - Compact Header */
        .museum-header {
            position: absolute;
            top: 10px;
            left: 20px;
            text-align: left;
            z-index: 1000;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            padding: 10px 18px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        .museum-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 4px;
            background: linear-gradient(45deg, #5eead4, #2dd4bf);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: titleGlow 3s ease-in-out infinite;
        }

        @keyframes titleGlow {
            0%, 100% { filter: brightness(1); }
            50% { filter: brightness(1.2); }
        }

        .exhibit-subtitle {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.8);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .discovery-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: #5eead4;
            border-radius: 50%;
            animation: discovery-pulse 2s ease-in-out infinite;
        }

        @keyframes discovery-pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.3); opacity: 0.7; }
        }

        /* Journey Navigation - Enhanced */
        .journey-navigation {
            position: absolute;
            bottom: 20px;
            left: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 1000;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            padding: 15px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            max-width: 320px;
        }

        .journey-title {
            font-size: 14px;
            font-weight: 600;
            color: #5eead4;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .journey-steps {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
        }

        .journey-btn {
            background: rgba(94, 234, 212, 0.2);
            border: 1px solid rgba(94, 234, 212, 0.4);
            color: white;
            padding: 6px 10px;
            border-radius: 20px;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 4px;
            white-space: nowrap;
        }

        .journey-btn:hover {
            background: rgba(94, 234, 212, 0.3);
            border-color: #5eead4;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(94, 234, 212, 0.3);
        }

        .journey-btn.active {
            background: linear-gradient(135deg, #0f766e, #5eead4);
            border-color: #0f766e;
            box-shadow: 0 0 20px rgba(15, 118, 110, 0.5);
            animation: pulse 2s infinite;
        }

        .journey-btn.completed {
            background: rgba(46, 204, 113, 0.3);
            border-color: #2ecc71;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* 3D Model Container */
        .model-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 0;
            overflow: hidden;
            border: none;
            z-index: 100;
        }

        .sketchfab-embed-wrapper {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0f766e 0%, #14b8a6 100%);
        }

        .sketchfab-embed-wrapper iframe {
            width: 100%;
            height: 100%;
            border: none;
            border-radius: 0;
        }

        /* Information Panel - Enhanced */
        .info-panel {
            position: absolute;
            top: 70px;
            right: 20px;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 16px;
            padding: 24px;
            width: 380px;
            max-height: calc(100vh - 140px);
            z-index: 800;
            overflow-y: auto;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }

        .info-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
        }

        .info-icon {
            font-size: 28px;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        .info-title {
            flex: 1;
        }

        .info-title h2 {
            font-size: 18px;
            color: #5eead4;
            margin-bottom: 4px;
        }

        .info-subtitle {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
        }

        .info-content {
            color: rgba(255, 255, 255, 0.9);
            font-size: 14px;
            line-height: 1.6;
        }

        /* Progress Tracker */
        .progress-tracker {
            background: linear-gradient(135deg, rgba(94, 234, 212, 0.1), rgba(15, 118, 110, 0.1));
            border: 1px solid rgba(94, 234, 212, 0.3);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 20px;
        }

        .progress-header {
            font-size: 13px;
            font-weight: 600;
            color: #5eead4;
            margin-bottom: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .progress-percentage {
            font-size: 18px;
            color: #0f766e;
            font-weight: 700;
        }

        .progress-bar {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 12px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #5eead4, #0f766e);
            border-radius: 4px;
            transition: width 0.8s ease;
            box-shadow: 0 0 10px rgba(15, 118, 110, 0.5);
        }

        .progress-steps-mini {
            display: flex;
            justify-content: space-between;
            font-size: 10px;
            color: rgba(255, 255, 255, 0.6);
        }

        .step-mini {
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .step-mini.active {
            color: #0f766e;
            font-weight: 600;
        }

        .step-mini.completed {
            color: #2ecc71;
        }

        /* Information Cards */
        .info-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 14px;
            margin-bottom: 14px;
        }

        .info-card-title {
            color: #5eead4;
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .info-card-content {
            color: rgba(255, 255, 255, 0.85);
            font-size: 12px;
            line-height: 1.5;
        }

        .info-list {
            list-style: none;
            padding: 0;
        }

        .info-list li {
            padding: 6px 0;
            padding-left: 20px;
            position: relative;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.8);
        }

        .info-list li:before {
            content: "🔬";
            position: absolute;
            left: 0;
            font-size: 10px;
        }

        /* Fun Fact Box */
        .fun-fact {
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.1), rgba(245, 158, 11, 0.1));
            border: 1px solid rgba(251, 191, 36, 0.3);
            border-radius: 12px;
            padding: 14px;
            margin: 16px 0;
            position: relative;
            overflow: hidden;
        }

        .fun-fact:before {
            content: "💡";
            position: absolute;
            top: -20px;
            right: -20px;
            font-size: 60px;
            opacity: 0.1;
        }

        .fun-fact-title {
            color: #fbbf24;
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 6px;
        }

        .fun-fact-text {
            color: rgba(255, 255, 255, 0.9);
            font-size: 12px;
            line-height: 1.5;
            position: relative;
            z-index: 1;
        }

        /* Voice Controls */
        .voice-controls {
            position: absolute;
            top: 10px;
            right: 20px;
            display: flex;
            gap: 8px;
            z-index: 1000;
        }

        .control-btn {
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            position: relative;
        }

        .control-btn:hover {
            background: rgba(15, 118, 110, 0.3);
            border-color: #0f766e;
            transform: scale(1.1);
        }

        .control-btn.active {
            background: rgba(15, 118, 110, 0.4);
            border-color: #0f766e;
            box-shadow: 0 0 20px rgba(15, 118, 110, 0.5);
        }

        .control-tooltip {
            position: absolute;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.9);
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 10px;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .control-btn:hover .control-tooltip {
            opacity: 1;
        }

        /* Loading Screen */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0f766e 0%, #14b8a6 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            transition: opacity 1s ease;
        }

        .loading-content {
            text-align: center;
        }

        .loading-discovery {
            font-size: 60px;
            animation: discovery-pulse 1.5s ease-in-out infinite;
            margin-bottom: 20px;
        }

        .loading-text {
            color: white;
            font-size: 20px;
            margin-bottom: 20px;
        }

        .loading-progress {
            width: 200px;
            height: 4px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 2px;
            overflow: hidden;
        }

        .loading-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #0f766e, #5eead4);
            animation: loading 2s ease-in-out infinite;
        }

        @keyframes loading {
            0% { width: 0%; }
            50% { width: 100%; }
            100% { width: 0%; }
        }

        /* Voice Indicator */
        .voice-indicator {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(15, 118, 110, 0.5);
            border-radius: 30px;
            padding: 14px 28px;
            display: flex;
            align-items: center;
            gap: 12px;
            z-index: 1000;
            opacity: 0;
            transition: all 0.3s ease;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }

        .voice-indicator.visible {
            opacity: 1;
            transform: translateX(-50%) translateY(-10px);
        }

        .voice-waves {
            display: flex;
            align-items: center;
            gap: 3px;
        }

        .voice-wave {
            width: 3px;
            height: 20px;
            background: linear-gradient(180deg, #0f766e, #5eead4);
            border-radius: 2px;
            animation: voice-wave 1s ease-in-out infinite;
        }

        .voice-wave:nth-child(2) { animation-delay: 0.1s; }
        .voice-wave:nth-child(3) { animation-delay: 0.2s; }
        .voice-wave:nth-child(4) { animation-delay: 0.3s; }
        .voice-wave:nth-child(5) { animation-delay: 0.4s; }

        @keyframes voice-wave {
            0%, 100% { transform: scaleY(0.3); }
            50% { transform: scaleY(1); }
        }

        .narration-text {
            color: white;
            font-size: 13px;
            max-width: 300px;
        }

        /* Quick Actions */
        .quick-actions {
            position: absolute;
            bottom: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
            z-index: 1000;
        }

        .action-btn {
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 10px 16px;
            border-radius: 25px;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
        }

        .action-btn:hover {
            background: rgba(94, 234, 212, 0.3);
            border-color: #5eead4;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(94, 234, 212, 0.3);
        }

        /* Custom Scrollbar */
        .info-panel::-webkit-scrollbar {
            width: 6px;
        }

        .info-panel::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 3px;
        }

        .info-panel::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, #0f766e, #5eead4);
            border-radius: 3px;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .info-panel {
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                top: auto;
                width: 100%;
                max-height: 50vh;
                border-radius: 20px 20px 0 0;
            }
            
            .journey-navigation {
                bottom: 52vh;
                max-width: calc(100% - 40px);
            }
            
            .voice-controls {
                top: auto;
                bottom: 55vh;
                right: 10px;
            }
            
            .quick-actions {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="bg-animation"></div>

    <!-- Loading Screen -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="loading-discovery">🔬</div>
            <div class="loading-text">Discovering the World of Cells...</div>
            <div class="loading-progress">
                <div class="loading-progress-bar"></div>
            </div>
        </div>
    </div>

    <!-- Museum Header -->
    <div class="museum-header">
        <div class="museum-title">Discovery of Cells</div>
        <div class="exhibit-subtitle">
            <span class="discovery-indicator"></span>
            From First Observation to Cell Theory
        </div>
    </div>

    <!-- Journey Navigation -->
    <div class="journey-navigation">
        <div class="journey-title">
            <span>🔬</span>
            <span>Discovery Journey</span>
        </div>
        <div class="journey-steps">
            <button class="journey-btn active" onclick="loadJourneyStep('discovery')">
                <span>🏛️</span> Hooke's Discovery
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('microscope')">
                <span>🔍</span> Microscope
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('celltheory')">
                <span>📜</span> Cell Theory
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('celltypes')">
                <span>🧬</span> Cell Types
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('unicellular')">
                <span>🦠</span> Unicellular
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('activities')">
                <span>🧪</span> Activities
            </button>
        </div>
    </div>

    <!-- 3D Model Container -->
    <div class="model-container">
        <div class="sketchfab-embed-wrapper">
            <iframe id="api-frame"
                    title="Cell Discovery" 
                    frameborder="0" 
                    allowfullscreen 
                    mozallowfullscreen="true" 
                    webkitallowfullscreen="true" 
                    allow="autoplay; fullscreen; xr-spatial-tracking"
                    xr-spatial-tracking 
                    execution-while-out-of-viewport 
                    execution-while-not-rendered 
                    web-share 
                    src="https://sketchfab.com/models/60ef7d2515b0403986ff9e8b7f234a66/embed?autostart=1&internal=1&tracking=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0">
            </iframe>
        </div>
    </div>

    <!-- Information Panel -->
    <div class="info-panel" id="infoPanel">
        <div class="info-header">
            <div class="info-icon" id="stepIcon">🏛️</div>
            <div class="info-title">
                <h2 id="stepTitle">Robert Hooke's Discovery</h2>
                <div class="info-subtitle" id="stepSubtitle">The birth of cell biology in 1665</div>
            </div>
        </div>

        <!-- Progress Tracker -->
        <div class="progress-tracker">
            <div class="progress-header">
                <span>Discovery Progress</span>
                <span class="progress-percentage" id="progressPercent">0%</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 0%"></div>
            </div>
            <div class="progress-steps-mini">
                <span class="step-mini active" onclick="loadJourneyStep('discovery')">Hooke</span>
                <span class="step-mini" onclick="loadJourneyStep('microscope')">Micro.</span>
                <span class="step-mini" onclick="loadJourneyStep('celltheory')">Theory</span>
                <span class="step-mini" onclick="loadJourneyStep('celltypes')">Types</span>
                <span class="step-mini" onclick="loadJourneyStep('unicellular')">Unicell.</span>
                <span class="step-mini" onclick="loadJourneyStep('activities')">Activity</span>
            </div>
        </div>

        <div class="info-content" id="mainDescription">
            In 1665, Robert Hooke made a groundbreaking discovery that would revolutionize biology. Using his microscope to examine thin slices of cork, he observed tiny, box-like compartments that reminded him of monastery cells. He coined the term "cell" - unknowingly naming the fundamental unit of all life.
        </div>

        <div class="info-card">
            <div class="info-card-title">
                <span>🔬</span> Key Historical Points
            </div>
            <div class="info-card-content">
                <ul class="info-list" id="keyConcepts">
                    <li>First observation of cells in cork (1665)</li>
                    <li>Named "cells" after monastery rooms</li>
                    <li>Published in "Micrographia"</li>
                    <li>Foundation for cell biology</li>
                </ul>
            </div>
        </div>

        <div class="fun-fact">
            <div class="fun-fact-title">Historical Discovery</div>
            <div class="fun-fact-text" id="funFact">
                Hooke was actually observing the dead cell walls of cork cells, not living cells! He had no idea he was looking at the remains of what were once living structures.
            </div>
        </div>

        <div class="info-card">
            <div class="info-card-title">
                <span>🎯</span> Learning Objectives
            </div>
            <div class="info-card-content" id="learningObjectives">
                Understand the historical significance of Hooke's discovery and how it led to the development of modern cell biology.
            </div>
        </div>
    </div>

    <!-- Voice Controls -->
    <div class="voice-controls">
        <button class="control-btn active" id="voiceToggle" onclick="toggleVoice()">
            🔊
            <span class="control-tooltip">Voice Narration</span>
        </button>
        <button class="control-btn" onclick="toggleAutoPlay()">
            ▶️
            <span class="control-tooltip">Auto Journey</span>
        </button>
        <button class="control-btn" onclick="toggleInfo()">
            ℹ️
            <span class="control-tooltip">Toggle Info</span>
        </button>
    </div>

    <!-- Quick Actions -->
    <div class="quick-actions">
        <button class="action-btn" onclick="startGuidedTour()">
            <span>🚀</span> Guided Tour
        </button>
        <button class="action-btn" onclick="showQuiz()">
            <span>🎯</span> Test Knowledge
        </button>
    </div>

    <!-- Voice Indicator -->
    <div class="voice-indicator" id="voiceIndicator">
        <div class="voice-waves">
            <div class="voice-wave"></div>
            <div class="voice-wave"></div>
            <div class="voice-wave"></div>
            <div class="voice-wave"></div>
            <div class="voice-wave"></div>
        </div>
        <div class="narration-text" id="narrationText">Narrating...</div>
    </div>

    <script>
        // Journey Step Data with Complete Educational Content
        const JOURNEY_DATA = {
            discovery: {
                title: "Robert Hooke's Discovery",
                subtitle: "The birth of cell biology in 1665",
                icon: "🏛️",
                modelUrl: "https://sketchfab.com/models/60ef7d2515b0403986ff9e8b7f234a66/embed?autostart=1&internal=1&tracking=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "In 1665, Robert Hooke made a groundbreaking discovery that would revolutionize biology. Using his microscope to examine thin slices of cork, he observed tiny, box-like compartments that reminded him of monastery cells. He coined the term 'cell' - unknowingly naming the fundamental unit of all life.",
                concepts: [
                    "First observation of cells in cork (1665)",
                    "Named 'cells' after monastery rooms",
                    "Published in 'Micrographia'",
                    "Foundation for cell biology"
                ],
                funFact: "Hooke was actually observing the dead cell walls of cork cells, not living cells! He had no idea he was looking at the remains of what were once living structures.",
                objectives: "Understand the historical significance of Hooke's discovery and how it led to the development of modern cell biology.",
                narration: "Step back in time to 1665, when Robert Hooke, an English scientist, made one of the most important discoveries in biological history! You're looking at a human cell, but imagine seeing cellular structures for the very first time. Hooke was examining thin slices of cork under his primitive microscope when he noticed tiny, empty compartments arranged in neat rows. These box-like structures reminded him of the small rooms, or cells, where monks lived in monasteries. Little did he know that he was coining a term that would become fundamental to all of biology! What Hooke saw were actually the cell walls of dead cork cells - the living contents had long since disappeared, leaving only the rigid cellulose walls behind. But this observation was revolutionary because it was the first time anyone had seen and described these microscopic structures. Hooke documented his findings in his famous book 'Micrographia,' complete with detailed drawings that amazed the scientific world. This single observation opened up an entirely new realm of study and laid the foundation for what would eventually become cell biology, fundamentally changing our understanding of life itself."
            },
            microscope: {
                title: "The Compound Microscope",
                subtitle: "The tool that revealed the microscopic world",
                icon: "🔍",
                modelUrl: "https://sketchfab.com/models/2435e338bf7541a4b919e53df50eeeea/embed?autostart=1&internal=1&tracking=0&ui_ar=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "The compound microscope was the key instrument that made Hooke's discovery possible. This revolutionary tool used multiple lenses to magnify objects hundreds of times, revealing a world invisible to the naked eye and opening new frontiers in scientific exploration.",
                concepts: [
                    "Uses multiple lenses for magnification",
                    "Reveals structures invisible to naked eye",
                    "Essential tool for biological research",
                    "Enabled the discovery of microorganisms"
                ],
                funFact: "Early microscopes like Hooke's could magnify objects about 50 times - modern microscopes can magnify over 1 million times!",
                objectives: "Understand how the microscope revolutionized scientific observation and enabled the discovery of cells and microorganisms.",
                narration: "Here's the instrument that changed everything - the compound microscope! This technological marvel was the key that unlocked the microscopic world for scientists like Robert Hooke. The compound microscope gets its name because it uses multiple lenses working together to achieve much greater magnification than a simple magnifying glass. Light passes through the specimen, then through an objective lens that creates a magnified image, which is further magnified by an eyepiece lens. This two-stage magnification system allowed scientists to see objects hundreds of times larger than their actual size. Without this tool, Hooke never would have seen those cork cells, and the entire field of cell biology might have been delayed by centuries! The microscope didn't just reveal cells - it opened up an entirely new world of discovery. Scientists began finding tiny organisms in pond water, observing the structure of insects, and exploring the intricate details of plant and animal tissues. Each improvement in microscope technology revealed new layers of complexity in the natural world. From these humble beginnings, microscopy has evolved to include electron microscopes, fluorescence microscopes, and even atomic force microscopes, but it all started with instruments like this one."
            },
            celltheory: {
                title: "Cell Theory Development",
                subtitle: "Three scientists, three fundamental principles",
                icon: "📜",
                modelUrl: "https://sketchfab.com/models/60ef7d2515b0403986ff9e8b7f234a66/embed?autostart=1&internal=1&tracking=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "Cell theory emerged from the work of three scientists: Matthias Schleiden (plants are made of cells), Theodor Schwann (animals are made of cells), and Rudolf Virchow (cells come from other cells). These three principles form the foundation of modern biology.",
                concepts: [
                    "Schleiden: All plants are made of cells (1838)",
                    "Schwann: All animals are made of cells (1839)",
                    "Virchow: Cells come from existing cells (1855)",
                    "Foundation of modern biology"
                ],
                funFact: "Cell theory took nearly 200 years to develop after Hooke's discovery - it required the observations of many scientists to piece together the complete picture!",
                objectives: "Learn how multiple scientists contributed to cell theory and understand its three fundamental principles.",
                narration: "You're witnessing the culmination of nearly two centuries of scientific discovery - the development of cell theory! After Hooke's initial observation, it took many more scientists to understand what cells really were. The first breakthrough came in 1838 when German botanist Matthias Schleiden concluded that all plants are made up of cells. This was revolutionary because it suggested that despite the incredible diversity of plant life, from tiny mosses to giant trees, they all shared this fundamental building block. Just one year later, zoologist Theodor Schwann extended this idea to animals, proposing that all animals are also composed of cells. This unified plants and animals under one biological principle - something no one had imagined before! But the theory wasn't complete yet. It wasn't until 1855 that Rudolf Virchow added the final piece: 'Omnis cellula e cellula' - all cells come from existing cells. This destroyed the old idea of spontaneous generation and established that life comes only from life. These three principles - all living things are made of cells, the cell is the basic unit of life, and all cells come from pre-existing cells - form the foundation of everything we know about biology today."
            },
            celltypes: {
                title: "Different Cell Types",
                subtitle: "Form follows function in cellular design",
                icon: "🧬",
                modelUrl: "https://sketchfab.com/models/f33ea01f8e674578b55ac51d110b1721/embed?autostart=1&internal=1&tracking=0&ui_ar=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "Cells come in many different shapes and sizes, each perfectly adapted for their specific function. From the branched networks of neurons to the flexible discs of red blood cells, cellular structure directly reflects cellular purpose.",
                concepts: [
                    "Cell shape matches cell function",
                    "Neurons have long projections for communication",
                    "Red blood cells are flexible for circulation",
                    "Specialized structures enable specific roles"
                ],
                funFact: "A single neuron can be over a meter long - from your spinal cord to your toe - making it one of the longest cells in your body!",
                objectives: "Explore how different cell types are specialized for their functions and understand the relationship between structure and function.",
                narration: "Here's a perfect example of how cell structure matches function - a neuron! This nerve cell looks completely different from the basic cell we started with, and there's a good reason for that. The neuron's long, branching projections called dendrites and axons are specialized for communication. The dendrites receive signals from other neurons, while the axon transmits signals over long distances. This cell might stretch from your brain all the way down your spinal cord! Compare this to red blood cells, which are small, flexible discs without nuclei. Their shape allows them to squeeze through tiny capillaries and carry oxygen efficiently. Or consider muscle cells, which are long and contain special proteins that can contract to generate force. Each cell type represents millions of years of evolutionary refinement for a specific job. Plant cells have rigid walls for support and chloroplasts for photosynthesis. Sperm cells have tails for swimming. White blood cells can change shape to engulf invaders. This diversity shows that while all cells share basic characteristics - they're all bounded by membranes, contain genetic material, and carry out metabolism - they can be dramatically modified to perform specialized functions. It's like having a basic car design that can be modified into a race car, a truck, or a motorcycle depending on what job it needs to do."
            },
            unicellular: {
                title: "Unicellular vs Multicellular",
                subtitle: "Single cells versus cellular communities",
                icon: "🦠",
                modelUrl: "https://sketchfab.com/models/c3a85d646c7040ad81b75150b401fbac/embed?autostart=1&internal=1&tracking=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "Life exists as both single-celled organisms that carry out all life functions within one cell, and multicellular organisms where specialized cells work together. Each strategy has advantages for survival in different environments.",
                concepts: [
                    "Unicellular: entire organism is one cell",
                    "Multicellular: many specialized cells working together",
                    "Division of labor in multicellular organisms",
                    "Both strategies are successful in nature"
                ],
                funFact: "Some unicellular organisms like amoebas can be seen with the naked eye, while some multicellular organisms have trillions of cells working together!",
                objectives: "Compare unicellular and multicellular organization and understand the advantages of each approach to life.",
                narration: "You're looking at red blood cells, which represent one strategy for cellular organization - being part of a multicellular organism where each cell has a specialized job. But life has evolved two main strategies: unicellular and multicellular. Unicellular organisms, like bacteria, amoebas, and paramecia, are complete living beings made of just one cell. That single cell must do everything - find food, digest it, excrete waste, reproduce, respond to the environment, and maintain itself. It's like being a one-person company where you're the CEO, accountant, janitor, and security guard all at once! Multicellular organisms like you take a different approach - they use many cells working together, with each type of cell specializing in particular functions. Red blood cells specialize in carrying oxygen, nerve cells in communication, muscle cells in movement, and so on. This division of labor allows for much more complex organisms, but it also means that individual cells become dependent on each other. A red blood cell can't survive on its own - it needs other cells to provide nutrients, remove wastes, and protect it. Both strategies work well in nature. Unicellular organisms are incredibly successful - they've been around for billions of years and can survive in environments that would kill multicellular organisms. Multicellular organisms can grow larger, develop complex behaviors, and adapt to new environments through specialization."
            },
            activities: {
                title: "Hands-on Activities",
                subtitle: "Observing cells like the pioneers",
                icon: "🧪",
                modelUrl: "https://sketchfab.com/models/2435e338bf7541a4b919e53df50eeeea/embed?autostart=1&internal=1&tracking=0&ui_ar=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "Experience the thrill of discovery through hands-on activities. Activity 5.1 involves observing onion peel cells, while Activity 5.2 explores different cell types. These exercises let you see the microscopic world that amazed early scientists.",
                concepts: [
                    "Activity 5.1: Onion peel cell observation",
                    "Activity 5.2: Different cell types comparison",
                    "Proper microscope technique essential",
                    "Direct observation builds understanding"
                ],
                funFact: "When you peel an onion, you're actually removing layers of cells - each thin layer is made up of millions of individual onion cells!",
                objectives: "Develop microscopy skills and experience firsthand the wonder of cellular discovery through guided observations.",
                narration: "Now it's time for you to become a cell explorer! These hands-on activities will let you experience the same wonder that Hooke and other pioneers felt when they first saw cells. Activity 5.1 involves preparing and observing onion peel cells - one of the best specimens for beginning cell biology. When you peel an onion, you can easily remove a thin, transparent layer that's just one cell thick. Under the microscope, you'll see the rectangular cell walls that form a beautiful honeycomb pattern, just like the cork cells that Hooke observed. You might even see the nucleus inside each cell! Activity 5.2 takes you further by examining different types of cells. You might look at your own cheek cells, which are round and flexible, or observe pond water to see unicellular organisms swimming around. Each observation teaches you something new about cellular diversity and function. The key to these activities is careful observation and proper microscope technique. Start with low magnification to find your specimen, then gradually increase magnification to see details. Adjust the light carefully - too much will wash out details, too little will leave you in the dark. Most importantly, take time to really look at what you're seeing. You're witnessing the fundamental unit of all life, the same structures that fascinated scientists centuries ago and continue to amaze researchers today!"
            }
        };

        // Global Variables
        let currentStep = 'discovery';
        let voiceEnabled = true;
        let autoPlayEnabled = false;
        let currentSpeech = null;
        let selectedVoice = null;
        let journeyProgress = 0;
        let guidedTourActive = false;

        // Initialize Voice System
        function initVoiceSystem() {
            if (!('speechSynthesis' in window)) {
                console.warn('Speech synthesis not supported');
                voiceEnabled = false;
                document.getElementById('voiceToggle').style.display = 'none';
                return;
            }

            function loadVoices() {
                const voices = speechSynthesis.getVoices();
                if (voices.length === 0) return;

                const preferredVoices = [
                    'Google UK English Female',
                    'Microsoft Sonia',
                    'Microsoft Hazel',
                    'Samantha',
                    'Victoria'
                ];

                for (const name of preferredVoices) {
                    selectedVoice = voices.find(v => v.name.includes(name));
                    if (selectedVoice) break;
                }

                if (!selectedVoice) {
                    selectedVoice = voices.find(v => v.lang.startsWith('en'));
                }
            }

            loadVoices();
            if (speechSynthesis.onvoiceschanged !== undefined) {
                speechSynthesis.onvoiceschanged = loadVoices;
            }
        }

        // Load Journey Step
        function loadJourneyStep(stepId) {
            const stepData = JOURNEY_DATA[stepId];
            if (!stepData) return;

            currentStep = stepId;
            
            document.getElementById('api-frame').src = stepData.modelUrl;
            
            document.getElementById('stepIcon').textContent = stepData.icon;
            document.getElementById('stepTitle').textContent = stepData.title;
            document.getElementById('stepSubtitle').textContent = stepData.subtitle;
            document.getElementById('mainDescription').textContent = stepData.description;
            
            const conceptsList = document.getElementById('keyConcepts');
            conceptsList.innerHTML = stepData.concepts.map(c => `<li>${c}</li>`).join('');
            
            document.getElementById('funFact').textContent = stepData.funFact;
            document.getElementById('learningObjectives').textContent = stepData.objectives;
            
            updateNavigationButtons(stepId);
            updateProgress();
            
            if (voiceEnabled) {
                speakText(stepData.narration);
            }
        }

        // Update Navigation Buttons
        function updateNavigationButtons(activeStep) {
            const buttons = document.querySelectorAll('.journey-btn');
            const steps = ['discovery', 'microscope', 'celltheory', 'celltypes', 'unicellular', 'activities'];
            const activeIndex = steps.indexOf(activeStep);
            
            buttons.forEach((btn, index) => {
                btn.classList.remove('active', 'completed');
                if (index < activeIndex) {
                    btn.classList.add('completed');
                } else if (index === activeIndex) {
                    btn.classList.add('active');
                }
            });
            
            const miniSteps = document.querySelectorAll('.step-mini');
            miniSteps.forEach((step, index) => {
                step.classList.remove('active', 'completed');
                if (index < activeIndex) {
                    step.classList.add('completed');
                } else if (index === activeIndex) {
                    step.classList.add('active');
                }
            });
        }

        // Update Progress
        function updateProgress() {
            const steps = ['discovery', 'microscope', 'celltheory', 'celltypes', 'unicellular', 'activities'];
            const currentIndex = steps.indexOf(currentStep);
            const progress = ((currentIndex + 1) / steps.length) * 100;
            
            document.getElementById('progressPercent').textContent = Math.round(progress) + '%';
            document.getElementById('progressFill').style.width = progress + '%';
        }

        // Speech Functions
        function speakText(text) {
            if (!voiceEnabled || !text) return;
            
            stopSpeech();
            
            currentSpeech = new SpeechSynthesisUtterance(text);
            if (selectedVoice) {
                currentSpeech.voice = selectedVoice;
            }
            currentSpeech.rate = 0.9;
            currentSpeech.pitch = 1.0;
            currentSpeech.volume = 0.9;
            
            currentSpeech.onstart = () => {
                document.getElementById('voiceIndicator').classList.add('visible');
                document.getElementById('narrationText').textContent = 
                    text.substring(0, 50) + (text.length > 50 ? '...' : '');
            };
            
            currentSpeech.onend = () => {
                document.getElementById('voiceIndicator').classList.remove('visible');
                currentSpeech = null;
                
                if (guidedTourActive) {
                    setTimeout(nextStep, 2000);
                }
            };
            
            speechSynthesis.speak(currentSpeech);
        }

        function stopSpeech() {
            if (currentSpeech) {
                speechSynthesis.cancel();
                currentSpeech = null;
                document.getElementById('voiceIndicator').classList.remove('visible');
            }
        }

        // Control Functions
        function toggleVoice() {
            voiceEnabled = !voiceEnabled;
            const btn = document.getElementById('voiceToggle');
            btn.textContent = voiceEnabled ? '🔊' : '🔇';
            btn.classList.toggle('active', voiceEnabled);
            
            if (!voiceEnabled) {
                stopSpeech();
            }
        }

        function toggleAutoPlay() {
            autoPlayEnabled = !autoPlayEnabled;
            if (autoPlayEnabled) {
                startGuidedTour();
            } else {
                guidedTourActive = false;
            }
        }

        function toggleInfo() {
            const panel = document.getElementById('infoPanel');
            panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
        }

        // Guided Tour
        function startGuidedTour() {
            guidedTourActive = true;
            const steps = ['discovery', 'microscope', 'celltheory', 'celltypes', 'unicellular', 'activities'];
            let stepIndex = 0;
            
            function tourStep() {
                if (stepIndex < steps.length && guidedTourActive) {
                    loadJourneyStep(steps[stepIndex]);
                    stepIndex++;
                } else {
                    guidedTourActive = false;
                    if (voiceEnabled) {
                        speakText("Congratulations! You've completed your journey through the discovery of cells. From Hooke's first observation to modern cell theory, you now understand how scientists uncovered the fundamental unit of life. The adventure of cellular discovery continues with every new observation!");
                    }
                }
            }
            
            tourStep();
            window.nextStep = tourStep;
        }

        // Quiz Function
        function showQuiz() {
            const questions = [
                "What did Robert Hooke observe in 1665 that led to naming cells?",
                "Who were the three scientists that contributed to cell theory?",
                "How does the microscope enable cellular discovery?",
                "Why do different cell types have different shapes?",
                "What are the advantages of unicellular versus multicellular organization?"
            ];
            
            const randomQ = questions[Math.floor(Math.random() * questions.length)];
            
            if (voiceEnabled) {
                speakText(`Let's test your knowledge of cell discovery! Here's your question: ${randomQ} Think about the historical journey from first observation to modern understanding!`);
            }
        }

        // Initialize
        function init() {
            initVoiceSystem();
            
            setTimeout(() => {
                const loading = document.getElementById('loadingOverlay');
                loading.style.opacity = '0';
                setTimeout(() => {
                    loading.style.display = 'none';
                    
                    if (voiceEnabled) {
                        speakText("Welcome to the fascinating story of cell discovery! We'll journey from Robert Hooke's first observation in 1665 through the development of cell theory and explore the amazing diversity of cellular life. Let's discover how scientists uncovered the secrets of life's fundamental building blocks!");
                    }
                }, 1000);
            }, 3000);
            
            document.addEventListener('keydown', (e) => {
                switch(e.key) {
                    case 'v': toggleVoice(); break;
                    case 'i': toggleInfo(); break;
                    case 'g': startGuidedTour(); break;
                    case 'Escape': stopSpeech(); guidedTourActive = false; break;
                    case 'ArrowRight': nextStep && nextStep(); break;
                }
            });
        }

        init();
    </script>
</body>
</html>