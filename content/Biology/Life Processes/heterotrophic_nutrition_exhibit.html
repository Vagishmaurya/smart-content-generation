<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Heterotrophic Nutrition Types - Complete Journey</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tween.js/18.6.4/tween.umd.js"></script>

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #e67e22 0%, #d35400 100%);
            color: white;
            overflow: hidden;
            position: relative;
            height: 100vh;
        }

        /* Animated Background */
        .bg-animation {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 0;
            opacity: 0.1;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320"><path fill="%23ffffff" fill-opacity="0.2" d="M0,96L48,112C96,128,192,160,288,186.7C384,213,480,235,576,213.3C672,192,768,128,864,128C960,128,1056,192,1152,197.3C1248,203,1344,149,1392,122.7L1440,96L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path></svg>') repeat-x;
            animation: wave 10s linear infinite;
        }

        @keyframes wave {
            0% { background-position-x: 0; }
            100% { background-position-x: 1440px; }
        }

        /* Museum Interface - Compact Header */
        .museum-header {
            position: absolute;
            top: 10px;
            left: 20px;
            text-align: left;
            z-index: 1000;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            padding: 10px 18px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        .museum-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 4px;
            background: linear-gradient(45deg, #e67e22, #d35400);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: titleGlow 3s ease-in-out infinite;
        }

        @keyframes titleGlow {
            0%, 100% { filter: brightness(1); }
            50% { filter: brightness(1.2); }
        }

        .exhibit-subtitle {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.8);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nutrition-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: #e67e22;
            border-radius: 50%;
            animation: nutrition-pulse 1.5s ease-in-out infinite;
        }

        @keyframes nutrition-pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.3); opacity: 0.7; }
        }

        /* Journey Navigation - Enhanced */
        .journey-navigation {
            position: absolute;
            bottom: 20px;
            left: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 1000;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            padding: 15px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            max-width: 320px;
        }

        .journey-title {
            font-size: 14px;
            font-weight: 600;
            color: #e67e22;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .journey-steps {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
        }

        .journey-btn {
            background: rgba(230, 126, 34, 0.2);
            border: 1px solid rgba(230, 126, 34, 0.4);
            color: white;
            padding: 6px 10px;
            border-radius: 20px;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 4px;
            white-space: nowrap;
        }

        .journey-btn:hover {
            background: rgba(230, 126, 34, 0.3);
            border-color: #e67e22;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(230, 126, 34, 0.3);
        }

        .journey-btn.active {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            border-color: #e74c3c;
            box-shadow: 0 0 20px rgba(231, 76, 60, 0.5);
            animation: pulse 2s infinite;
        }

        .journey-btn.completed {
            background: rgba(52, 152, 219, 0.3);
            border-color: #3498db;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* 3D Model Container */
        .model-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 0;
            overflow: hidden;
            border: none;
            z-index: 100;
        }

        .sketchfab-embed-wrapper {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #e67e22 0%, #d35400 100%);
        }

        .sketchfab-embed-wrapper iframe {
            width: 100%;
            height: 100%;
            border: none;
            border-radius: 0;
        }

        /* Information Panel - Enhanced */
        .info-panel {
            position: absolute;
            top: 70px;
            right: 20px;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 16px;
            padding: 24px;
            width: 380px;
            max-height: calc(100vh - 140px);
            z-index: 800;
            overflow-y: auto;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }

        .info-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
        }

        .info-icon {
            font-size: 28px;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        .info-title {
            flex: 1;
        }

        .info-title h2 {
            font-size: 18px;
            color: #e67e22;
            margin-bottom: 4px;
        }

        .info-subtitle {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
        }

        .info-content {
            color: rgba(255, 255, 255, 0.9);
            font-size: 14px;
            line-height: 1.6;
        }

        /* Progress Tracker */
        .progress-tracker {
            background: linear-gradient(135deg, rgba(230, 126, 34, 0.1), rgba(211, 84, 0, 0.1));
            border: 1px solid rgba(230, 126, 34, 0.3);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 20px;
        }

        .progress-header {
            font-size: 13px;
            font-weight: 600;
            color: #e67e22;
            margin-bottom: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .progress-percentage {
            font-size: 18px;
            color: #e74c3c;
            font-weight: 700;
        }

        .progress-bar {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 12px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #e67e22, #d35400);
            border-radius: 4px;
            transition: width 0.8s ease;
            box-shadow: 0 0 10px rgba(230, 126, 34, 0.5);
        }

        .progress-steps-mini {
            display: flex;
            justify-content: space-between;
            font-size: 10px;
            color: rgba(255, 255, 255, 0.6);
        }

        .step-mini {
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .step-mini.active {
            color: #e74c3c;
            font-weight: 600;
        }

        .step-mini.completed {
            color: #3498db;
        }

        /* Information Cards */
        .info-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 14px;
            margin-bottom: 14px;
        }

        .info-card-title {
            color: #e67e22;
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .info-card-content {
            color: rgba(255, 255, 255, 0.85);
            font-size: 12px;
            line-height: 1.5;
        }

        .info-list {
            list-style: none;
            padding: 0;
        }

        .info-list li {
            padding: 6px 0;
            padding-left: 20px;
            position: relative;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.8);
        }

        .info-list li:before {
            content: "→";
            position: absolute;
            left: 0;
            color: #e67e22;
        }

        /* Fun Fact Box */
        .fun-fact {
            background: linear-gradient(135deg, rgba(52, 152, 219, 0.1), rgba(155, 89, 182, 0.1));
            border: 1px solid rgba(52, 152, 219, 0.3);
            border-radius: 12px;
            padding: 14px;
            margin: 16px 0;
            position: relative;
            overflow: hidden;
        }

        .fun-fact:before {
            content: "🍽️";
            position: absolute;
            top: -20px;
            right: -20px;
            font-size: 60px;
            opacity: 0.1;
        }

        .fun-fact-title {
            color: #3498db;
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 6px;
        }

        .fun-fact-text {
            color: rgba(255, 255, 255, 0.9);
            font-size: 12px;
            line-height: 1.5;
            position: relative;
            z-index: 1;
        }

        /* Voice Controls */
        .voice-controls {
            position: absolute;
            top: 10px;
            right: 20px;
            display: flex;
            gap: 8px;
            z-index: 1000;
        }

        .control-btn {
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            position: relative;
        }

        .control-btn:hover {
            background: rgba(230, 126, 34, 0.3);
            border-color: #e67e22;
            transform: scale(1.1);
        }

        .control-btn.active {
            background: rgba(230, 126, 34, 0.4);
            border-color: #e67e22;
            box-shadow: 0 0 20px rgba(230, 126, 34, 0.5);
        }

        .control-tooltip {
            position: absolute;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.9);
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 10px;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .control-btn:hover .control-tooltip {
            opacity: 1;
        }

        /* Loading Screen */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #e67e22 0%, #d35400 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            transition: opacity 1s ease;
        }

        .loading-content {
            text-align: center;
        }

        .loading-nutrition {
            font-size: 60px;
            animation: nutrition-rotate 2s ease-in-out infinite;
            margin-bottom: 20px;
        }

        @keyframes nutrition-rotate {
            0%, 100% { transform: rotate(0deg) scale(1); }
            50% { transform: rotate(180deg) scale(1.1); }
        }

        .loading-text {
            color: white;
            font-size: 20px;
            margin-bottom: 20px;
        }

        .loading-progress {
            width: 200px;
            height: 4px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 2px;
            overflow: hidden;
        }

        .loading-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #e67e22, #d35400);
            animation: loading 2s ease-in-out infinite;
        }

        @keyframes loading {
            0% { width: 0%; }
            50% { width: 100%; }
            100% { width: 0%; }
        }

        /* Voice Indicator */
        .voice-indicator {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(230, 126, 34, 0.5);
            border-radius: 30px;
            padding: 14px 28px;
            display: flex;
            align-items: center;
            gap: 12px;
            z-index: 1000;
            opacity: 0;
            transition: all 0.3s ease;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }

        .voice-indicator.visible {
            opacity: 1;
            transform: translateX(-50%) translateY(-10px);
        }

        .voice-waves {
            display: flex;
            align-items: center;
            gap: 3px;
        }

        .voice-wave {
            width: 3px;
            height: 20px;
            background: linear-gradient(180deg, #e67e22, #d35400);
            border-radius: 2px;
            animation: voice-wave 1s ease-in-out infinite;
        }

        .voice-wave:nth-child(2) { animation-delay: 0.1s; }
        .voice-wave:nth-child(3) { animation-delay: 0.2s; }
        .voice-wave:nth-child(4) { animation-delay: 0.3s; }
        .voice-wave:nth-child(5) { animation-delay: 0.4s; }

        @keyframes voice-wave {
            0%, 100% { transform: scaleY(0.3); }
            50% { transform: scaleY(1); }
        }

        .narration-text {
            color: white;
            font-size: 13px;
            max-width: 300px;
        }

        /* Quick Actions */
        .quick-actions {
            position: absolute;
            bottom: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
            z-index: 1000;
        }

        .action-btn {
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 10px 16px;
            border-radius: 25px;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
        }

        .action-btn:hover {
            background: rgba(230, 126, 34, 0.3);
            border-color: #e67e22;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(230, 126, 34, 0.3);
        }

        /* Custom Scrollbar */
        .info-panel::-webkit-scrollbar {
            width: 6px;
        }

        .info-panel::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 3px;
        }

        .info-panel::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, #e67e22, #d35400);
            border-radius: 3px;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .info-panel {
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                top: auto;
                width: 100%;
                max-height: 50vh;
                border-radius: 20px 20px 0 0;
            }
            
            .journey-navigation {
                bottom: 52vh;
                max-width: calc(100% - 40px);
            }
            
            .voice-controls {
                top: auto;
                bottom: 55vh;
                right: 10px;
            }
            
            .quick-actions {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="bg-animation"></div>

    <!-- Loading Screen -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="loading-nutrition">🍽️</div>
            <div class="loading-text">Exploring Heterotrophic Nutrition...</div>
            <div class="loading-progress">
                <div class="loading-progress-bar"></div>
            </div>
        </div>
    </div>

    <!-- Museum Header -->
    <div class="museum-header">
        <div class="museum-title">Heterotrophic Nutrition Types</div>
        <div class="exhibit-subtitle">
            <span class="nutrition-indicator"></span>
            How Organisms Feed on Others
        </div>
    </div>

    <!-- Journey Navigation -->
    <div class="journey-navigation">
        <div class="journey-title">
            <span>🍽️</span>
            <span>Nutrition Strategies</span>
        </div>
        <div class="journey-steps">
            <button class="journey-btn active" onclick="loadJourneyStep('introduction')">
                <span>🌟</span> Introduction
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('amoeba_feeding')">
                <span>🦠</span> Amoeba
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('paramecium_feeding')">
                <span>👟</span> Paramecium
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('parasitic_nutrition')">
                <span>🪱</span> Parasites
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('enzyme_action')">
                <span>⚗️</span> Enzymes
            </button>
            <button class="journey-btn" onclick="loadJourneyStep('nutrition_comparison')">
                <span>📊</span> Comparison
            </button>
        </div>
    </div>

    <!-- 3D Model Container -->
    <div class="model-container">
        <div class="sketchfab-embed-wrapper">
            <iframe id="api-frame"
                    title="Heterotrophic Nutrition Model" 
                    frameborder="0" 
                    allowfullscreen 
                    mozallowfullscreen="true" 
                    webkitallowfullscreen="true" 
                    allow="autoplay; fullscreen; xr-spatial-tracking"
                    xr-spatial-tracking 
                    execution-while-out-of-viewport 
                    execution-while-not-rendered 
                    web-share 
                    src="https://sketchfab.com/models/171a16a37c4347799e4838853fd84ffe/embed?autostart=1&internal=1&tracking=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_watermark=0">
            </iframe>
        </div>
    </div>

    <!-- Information Panel -->
    <div class="info-panel" id="infoPanel">
        <div class="info-header">
            <div class="info-icon" id="stepIcon">🌟</div>
            <div class="info-title">
                <h2 id="stepTitle">Welcome to Heterotrophic Nutrition</h2>
                <div class="info-subtitle" id="stepSubtitle">How organisms depend on others for food</div>
            </div>
        </div>

        <!-- Progress Tracker -->
        <div class="progress-tracker">
            <div class="progress-header">
                <span>Learning Progress</span>
                <span class="progress-percentage" id="progressPercent">0%</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 0%"></div>
            </div>
            <div class="progress-steps-mini">
                <span class="step-mini active" onclick="loadJourneyStep('introduction')">Intro</span>
                <span class="step-mini" onclick="loadJourneyStep('amoeba_feeding')">Amoeba</span>
                <span class="step-mini" onclick="loadJourneyStep('paramecium_feeding')">Param</span>
                <span class="step-mini" onclick="loadJourneyStep('parasitic_nutrition')">Parasite</span>
                <span class="step-mini" onclick="loadJourneyStep('enzyme_action')">Enzyme</span>
                <span class="step-mini" onclick="loadJourneyStep('nutrition_comparison')">Compare</span>
            </div>
        </div>

        <div class="info-content" id="mainDescription">
            Unlike plants that make their own food, heterotrophic organisms must obtain nutrition by consuming other living things. This feeding strategy has evolved into diverse and fascinating forms, from simple single-celled organisms that engulf their prey to complex parasites that live inside their hosts.
        </div>

        <div class="info-card">
            <div class="info-card-title">
                <span>🔬</span> Key Concepts
            </div>
            <div class="info-card-content">
                <ul class="info-list" id="keyConcepts">
                    <li>Heterotrophs depend on other organisms for food</li>
                    <li>Different feeding strategies exist across species</li>
                    <li>Enzymes break down complex food molecules</li>
                    <li>Single-celled organisms show diverse feeding methods</li>
                </ul>
            </div>
        </div>

        <div class="fun-fact">
            <div class="fun-fact-title">Incredible Fact!</div>
            <div class="fun-fact-text" id="funFact">
                Some single-celled organisms can consume prey larger than themselves by slowly engulfing them over several hours!
            </div>
        </div>

        <div class="info-card">
            <div class="info-card-title">
                <span>🎯</span> Learning Objectives
            </div>
            <div class="info-card-content" id="learningObjectives">
                Explore different heterotrophic nutrition strategies, understand how single-celled organisms feed, and discover the role of enzymes in digestion.
            </div>
        </div>
    </div>

    <!-- Voice Controls -->
    <div class="voice-controls">
        <button class="control-btn active" id="voiceToggle" onclick="toggleVoice()">
            🔊
            <span class="control-tooltip">Voice Narration</span>
        </button>
        <button class="control-btn" onclick="toggleAutoPlay()">
            ▶️
            <span class="control-tooltip">Auto Journey</span>
        </button>
        <button class="control-btn" onclick="toggleInfo()">
            ℹ️
            <span class="control-tooltip">Toggle Info</span>
        </button>
    </div>

    <!-- Quick Actions -->
    <div class="quick-actions">
        <button class="action-btn" onclick="startGuidedTour()">
            <span>🚀</span> Guided Tour
        </button>
        <button class="action-btn" onclick="showQuiz()">
            <span>🎯</span> Test Knowledge
        </button>
    </div>

    <!-- Voice Indicator -->
    <div class="voice-indicator" id="voiceIndicator">
        <div class="voice-waves">
            <div class="voice-wave"></div>
            <div class="voice-wave"></div>
            <div class="voice-wave"></div>
            <div class="voice-wave"></div>
            <div class="voice-wave"></div>
        </div>
        <div class="narration-text" id="narrationText">Narrating...</div>
    </div>

    <script>
        // Journey Step Data with Complete Pedagogical Content
        const JOURNEY_DATA = {
            introduction: {
                title: "Welcome to Heterotrophic Nutrition",
                subtitle: "How organisms depend on others for food",
                icon: "🌟",
                modelUrl: "https://sketchfab.com/models/171a16a37c4347799e4838853fd84ffe/embed?autostart=1&internal=1&tracking=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_watermark=0",
                description: "Unlike plants that make their own food, heterotrophic organisms must obtain nutrition by consuming other living things. This feeding strategy has evolved into diverse and fascinating forms, from simple single-celled organisms that engulf their prey to complex parasites that live inside their hosts.",
                concepts: [
                    "Heterotrophs depend on other organisms for food",
                    "Different feeding strategies exist across species",
                    "Enzymes break down complex food molecules",
                    "Single-celled organisms show diverse feeding methods"
                ],
                funFact: "Some single-celled organisms can consume prey larger than themselves by slowly engulfing them over several hours!",
                objectives: "Explore different heterotrophic nutrition strategies, understand how single-celled organisms feed, and discover the role of enzymes in digestion.",
                narration: "Welcome to the world of heterotrophic nutrition! You're looking at an amoeba, one of the most fascinating examples of how organisms feed on others. The word 'heterotrophic' comes from Greek meaning 'other-feeding' - these organisms cannot make their own food like plants do, so they must consume other living things to survive. This creates an incredible diversity of feeding strategies throughout the natural world. Some organisms like this amoeba simply engulf their food, others filter it from water, some hunt actively, and still others live as parasites inside their hosts. What unites all heterotrophs is their dependence on the organic molecules created by other organisms. Every bite you take, every meal you eat, connects you to this ancient and essential biological process!"
            },
            amoeba_feeding: {
                title: "Amoeba - Engulfing Food",
                subtitle: "Phagocytosis in single-celled organisms",
                icon: "🦠",
                modelUrl: "https://sketchfab.com/models/171a16a37c4347799e4838853fd84ffe/embed?autostart=1&internal=1&tracking=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_watermark=0",
                description: "Amoebas demonstrate one of the most primitive yet effective feeding strategies called phagocytosis. They extend finger-like projections called pseudopodia to surround and engulf food particles, forming internal food vacuoles where digestion occurs.",
                concepts: [
                    "Phagocytosis means 'cell eating'",
                    "Pseudopodia extend to surround food",
                    "Food vacuoles form inside the cell",
                    "Digestive enzymes break down food internally"
                ],
                funFact: "An amoeba can detect food from a distance using chemical signals and will actively move toward potential meals!",
                objectives: "Understand how amoebas capture and digest food through phagocytosis and internal digestion.",
                narration: "Here we see an amoeba in action - one of nature's most elegant feeding machines! Watch how this single-celled organism uses phagocytosis, literally meaning 'cell eating,' to capture its food. The amoeba extends finger-like projections called pseudopodia around its prey, gradually surrounding and engulfing it. This process can take several minutes as the cell membrane flows around the food particle like a slow-motion embrace. Once the food is completely enclosed, it forms a food vacuole inside the amoeba. This vacuole then fuses with lysosomes containing digestive enzymes that break down the food into smaller molecules the cell can use. What's remarkable is that this entire process happens without any specialized organs - the amoeba is both hunter and digestive system in one! The nutrients are absorbed into the cytoplasm while waste materials are eventually expelled from the cell."
            },
            paramecium_feeding: {
                title: "Paramecium - Filter Feeding",
                subtitle: "Specialized feeding structures in protists",
                icon: "👟",
                modelUrl: "https://sketchfab.com/models/7cb325a9ac5346be943ef7ddd41de51e/embed?autostart=1&internal=1&tracking=0&ui_ar=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "Paramecium represents a more sophisticated approach to heterotrophic nutrition with specialized feeding structures. It uses cilia to create water currents that sweep food particles into its oral groove and cytostome, demonstrating how evolution has refined feeding mechanisms.",
                concepts: [
                    "Cilia create feeding currents",
                    "Oral groove channels food to cytostome",
                    "Food vacuoles circulate through cytoplasm",
                    "Specialized structures improve feeding efficiency"
                ],
                funFact: "A paramecium's cilia beat in coordinated waves, creating feeding currents that can capture thousands of bacteria per hour!",
                objectives: "Examine the specialized feeding structures of paramecium and understand how filter feeding works in microorganisms.",
                narration: "Meet the paramecium - a single-celled organism that has evolved sophisticated feeding machinery! Unlike the amoeba's simple engulfing strategy, the paramecium has developed specialized structures for filter feeding. Look at those hair-like cilia covering its surface - they beat in coordinated waves to propel the organism through water and create feeding currents. These currents sweep bacteria and other small food particles toward the oral groove, a funnel-like depression that leads to the cytostome or 'cell mouth.' As food particles collect in the cytostome, they're packaged into food vacuoles that then circulate through the cytoplasm. The paramecium essentially has an assembly line for food processing! The cilia not only help with feeding but also with locomotion, making the paramecium an efficient hunter that can actively seek out food-rich areas. This represents an evolutionary advancement - from passive engulfing to active filter feeding with specialized cellular machinery."
            },
            parasitic_nutrition: {
                title: "Parasitic Nutrition - Living on Others",
                subtitle: "Specialized adaptations for host dependence",
                icon: "🪱",
                modelUrl: "https://sketchfab.com/models/b93ad71b8f134504a261334028271269/embed?autostart=1&internal=1&tracking=0&ui_ar=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_theatre=1&ui_watermark=0",
                description: "Parasites represent an extreme form of heterotrophic nutrition where organisms live in or on other organisms, obtaining nutrients directly from their host. Tapeworms show remarkable adaptations for this lifestyle, including specialized attachment structures and efficient nutrient absorption systems.",
                concepts: [
                    "Parasites depend completely on host organisms",
                    "Specialized attachment structures prevent removal",
                    "Nutrient absorption occurs across body surface",
                    "Reduced digestive systems due to pre-digested food"
                ],
                funFact: "Some tapeworms can grow over 30 feet long inside their host, absorbing nutrients through their entire body surface!",
                objectives: "Understand parasitic nutrition strategies and how parasites have adapted to live within or on other organisms.",
                narration: "Here we see a tapeworm - a master of parasitic nutrition that represents one of the most specialized feeding strategies in nature! This ribbon-like organism has evolved to live inside the intestines of other animals, absorbing nutrients that the host has already digested. Notice the scolex or head region with its hooks and suckers - these structures allow the tapeworm to attach firmly to the intestinal wall, preventing it from being swept away by the flow of digested food. The tapeworm has essentially given up the ability to hunt or capture food in exchange for a guaranteed meal ticket. Its body surface is covered with tiny projections that maximize nutrient absorption, and it has no digestive system of its own since it lives in a bath of pre-digested nutrients! This extreme specialization shows how evolution can produce organisms perfectly adapted to their specific ecological niche, even when that niche involves living inside another organism."
            },
            enzyme_action: {
                title: "Enzyme Action in Digestion",
                subtitle: "Molecular machines that break down food",
                icon: "⚗️",
                modelUrl: "https://sketchfab.com/models/735ba3ace7ca48b3a38fc562c5f85e35/embed?autostart=1&internal=1&tracking=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_watermark=0",
                description: "Enzymes are the molecular machines that make heterotrophic nutrition possible by breaking down complex food molecules into simpler compounds that cells can absorb and use. Each enzyme is highly specific, catalyzing particular chemical reactions with remarkable efficiency.",
                concepts: [
                    "Enzymes are biological catalysts",
                    "Each enzyme has a specific shape and function",
                    "Lock and key model explains enzyme specificity",
                    "Enzymes speed up digestion reactions"
                ],
                funFact: "A single enzyme molecule can catalyze thousands of reactions per second, making digestion incredibly efficient!",
                objectives: "Understand how enzymes facilitate digestion and why they are essential for all heterotrophic nutrition.",
                narration: "You're looking at PETase, a remarkable enzyme that demonstrates the incredible specificity and efficiency of these biological catalysts! While this particular enzyme breaks down plastic, all digestive enzymes work on the same principle - they are molecular machines perfectly shaped to facilitate specific chemical reactions. In heterotrophic nutrition, enzymes are absolutely essential because they break down the complex food molecules that organisms consume into simpler compounds that cells can actually use. Think of enzymes as highly specialized molecular scissors - each one is designed to cut specific chemical bonds. A protease enzyme cuts proteins, a lipase cuts fats, and an amylase cuts starches. The lock and key model shows how each enzyme's active site is perfectly shaped to bind with its specific substrate, like a key fitting into a lock. Without enzymes, the chemical reactions needed for digestion would happen so slowly that organisms would starve! This is why all heterotrophic organisms, from single-celled amoebas to complex animals, depend on these remarkable molecular machines."
            },
            nutrition_comparison: {
                title: "Comparing Nutrition Strategies",
                subtitle: "Different approaches to obtaining food",
                icon: "📊",
                modelUrl: "https://sketchfab.com/models/171a16a37c4347799e4838853fd84ffe/embed?autostart=1&internal=1&tracking=0&ui_infos=0&ui_snapshots=1&ui_stop=0&ui_watermark=0",
                description: "Heterotrophic organisms have evolved diverse strategies for obtaining nutrition, each with distinct advantages and limitations. From the simple engulfing mechanism of amoebas to the specialized parasitic lifestyle of tapeworms, these feeding strategies represent different evolutionary solutions to the challenge of obtaining energy and nutrients.",
                concepts: [
                    "Holozoic nutrition involves ingesting whole food",
                    "Saprophytic nutrition involves decomposing matter",
                    "Parasitic nutrition involves living on hosts",
                    "Each strategy has unique advantages and trade-offs"
                ],
                funFact: "The diversity of heterotrophic nutrition strategies allows different organisms to exploit virtually every possible food source on Earth!",
                objectives: "Compare and contrast different heterotrophic nutrition strategies and understand their ecological significance.",
                narration: "Looking at this amoeba again, we can now appreciate how it represents just one of many heterotrophic nutrition strategies that have evolved in nature! Let's compare the different approaches we've explored. Holozoic nutrition, like that of the amoeba and paramecium, involves ingesting whole food particles and digesting them internally - this gives organisms the flexibility to choose their food and adapt to different environments. Saprophytic nutrition involves organisms that feed on dead and decaying matter, like mushrooms and many bacteria - they're nature's recyclers, breaking down complex organic molecules and returning nutrients to the ecosystem. Parasitic nutrition, as we saw with the tapeworm, involves living on or in another organism - while this guarantees a food source, it also creates complete dependence on the host. Each strategy represents an evolutionary trade-off between energy investment and food security. The remarkable diversity of these feeding strategies allows life to exploit virtually every possible food source on Earth, from sunlight and simple chemicals to complex organic matter and even other living organisms!"
            }
        };

        // Global Variables
        let currentStep = 'introduction';
        let voiceEnabled = true;
        let autoPlayEnabled = false;
        let currentSpeech = null;
        let selectedVoice = null;
        let journeyProgress = 0;
        let guidedTourActive = false;

        // Initialize Voice System
        function initVoiceSystem() {
            if (!('speechSynthesis' in window)) {
                console.warn('Speech synthesis not supported');
                voiceEnabled = false;
                document.getElementById('voiceToggle').style.display = 'none';
                return;
            }

            function loadVoices() {
                const voices = speechSynthesis.getVoices();
                if (voices.length === 0) return;

                const preferredVoices = [
                    'Google UK English Female',
                    'Microsoft Sonia',
                    'Microsoft Hazel',
                    'Samantha',
                    'Victoria'
                ];

                for (const name of preferredVoices) {
                    selectedVoice = voices.find(v => v.name.includes(name));
                    if (selectedVoice) break;
                }

                if (!selectedVoice) {
                    selectedVoice = voices.find(v => v.lang.startsWith('en'));
                }
            }

            loadVoices();
            if (speechSynthesis.onvoiceschanged !== undefined) {
                speechSynthesis.onvoiceschanged = loadVoices;
            }
        }

        // Load Journey Step
        function loadJourneyStep(stepId) {
            const stepData = JOURNEY_DATA[stepId];
            if (!stepData) return;

            currentStep = stepId;
            
            document.getElementById('api-frame').src = stepData.modelUrl;
            document.getElementById('stepIcon').textContent = stepData.icon;
            document.getElementById('stepTitle').textContent = stepData.title;
            document.getElementById('stepSubtitle').textContent = stepData.subtitle;
            document.getElementById('mainDescription').textContent = stepData.description;
            
            const conceptsList = document.getElementById('keyConcepts');
            conceptsList.innerHTML = stepData.concepts.map(c => `<li>${c}</li>`).join('');
            
            document.getElementById('funFact').textContent = stepData.funFact;
            document.getElementById('learningObjectives').textContent = stepData.objectives;
            
            updateNavigationButtons(stepId);
            updateProgress();
            
            if (voiceEnabled) {
                speakText(stepData.narration);
            }
        }

        function updateNavigationButtons(activeStep) {
            const buttons = document.querySelectorAll('.journey-btn');
            const steps = ['introduction', 'amoeba_feeding', 'paramecium_feeding', 'parasitic_nutrition', 'enzyme_action', 'nutrition_comparison'];
            const activeIndex = steps.indexOf(activeStep);
            
            buttons.forEach((btn, index) => {
                btn.classList.remove('active', 'completed');
                if (index < activeIndex) {
                    btn.classList.add('completed');
                } else if (index === activeIndex) {
                    btn.classList.add('active');
                }
            });
            
            const miniSteps = document.querySelectorAll('.step-mini');
            miniSteps.forEach((step, index) => {
                step.classList.remove('active', 'completed');
                if (index < activeIndex) {
                    step.classList.add('completed');
                } else if (index === activeIndex) {
                    step.classList.add('active');
                }
            });
        }

        function updateProgress() {
            const steps = ['introduction', 'amoeba_feeding', 'paramecium_feeding', 'parasitic_nutrition', 'enzyme_action', 'nutrition_comparison'];
            const currentIndex = steps.indexOf(currentStep);
            const progress = ((currentIndex + 1) / steps.length) * 100;
            
            document.getElementById('progressPercent').textContent = Math.round(progress) + '%';
            document.getElementById('progressFill').style.width = progress + '%';
        }

        function speakText(text) {
            if (!voiceEnabled || !text) return;
            
            stopSpeech();
            
            currentSpeech = new SpeechSynthesisUtterance(text);
            if (selectedVoice) {
                currentSpeech.voice = selectedVoice;
            }
            currentSpeech.rate = 0.9;
            currentSpeech.pitch = 1.0;
            currentSpeech.volume = 0.9;
            
            currentSpeech.onstart = () => {
                document.getElementById('voiceIndicator').classList.add('visible');
                document.getElementById('narrationText').textContent = 
                    text.substring(0, 50) + (text.length > 50 ? '...' : '');
            };
            
            currentSpeech.onend = () => {
                document.getElementById('voiceIndicator').classList.remove('visible');
                currentSpeech = null;
                
                if (guidedTourActive) {
                    setTimeout(nextStep, 2000);
                }
            };
            
            speechSynthesis.speak(currentSpeech);
        }

        function stopSpeech() {
            if (currentSpeech) {
                speechSynthesis.cancel();
                currentSpeech = null;
                document.getElementById('voiceIndicator').classList.remove('visible');
            }
        }

        function toggleVoice() {
            voiceEnabled = !voiceEnabled;
            const btn = document.getElementById('voiceToggle');
            btn.textContent = voiceEnabled ? '🔊' : '🔇';
            btn.classList.toggle('active', voiceEnabled);
            
            if (!voiceEnabled) {
                stopSpeech();
            }
        }

        function toggleAutoPlay() {
            autoPlayEnabled = !autoPlayEnabled;
            if (autoPlayEnabled) {
                startGuidedTour();
            } else {
                guidedTourActive = false;
            }
        }

        function toggleInfo() {
            const panel = document.getElementById('infoPanel');
            panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
        }

        function startGuidedTour() {
            guidedTourActive = true;
            const steps = ['introduction', 'amoeba_feeding', 'paramecium_feeding', 'parasitic_nutrition', 'enzyme_action', 'nutrition_comparison'];
            let stepIndex = 0;
            
            function tourStep() {
                if (stepIndex < steps.length && guidedTourActive) {
                    loadJourneyStep(steps[stepIndex]);
                    stepIndex++;
                } else {
                    guidedTourActive = false;
                    if (voiceEnabled) {
                        speakText("Congratulations! You've completed your journey through heterotrophic nutrition. You now understand the diverse strategies organisms use to obtain food and how these feeding methods have evolved across different species!");
                    }
                }
            }
            
            tourStep();
            window.nextStep = tourStep;
        }

        function showQuiz() {
            const questions = [
                "What does heterotrophic nutrition mean?",
                "How does an amoeba capture and digest food?",
                "What specialized structures help paramecium feed?",
                "How are parasites adapted for their lifestyle?",
                "What role do enzymes play in digestion?"
            ];
            
            const randomQ = questions[Math.floor(Math.random() * questions.length)];
            
            if (voiceEnabled) {
                speakText(`Here's a nutrition question: ${randomQ} Think about the different feeding strategies we've explored!`);
            }
        }

        function init() {
            initVoiceSystem();
            
            setTimeout(() => {
                const loading = document.getElementById('loadingOverlay');
                loading.style.opacity = '0';
                setTimeout(() => {
                    loading.style.display = 'none';
                    
                    if (voiceEnabled) {
                        speakText("Welcome to the fascinating world of heterotrophic nutrition! We'll explore how different organisms have evolved diverse strategies to obtain food from other living things. From simple single-celled hunters to complex parasites, let's discover the remarkable ways life feeds on life!");
                    }
                }, 1000);
            }, 3000);
            
            document.addEventListener('keydown', (e) => {
                switch(e.key) {
                    case 'v': toggleVoice(); break;
                    case 'i': toggleInfo(); break;
                    case 'g': startGuidedTour(); break;
                    case 'Escape': stopSpeech(); guidedTourActive = false; break;
                    case 'ArrowRight': nextStep && nextStep(); break;
                }
            });
        }

        init();
    </script>
</body>
</html>